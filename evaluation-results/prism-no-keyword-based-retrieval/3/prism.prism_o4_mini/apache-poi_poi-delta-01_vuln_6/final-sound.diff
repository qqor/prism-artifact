--- a/poi-ooxml/src/main/java/org/apache/poi/xssf/extractor/XSSFEventBasedExcelExtractor.java
+++ b/poi-ooxml/src/main/java/org/apache/poi/xssf/extractor/XSSFEventBasedExcelExtractor.java
@@ -73,7 +73,7 @@
     implements POIXMLTextExtractor, ExcelExtractor {
 
     private static final Logger LOGGER = PoiLogManager.getLogger(XSSFEventBasedExcelExtractor.class);
-    private static final Pattern MAJOR_VERSION_PATTERN = Pattern.compile("(-?(?:\\d{1,30})*)(?:\\.(\\dc?)*)");
+    private static final Pattern MAJOR_VERSION_PATTERN = Pattern.compile("^(-?\\d{1,30})(?:\\.(\\d{1,30}))?$");
     protected final OPCPackage container;
     protected final POIXMLProperties properties;
 
@@ -526,8 +526,12 @@
             if (appVersionString.isEmpty()) {
                 return;
             }
+            if (appVersionString.length() > 200) {
+                appVersionBuffer.setLength(0);
+                return;
+            }
             Matcher m = MAJOR_VERSION_PATTERN.matcher(appVersionString);
-            if (m.find()) {
+            if (m.matches()) {
                 text.append("MajorVersion: ").append(m.group(1)).append("\n");
             }
             appVersionBuffer.setLength(0);
