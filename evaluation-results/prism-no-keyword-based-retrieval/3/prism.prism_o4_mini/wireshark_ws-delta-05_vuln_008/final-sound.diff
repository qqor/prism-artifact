--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1141,7 +1141,11 @@
 	}
 
 				/* branch to handle commands */
-	session_id = (dissect_netb[ command])( tvb, pinfo, offset, netb_tree);
+	if ((guint)command < G_N_ELEMENTS(dissect_netb)) {
+		session_id = (dissect_netb[ command])( tvb, pinfo, offset, netb_tree);
+	} else {
+		session_id = dissect_netb_unknown(tvb, pinfo, offset, netb_tree);
+	}
 
 	offset += hdr_len;			/* move past header */
 
