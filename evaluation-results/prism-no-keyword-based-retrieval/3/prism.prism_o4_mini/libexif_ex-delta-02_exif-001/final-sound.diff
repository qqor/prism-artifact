--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -163,14 +163,21 @@
 			  "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
-	if (CHECKOVERFLOW(n->offset, buf_size, 6+8+4)) {
+	if (CHECKOVERFLOW(n->offset, buf_size, 8+4)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 			  "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
-	datao = 6 + n->offset;
+	datao = n->offset;
 
 	n->order = EXIF_BYTE_ORDER_INTEL;
+
+	/* Ensure we have room for a 4-byte pointer at buf + datao + 8 */
+	if (CHECKOVERFLOW(datao + 8, buf_size, 4)) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+			  "ExifMnoteDataFuji", "Short MakerNote");
+		return;
+	}
 
 	datao += exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
 	if (CHECKOVERFLOW(datao, buf_size, 2)) {
@@ -241,7 +248,7 @@
 			size_t dataofs = o + 8;
 			if (s > 4)
 				/* The data in this case is merely a pointer */
-				dataofs = exif_get_long (buf + dataofs, n->order) + 6 + n->offset;
+				dataofs = exif_get_long (buf + dataofs, n->order) + n->offset;
 
 			if (CHECKOVERFLOW(dataofs, buf_size, s)) {
 				exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
