--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -162,76 +162,70 @@
 
 static int
 exif_data_load_data_entry (ExifData *data, ExifEntry *entry,
-			   const unsigned char *d,
-			   unsigned int size, unsigned int offset)
-{
-	unsigned int s, doff;
-
+                           const unsigned char *d,
+                           size_t size, size_t offset)
+{
+	size_t s, doff;
+
+	/* 1) Ensure entire 12-byte entry header is within buffer */
+	if (offset > size || offset + 12 > size) {
+		exif_log(data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
+		         "Entry header past end of buffer (%zu+12 > %zu)", offset, size);
+		return 0;
+	}
+
+	/* 2) Read tag, format, components */
 	entry->tag        = exif_get_short (d + offset + 0, data->priv->order);
 	entry->format     = exif_get_short (d + offset + 2, data->priv->order);
 	entry->components = exif_get_long  (d + offset + 4, data->priv->order);
 
-	/* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent 
-	 * has not been set yet
-	 */
-	exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-		  "Loading entry 0x%x ('%s')...", entry->tag,
-		  exif_tag_get_name (entry->tag));
-
-	/* {0,1,2,4,8} x { 0x00000000 .. 0xffffffff } 
-	 *   -> { 0x000000000 .. 0x7fffffff8 } */
-	s = exif_format_get_size(entry->format) * entry->components;
-	if ((s < entry->components) || (s == 0)){
+	exif_log(data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
+	          "Loading entry 0x%x ('%s')...", entry->tag,
+	          exif_tag_get_name(entry->tag));
+
+	/* 3) Compute total data size 's', checking for multiplication overflow */
+	{
+		size_t fmt_size = exif_format_get_size(entry->format);
+		if (fmt_size == 0 || entry->components == 0 || fmt_size > SIZE_MAX / entry->components) {
+			return 0;
+		}
+		s = fmt_size * entry->components;
+	}
+
+	/* 4) Determine data offset 'doff' */
+	if (s <= 4) {
+		/* Inline data within entry */
+		doff = offset + 8;
+	} else {
+		/* Out-of-line data: ensure we can read the 4-byte pointer */
+		if (offset + 8 > size || offset + 12 > size) {
+			return 0;
+		}
+		ExifLong raw_off = exif_get_long(d + offset + 8, data->priv->order);
+		if (raw_off < 0) {
+			return 0;
+		}
+		doff = (size_t)raw_off;
+	}
+
+	/* 5) Final bounds check: doff + s must be within buffer */
+	if (doff > size || s > size - doff) {
 		return 0;
 	}
 
-	/*
-	 * Size? If bigger than 4 bytes, the actual data is not
-	 * in the entry but somewhere else (offset).
-	 */
-	if (s > 4)
-		doff = exif_get_long (d + offset + 8, data->priv->order);
-	else
-		doff = offset + 8;
-
-	/* Sanity checks */
-	if (doff >= size) {
-		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-				  "Tag starts past end of buffer (%u > %u)", doff, size);
+	/* 6) Allocate and copy data */
+	entry->data = exif_data_alloc(data, (unsigned)s);
+	if (!entry->data) {
 		return 0;
 	}
-
-	if (s > size - doff) {
-		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-				  "Tag data goes past end of buffer (%u > %u)", doff+s, size);
-		return 0;
-	}
-
-	entry->data = exif_data_alloc (data, s);
-	if (entry->data) {
-		entry->size = s;
-		memcpy (entry->data, d + doff, s);
-	} else {
-		EXIF_LOG_NO_MEMORY(data->priv->log, "ExifData", s);
-		return 0;
-	}
-
-	/* If this is the MakerNote, remember the offset */
+	entry->size = s;
+	memcpy(entry->data, d + doff, s);
+
+	/* 7) MakerNote handling */
 	if (entry->tag == EXIF_TAG_MAKER_NOTE) {
-		if (!entry->data) {
-			exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-					  "MakerNote found with empty data");	
-		} else if (entry->size > 6) {
-			exif_log (data->priv->log,
-					       EXIF_LOG_CODE_DEBUG, "ExifData",
-					       "MakerNote found (%02x %02x %02x %02x "
-					       "%02x %02x %02x...).",
-					       entry->data[0], entry->data[1], entry->data[2],
-					       entry->data[3], entry->data[4], entry->data[5],
-					       entry->data[6]);
-		}
 		data->priv->offset_mnote = doff;
 	}
+
 	return 1;
 }
 
