[2;36m[12/24/25 22:01:15][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=870612;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=108926;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp439sjk45[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/libxml2_lx-full-01_vuln_003/[0m[95magent-outpu[0m [2m               [0m
[2;36m                    [0m         [95mt-1766581275.9181194[0m                                                                 [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libxml2_lx-full-01_vuln_003.toml                      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m           ]8;id=208134;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=783114;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/24/25 22:01:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m Took     ]8;id=703002;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=265940;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m36.74[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=544592;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=843846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m ]8;id=450493;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=69427;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=499000;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=988586;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m36[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=238508;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=145423;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:01:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=442678;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=151144;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=979588;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=463425;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=144191;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=355804;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=15349;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=58141;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=963490;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=350861;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:01:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m1.22[0m seconds;               ]8;id=983857;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=15830;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=359738;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=362604;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=351763;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=294374;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 22:01:57][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=985451;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=998501;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mxml[0m                                                                        [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer xml -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m     [2m                [0m
[2;36m                    [0m         -[33mdict[0m=[35mxml[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                          [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m104[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1138606941[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49694[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c517f8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x5607b8c5da16[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49694[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c5da18[0m[39m,[0m[1;36m0x5607b8d1fbf8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000000b37[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x5607b882c0d2[0m[39m bp [0m[1;36m0x7fffed2238d0[0m[39m sp [0m[1;36m0x7fffed223090[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m48[0m[39m at [0m[1;36m0x502000000b37[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882c0d1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlSBufAddEntitySecure [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlExpandPEsInEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4005:17[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b8886a54[0m[39m in xmlParseEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4119:5[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b889d1c2[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m5940:18[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b870586d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mxml+0x1aa86d[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--xmlSBufAddEntitySecure--xmlExpandPEsInEntityValue[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x502000000b37[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000000b30[0m[39m,[0m[1;36m0x502000000b37[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882e1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b886e018[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrndup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m57:11[0m                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrdup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m82:12[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b8b0c49b[0m[39m in xmlCreateEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m137:14[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b8b0be91[0m[39m in xmlAddEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m269:11[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88eda34[0m[39m in xmlSAX2EntityDecl [0m[35m/src/libxml2/[0m[95mSAX2.c[0m[39m:[0m[1;92m537:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b889d824[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlStrndup[0m                        [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m[39m in [0m     [2m                [0m
[2;36m                    [0m         [39mxmlSBufAddEntitySecure[0m                                                              [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000880[0m[39m: fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000900[0m[39m: fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m05[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000980[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a00[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a80[0m[39m: fa fa fd fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000b00[0m[39m: fa fa fd fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000b80[0m[39m: fa fa fd fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m02[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c00[0m[39m: fa fa fd fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp88br1tun[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce xml[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mxml[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer xml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mxml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                          [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m104[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1138606941[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49694[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c517f8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x5607b8c5da16[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49694[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c5da18[0m[39m,[0m[1;36m0x5607b8d1fbf8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000000b37[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x5607b882c0d2[0m[39m bp [0m[1;36m0x7fffed2238d0[0m[39m sp [0m[1;36m0x7fffed223090[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m48[0m[39m at [0m[1;36m0x502000000b37[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882c0d1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlSBufAddEntitySecure [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlExpandPEsInEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4005:17[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b8886a54[0m[39m in xmlParseEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4119:5[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b889d1c2[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m5940:18[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b870586d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mxml+0x1aa86d[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--xmlSBufAddEntitySecure--xmlExpandPEsInEntityValue[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x502000000b37[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000000b30[0m[39m,[0m[1;36m0x502000000b37[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882e1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b886e018[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrndup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m57:11[0m                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrdup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m82:12[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b8b0c49b[0m[39m in xmlCreateEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m137:14[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b8b0be91[0m[39m in xmlAddEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m269:11[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88eda34[0m[39m in xmlSAX2EntityDecl [0m[35m/src/libxml2/[0m[95mSAX2.c[0m[39m:[0m[1;92m537:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b889d824[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlStrndup[0m                        [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m[39m in [0m     [2m                [0m
[2;36m                    [0m         [39mxmlSBufAddEntitySecure[0m                                                              [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000880[0m[39m: fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000900[0m[39m: fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m05[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000980[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a00[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a80[0m[39m: fa fa fd fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000b00[0m: fa fa fd fa fa fa[1m[[0m[1;36m07[0m[1m][0mfa fa fa [1;36m07[0m fa fa fa [1;36m00[0m [1;36m01[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000b80[0m: fa fa fd fa fa fa [1;36m06[0m fa fa fa [1;36m06[0m fa fa fa [1;36m00[0m [1;36m02[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000c00[0m: fa fa fd fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000c80[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000d00[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000d80[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp88br1tun[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce xml [2m                [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 22:02:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=173423;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=141577;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 22:03:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=217598;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=601746;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 22:04:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=739527;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=915246;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=778954;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=632282;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=257920;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=679205;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 22:04:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Started[33m...[0m                             ]8;id=933705;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=557007;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpdekwbbxa[0m                                                 ]8;id=686517;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=340406;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/24/25 22:04:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Took [1;36m29.31[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=506857;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=739278;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Started[33m...[0m                       ]8;id=620553;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=14634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:04:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Took [1;36m8.32[0m seconds;              ]8;id=233333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=142319;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Started[33m...[0m                          ]8;id=627461;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=328824;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:04:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Took [1;36m1.18[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=95093;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=535115;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Started[33m...[0m                              ]8;id=225674;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=199398;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=539943;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445288;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=187585;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=3588;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:04:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=299333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=529070;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 22:04:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=679429;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=761557;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=401293;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=927050;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=375392;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=25779;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 22:04:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=454701;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=553761;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=260513;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=752705;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/parser.c                                                                      [2m                [0m
[2;36m                    [0m         +++ b/parser.c                                                                      [2m                [0m
[2;36m                    [0m         @@ [1;36m-766[0m,[1;36m9[0m +[1;36m766[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  return;                                                                    [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    if [1m([0mbuf->cap == [1;36m0[0m[1m)[0m [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m Ensure that the buffer is double the necessary size                     [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m This ensures no buffer overflow is possible                             [2m                [0m
[2;36m                    [0m         +    if [1m([0mbuf->cap - buf->size [1m<[0m[39m len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, len * [0m[1;36m2[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m             return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-4002[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m4000[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m                 [0m[35m/[0m[35m/[0m[39m Grow the buffer to handle the input[0m                             [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, str - chunk[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->name, ent->length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->content, ent->length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m                 chunk = str;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mxml[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer xml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mxml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                          [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m104[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1138606941[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49694[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c517f8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x5607b8c5da16[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49694[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c5da18[0m[39m,[0m[1;36m0x5607b8d1fbf8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000000b37[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x5607b882c0d2[0m[39m bp [0m[1;36m0x7fffed2238d0[0m[39m sp [0m[1;36m0x7fffed223090[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m48[0m[39m at [0m[1;36m0x502000000b37[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882c0d1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlSBufAddEntitySecure [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlExpandPEsInEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4005:17[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b8886a54[0m[39m in xmlParseEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4119:5[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b889d1c2[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m5940:18[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b870586d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mxml+0x1aa86d[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--xmlSBufAddEntitySecure--xmlExpandPEsInEntityValue[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x502000000b37[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000000b30[0m[39m,[0m[1;36m0x502000000b37[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882e1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b886e018[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrndup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m57:11[0m                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrdup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m82:12[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b8b0c49b[0m[39m in xmlCreateEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m137:14[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b8b0be91[0m[39m in xmlAddEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m269:11[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88eda34[0m[39m in xmlSAX2EntityDecl [0m[35m/src/libxml2/[0m[95mSAX2.c[0m[39m:[0m[1;92m537:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b889d824[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlStrndup[0m                        [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m[39m in [0m     [2m                [0m
[2;36m                    [0m         [39mxmlSBufAddEntitySecure[0m                                                              [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000880[0m[39m: fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000900[0m[39m: fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m05[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000980[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a00[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a80[0m[39m: fa fa fd fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000b00[0m[39m: fa fa fd fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000b80[0m[39m: fa fa fd fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m02[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c00[0m[39m: fa fa fd fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp88br1tun[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce xml[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDuring a fuzzing session of the libxml2 XML parser [0m[1;39m([0m[39m`out/xml`[0m[1;39m)[0m[39m, AddressSanitizer [0m   [2m                [0m
[2;36m                    [0m         [39mdetected a heap-buffer-overflow in the function `xmlSBufAddEntitySecure` [0m           [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mparser.[0m[1;92mc:777[0m[1;39m)[0m[39m. A [0m[1;36m7[0m[39m-byte heap buffer was allocated by `xmlFuzzMalloc`[0m[35m/[0m[39m`xmlStrdup` [0m  [2m                [0m
[2;36m                    [0m         [39mbut a `memcpy` of [0m[1;36m48[0m[39m bytes was attempted, leading to an out-of-bounds read and [0m     [2m                [0m
[2;36m                    [0m         [39mabort.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Issue observed**  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  The fuzzer invoked `LLVMFuzzerTestOneInput`, which calls into [0m                    [2m                [0m
[2;36m                    [0m         [39m`xmlCtxtParseDocument` → `xmlParseDocument` → `xmlParseInternalSubset` → [0m           [2m                [0m
[2;36m                    [0m         [39m`xmlParseEntityDecl` → `xmlParseEntityValue` → `xmlExpandPEsInEntityValue` → [0m       [2m                [0m
[2;36m                    [0m         [39m`xmlSBufAddEntitySecure`. At that point a `__asan_memcpy` attempted to copy [0m[1;36m48[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mbytes into a buffer that was only [0m[1;36m7[0m[39m bytes long, triggering an ASan [0m                 [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Vulnerability type**  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m  Heap-based buffer overflow [0m[1;39m([0m[39mmulti-byte read overflow[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Important observations**  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m  • The overflow occurs when processing an entity declaration in the internal [0m      [2m                [0m
[2;36m                    [0m         [39msubset of the DTD.  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m  • The offending buffer is allocated via `xmlFuzzMalloc` in the fuzz harness [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mthrough `xmlStrdup`[0m[1;39m)[0m[39m, indicating the vulnerable path is exercised with fuzzed [0m     [2m                [0m
[2;36m                    [0m         [39mentity names or values.  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m  • ASan’s shadow bytes confirm that the overflow happens immediately after the [0m    [2m                [0m
[2;36m                    [0m         [39mright redzone of the allocated [0m[1;36m7[0m[39m-byte region.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m  • The full crash stack trace, including addresses and allocation points, is [0m      [2m                [0m
[2;36m                    [0m         [39mprovided in the ASan report.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Areas to investigate**  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m  • `parser.c`, especially the functions `xmlSBufAddEntitySecure`, [0m                 [2m                [0m
[2;36m                    [0m         [39m`xmlExpandPEsInEntityValue`, `xmlParseEntityValue`, `xmlParseEntityDecl` and [0m       [2m                [0m
[2;36m                    [0m         [39mrelated DTD/internal-subset parsing logic.  [0m                                        [2m                [0m
[2;36m                    [0m         [39m  • `xmlstring.c` implementation of `xmlStrdup`[0m[35m/[0m[39m`xmlStrndup` to understand [0m         [2m                [0m
[2;36m                    [0m         [39mallocation sizes.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  • `entities.c` code around `xmlCreateEntity` and `xmlAddEntity` where entity [0m     [2m                [0m
[2;36m                    [0m         [39mname/value buffers are set up.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  • The fuzz harness at `fuzz/xml.c` for how inputs are handed over to [0m             [2m                [0m
[2;36m                    [0m         [39m`xmlCtxtParseDocument`.  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m  • Any data structures tracking entity content size to confirm they match buffer [0m  [2m                [0m
[2;36m                    [0m         [39mallocations.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis evaluation report collates the observed fault and highlights the components of[0m [2m                [0m
[2;36m                    [0m         [39mthe libxml2 codebase that should be reviewed to fully understand the overflow [0m      [2m                [0m
[2;36m                    [0m         [39mwithout speculating on its root cause or proposing fixes.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mxml[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer xml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mxml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                          [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m104[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1138606941[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49694[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c517f8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x5607b8c5da16[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49694[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49694[0m[39m [0m[1;39m[[0m[1;36m0x5607b8c5da18[0m[39m,[0m[1;36m0x5607b8d1fbf8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mxml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000000b37[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x5607b882c0d2[0m[39m bp [0m[1;36m0x7fffed2238d0[0m[39m sp [0m[1;36m0x7fffed223090[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m48[0m[39m at [0m[1;36m0x502000000b37[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882c0d1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlSBufAddEntitySecure [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b8889126[0m[39m in xmlExpandPEsInEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4005:17[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b8886a54[0m[39m in xmlParseEntityValue [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m4119:5[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b889d1c2[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m5940:18[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b870586d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mxml+0x1aa86d[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--xmlSBufAddEntitySecure--xmlExpandPEsInEntityValue[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x502000000b37[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000000b30[0m[39m,[0m[1;36m0x502000000b37[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5607b882e1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5607b886e018[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrndup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m57:11[0m                  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5607b895efa4[0m[39m in xmlStrdup [0m[35m/src/libxml2/[0m[95mxmlstring.c[0m[39m:[0m[1;92m82:12[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5607b8b0c49b[0m[39m in xmlCreateEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m137:14[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5607b8b0be91[0m[39m in xmlAddEntity [0m[35m/src/libxml2/[0m[95mentities.c[0m[39m:[0m[1;92m269:11[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5607b88eda34[0m[39m in xmlSAX2EntityDecl [0m[35m/src/libxml2/[0m[95mSAX2.c[0m[39m:[0m[1;92m537:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x5607b889d824[0m[39m in xmlParseEntityDecl [0m[35m/src/libxml2/[0m[95mparser.c[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5607b88bf5aa[0m[39m in xmlParseInternalSubset [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m8422:10[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x5607b88be48d[0m[39m in xmlParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m10878[0m[39m:[0m[1;36m6[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x5607b88cebf0[0m[39m in xmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;36m13991[0m[39m:[0m[1;36m5[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5607b886da4f[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mxml.c[0m[39m:[0m[1;92m68:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x5607b8722410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5607b870d685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x5607b871311f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x5607b873e3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m16[0m[39m [0m[1;36m0x7f5ec5066082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlStrndup[0m                        [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mparser.c[0m[39m:[0m[1;92m777:9[0m[39m in [0m     [2m                [0m
[2;36m                    [0m         [39mxmlSBufAddEntitySecure[0m                                                              [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000880[0m[39m: fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000900[0m[39m: fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m05[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000980[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m05[0m[39m fa fa fa [0m[1;36m06[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a00[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000a80[0m[39m: fa fa fd fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000b00[0m[39m: fa fa fd fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m07[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m01[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000b80[0m[39m: fa fa fd fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m02[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c00[0m[39m: fa fa fd fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000c80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000d80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp88br1tun[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce xml[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparser.[0m[1;92mc:760[0m[39m-[0m[1;36m820[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:[0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mxmlSBuf *buf, const xmlChar *str, unsigned len[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:    if [0m[1;39m([0m[39mbuf->max - buf->size < len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:        if [0m[1;39m([0m[39mbuf->code == XML_ERR_OK[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:            buf->code = XML_ERR_RESOURCE_LIMIT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:    if [0m[1;39m([0m[39mbuf->cap == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:        [0m[35m/[0m[35m/[0m[39m Ensure that the buffer is double the necessary size[0m                  [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:        [0m[35m/[0m[35m/[0m[39m This ensures no buffer overflow is possible[0m                          [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:        if [0m[1;39m([0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, len * [0m[1;36m2[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:    if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mbuf->mem + buf->size, str, len[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    buf->size += len;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:[0m[1;35mxmlSBufAddString[0m[1;39m([0m[39mxmlSBuf *buf, const xmlChar *str, unsigned len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:    if [0m[1;39m([0m[39mbuf->max - buf->size < len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        if [0m[1;39m([0m[39mbuf->code == XML_ERR_OK[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:            buf->code = XML_ERR_RESOURCE_LIMIT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:    if [0m[1;39m([0m[39mbuf->cap - buf->size <= len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:        if [0m[1;39m([0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, len[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mbuf->mem + buf->size, str, len[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    buf->size += len;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m[1;35mxmlSBufAddCString[0m[1;39m([0m[39mxmlSBuf *buf, const char *str, unsigned len[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[1;35mxmlSBufAddString[0m[1;39m([0m[39mbuf, [0m[1;39m([0m[39mconst xmlChar *[0m[1;39m)[0m[39m str, len[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:[0m[1;35mxmlSBufAddChar[0m[1;39m([0m[39mxmlSBuf *buf, int c[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    xmlChar *end;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mbuf->max - buf->size < [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        if [0m[1;39m([0m[39mbuf->code == XML_ERR_OK[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:            buf->code = XML_ERR_RESOURCE_LIMIT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    if [0m[1;39m([0m[39mbuf->cap - buf->size <= [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:        if [0m[1;39m([0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, [0m[1;36m4[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    end = buf->mem + buf->size;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparser.[0m[1;92mc:3980[0m[39m-[0m[1;36m4040[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3980[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3981[0m[39m:            if [0m[1;39m([0m[39ment->flags & XML_ENT_EXPANDING[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3982[0m[39m:                [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_ENTITY_LOOP, NULL[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m3983[0m[39m:                [0m[1;35mxmlHaltParser[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3984[0m[39m:                return;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m3985[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3986[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3987[0m[39m:            ent->flags |= XML_ENT_EXPANDING;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3988[0m[39m:            [0m[1;35mxmlExpandPEsInEntityValue[0m[1;39m([0m[39mctxt, buf, ent->content, ent->length,[0m    [2m                [0m
[2;36m                    [0m         [1;36m3989[0m[39m:                                      depth[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m3990[0m[39m:            ent->flags &= ~XML_ENT_EXPANDING;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m3991[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3992[0m[39m:            chunk = str;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m3993[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc == [0m[32m'*'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3994[0m[39m:            if [0m[1;39m([0m[39m str[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'%'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3995[0m[39m:                str++;                [0m                                         [2m                [0m
[2;36m                    [0m         [1;36m3996[0m[39m:                xmlEntityPtr ent;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3997[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3998[0m[39m:                ent = [0m[1;35mxmlParseStringPEReference[0m[1;39m([0m[39mctxt, &str[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m3999[0m[39m:                if [0m[1;39m([0m[39ment == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m4000[0m[39m:                    return;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4001[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m4002[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4003[0m[39m:                [0m[35m/[0m[35m/[0m[39m Grow the buffer to handle the input[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4004[0m[39m:                [0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, str - chunk[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m4005[0m[39m:                [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->name, ent->length[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m4006[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4007[0m[39m:                chunk = str;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4008[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4009[0m[39m:                [0m[35m/[0m[39m* Normal ASCII char *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4010[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mIS_BYTE_CHAR[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4011[0m[39m:                    [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_INVALID_CHAR,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4012[0m[39m:                            [0m[32m"invalid character in entity value\n"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m4013[0m[39m:                    if [0m[1;39m([0m[39mchunk < str[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m4014[0m[39m:                        [0m[1;35mxmlSBufAddEntity[0m[1;39m([0m[39mbuf, chunk, str - chunk[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m4015[0m[39m:                    [0m[1;35mxmlSBufAddReplChar[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4016[0m[39m:                    str += [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m4017[0m[39m:                    chunk = str;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4018[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m4019[0m[39m:                    str += [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m4020[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m4021[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4022[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4023[0m[39m:            [0m[35m/[0m[39m* Normal ASCII char *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4024[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mIS_BYTE_CHAR[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4025[0m[39m:                [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_INVALID_CHAR,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4026[0m[39m:                        [0m[32m"invalid character in entity value\n"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m4027[0m[39m:                if [0m[1;39m([0m[39mchunk < str[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4028[0m[39m:                    [0m[1;35mxmlSBufAddString[0m[1;39m([0m[39mbuf, chunk, str - chunk[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4029[0m[39m:                [0m[1;35mxmlSBufAddReplChar[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m4030[0m[39m:                str += [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4031[0m[39m:                chunk = str;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4032[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4033[0m[39m:                str += [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4034[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4035[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m4036[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m4037[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4038[0m[39m:    if [0m[1;39m([0m[39mchunk < str[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4039[0m[39m:        [0m[1;35mxmlSBufAddString[0m[1;39m([0m[39mbuf, chunk, str - chunk[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m4040[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mentities.[0m[1;92mc:120[0m[39m-[0m[1;36m180[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;35mxmlCreateEntity[0m[1;39m([0m[39mxmlDocPtr doc, const xmlChar *name, int type,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        const xmlChar *ExternalID, const xmlChar *SystemID,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        const xmlChar *content[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    xmlEntityPtr ret;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    ret = [0m[1;39m([0m[39mxmlEntityPtr[0m[1;39m)[0m[39m [0m[1;35mxmlMalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mxmlEntity[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    if [0m[1;39m([0m[39mret == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mret, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mxmlEntity[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    ret->doc = doc;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    ret->type = XML_ENTITY_DECL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     * fill the structure.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    ret->etype = [0m[1;39m([0m[39mxmlEntityType[0m[1;39m)[0m[39m type;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mdoc == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mdoc->dict == NULL[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39mret->name = [0m[1;35mxmlStrdup[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        ret->name = [0m[1;35mxmlDictLookup[0m[1;39m([0m[39mdoc->dict, name, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    if [0m[1;39m([0m[39mret->name == NULL[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        goto error;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    if [0m[1;39m([0m[39mExternalID != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        ret->ExternalID = [0m[1;35mxmlStrdup[0m[1;39m([0m[39mExternalID[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        if [0m[1;39m([0m[39mret->ExternalID == NULL[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            goto error;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    if [0m[1;39m([0m[39mSystemID != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        ret->SystemID = [0m[1;35mxmlStrdup[0m[1;39m([0m[39mSystemID[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        if [0m[1;39m([0m[39mret->SystemID == NULL[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            goto error;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    if [0m[1;39m([0m[39mcontent != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        ret->length = [0m[1;35mxmlStrlen[0m[1;39m([0m[39mcontent[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39mret->content = [0m[1;35mxmlStrndup[0m[1;39m([0m[39mcontent, ret->length[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39mret->content == NULL[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            goto error;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        ret->length = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        ret->content = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    ret->URI = NULL; [0m[35m/[0m[39m* to be computed by the layer knowing[0m                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39m        [0m[39mthe defining entity *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    ret->orig = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m167:e[0m[39mrror:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[1;35mxmlFreeEntity[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m: * xmlAddEntity:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m: * @doc:  the document[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m: * @extSubset:  add to the external or internal subset[0m                          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m: * @name:  the entity name[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m: * @type:  the entity type XML_xxx_yyy_ENTITY[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m: * @ExternalID:  the entity external ID if available[0m                            [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m: * @SystemID:  the entity system ID if available[0m                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m: * @content:  the entity content[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmlstring.[0m[1;92mc:1[0m[39m-[0m[1;36m120[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * string.c : an XML string utilities module[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * This module provides various utility functions for manipulating[0m                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * the xmlChar* type. All functions named xmlStr* have been moved here[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * from the parser.c file [0m[1;39m([0m[39mtheir original home[0m[1;39m)[0m[39m.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * See Copyright for the status of this software.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * UTF8 string routines from:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * William Brack <wbrack@mmm.com.hk>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * daniel@veillard.com[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#define IN_LIBXML[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#include [0m[32m"libxml.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <limits.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include <libxml/xmlmemory.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include <libxml/parserInternals.h>[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <libxml/xmlstring.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include [0m[32m"private/parser.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"private/string.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#ifndef va_copy[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  #ifdef __va_copy[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    #define [0m[1;35mva_copy[0m[1;39m([0m[39mdest, src[0m[1;39m)[0m[39m [0m[1;35m__va_copy[0m[1;39m([0m[39mdest, src[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  #else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    #define [0m[1;35mva_copy[0m[1;39m([0m[39mdest, src[0m[1;39m)[0m[39m [0m[1;35mmemcpy[0m[1;39m([0m[39m&[0m[1;39m([0m[39mdest[0m[1;39m)[0m[39m, &[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mva_list[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:  #endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[35m/[0m[39m************************************************************************[0m        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *                                                                      *[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *                Commodity functions to handle xmlChars                *[0m        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *                                                                      *[0m        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: ************************************************************************[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * xmlStrndup:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * @cur:  the input xmlChar *[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * @len:  the len of @cur[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * a strndup for array of xmlChar's[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * Returns a new xmlChar * or NULL[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:xmlChar *[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m[1;35mxmlStrndup[0m[1;39m([0m[39mconst xmlChar *cur, int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    xmlChar *ret;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mcur == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    ret = [0m[1;35mxmlMalloc[0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m len + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    if [0m[1;39m([0m[39mret == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mret, cur, len[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    ret[0m[1;39m[[0m[39mlen[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * xmlStrdup:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m: * @cur:  the input xmlChar *[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m: * a strdup for array of xmlChar's. Since they are supposed to be[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m: * encoded in UTF-[0m[1;36m8[0m[39m or an encoding with 8bit based chars, we assume[0m              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m: * a termination mark of [0m[32m'0'[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m: * Returns a new xmlChar * or NULL[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:xmlChar *[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;35mxmlStrdup[0m[1;39m([0m[39mconst xmlChar *cur[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    const xmlChar *p = cur;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    if [0m[1;39m([0m[39mcur == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    while [0m[1;39m([0m[39m*p != [0m[1;36m0[0m[1;39m)[0m[39m p++; [0m[35m/[0m[39m* non input consuming *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;35mxmlStrndup[0m[1;39m([0m[39mcur, p - cur[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * xmlCharStrndup:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * @cur:  the input char *[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * @len:  the len of @cur[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: * a strndup for char's to xmlChar's[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * Returns a new xmlChar * or NULL[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:xmlChar *[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;35mxmlCharStrndup[0m[1;39m([0m[39mconst char *cur, int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    int i;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    xmlChar *ret;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mcur == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    ret = [0m[1;35mxmlMalloc[0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m len + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    if [0m[1;39m([0m[39mret == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m;i < len;i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[35m/[0m[39m* Explicit sign change *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        ret[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;39m([0m[39mxmlChar[0m[1;39m)[0m[39m cur[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        if [0m[1;39m([0m[39mret[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    ret[0m[1;39m[[0m[39mlen[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m: * xmlCharStrdup:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m: * @cur:  the input char *[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m: * a strdup for char's to xmlChar's[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m: * Returns a new xmlChar * or NULL[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparser.[0m[1;92mc:5900[0m[39m-[0m[1;36m6000[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m5900[0m[39m:   [0m[39m        [0m[39m     name, NULL, NULL[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m5901[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m5902[0m[39m:   [0m[39mif [0m[1;39m([0m[39mSKIP_BLANKS_PE == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m5903[0m[39m:   [0m[39m    [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_SPACE_REQUIRED,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m5904[0m[39m:   [0m[39m        [0m[39m        [0m[39m   [0m[32m"Space required after the entity name\n"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m5905[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m5906[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m5907[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m5908[0m[39m:   [0m[39m * handle the various case of definitions[0m[33m...[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5909[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m5910[0m[39m:   [0m[39mif [0m[1;39m([0m[39misParameter[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5911[0m[39m:   [0m[39m    if [0m[1;39m([0m[1;39m([0m[39mRAW == [0m[32m'"'[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mRAW == [0m[32m'\''[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m5912[0m[39m:   [0m[39m        value = [0m[1;35mxmlParseEntityValue[0m[1;39m([0m[39mctxt, &orig[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5913[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m5914[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[1;39m([0m[39mctxt->sax != NULL[0m[1;39m)[0m[39m &&[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m5915[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m([0m[39m!ctxt->disableSAX[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mctxt->sax->entityDecl != NULL[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m5916[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->sax->[0m[1;35mentityDecl[0m[1;39m([0m[39mctxt->userData, name,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m5917[0m[39m:   [0m[39m        [0m[39m                    XML_INTERNAL_PARAMETER_ENTITY,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m5918[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m    NULL, NULL, value[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m5919[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5920[0m[39m:   [0m[39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5921[0m[39m:   [0m[39m        URI = [0m[1;35mxmlParseExternalID[0m[1;39m([0m[39mctxt, &literal, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m5922[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mURI == NULL[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mliteral == NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5923[0m[39m:   [0m[39m        [0m[39m    [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_VALUE_REQUIRED, NULL[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m5924[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5925[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mURI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5926[0m[39m:                    if [0m[1;39m([0m[1;35mxmlStrchr[0m[1;39m([0m[39mURI, [0m[32m'#'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5927[0m[39m:                        [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_URI_FRAGMENT, NULL[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m5928[0m[39m:                    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m5929[0m[39m:                        if [0m[1;39m([0m[1;39m([0m[39mctxt->sax != NULL[0m[1;39m)[0m[39m &&[0m                             [2m                [0m
[2;36m                    [0m         [1;36m5930[0m[39m:                            [0m[1;39m([0m[39m!ctxt->disableSAX[0m[1;39m)[0m[39m &&[0m                             [2m                [0m
[2;36m                    [0m         [1;36m5931[0m[39m:                            [0m[1;39m([0m[39mctxt->sax->entityDecl != NULL[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5932[0m[39m:                            ctxt->sax->[0m[1;35mentityDecl[0m[1;39m([0m[39mctxt->userData, name,[0m        [2m                [0m
[2;36m                    [0m         [1;36m5933[0m[39m:                                        XML_EXTERNAL_PARAMETER_ENTITY,[0m         [2m                [0m
[2;36m                    [0m         [1;36m5934[0m[39m:                                        literal, URI, NULL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5935[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5936[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5937[0m[39m:   [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m5938[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m5939[0m[39m:   [0m[39m    if [0m[1;39m([0m[1;39m([0m[39mRAW == [0m[32m'"'[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mRAW == [0m[32m'\''[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m5940[0m[39m:   [0m[39m        value = [0m[1;35mxmlParseEntityValue[0m[1;39m([0m[39mctxt, &orig[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5941[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mctxt->sax != NULL[0m[1;39m)[0m[39m &&[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m5942[0m[39m:   [0m[39m        [0m[39m    [0m[1;39m([0m[39m!ctxt->disableSAX[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mctxt->sax->entityDecl != NULL[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m5943[0m[39m:   [0m[39m        [0m[39m    ctxt->sax->[0m[1;35mentityDecl[0m[1;39m([0m[39mctxt->userData, name,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m5944[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mXML_INTERNAL_GENERAL_ENTITY,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m5945[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mNULL, NULL, value[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5946[0m[39m:   [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5947[0m[39m:   [0m[39m        [0m[39m * For expat compatibility in SAX mode.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m5948[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m5949[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mctxt->myDoc == NULL[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m5950[0m[39m:   [0m[39m        [0m[39m    [0m[1;39m([0m[1;35mxmlStrEqual[0m[1;39m([0m[39mctxt->myDoc->version, SAX_COMPAT_MODE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m5951[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[39mctxt->myDoc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m5952[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->myDoc = [0m[1;35mxmlNewDoc[0m[1;39m([0m[39mSAX_COMPAT_MODE[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5953[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mctxt->myDoc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m5954[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[1;35mxmlErrMemory[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m5955[0m[39m:   [0m[39m        [0m[39m        [0m[39m    goto done;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5956[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m5957[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->myDoc->properties = XML_DOC_INTERNAL;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m5958[0m[39m:   [0m[39m        [0m[39m    [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5959[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[39mctxt->myDoc->intSubset == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5960[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->myDoc->intSubset = [0m[1;35mxmlNewDtd[0m[1;39m([0m[39mctxt->myDoc,[0m             [2m                [0m
[2;36m                    [0m         [1;36m5961[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    BAD_CAST [0m[32m"fake"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m5962[0m[39m:                        if [0m[1;39m([0m[39mctxt->myDoc->intSubset == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m5963[0m[39m:                            [0m[1;35mxmlErrMemory[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5964[0m[39m:                            goto done;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m5965[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m5966[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5967[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m5968[0m[39m:   [0m[39m        [0m[39m    [0m[1;35mxmlSAX2EntityDecl[0m[1;39m([0m[39mctxt, name, XML_INTERNAL_GENERAL_ENTITY,[0m      [2m                [0m
[2;36m                    [0m         [1;36m5969[0m[39m:   [0m[39m        [0m[39m        [0m[39m              NULL, NULL, value[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5970[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5971[0m[39m:   [0m[39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5972[0m[39m:   [0m[39m        URI = [0m[1;35mxmlParseExternalID[0m[1;39m([0m[39mctxt, &literal, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m5973[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mURI == NULL[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mliteral == NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5974[0m[39m:   [0m[39m        [0m[39m    [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_VALUE_REQUIRED, NULL[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m5975[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5976[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mURI[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5977[0m[39m:                    if [0m[1;39m([0m[1;35mxmlStrchr[0m[1;39m([0m[39mURI, [0m[32m'#'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5978[0m[39m:                        [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_URI_FRAGMENT, NULL[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m5979[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5980[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5981[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mRAW != [0m[32m'>'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mSKIP_BLANKS_PE == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m5982[0m[39m:   [0m[39m        [0m[39m    [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_SPACE_REQUIRED,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m5983[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m[32m"Space required before 'NDATA'\n"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m5984[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5985[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCMP5[0m[1;39m([0m[39mCUR_PTR, [0m[32m'N'[0m[39m, [0m[32m'D'[0m[39m, [0m[32m'A'[0m[39m, [0m[32m'T'[0m[39m, [0m[32m'A'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m5986[0m[39m:   [0m[39m        [0m[39m    [0m[1;35mSKIP[0m[1;39m([0m[1;36m5[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m5987[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[39mSKIP_BLANKS_PE == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m5988[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_SPACE_REQUIRED,[0m                [2m                [0m
[2;36m                    [0m         [1;36m5989[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"Space required after 'NDATA'\n"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m5990[0m[39m:   [0m[39m        [0m[39m    [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5991[0m[39m:   [0m[39m        [0m[39m    ndata = [0m[1;35mxmlParseName[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m5992[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[1;39m([0m[39mctxt->sax != NULL[0m[1;39m)[0m[39m && [0m[1;39m([0m[39m!ctxt->disableSAX[0m[1;39m)[0m[39m &&[0m               [2m                [0m
[2;36m                    [0m         [1;36m5993[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m([0m[39mctxt->sax->unparsedEntityDecl != NULL[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m5994[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->sax->[0m[1;35munparsedEntityDecl[0m[1;39m([0m[39mctxt->userData, name,[0m         [2m                [0m
[2;36m                    [0m         [1;36m5995[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m    literal, URI, ndata[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m5996[0m[39m:   [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m5997[0m[39m:   [0m[39m        [0m[39m    if [0m[1;39m([0m[1;39m([0m[39mctxt->sax != NULL[0m[1;39m)[0m[39m &&[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m5998[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m([0m[39m!ctxt->disableSAX[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mctxt->sax->entityDecl != NULL[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m5999[0m[39m:   [0m[39m        [0m[39m        [0m[39mctxt->sax->[0m[1;35mentityDecl[0m[1;39m([0m[39mctxt->userData, name,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m6000[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m    XML_EXTERNAL_GENERAL_PARSED_ENTITY,[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mSAX2.[0m[1;92mc:500[0m[39m-[0m[1;36m600[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:xmlEntityPtr[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:[0m[1;35mxmlSAX2GetParameterEntity[0m[1;39m([0m[39mvoid *ctx, const xmlChar *name[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    xmlParserCtxtPtr ctxt = [0m[1;39m([0m[39mxmlParserCtxtPtr[0m[1;39m)[0m[39m ctx;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    xmlEntityPtr ret;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    if [0m[1;39m([0m[39mctx == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    ret = [0m[1;35mxmlGetParameterEntity[0m[1;39m([0m[39mctxt->myDoc, name[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m: * xmlSAX2EntityDecl:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m: * @ctx: the user data [0m[1;39m([0m[39mXML parser context[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m: * @name:  the entity name[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m: * @type:  the entity type[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m: * @publicId: The public ID of the entity[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m: * @systemId: The system ID of the entity[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m: * @content: the entity value [0m[1;39m([0m[39mwithout processing[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m: * An entity definition has been parsed[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:[0m[1;35mxmlSAX2EntityDecl[0m[1;39m([0m[39mvoid *ctx, const xmlChar *name, int type,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:          const xmlChar *publicId, const xmlChar *systemId, xmlChar *content[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:    xmlEntityPtr ent;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:    xmlParserCtxtPtr ctxt = [0m[1;39m([0m[39mxmlParserCtxtPtr[0m[1;39m)[0m[39m ctx;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:    int extSubset;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:    int res;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mctxt == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mctxt->myDoc == NULL[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    extSubset = ctxt->inSubset == [0m[1;36m2[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:    res = [0m[1;35mxmlAddEntity[0m[1;39m([0m[39mctxt->myDoc, extSubset, name, type, publicId, systemId,[0m  [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:                       content, &ent[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:    switch [0m[1;39m([0m[39mres[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:        case XML_ERR_OK:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:            break;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:        case XML_ERR_NO_MEMORY:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:            [0m[1;35mxmlSAX2ErrMemory[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:        case XML_WAR_ENTITY_REDEFINED:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:            if [0m[1;39m([0m[39mctxt->pedantic[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:                if [0m[1;39m([0m[39mextSubset[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:                    [0m[1;35mxmlWarnMsg[0m[1;39m([0m[39mctxt, res, [0m[32m"Entity[0m[32m([0m[32m%s[0m[32m)[0m[32m already defined in the"[0m   [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:                               [0m[32m" external subset\n"[0m[39m, name[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:                    [0m[1;35mxmlWarnMsg[0m[1;39m([0m[39mctxt, res, [0m[32m"Entity[0m[32m([0m[32m%s[0m[32m)[0m[32m already defined in the"[0m   [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:                               [0m[32m" internal subset\n"[0m[39m, name[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        case XML_ERR_REDECL_PREDEF_ENTITY:[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:            [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:             * Technically an error but it's a common mistake to get double[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:             * escaping according to [0m[32m"4.6 Predefined Entities"[0m[39m wrong.[0m           [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:             *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[1;35mxmlWarnMsg[0m[1;39m([0m[39mctxt, res, [0m[32m"Invalid redeclaration of predefined"[0m         [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:                       [0m[32m" entity '%s'"[0m[39m, name[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:        default:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:            [0m[1;35mxmlFatalErrMsg[0m[1;39m([0m[39mctxt, XML_ERR_INTERNAL_ERROR,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:                           [0m[32m"Unexpected error code from xmlAddEntity\n"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:                           NULL, NULL[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39ment->URI == NULL[0m[1;39m)[0m[39m && [0m[1;39m([0m[39msystemId != NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:        xmlChar *URI;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        const char *base = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:        int i;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:        for [0m[1;39m([0m[39mi = ctxt->inputNr - [0m[1;36m1[0m[39m; i >= [0m[1;36m0[0m[39m; i--[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:            if [0m[1;39m([0m[39mctxt->inputTab[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m->filename != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:                base = ctxt->inputTab[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m->filename;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[35m/[0m[39m*[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:         * We don't really need the [0m[32m'directory'[0m[39m struct member, but some[0m         [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:         * users set it manually to a base URI for memory streams.[0m              [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        if [0m[1;39m([0m[39mbase == NULL[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:            base = ctxt->directory;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:        res = [0m[1;35mxmlBuildURISafe[0m[1;39m([0m[39msystemId, [0m[1;39m([0m[39mconst xmlChar *[0m[1;39m)[0m[39m base, &URI[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:        if [0m[1;39m([0m[39mURI == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:            if [0m[1;39m([0m[39mres < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:                [0m[1;35mxmlSAX2ErrMemory[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:                [0m[1;35mxmlWarnMsg[0m[1;39m([0m[39mctxt, XML_ERR_INVALID_URI,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:                           [0m[32m"Can't resolve URI: %s\n"[0m[39m, systemId[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mxmlStrlen[0m[1;39m([0m[39mURI[0m[1;39m)[0m[39m > XML_MAX_URI_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:            [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_RESOURCE_LIMIT, [0m[32m"URI too long"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:            [0m[1;35mxmlFree[0m[1;39m([0m[39mURI[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmlstring.[0m[1;92mc:120[0m[39m-[0m[1;36m180[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m: * Returns a new xmlChar * or NULL[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:xmlChar *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m[1;35mxmlCharStrdup[0m[1;39m([0m[39mconst char *cur[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    const char *p = cur;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    if [0m[1;39m([0m[39mcur == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    while [0m[1;39m([0m[39m*p != [0m[32m'\0'[0m[1;39m)[0m[39m p++; [0m[35m/[0m[39m* non input consuming *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;35mxmlCharStrndup[0m[1;39m([0m[39mcur, p - cur[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m: * xmlStrcmp:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m: * @str1:  the first xmlChar *[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m: * @str2:  the second xmlChar *[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m: * a strcmp for xmlChar's[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m: * Returns the integer result of the comparison[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;35mxmlStrcmp[0m[1;39m([0m[39mconst xmlChar *str1, const xmlChar *str2[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    if [0m[1;39m([0m[39mstr1 == str2[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    if [0m[1;39m([0m[39mstr1 == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    if [0m[1;39m([0m[39mstr2 == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mstr1, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mstr2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    do [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        int tmp = *str1++ - *str2;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        if [0m[1;39m([0m[39mtmp != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[39m*str2++ != [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m: * xmlStrEqual:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m: * @str1:  the first xmlChar *[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m: * @str2:  the second xmlChar *[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m: * Check if both strings are equal of have same content.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m: * Should be a bit more readable and faster than [0m[1;35mxmlStrcmp[0m[1;39m([0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m: * Returns [0m[1;36m1[0m[39m if they are equal, [0m[1;36m0[0m[39m if they are different[0m                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m[1;35mxmlStrEqual[0m[1;39m([0m[39mconst xmlChar *str1, const xmlChar *str2[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    if [0m[1;39m([0m[39mstr1 == str2[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    if [0m[1;39m([0m[39mstr1 == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    if [0m[1;39m([0m[39mstr2 == NULL[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mstr1, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mstr2[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    do [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        if [0m[1;39m([0m[39m*str1++ != *str2[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[39m*str2++[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparserInternals.[0m[1;92mc:100[0m[39m-[0m[1;36m200[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * warnings. If handler is NULL, the error handler will be deactivated.[0m         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m: * This is the recommended way to collect errors from the parser and[0m            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m: * takes precedence over all other error reporting mechanisms.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m: * These are [0m[1;39m([0m[39min order of precedence[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m: * - per-context structured handler [0m[1;39m([0m[39mxmlCtxtSetErrorHandler[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m: * - per-context structured [0m[32m"serror"[0m[39m SAX handler[0m                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m: * - global structured handler [0m[1;39m([0m[39mxmlSetStructuredErrorFunc[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m: * - per-context generic [0m[32m"error"[0m[39m and [0m[32m"warning"[0m[39m SAX handlers[0m                     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m: * - global generic handler [0m[1;39m([0m[39mxmlSetGenericErrorFunc[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m: * - print to stderr[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m: * Available since [0m[1;36m2.13[0m[39m.[0m[1;36m0[0m[39m.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m[1;35mxmlCtxtSetErrorHandler[0m[1;39m([0m[39mxmlParserCtxtPtr ctxt, xmlStructuredErrorFunc handler,[0m   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                       void *data[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    if [0m[1;39m([0m[39mctxt == NULL[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    ctxt->errorHandler = handler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    ctxt->errorCtxt = data;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m: * xmlCtxtGetLastError:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m: * @ctx:  an XML parser context[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m: * Get the last parsing error registered.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m: * Returns NULL if no error occurred or a pointer to the error[0m                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m133:c[0m[39monst xmlError *[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m[1;35mxmlCtxtGetLastError[0m[1;39m([0m[39mvoid *ctx[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    xmlParserCtxtPtr ctxt = [0m[1;39m([0m[39mxmlParserCtxtPtr[0m[1;39m)[0m[39m ctx;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    if [0m[1;39m([0m[39mctxt == NULL[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        return [0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    if [0m[1;39m([0m[39mctxt->lastError.code == XML_ERR_OK[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        return [0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    return [0m[1;39m([0m[39m&ctxt->lastError[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m: * xmlCtxtResetLastError:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m: * @ctx:  an XML parser context[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m: * Cleanup the last global error registered. For parsing error[0m                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m: * this does not change the well-formedness result.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m[1;35mxmlCtxtResetLastError[0m[1;39m([0m[39mvoid *ctx[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    xmlParserCtxtPtr ctxt = [0m[1;39m([0m[39mxmlParserCtxtPtr[0m[1;39m)[0m[39m ctx;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    if [0m[1;39m([0m[39mctxt == NULL[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    ctxt->errNo = XML_ERR_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    if [0m[1;39m([0m[39mctxt->lastError.code == XML_ERR_OK[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;35mxmlResetError[0m[1;39m([0m[39m&ctxt->lastError[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m: * xmlCtxtErrMemory:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m: * @ctxt:  an XML parser context[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m: * Handle an out-of-memory error.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m: * Available since [0m[1;36m2.13[0m[39m.[0m[1;36m0[0m[39m.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m[1;35mxmlCtxtErrMemory[0m[1;39m([0m[39mxmlParserCtxtPtr ctxt[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    xmlStructuredErrorFunc schannel = NULL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    xmlGenericErrorFunc channel = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    void *data;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    if [0m[1;39m([0m[39mctxt == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        [0m[1;35mxmlRaiseMemoryError[0m[1;39m([0m[39mNULL, NULL, NULL, XML_FROM_PARSER, NULL[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    ctxt->errNo = XML_ERR_NO_MEMORY;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    ctxt->instate = XML_PARSER_EOF; [0m[35m/[0m[39m* TODO: Remove after refactoring *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    ctxt->wellFormed = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    ctxt->disableSAX = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    if [0m[1;39m([0m[39mctxt->errorHandler[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        schannel = ctxt->errorHandler;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        data = ctxt->errorCtxt;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mctxt->sax->initialized == XML_SAX2_MAGIC[0m[1;39m)[0m[39m &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        [0m[1;39m([0m[39mctxt->sax->serror != NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        schannel = ctxt->sax->serror;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        data = ctxt->userData;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        channel = ctxt->sax->error;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        data = ctxt->userData;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:80[0m[39m-[0m[1;36m140[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     if [0m[1;39m([0m[39mbuf->use != [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf->compat_use[0m[1;39m)[0m[39m       [0m[39m        [0m[39m    \[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:         if [0m[1;39m([0m[39mbuf->compat_use < INT_MAX[0m[1;39m)[0m[39m      [0m[39m        [0m[39m        [0m[39m    \[0m               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m     buf->use = buf->compat_use;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:#else [0m[35m/[0m[39m* ! WITH_BUFFER_COMPAT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:#define [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:#define [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:#endif [0m[35m/[0m[39m* WITH_BUFFER_COMPAT *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: * xmlBufMemoryError:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * @extra:  extra information[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * Handle an out of memory condition[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: * To be improved[0m[33m...[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;35mxmlBufMemoryError[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        buf->flags |= BUF_FLAG_OOM;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m: * xmlBufOverflowError:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m: * @extra:  extra information[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m: * Handle a buffer overflow error[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m: * To be improved[0m[33m...[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m[1;35mxmlBufOverflowError[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        buf->flags |= BUF_FLAG_OVERFLOW;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m: * xmlBufCreate:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m: * @size: initial size of buffer[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m: * routine to create an XML buffer.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m: * returns the new structure.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:xmlBufPtr[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;35mxmlBufCreate[0m[1;39m([0m[39msize_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    xmlBufPtr ret;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    if [0m[1;39m([0m[39msize == SIZE_MAX[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    ret = [0m[1;35mxmlMalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*ret[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    if [0m[1;39m([0m[39mret == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    ret->use = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    ret->flags = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    ret->size = size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    ret->maxSize = SIZE_MAX - [0m[1;36m1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    ret->mem = [0m[1;35mxmlMalloc[0m[1;39m([0m[39mret->size + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:200[0m[39m-[0m[1;36m260[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    ret->content = ret->mem;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m: * xmlBufDetach:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m: * @buf:  the buffer[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m: * Remove the string contained in a buffer and give it back to the[0m              [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m: * caller. The buffer is reset to an empty content.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m: * This doesn't work with immutable buffers as they can't be reset.[0m             [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m: * Returns the previous string contained by the buffer.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:xmlChar *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:[0m[1;35mxmlBufDetach[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    xmlChar *ret;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_STATIC[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    if [0m[1;39m([0m[39mbuf->content != buf->mem[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        ret = [0m[1;35mxmlStrndup[0m[1;39m([0m[39mbuf->content, buf->use[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mbuf->mem[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        ret = buf->mem;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    buf->content = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    buf->mem = NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    buf->size = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    buf->use = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    return ret;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m: * xmlBufFree:[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m: * @buf:  the buffer to free[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m: * Frees an XML buffer. It frees both the content and the structure which[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m: * encapsulate it.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:[0m[1;35mxmlBufFree[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    if [0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39mreturn;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mBUF_STATIC[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mbuf->mem[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[1;35mxmlFree[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m: * xmlBufEmpty:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m: * @buf:  the buffer[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m: * empty a buffer.[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The ASan report shows a heap-buffer-overflow in xmlSBufAddEntitySecure: it [0m    [2m                [0m
[2;36m                    [0m         [39mreads `len` bytes from the source `str`, but in the failing code path `str` is [0m     [2m                [0m
[2;36m                    [0m         [39m`ent->name` [0m[1;39m([0m[39mthe entity’s name buffer, typically small[0m[1;39m)[0m[39m while `len` is [0m             [2m                [0m
[2;36m                    [0m         [39m`ent->length` [0m[1;39m([0m[39mthe length of the entity content, often much larger[0m[1;39m)[0m[39m. This mismatch [0m [2m                [0m
[2;36m                    [0m         [39mcauses a multi-byte read past the [0m[1;36m7[0m[39m-byte name buffer when the entity content length[0m [2m                [0m
[2;36m                    [0m         [39mexceeds the name length.[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - The code in xmlExpandPEsInEntityValue [0m[1;39m([0m[39mparser.c[0m[1;39m)[0m[39m mistakenly passes the [0m        [2m                [0m
[2;36m                    [0m         [39mentity’s name pointer instead of its content pointer to xmlSBufAddEntitySecure:[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->name, ent->length[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Furthermore, xmlSBufAddEntitySecure only grows the buffer on its first [0m        [2m                [0m
[2;36m                    [0m         [39minvocation [0m[1;39m([0m[39mwhen [0m[33mcap[0m[39m==[0m[1;36m0[0m[1;39m)[0m[39m; subsequent calls do not enlarge cap, so even correctly [0m   [2m                [0m
[2;36m                    [0m         [39mpassing content could overflow if the buffer hasn’t been pre-grown for the new [0m     [2m                [0m
[2;36m                    [0m         [39mdata.[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Location and Changes[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   A. In parser.c within xmlExpandPEsInEntityValue [0m[1;39m([0m[39m~line [0m[1;36m3998[0m[1;39m)[0m[39m:[0m                    [2m                [0m
[2;36m                    [0m         [39m      - Change the call to xmlSBufAddEntitySecure to use the entity content:[0m        [2m                [0m
[2;36m                    [0m         [39m          - From:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->name, ent->length[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m          - To:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mxmlSBufAddEntitySecure[0m[1;39m([0m[39mbuf, ent->content, ent->length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m      - This ensures we copy from the content buffer [0m[1;39m([0m[39mcorrect size `ent->length`[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mrather than the name buffer.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   B. In parser.c within xmlSBufAddEntitySecure [0m[1;39m([0m[39maround line [0m[1;36m769[0m[1;39m)[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [39m      - Adjust the buffer-growth logic to handle all invocations, not just the [0m     [2m                [0m
[2;36m                    [0m         [39mfirst:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m          - Replace the `if [0m[1;39m([0m[39mbuf->cap == [0m[1;36m0[0m[1;39m)[0m[39m` block with a check on available [0m       [2m                [0m
[2;36m                    [0m         [39mcapacity:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mbuf->cap - buf->size < len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m                 [0m[35m/[0m[39m* grow by at least len [0m[1;39m([0m[39mor len*[0m[1;36m2[0m[39m for margin[0m[1;39m)[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [39m                 if [0m[1;39m([0m[1;35mxmlSBufGrow[0m[1;39m([0m[39mbuf, len * [0m[1;36m2[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m                     return;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m      - This mirrors xmlSBufAddString’s behavior and ensures the destination buffer[0m [2m                [0m
[2;36m                    [0m         [39mcan accommodate `len` bytes on every append.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of Existing Logic[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - We do not alter any harness or fuzzing code; the fuzzer entry point remains [0m   [2m                [0m
[2;36m                    [0m         [39m`xmlCtxtParseDocument` → [0m[33m...[0m[39m → `xmlExpandPEsInEntityValue`.[0m                         [2m                [0m
[2;36m                    [0m         [39m   - We only correct a misuse of pointers and ensure buffer safety. SAX callbacks, [0m [2m                [0m
[2;36m                    [0m         [39mentity creation, and other parsing logic remain untouched.[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Tests and existing DTD/entity-processing functionality behave identically, [0m    [2m                [0m
[2;36m                    [0m         [39maside from avoiding the overflow.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification and Side-Effects[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Using `ent->content` aligns with the intended semantics of expanding a [0m        [2m                [0m
[2;36m                    [0m         [39mparameter entity’s value into the buffer.[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Enhancing xmlSBufAddEntitySecure’s growth logic prevents future overflows [0m     [2m                [0m
[2;36m                    [0m         [39mduring nested or repeated entity expansions.[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The change is local to parser.c; no external or library APIs are modified.[0m     [2m                [0m
[2;36m                    [0m         [39m   - Potential side-effect: the buffer might grow more aggressively, but since [0m     [2m                [0m
[2;36m                    [0m         [39mresource limits [0m[1;39m([0m[39m`buf->max`[0m[1;39m)[0m[39m are still enforced, this does not affect memory safety[0m [2m                [0m
[2;36m                    [0m         [39mor the fuzzer harness.[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Similar growth patterns exist in xmlSBufAddString; this patch unifies [0m         [2m                [0m
[2;36m                    [0m         [39msecure-entity expansion with string expansion behavior.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Validation[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - After patching, rerun the existing fuzz harness [0m[1;39m([0m[39m`out/xml`[0m[1;39m)[0m[39m under [0m             [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer to confirm no heap-buffer-overflow in xmlSBufAddEntitySecure.[0m      [2m                [0m
[2;36m                    [0m         [39m   - Ensure existing regression tests for DTDs and parameter entities still pass.[0m   [2m                [0m
[2;36m                    [0m         [39m   - This fix addresses the exact crash stack [0m[1;39m([0m[39mparser.[0m[1;92mc:777[0m[1;39m)[0m[39m by using the correct [0m  [2m                [0m
[2;36m                    [0m         [39mdata pointer and guaranteeing sufficient buffer capacity.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=531298;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=739909;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=769542;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=535320;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp439sjk45[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/libxml2_lx-full-01_vuln_003/[0m[95magent-outpu[0m [2m               [0m
[2;36m                    [0m         [95mt-1766581484.9752936[0m                                                                 [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libxml2_lx-full-01_vuln_003.toml                      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/24/25 22:04:45][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mlibxml2[0m        ]8;id=997818;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=585490;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=254296;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=798157;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibxml2[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=427608;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=868007;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m                [2m               [0m
