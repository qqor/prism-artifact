--- a/poi/src/main/java/org/apache/poi/hssf/record/RecordFactory.java
+++ b/poi/src/main/java/org/apache/poi/hssf/record/RecordFactory.java
@@ -178,18 +178,14 @@
      * @throws org.apache.poi.util.RecordFormatException on error processing the InputStream
      */
     public static List<org.apache.poi.hssf.record.Record> createRecords(InputStream in) throws RecordFormatException {
-
         List<org.apache.poi.hssf.record.Record> records = new ArrayList<>(NUM_RECORDS);
-
-        RecordFactoryInputStream recStream = new RecordFactoryInputStream(in, true);
-
-        Record record;
-        while ((record = recStream.nextRecord())!=null) {
-            records.add(record);
-
-            IOUtils.safelyAllocateCheck(records.size(), MAX_NUMBER_OF_RECORDS);
+        try (RecordFactoryInputStream recStream = new RecordFactoryInputStream(in, true)) {
+            Record record;
+            while ((record = recStream.nextRecord()) != null) {
+                records.add(record);
+                IOUtils.safelyAllocateCheck(records.size(), MAX_NUMBER_OF_RECORDS);
+            }
         }
-
         return records;
     }
 }

--- a/poi/src/main/java/org/apache/poi/hssf/usermodel/HSSFWorkbookFactory.java
+++ b/poi/src/main/java/org/apache/poi/hssf/usermodel/HSSFWorkbookFactory.java
@@ -92,7 +92,14 @@
     @Override
     public Workbook create(InputStream inp, String password) throws IOException {
         POIFSFileSystem fs = new POIFSFileSystem(inp);
-        return create(fs.getRoot(), password);
+        try {
+            HSSFWorkbook wb = (HSSFWorkbook)create(fs.getRoot(), password);
+            fs.close();
+            return wb;
+        } catch (IOException | RuntimeException e) {
+            fs.close();
+            throw e;
+        }
     }
 
     @Override
