{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/user/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.15939879999999998,
    "prompt_tokens": 81776,
    "completion_tokens": 15783
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n@@ -19,6 +19,7 @@\n import java.io.Serializable;\n import java.util.HashMap;\n import java.util.Map;\n+import org.apache.tika.config.Field;\n \n public class TextAndCSVConfig implements Serializable {\n \n@@ -41,6 +42,8 @@\n     private Map<String, Character> nameToDelimiterMap = NAME_TO_DELIMITER_MAP;\n     private Map<Character, String> delimiterToNameMap = DELIMITER_TO_NAME_MAP;\n \n+    @Field\n+    private boolean fetchExternalResources = false;\n     public Map<String, Character> getNameToDelimiterMap() {\n         return nameToDelimiterMap;\n     }\n@@ -55,4 +58,12 @@\n         nameToDelimiterMap.entrySet()\n                           .forEach(e -> delimiterToNameMap.put(e.getValue(), e.getKey()));\n     }\n+\n+    public boolean isFetchExternalResources() {\n+        return fetchExternalResources;\n+    }\n+\n+    public void setFetchExternalResources(boolean fetchExternalResources) {\n+        this.fetchExternalResources = fetchExternalResources;\n+    }\n }\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -268,6 +268,10 @@\n     private void processURL(String urlString, String name, XHTMLContentHandler xhtml,\n                             Metadata parentMetadata,\n                             ParseContext context) throws IOException, SAXException {\n+        TextAndCSVConfig cfg = context.get(TextAndCSVConfig.class, defaultTextAndCSVConfig);\n+        if (!cfg.isFetchExternalResources()) {\n+            return;\n+        }\n         EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n         Metadata metadata = new Metadata();\n         metadata.set(TikaCoreProperties.RESOURCE_NAME_KEY, name);\n",
  "stdout": "",
  "stderr": ""
}