--- a/lib/file.c
+++ b/lib/file.c
@@ -491,8 +491,9 @@
       return result;
 
     if(data->req.no_body) {
+      /* limit writes to the actual header buffer size to prevent overflow */
       headerlen =
-      msnprintf(header, sizeof(no_body), "%s (%ld bytes) \r\n",
+      msnprintf(header, sizeof(header), "%s (%" FMT_OFF_T " bytes)\r\n",
                   no_body, expected_size);
       result = Curl_client_write(data, CLIENTWRITE_HEADER, header, headerlen);
     }
