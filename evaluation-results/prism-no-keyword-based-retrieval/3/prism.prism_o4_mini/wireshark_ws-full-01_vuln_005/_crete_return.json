{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-full-01_vuln_005",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.4734653,
    "prompt_tokens": 331675,
    "completion_tokens": 24687
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-bat.c\n+++ b/epan/dissectors/packet-bat.c\n@@ -662,13 +662,15 @@\n \tvis_packeth->tq_max = tvb_get_uint8(tvb, offset++);\n \tvis_packeth_raw_data_size = tvb_get_uint32(tvb, offset++, 0);\n \toffset += 4;\n-\tif ((unsigned long)vis_packeth_raw_data_size > sizeof(vis_packeth_raw_data))\n+\tif ((unsigned long)vis_packeth_raw_data_size >= sizeof(vis_packeth_raw_data)) {\n \t\treturn;\n-\n-\tfor (i=0; i < vis_packeth_raw_data_size; i++) {\n+\t}\n+\n+\tfor (i = 0; i < vis_packeth_raw_data_size; i++) {\n \t\tvis_packeth_raw_data[i] = tvb_get_uint8(tvb, offset);\n \t\toffset++;\n \t}\n+\tvis_packeth_raw_data[vis_packeth_raw_data_size] = '\\0';\n \n \t/* set protocol name */\n \tcol_set_str(pinfo->cinfo, COL_PROTOCOL, \"BAT_VIS\");\n@@ -701,8 +703,9 @@\n \t\t/*offset += 1;*/\n \t}\n \n-\tif ((vis_packeth_raw_data_size > 4) && (strlen(vis_packeth_raw_data) > 4))\n-\t\tfprintf(stderr, d_output_buffer);\n+\tif ((vis_packeth_raw_data_size > 4) && (strlen(vis_packeth_raw_data) > 4)) {\n+\t\tfprintf(stderr, \"%s\", d_output_buffer);\n+\t}\n \n \ttap_queue_packet(bat_tap, pinfo, vis_packeth);\n \n",
  "stdout": "",
  "stderr": ""
}