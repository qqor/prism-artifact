[2;36m[12/24/25 17:13:13][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=734016;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=856343;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpp0aqk7r9[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/apache-poi_poi-full-01_vuln_1/[0m[95magent-out[0m [2m               [0m
[2;36m                    [0m         [95mput-1766563993.8672535[0m                                                               [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-poi_poi-full-01_vuln_1.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=741834;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144587;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/24/25 17:16:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=251121;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=620783;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m186.29[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=138746;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=834561;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=559882;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=975812;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=900655;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=129840;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m186[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=421777;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=901919;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.70[0m seconds;            ]8;id=833067;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=967633;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 17:16:22][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=336012;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=56798;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=946829;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=447098;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=550948;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=650226;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=16662;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=915946;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 17:16:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m2.98[0m seconds;            ]8;id=644415;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=905508;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=940126;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=189978;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 17:16:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.50[0m seconds;            ]8;id=456999;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=40368;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 17:16:32][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=414260;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=327802;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx921m'[0m to reproduce[1m)[0m                                                [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Java heap space                              [2m                [0m
[2;36m                    [0m                 at java.base/java.lang.String.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04800.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04000.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init[0m[1m>[0m[1m([0mHMEFMessage.jav[1;92ma:72[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1m([0mPOIHMEFFuzzer.jav[1;92ma:32[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cb8800.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800d04800.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800d04000.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a36f54a5f0a295bd                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 17:16:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=185957;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=144432;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 17:17:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=121412;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=464217;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 17:18:36][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=342607;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=231731;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=205536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=872098;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.50[0m seconds;            ]8;id=308676;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=187903;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=952917;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=612810;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp80gozwcz[0m                                                 ]8;id=807944;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=113337;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/24/25 17:21:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m148.20[0m seconds;               ]8;id=560531;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=226722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=202729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=55953;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 17:21:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m19.82[0m seconds;          ]8;id=253526;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=844353;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=514246;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=33226;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 17:21:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m22.93[0m seconds;             ]8;id=646393;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=327852;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=312075;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=405891;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=468117;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=126749;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=947608;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=634845;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 17:21:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.57[0m seconds;            ]8;id=852080;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=775975;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 17:21:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=953284;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=710338;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.55[0m seconds;            ]8;id=719211;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=487110;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 17:21:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=311617;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=203907;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.55[0m seconds;            ]8;id=803011;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=241359;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=310335;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=979446;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/util/StringUtil.java                         [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/util/StringUtil.java                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-89[0m,[1;36m6[0m +[1;36m89[0m,[1;36m10[0m @@                                                                  [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  if [1m([0m[1m([0mlen [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mstring.length - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m < len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Illegal length "[0m[39m + len[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlen > MAX_RECORD_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Requested UnicodeLE length "[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m+                + len + [0m[32m" exceeds allowed maximum of "[0m[39m + MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len * [0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04800.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04000.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Java process running an Apache POI HMEF [0m[1;39m([0m[39mTNEF[0m[1;39m)[0m[39m parser crashed with an [0m            [2m                [0m
[2;36m                    [0m         [39mOutOfMemoryError during fuzz testing. The fuzzer entry point [0m                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`POIHMEFFuzzer.fuzzerTestOneInput`[0m[1;39m)[0m[39m invoked `HMEFMessage` construction and [0m        [2m                [0m
[2;36m                    [0m         [39mprocessing, eventually exhausting the Java heap while decoding a Unicode string. [0m   [2m                [0m
[2;36m                    [0m         [39mThe issue is reported by Jazzer as a low-severity security finding [0m                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mFuzzerSecurityIssueLow[0m[1;39m)[0m[39m.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type: Out of memory [0m[1;39m([0m[39mJava heap space[0m[1;39m)[0m[39m  [0m                                     [2m                [0m
[2;36m                    [0m         [39m- Vulnerability tag [0m[1;39m([0m[39mas reported[0m[1;39m)[0m[39m: [0m                                                 [2m                [0m
[2;36m                    [0m         [39mcom.code_intelligence.jazzer.api.FuzzerSecurityIssueLow  [0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations and findings:  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  â€¢ The heap exhaustion occurs in `java.lang.String.<init>` while decoding a buffer[0m [2m                [0m
[2;36m                    [0m         [39min `StringUtil.getFromUnicodeLE`.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m  â€¢ The failure is triggered during the creation of MAPI attributes:  [0m              [2m                [0m
[2;36m                    [0m         [39m     â€“ `MAPIAttribute.create` calls into `StringUtil.getFromUnicodeLE`  [0m            [2m                [0m
[2;36m                    [0m         [39m     â€“ `TNEFMAPIAttribute` and `TNEFAttribute` constructors propagate the data  [0m    [2m                [0m
[2;36m                    [0m         [39m     â€“ `HMEFMessage.processMessage` iterates over and constructs multiple [0m          [2m                [0m
[2;36m                    [0m         [39mattributes  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m  â€¢ The fuzzer harness [0m[1;39m([0m[39m`POIHMEFFuzzer.fuzzerTestOneInput`[0m[1;39m)[0m[39m supplies arbitrary [0m     [2m                [0m
[2;36m                    [0m         [39minput to `new [0m[1;35mHMEFMessage[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, driving the code path that ultimately hits the [0m    [2m                [0m
[2;36m                    [0m         [39mstring-conversion logic.  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m  â€¢ A reproduction hint suggests running with `-Xmx921m` to consistently trigger [0m   [2m                [0m
[2;36m                    [0m         [39mthe condition.  [0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas of the codebase to investigate for a holistic view:  [0m                         [2m                [0m
[2;36m                    [0m         [39m [0m[1;36m1[0m[39m. String decoding utilities:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.util.StringUtil.getFromUnicodeLE  [0m                             [2m                [0m
[2;36m                    [0m         [39m [0m[1;36m2[0m[39m. MAPI attribute handling:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.hmef.attribute.MAPIAttribute  [0m                                 [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.hmef.attribute.TNEFMAPIAttribute  [0m                             [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.hmef.attribute.TNEFAttribute  [0m                                 [2m                [0m
[2;36m                    [0m         [39m [0m[1;36m3[0m[39m. HMEF message parsing flow:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.hmef.HMEFMessage constructors and `processMessage`[0m[35m/[0m[39m`process` [0m  [2m                [0m
[2;36m                    [0m         [39mmethods  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m [0m[1;36m4[0m[39m. Fuzzer harness entry point:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    â€“ org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput [0m[1;39m([0m[39mclarify how input is fed and[0m [2m                [0m
[2;36m                    [0m         [39mparsed[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04800.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d04000.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.util;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static java.nio.charset.StandardCharsets.ISO_8859_1;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * Collection of string handling utilities[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:@Internal[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public final class StringUtil [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final int DEFAULT_MAX_RECORD_LENGTH = [0m[1;36m10000000[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public static final Charset UTF16LE = StandardCharsets.UTF_16LE;[0m             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public static final Charset UTF8 = StandardCharsets.UTF_8;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public static final Charset WIN_1252 = [0m[1;35mCharset.forName[0m[1;39m([0m[32m"cp1252"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @param length the max record length allowed for StringUtil[0m                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        MAX_RECORD_LENGTH = length;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return the max record length allowed for StringUtil[0m                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        return MAX_RECORD_LENGTH;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private [0m[1;35mStringUtil[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[35m/[0m[35m/[0m[39m no instances of this class[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Given a byte array of [0m[1;36m16[0m[39m-bit unicode characters in Little Endian[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * format [0m[1;39m([0m[39mmost important byte last[0m[1;39m)[0m[39m, return a Java String representation[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * of it.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * [0m[1;39m{[0m[39m [0m[1;36m0x16[0m[39m, [0m[1;36m0x00[0m[39m [0m[1;39m}[0m[39m -[0m[1;36m0x16[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @param string the byte array to be converted[0m                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @param offset the initial offset into the[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *               byte array. it is assumed that string[0m[1;39m[[0m[39m offset [0m[1;39m][0m[39m and string[0m[1;39m[[0m [2m                [0m
[2;36m                    [0m         [39moffset +[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *               [0m[1;36m1[0m[39m [0m[1;39m][0m[39m contain the first [0m[1;36m16[0m[39m-bit unicode character[0m              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param len    the length of the final string[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return the converted string, never [0m[1;39m{[0m[39m@code null[0m[1;39m}[0m[39m.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws ArrayIndexOutOfBoundsException if offset is out of bounds for[0m     [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *                                        the byte array [0m[1;39m([0m[39mi.e., is negative [0m [2m                [0m
[2;36m                    [0m         [39mor is greater than or equal to[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *                                        string.length[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IllegalArgumentException       if len is too large [0m[1;39m([0m[39mi.e.,[0m         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *                                        there is not enough data in string[0m [2m                [0m
[2;36m                    [0m         [39mto create a String of that[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *                                        length[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            final int offset,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            final int len[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws ArrayIndexOutOfBoundsException, IllegalArgumentException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39mlen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39moffset < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset >= string.length[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mArrayIndexOutOfBoundsException[0m[1;39m([0m[32m"Illegal offset "[0m[39m + offset [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m" [0m[32m([0m[32mString data is of length "[0m[39m + string.length + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mstring.length - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m < len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Illegal length "[0m[39m + len[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len * [0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * Given a byte array of [0m[1;36m16[0m[39m-bit unicode characters in little endian[0m          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * format [0m[1;39m([0m[39mmost important byte last[0m[1;39m)[0m[39m, return a Java String representation[0m    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * of it.[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * [0m[1;39m{[0m[39m [0m[1;36m0x16[0m[39m, [0m[1;36m0x00[0m[39m [0m[1;39m}[0m[39m -[0m[1;36m0x16[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * @param string the byte array to be converted[0m                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     * @return the converted string, never [0m[1;39m{[0m[39m@code null[0m[1;39m}[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m string[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        if [0m[1;39m([0m[39mstring.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            return [0m[32m""[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        return [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mstring, [0m[1;36m0[0m[39m, string.length [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * Convert String to [0m[1;36m16[0m[39m-bit unicode characters in little endian format[0m      [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * @param string the string[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * @return the byte array of [0m[1;36m16[0m[39m-bit unicode characters[0m                      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetToUnicodeLE[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        return [0m[1;35mstring.getBytes[0m[1;39m([0m[39mUTF16LE[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     * Read [0m[1;36m8[0m[39m bit data [0m[1;39m([0m[39min ISO-[0m[1;36m8859[0m[39m-[0m[1;36m1[0m[39m codepage[0m[1;39m)[0m[39m into a [0m[1;39m([0m[39municode[0m[1;39m)[0m[39m Java[0m           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * String and return.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * [0m[1;39m([0m[39mIn Excel terms, read compressed [0m[1;36m8[0m[39m bit unicode as a string[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * @param string byte array to read[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * @param offset offset to read byte array[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     * @param len    length to read byte array[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * @return String generated String instance by reading byte array [0m          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mISO-[0m[1;36m8859[0m[39m-[0m[1;36m1[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    public static String [0m[1;35mgetFromCompressedUnicode[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            final int offset,[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            final int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        int len_to_use = [0m[1;35mMath.min[0m[1;39m([0m[39mlen, string.length - offset[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len_to_use, ISO_8859_1[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * Read [0m[1;36m8[0m[39m bit data [0m[1;39m([0m[39min UTF-[0m[1;36m8[0m[39m codepage[0m[1;39m)[0m[39m into a [0m[1;39m([0m[39municode[0m[1;39m)[0m[39m Java[0m                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * String and return.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * [0m[1;39m([0m[39mIn Excel terms, read compressed [0m[1;36m8[0m[39m bit unicode as a string[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * @param string byte array to read[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * @param offset offset to read byte array[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     * @param len    length to read byte array[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:     * @return String generated String instance by reading byte array [0m[1;39m([0m[39mUTF-[0m[1;36m8[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    public static String [0m[1;35mgetFromCompressedUTF8[0m[1;39m([0m                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            final int offset,[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:            final int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        int len_to_use = [0m[1;35mMath.min[0m[1;39m([0m[39mlen, string.length - offset[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len_to_use, UTF_8[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * @param in stream,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     * @param nChars number pf chars[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     * @return ISO_8859_1 encoded result[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    public static String [0m[1;35mreadCompressedUnicode[0m[1;39m([0m[39mLittleEndianInput in, int [0m       [2m                [0m
[2;36m                    [0m         [39mnChars[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mnChars, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;35min.readFully[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mbuf, ISO_8859_1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:     * InputStream [0m[1;39m{[0m[39m@code in[0m[1;39m}[0m[39m is expected to contain:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:     * <ol>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:     * <li>ushort nChars<[0m[35m/[0m[95mli[0m[39m>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:     * <li>byte is16BitFlag<[0m[35m/[0m[95mli[0m[39m>[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:     * <li>byte[0m[1;39m[[0m[1;39m][0m[35m/[0m[95mchar[0m[1;39m[[0m[1;39m][0m[39m characterData<[0m[35m/[0m[95mli[0m[39m>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:     * <[0m[35m/[0m[95mol[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:     * For this encoding, the is16BitFlag is always present even if [0m[33mnChars[0m[39m==[0m[1;36m0[0m[39m.[0m  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:     * This structure is also known as a XLUnicodeString.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    public static String [0m[1;35mreadUnicodeString[0m[1;39m([0m[39mLittleEndianInput in[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        int nChars = [0m[1;35min.readUShort[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        byte flag = [0m[1;35min.readByte[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mflag & [0m[1;36m0x01[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            return [0m[1;35mreadCompressedUnicode[0m[1;39m([0m[39min, nChars[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        return [0m[1;35mreadUnicodeLE[0m[1;39m([0m[39min, nChars[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:     * InputStream [0m[1;39m{[0m[39m@code in[0m[1;39m}[0m[39m is expected to contain:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:     * <ol>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:     * <li>byte is16BitFlag<[0m[35m/[0m[95mli[0m[39m>[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:     * <li>byte[0m[1;39m[[0m[1;39m][0m[35m/[0m[95mchar[0m[1;39m[[0m[1;39m][0m[39m characterData<[0m[35m/[0m[95mli[0m[39m>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:     * <[0m[35m/[0m[95mol[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:     * For this encoding, the is16BitFlag is always present even if [0m[33mnChars[0m[39m==[0m[1;36m0[0m[39m.[0m  [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:     * <br>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     * This method should be used when the nChars field is <em>not<[0m[35m/[0m[95mem[0m[39m> stored[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/HMEFMessage.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hmef.attribute.MAPIAttribute;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.attribute.MAPIStringAttribute;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.attribute.TNEFAttribute;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hmef.attribute.TNEFMAPIAttribute;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hmef.attribute.TNEFProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * HMEF - Implementation of the Microsoft TNEF message[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *  encoding format [0m[1;39m([0m[39maka winmail.dat[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * See:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *   [0m[4;94mhttp://support.microsoft.com/kb/241538[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *   [0m[4;94mhttp://en.wikipedia.org/wiki/Transport_Neutral_Encapsulation_Format[0m         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *   [0m[4;94mhttp://search.cpan.org/dist/Convert-TNEF/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class HMEFMessage [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public static final int [0m[1;33mHEAD[0m[39mER_SIGNATURE = [0m[1;36m0x223e9f78[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unused"[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private int fileId;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private final List<TNEFAttribute> messageAttributes = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private final List<MAPIAttribute> mapiAttributes = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    private final List<Attachment> attachments = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param inp input stream[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @throws IOException If reading data from the stream fails[0m                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @throws IllegalStateException a number of runtime exceptions can be [0m      [2m                [0m
[2;36m                    [0m         [39mthrown, especially if there are problems with the[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * input format[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public [0m[1;35mHMEFMessage[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[35m/[0m[35m/[0m[39m Check the signature matches[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            int sig = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            if [0m[1;39m([0m[39msig != [0m[1;33mHEAD[0m[39mER_SIGNATURE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                        [0m[32m"TNEF signature not detected in file, "[0m[39m +[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                        [0m[32m"expected "[0m[39m + [0m[1;33mHEAD[0m[39mER_SIGNATURE + [0m[32m" but got "[0m[39m + sig[0m       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[35m/[0m[35m/[0m[39m Read the File ID[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            fileId = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now begin processing the contents[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;35mprocess[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;35minp.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private void [0m[1;35mprocess[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:       int level;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:       do [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:           [0m[35m/[0m[35m/[0m[39m Fetch the level[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:           level = [0m[1;35minp.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:           [0m[35m/[0m[35m/[0m[39m Decide what to attach it to, based on the levels and IDs[0m           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:           switch [0m[1;39m([0m[39mlevel[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:               case TNEFProperty.LEVEL_MESSAGE:[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                   [0m[1;35mprocessMessage[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                   break;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                case TNEFProperty.LEVEL_ATTACHMENT:[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                   [0m[1;35mprocessAttachment[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                   break;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:               [0m[35m/[0m[35m/[0m[39m ignore trailing newline[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                case [0m[32m'\r'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                case [0m[32m'\n'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                case TNEFProperty.LEVEL_END_OF_FILE:[0m                             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                default:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                    throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"Unhandled level "[0m[39m + level[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;39m}[0m[39m while [0m[1;39m([0m[39mlevel != TNEFProperty.LEVEL_END_OF_FILE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    void [0m[1;35mprocessMessage[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build the attribute[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        TNEFAttribute attr = [0m[1;35mTNEFAttribute.create[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;35mmessageAttributes.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        if [0m[1;39m([0m[39mattr instanceof TNEFMAPIAttribute[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            TNEFMAPIAttribute tnefMAPI = [0m[1;39m([0m[39mTNEFMAPIAttribute[0m[1;39m)[0m[39m attr;[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mmapiAttributes.addAll[0m[1;39m([0m[1;35mtnefMAPI.getMAPIAttributes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    void [0m[1;35mprocessAttachment[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build the attribute[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        TNEFAttribute attr = [0m[1;35mTNEFAttribute.create[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[35m/[0m[35m/[0m[39m Previous attachment or a new one?[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[1;35mattachments.isEmpty[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                || [0m[1;35mattr.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_ATTACHRENDERDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mattachments.add[0m[1;39m([0m[39mnew [0m[1;35mAttachment[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[35m/[0m[35m/[0m[39m Save the attribute for it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        Attachment attach = [0m[1;35mattachments.get[0m[1;39m([0m[1;35mattachments.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;35mattach.addAttribute[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     * Returns all HMEF/TNEF attributes of the message.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * Note - In a typical message, most of the interesting properties[0m          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     *  are stored as [0m[1;39m{[0m[39m@link MAPIAttribute[0m[1;39m}[0m[39ms - see [0m[1;39m{[0m[39m@link [0m                      [2m                [0m
[2;36m                    [0m         [39m#[0m[1;35mgetMessageMAPIAttributes[0m[1;39m([0m[1;39m)[0m[1;39m}[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    public List<TNEFAttribute> [0m[1;35mgetMessageAttributes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        return [0m[1;35mCollections.unmodifiableList[0m[1;39m([0m[39mmessageAttributes[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * Returns all MAPI attributes of the message.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     * Note - A small number of HMEF/TNEF specific attributes normally[0m          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:     *  apply to most messages, see [0m[1;39m{[0m[39m@link #[0m[1;35mgetMessageAttributes[0m[1;39m([0m[1;39m)[0m[1;39m}[0m             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    public List<MAPIAttribute> [0m[1;35mgetMessageMAPIAttributes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        return [0m[1;35mCollections.unmodifiableList[0m[1;39m([0m[39mmapiAttributes[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     * Returns all the Attachments of the message.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    public List<Attachment> [0m[1;35mgetAttachments[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        return [0m[1;35mCollections.unmodifiableList[0m[1;39m([0m[39mattachments[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:     * Return the message attribute with the given ID,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     *  or null if there isn't one.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    public TNEFAttribute [0m[1;35mgetMessageAttribute[0m[1;39m([0m[39mTNEFProperty id[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        for [0m[1;39m([0m[39mTNEFAttribute attr : messageAttributes[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            if [0m[1;39m([0m[1;35mattr.getProperty[0m[1;39m([0m[1;39m)[0m[39m == id[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                return attr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:     * Return the message MAPI Attribute with the given ID,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:     *  or null if there isn't one.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    public MAPIAttribute [0m[1;35mgetMessageMAPIAttribute[0m[1;39m([0m[39mMAPIProperty id[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        for [0m[1;39m([0m[39mMAPIAttribute attr : mapiAttributes[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[35m/[0m[35m/[0m[39m Because of custom properties, match on ID not literal property [0m  [2m                [0m
[2;36m                    [0m         [39mobject[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:            if [0m[1;39m([0m[1;35mattr.getProperty[0m[1;39m([0m[1;39m)[0m[39m.id == id.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                return attr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:     * Return the string value of the mapi property, or null[0m                    [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:     *  if it isn't set[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    private String [0m[1;35mgetString[0m[1;39m([0m[39mMAPIProperty id[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        return [0m[1;35mMAPIStringAttribute.getAsString[0m[1;39m([0m[39m [0m[1;35mgetMessageMAPIAttribute[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:     * Returns the Message Subject, or null if the mapi property[0m                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:     *  for this isn't set[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    public String [0m[1;35mgetSubject[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        return [0m[1;35mgetString[0m[1;39m([0m[39mMAPIProperty.CONVERSATION_TOPIC[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:     * Returns the Message Body, as RTF, or null if the mapi property[0m           [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     *  for this isn't set[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.jav[0m[1;92ma:1[0m[39m-[0m[1;36m114[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * An attribute which applies to a [0m[1;39m{[0m[39m@link HMEFMessage[0m[1;39m}[0m                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *  or one of its [0m[1;39m{[0m[39m@link Attachment[0m[1;39m}[0m[39ms.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * Note - the types and IDs differ from standard Outlook/MAPI[0m                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *  ones, so we can't just re-use the HSMF ones.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class TNEFAttribute [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 20_000_000;[0m              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:   private final TNEFProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private final int checksum;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    * @param length the max record length allowed for TNEFAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    * @return the max record length allowed for TNEFAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    * Constructs a single new attribute from the id, type,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    *  and the contents of the stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   protected [0m[1;35mTNEFAttribute[0m[1;39m([0m[39mint id, int type, InputStream inp[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:      this.type = type;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:      int length = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      property = [0m[1;35mTNEFProperty.getBest[0m[1;39m([0m[39mid, type[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:      data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlength, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:      [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      checksum = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:   [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    * Creates a new TNEF Attribute by reading data from[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    *  the stream within a [0m[1;39m{[0m[39m@link HMEFMessage[0m[1;39m}[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:   public static TNEFAttribute [0m[1;35mcreate[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      int id   = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      int type = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[35m/[0m[35m/[0m[39m Create as appropriate[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mid == TNEFProperty.ID_MAPIPROPERTIES.id ||[0m                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            id == TNEFProperty.ID_ATTACHMENT.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:         return new [0m[1;35mTNEFMAPIAttribute[0m[1;39m([0m[39mid, type, inp[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mtype == TNEFProperty.TYPE_STRING ||[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:           type == TNEFProperty.TYPE_TEXT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:         return new [0m[1;35mTNEFStringAttribute[0m[1;39m([0m[39mid, type, inp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mtype == TNEFProperty.TYPE_DATE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:         return new [0m[1;35mTNEFDateAttribute[0m[1;39m([0m[39mid, type, inp[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:      return new [0m[1;35mTNEFAttribute[0m[1;39m([0m[39mid, type, inp[0m[1;39m)[0m[39m; [0m                                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:   public TNEFProperty [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      return property;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:   public int [0m[1;35mgetType[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      return type;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:   public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetData[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:      return data;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:   [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:   public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:      return [0m[32m"Attribute "[0m[39m + property + [0m[32m", [0m[32mtype[0m[32m="[0m[39m + type +[0m                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:             [0m[32m", data [0m[32mlength[0m[32m="[0m[39m + data.length; [0m                                   [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.Types.MAPIType;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.HexDump;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * A pure-MAPI attribute which applies to a [0m[1;39m{[0m[39m@link HMEFMessage[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *  or one of its [0m[1;39m{[0m[39m@link Attachment[0m[1;39m}[0m[39ms.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class MAPIAttribute [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 1_000_000;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:   private static int MAX_RECORD_LENGTH = 1_000_000;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   private static int MAX_RECORD_COUNT = 10_000;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:   private final MAPIProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    * @param length the max record length allowed for MAPIAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    * @return the max record length allowed for MAPIAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    * Constructs a single new attribute from[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    *  the contents of the stream[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:   public [0m[1;35mMAPIAttribute[0m[1;39m([0m[39mMAPIProperty property, int type, byte[0m[1;39m[[0m[1;39m][0m[39m data[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:      this.property = property;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      this.type = type;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:      this.data = [0m[1;35mdata.clone[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:   public MAPIProperty [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:      return property;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:   public int [0m[1;35mgetType[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      return type;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:   public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetData[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:      return data;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:   public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:      String hex;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata.length <= [0m[1;36m16[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:         hex = [0m[1;35mHexDump.toHex[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:         byte[0m[1;39m[[0m[1;39m][0m[39m d = [0m[1;35mArrays.copyOf[0m[1;39m([0m[39mdata, [0m[1;36m16[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:         hex = [0m[1;35mHexDump.toHex[0m[1;39m([0m[39md[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:         hex = [0m[1;35mhex.substring[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m + [0m[32m", ....[0m[32m][0m[32m"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:      return property + [0m[32m" "[0m[39m + hex;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:   [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    * Parses a MAPI Properties TNEF Attribute, and returns[0m                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    *  the list of MAPI Attributes contained within it[0m                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   public static List<MAPIAttribute> [0m[1;35mcreate[0m[1;39m([0m[39mTNEFAttribute parent[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_MAPIPROPERTIES[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:         [0m[35m/[0m[35m/[0m[39m Regular MAPI Properties, normally on the message[0m                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:      else [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_ATTACHMENT[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:         [0m[35m/[0m[35m/[0m[39m MAPI Properties for an attachment[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:      else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:         [0m[35m/[0m[35m/[0m[39m Something else, oh dear[0m[33m...[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:               [0m[32m"Can only create from a MAPIProperty attribute, "[0m[39m +[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:               [0m[32m"instead received a "[0m[39m + [0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" one"[0m            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:         [0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:      [0m[1;35mtry[0m[1;39m([0m[39mUnsynchronizedByteArrayInputStream inp = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[1;35mparent.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:         [0m[35m/[0m[35m/[0m[39m First up, get the number of attributes[0m                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:         int count = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:         List<MAPIAttribute> attrs = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:         [0m[35m/[0m[35m/[0m[39m Now, read each one in in turn[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:         [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            int typeAndMV = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            int id = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            [0m[35m/[0m[35m/[0m[39m Is it either Multi-Valued or Variable-Length?[0m                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            boolean isMV = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            boolean isVL = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            int typeId = typeAndMV;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39m [0m[1;39m([0m[39mtypeAndMV & Types.MULTIVALUED_FLAG[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:               isMV = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:               typeId -= Types.MULTIVALUED_FLAG;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mtypeId == [0m[1;35mTypes.ASCII_STRING.getId[0m[1;39m([0m[1;39m)[0m[39m || typeId == [0m               [2m                [0m
[2;36m                    [0m         [1;35mTypes.UNICODE_STRING.getId[0m[1;39m([0m[1;39m)[0m[39m ||[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                    typeId == [0m[1;35mTypes.BINARY.getId[0m[1;39m([0m[1;39m)[0m[39m || typeId == [0m                [2m                [0m
[2;36m                    [0m         [1;35mTypes.DIRECTORY.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:               isVL = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            [0m[35m/[0m[35m/[0m[39m Turn the type ID into a strongly typed thing[0m                     [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            MAPIType type = [0m[1;35mTypes.getById[0m[1;39m([0m[39mtypeId[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            if [0m[1;39m([0m[39mtype == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:               type = [0m[1;35mTypes.createCustom[0m[1;39m([0m[39mtypeId[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[39m If it's a named property, rather than a standard[0m                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[35m/[0m[35m/[0m[39m  MAPI property, grab the details of it[0m                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            MAPIProperty prop = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mid >= [0m[1;36m0x8000[0m[39m && id <= [0m[1;36m0xFFFF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m guid = new byte[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, guid[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read guid"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:               int mptype = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:               [0m[35m/[0m[35m/[0m[39m Get the name of it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:               String name;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mmptype == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                  [0m[35m/[0m[35m/[0m[39m It's based on a normal one[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                  int mpid = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                  MAPIProperty base = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mmpid[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                  name = base.name;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:               [0m[35m/[0m[35m/[0m[39m Now create[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, name[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mprop == MAPIProperty.UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, [0m[32m"[0m[32m([0m[32munknown "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [1;35mInteger.toHexString[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now read in the [0m[1;35mvalue[0m[1;39m([0m[39ms[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            int values = [0m[1;36m1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:               values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:               throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Placeholder/NULL arrays aren't [0m           [2m                [0m
[2;36m                    [0m         [32msupported."[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:               int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:               [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIStringAttribute.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:1[0m[39m-[0m[1;36m83[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.poi.logging.PoiLogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * A pure-MAPI attribute holding a String, which applies[0m                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *  to a [0m[1;39m{[0m[39m@link HMEFMessage[0m[1;39m}[0m[39m or one of its [0m[1;39m{[0m[39m@link Attachment[0m[1;39m}[0m[39ms.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public final class MAPIStringAttribute extends MAPIAttribute [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:   private static final Logger LOG = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mPoiLogManager.getLogger[0m[1;39m([0m[39mMAPIStringAttribute.class[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:   private static final String CODEPAGE = [0m[32m"CP1252"[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   private final String data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   public [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mMAPIProperty property, int type, byte[0m[1;39m[[0m[1;39m][0m[39m data[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:      [0m[1;35msuper[0m[1;39m([0m[39mproperty, type, data[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:      String tmpData = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mtype == [0m[1;35mTypes.ASCII_STRING.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:         tmpData = new [0m[1;35mString[0m[1;39m([0m[39mdata, [0m[1;35mCharset.forName[0m[1;39m([0m[39mCODEPAGE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == [0m[1;35mTypes.UNICODE_STRING.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:         tmpData = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Not a string type "[0m[39m + type[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:      [0m[35m/[0m[35m/[0m[39m Strip off the null terminator if present[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mtmpData.endsWith[0m[1;39m([0m[32m"\0"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         tmpData = [0m[1;35mtmpData.substring[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mtmpData.length[0m[1;39m([0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:      this.data = tmpData;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:   public String [0m[1;35mgetDataString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:      return data;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:   public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      return [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" "[0m[39m + data;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    * Returns the string of an Attribute, converting as appropriate[0m              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:   public static String [0m[1;35mgetAsString[0m[1;39m([0m[39mMAPIAttribute attr[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mattr == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:         return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mattr instanceof MAPIStringAttribute[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:         return [0m[1;39m([0m[1;39m([0m[39mMAPIStringAttribute[0m[1;39m)[0m[39mattr[0m[1;39m)[0m[1;35m.getDataString[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mattr instanceof MAPIRtfAttribute[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:         return [0m[1;39m([0m[1;39m([0m[39mMAPIRtfAttribute[0m[1;39m)[0m[39mattr[0m[1;39m)[0m[1;35m.getDataString[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      [0m[1;35mLOG.atWarn[0m[1;39m([0m[1;39m)[0m[1;35m.log[0m[1;39m([0m[32m"Warning, non string property found: [0m[32m{[0m[32m}[0m[32m"[0m[39m, attr[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      return null;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:79[0m[39m-[0m[1;36m94[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            final int offset,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            final int len[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws ArrayIndexOutOfBoundsException, IllegalArgumentException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39mlen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39moffset < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset >= string.length[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mArrayIndexOutOfBoundsException[0m[1;39m([0m[32m"Illegal offset "[0m[39m + offset [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m" [0m[32m([0m[32mString data is of length "[0m[39m + string.length + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mstring.length - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m < len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Illegal length "[0m[39m + len[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len * [0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:33[0m[39m-[0m[1;36m46[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final int DEFAULT_MAX_RECORD_LENGTH = [0m[1;36m10000000[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public static final Charset UTF16LE = StandardCharsets.UTF_16LE;[0m             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public static final Charset UTF8 = StandardCharsets.UTF_8;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public static final Charset WIN_1252 = [0m[1;35mCharset.forName[0m[1;39m([0m[32m"cp1252"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @param length the max record length allowed for StringUtil[0m                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        MAX_RECORD_LENGTH = length;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIStringAttribute.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:46[0m[39m-[0m[1;36m52[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:         tmpData = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Not a string type "[0m[39m + type[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:      [0m[35m/[0m[35m/[0m[39m Strip off the null terminator if present[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mtmpData.endsWith[0m[1;39m([0m[32m"\0"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - The OOM crash occurs when `StringUtil.getFromUnicodeLE` blindly calls `new [0m    [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m, offset, len*[0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m` on untrusted, potentially enormous buffers [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msupplied via MAPI/TNEF attributes[0m[1;39m)[0m[39m.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - While upstream code [0m[1;39m([0m[39me.g., `IOUtils.safelyAllocate`[0m[1;39m)[0m[39m bounds raw byte-array [0m    [2m                [0m
[2;36m                    [0m         [39mallocations via various `MAX_RECORD_LENGTH` constants, `getFromUnicodeLE` itself [0m   [2m                [0m
[2;36m                    [0m         [39mdoes not enforce any cap on `len`.  Thus a malicious or fuzzed attribute can [0m       [2m                [0m
[2;36m                    [0m         [39mspecify an excessive `len`, exhausting the heap in the JDKâ€™s `String` constructor.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Preserve Critical Logic:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Validating offset and length [0m[1;39m([0m[39mnegative/overflow checks[0m[1;39m)[0m[39m in `getFromUnicodeLE` [0m [2m                [0m
[2;36m                    [0m         [39mmust remain intact.[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Existing cap fields `DEFAULT_MAX_RECORD_LENGTH`, `MAX_RECORD_LENGTH` and their[0m [2m                [0m
[2;36m                    [0m         [39msetters/getters in `StringUtil` will be reused.[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Compressed-Unicode and UTF-[0m[1;36m8[0m[39m methods in `StringUtil` remain unaffected.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Patch Strategy [0m[1;39m([0m[39mhigh-level steps[0m[1;39m)[0m[39m:[0m                                               [2m                [0m
[2;36m                    [0m         [39m   a. In `StringUtil` [0m[1;39m([0m[39mpoi/src/main/java/org/apache/poi/util/StringUtil.java[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mlocate:[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m string, int offset, int len[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m   b. Immediately after the existing checks for `len < [0m[1;36m0[0m[39m` and `[0m[1;39m([0m[1;39m([0m[39mstring.length - [0m   [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[35m/[0m[95m2[0m[1;39m)[0m[39m < len`,[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m      insert:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mlen > MAX_RECORD_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Requested UnicodeLE length "[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m                 + len + [0m[32m" exceeds allowed maximum of "[0m[39m + MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   c. Ensure the single-argument overload [0m[1;39m([0m[39m`[0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m invokes the [0m [2m                [0m
[2;36m                    [0m         [39msame bounds check via that three-arg method.[0m                                        [2m                [0m
[2;36m                    [0m         [39m   d. Add a unit test [0m[1;39m([0m[39moutside fuzz harness[0m[1;39m)[0m[39m verifying that `getFromUnicodeLE` [0m     [2m                [0m
[2;36m                    [0m         [39mrejects `len > MAX_RECORD_LENGTH`.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Enforcing a maximum on `len` prevents malicious inputs from driving unbounded [0m [2m                [0m
[2;36m                    [0m         [39mmemory allocation in `String.<init>`, eliminating the OOM under fuzz testing.  [0m     [2m                [0m
[2;36m                    [0m         [39m   - Leveraging the existing `MAX_RECORD_LENGTH` field maintains consistency with [0m  [2m                [0m
[2;36m                    [0m         [39mother safe-allocation utilities [0m[1;39m([0m[39m`readCompressedUnicode`, [0m                          [2m                [0m
[2;36m                    [0m         [39m`IOUtils.safelyAllocate`[0m[1;39m)[0m[39m.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Normal use-cases with moderate text lengths [0m[1;39m([0m[39me.g., typical email bodies or [0m    [2m                [0m
[2;36m                    [0m         [39mattribute names[0m[1;39m)[0m[39m remain unaffected; if a legitimate input exceeds the default cap [0m  [2m                [0m
[2;36m                    [0m         [39mof [0m[1;36m10[0m[39m million characters, users can raise the limit via [0m                            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mStringUtil.setMaxRecordLength[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`.  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - No external libraries, harness code, or tests are modified, preserving [0m        [2m                [0m
[2;36m                    [0m         [39mexisting functionality and test coverage.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side Effects & Mitigations:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Very large but valid Unicode strings [0m[1;39m([0m[39m>[0m[1;36m10[0m[39m million chars[0m[1;39m)[0m[39m will now throw [0m       [2m                [0m
[2;36m                    [0m         [39m`IllegalArgumentException` by default.  Mitigation: allow configuration via [0m        [2m                [0m
[2;36m                    [0m         [39m`StringUtil.setMaxRecordLength`.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Upstream callers will see `IllegalArgumentException` rather than OOM; this is [0m [2m                [0m
[2;36m                    [0m         [39msafer and aligns with existing argument-validation patterns.  [0m                      [2m                [0m
[2;36m                    [0m         [39m   - No additional performance impact for normal strings, as the check is [0m[1;35mO[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Mirror of `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlength, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m` usage in [0m        [2m                [0m
[2;36m                    [0m         [39m`readCompressedUnicode`.[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Conforms to existing setter/getter pattern for record-length limits in [0m        [2m                [0m
[2;36m                    [0m         [39m`StringUtil`, `TNEFAttribute`, `MAPIAttribute`.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 17:21:52][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=510760;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=522064;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=707339;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=757800;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpp0aqk7r9[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/apache-poi_poi-full-01_vuln_1/[0m[95magent-out[0m [2m               [0m
[2;36m                    [0m         [95mput-1766564512.3209238[0m                                                               [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-poi_poi-full-01_vuln_1.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=198869;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=42388;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[12/24/25 17:21:53][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=543057;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=390124;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=581655;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=374990;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
