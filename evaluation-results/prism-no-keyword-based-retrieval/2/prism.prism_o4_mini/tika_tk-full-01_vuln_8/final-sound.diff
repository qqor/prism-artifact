--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -95,9 +95,13 @@
         }
         Path cwd = Paths.get(".").toAbsolutePath().normalize();
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
-        Path tmpFile = tmpDir.resolve(fileName);
+        Path tmpFile = Files.createTempFile(tmpDir, "tika-shell-", ".sh");
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
+        java.io.File tmpFileObj = tmpFile.toFile();
+        if (!tmpFileObj.setExecutable(true, true)) {
+            // Could not set executable permission, proceed anyway
+        }
+        ProcessBuilder pb = new ProcessBuilder(tmpFile.toAbsolutePath().toString());
         pb.directory(tmpDir.toFile());
         try {
             FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
