{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.33141790000000004,
    "prompt_tokens": 236169,
    "completion_tokens": 16280
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -1773,15 +1773,19 @@\n \n static void dissect_writereg_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, int startoffset, int length, gvcp_conv_info_t *gvcp_info, gvcp_transaction_t* gvcp_trans)\n {\n-\tint offset = startoffset;\n-\tint i;\n-\tproto_item *item = NULL;\n-\tuint32_t addr = 0;\n-\tuint32_t value = 0;\n-\tconst char *address_string = NULL;\n-\tbool is_custom_register = false;\n-\tint num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */\n-\tproto_tree *subtree = NULL;\n+    int offset = startoffset;\n+    gvcp_register_count = 0;\n+    int i;\n+    proto_item *item = NULL;\n+    uint32_t addr = 0;\n+    uint32_t value = 0;\n+    const char *address_string = NULL;\n+    bool is_custom_register = false;\n+    int num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */\n+    if (num_registers > GVCP_MAX_REGISTER_COUNT) {\n+        num_registers = GVCP_MAX_REGISTER_COUNT;\n+    }\n+    proto_tree *subtree = NULL;\n \n \tif (gvcp_trans)\n \t{\n",
  "stdout": "",
  "stderr": ""
}