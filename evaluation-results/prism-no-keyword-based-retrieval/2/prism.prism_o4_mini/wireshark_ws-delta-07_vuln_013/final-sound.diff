--- a/epan/dissectors/packet-gvcp.c
+++ b/epan/dissectors/packet-gvcp.c
@@ -1773,15 +1773,19 @@
 
 static void dissect_writereg_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, int startoffset, int length, gvcp_conv_info_t *gvcp_info, gvcp_transaction_t* gvcp_trans)
 {
-	int offset = startoffset;
-	int i;
-	proto_item *item = NULL;
-	uint32_t addr = 0;
-	uint32_t value = 0;
-	const char *address_string = NULL;
-	bool is_custom_register = false;
-	int num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */
-	proto_tree *subtree = NULL;
+    int offset = startoffset;
+    gvcp_register_count = 0;
+    int i;
+    proto_item *item = NULL;
+    uint32_t addr = 0;
+    uint32_t value = 0;
+    const char *address_string = NULL;
+    bool is_custom_register = false;
+    int num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */
+    if (num_registers > GVCP_MAX_REGISTER_COUNT) {
+        num_registers = GVCP_MAX_REGISTER_COUNT;
+    }
+    proto_tree *subtree = NULL;
 
 	if (gvcp_trans)
 	{
