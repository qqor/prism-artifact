--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -889,8 +889,14 @@
           len = 0;
         }
       }
-      else if(prec != -1)
-        len = (size_t)prec;
+      else if(prec >= 0) {
+        /* Only output up to 'prec' bytes and never read past str's NUL */
+        size_t max = (size_t)prec;
+        size_t i   = 0;
+        while(i < max && str[i])
+          i++;
+        len = i;
+      }
       else if(*str == '\0')
         len = 0;
       else

--- a/lib/dict.c
+++ b/lib/dict.c
@@ -227,7 +227,7 @@
         result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
         do {
-        result = sendf(data, user_start);
+        result = sendf(data, "%s", user_start);
         } while(result == CURLE_AGAIN);
       }
 
