{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-delta-05_curl-001",
  "source_directory": "/home/qqor/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.43517540000000005,
    "prompt_tokens": 259982,
    "completion_tokens": 33908
  },
  "variant": "sound",
  "diff": "--- a/lib/mprintf.c\n+++ b/lib/mprintf.c\n@@ -889,8 +889,14 @@\n           len = 0;\n         }\n       }\n-      else if(prec != -1)\n-        len = (size_t)prec;\n+      else if(prec >= 0) {\n+        /* Only output up to 'prec' bytes and never read past str's NUL */\n+        size_t max = (size_t)prec;\n+        size_t i   = 0;\n+        while(i < max && str[i])\n+          i++;\n+        len = i;\n+      }\n       else if(*str == '\\0')\n         len = 0;\n       else\n\n--- a/lib/dict.c\n+++ b/lib/dict.c\n@@ -227,7 +227,7 @@\n         result = sendf(data, \"Sending extra debug info...\");\n         } while(result == CURLE_AGAIN);\n         do {\n-        result = sendf(data, user_start);\n+        result = sendf(data, \"%s\", user_start);\n         } while(result == CURLE_AGAIN);\n       }\n \n",
  "stdout": "",
  "stderr": ""
}