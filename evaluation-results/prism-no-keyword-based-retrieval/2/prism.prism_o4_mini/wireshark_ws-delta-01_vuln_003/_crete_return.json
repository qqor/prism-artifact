{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-01_vuln_003",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.40166060000000003,
    "prompt_tokens": 274910,
    "completion_tokens": 22559
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-ber.c\n+++ b/epan/dissectors/packet-ber.c\n@@ -3185,13 +3185,14 @@\n          * do we want to throw an exception?\n          */\n         if (out_tvb) {\n+            size_t to_copy;\n             tvb_len = tvb_get_uint8(tvb, offset);\n-            if ((unsigned)tvb_len >= name_len) {\n-                tvb_memcpy(out_tvb, (uint8_t*)name_string, 0, name_len-1);\n-            } else {\n-                tvb_memcpy(out_tvb, (uint8_t*)name_string, 0, tvb_len);\n-            }\n-            name_string[tvb_len] = '\\0';\n+            to_copy = (size_t)tvb_len;\n+            if (to_copy >= name_len) {\n+                to_copy = name_len - 1;\n+            }\n+            tvb_memcpy(out_tvb, name_string, 0, to_copy);\n+            name_string[to_copy] = '\\0';\n         }\n     }\n \n",
  "stdout": "",
  "stderr": ""
}