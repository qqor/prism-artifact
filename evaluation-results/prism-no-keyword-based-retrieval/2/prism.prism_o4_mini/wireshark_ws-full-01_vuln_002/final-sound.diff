--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -636,8 +636,13 @@
 dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)
 {
-  if ( hf_telnet_naws_subopt_set )
+  if ( hf_telnet_naws_subopt_set ) {
     wmem_free(pinfo->pool, hf_naws_data);
+    /* Clear NAWS state to avoid use-after-free */
+    hf_telnet_naws_subopt_set = 0;
+    hf_naws_data             = NULL;
+    hf_telnet_line           = 0;
+  }
 
   return;
 }
@@ -651,8 +656,11 @@
 
   hf_naws_data = (uint8_t *)wmem_alloc(pinfo->pool, hf_telnet_width * hf_telnet_height);
 
-  if ( hf_naws_data )
+  if ( hf_naws_data ) {
     hf_telnet_naws_subopt_set = 1;
+    /* Initialize line index for the newly allocated NAWS buffer */
+    hf_telnet_line = 0;
+  }
   else
     hf_telnet_naws_subopt_set = 0;
 
