--- a/src/udev/udev-rules.c
+++ b/src/udev/udev-rules.c
@@ -1215,18 +1215,23 @@
                 * The return value must be terminated by two subsequent NULs
                 * so it could be safely interpreted as nulstr.
                 */
-                if (is_prefix_match){
-                        /* need more room to make rule glob match */
-                        memcpy(str + pos - 1, unescaped, l + 1);
-                        str[pos + l - 1] = '*';
-                        str[pos + l] = '\0';
-                        str[pos + l + 1] = '\0';
-                        m = str + pos - 1;
-
-                } else {
-                        memcpy(m, unescaped, l + 1);
-                        m[l] = '\0';
-                        m[l + 1] = '\0';
+                {
+                        char *target;
+                        if (is_prefix_match)
+                                target = str + pos - 1;
+                        else
+                                target = m;
+                        memcpy(target, unescaped, (size_t) l + 1);
+                        char *j = target + l;
+                        if (is_prefix_match) {
+                                j[0] = '*';
+                                j[1] = '\0';
+                                j[2] = '\0';
+                        } else {
+                                j[0] = '\0';
+                                j[1] = '\0';
+                        }
+                        m = target;
                 }
                 str = m;
 
