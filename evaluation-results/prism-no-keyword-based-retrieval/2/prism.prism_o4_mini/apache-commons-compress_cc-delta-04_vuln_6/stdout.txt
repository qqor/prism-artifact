[2;36m[01/02/26 03:30:02][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=594769;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=693822;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpv6jz05w3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/apache-commons-compress_cc-delta-04_vul[0m [2m               [0m
[2;36m                    [0m         [35mn_6/[0m[95magent-output-1767292202.7803934[0m                                                  [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-04_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=670899;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=968910;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/02/26 03:31:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=322884;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=161207;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m79.94[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=654969;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=924242;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=382037;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=123792;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=47117;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=771316;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m79[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=156517;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=663380;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:31:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.54[0m        ]8;id=487507;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=568558;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/02/26 03:31:24][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=910877;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=778723;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=329890;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=416722;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=465666;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=507577;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=101652;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=289116;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:31:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.77[0m        ]8;id=833063;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=246936;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=953246;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=88859;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:31:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.49[0m        ]8;id=672170;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=237264;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/02/26 03:31:31][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=465233;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=860739;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3311455272931291867/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3311455272931291867/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/02/26 03:31:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=989905;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=580679;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/02/26 03:32:21][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=306867;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=296623;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/02/26 03:32:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=761958;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=52583;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=825199;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=408823;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:32:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.48[0m        ]8;id=689733;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=548124;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=432879;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=130582;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpznj948jw[0m                                                 ]8;id=969640;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=742869;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/02/26 03:33:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m35.48[0m seconds;   ]8;id=907762;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=166115;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=174887;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=447213;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:33:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m12.17[0m      ]8;id=847568;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863479;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=450457;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=269660;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:33:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m4.23[0m seconds; ]8;id=257389;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=226769;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=371524;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=362099;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=426308;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579800;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=858701;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=322560;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:33:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.54[0m        ]8;id=92077;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=736899;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=559538;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=44876;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/02/26 03:33:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.53[0m        ]8;id=412156;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=140108;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=879066;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383036;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.52[0m        ]8;id=205039;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=702025;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/02/26 03:33:47][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=426321;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=60489;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         @@ [1;36m-70[0m,[1;36m20[0m +[1;36m70[0m,[1;36m24[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  final Path targetDirPath = nullTarget ? null :                             [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1m([0m[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m                  T nextEntry = [1;35msupplier.get[0m[1m([0m[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                  while [1m([0mnextEntry != null[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -            final Path targetPath = nullTarget ? null :                            [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1m([0mtargetDirPath[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +            Path rawTargetPath = nullTarget ? null :                               [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1m([0mtargetDirPath[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +            Path normalizedTargetPath = nullTarget ? null :                        [2m                [0m
[2;36m                    [0m         [1;35mrawTargetPath.normalize[0m[1m([0m[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         +            if [1m([0m!nullTarget && ![1;35mnormalizedTargetPath.startsWith[0m[1m([0mtargetDirPath[1m)[0m[1m)[0m [1m{[0m  [2m                [0m
[2;36m                    [0m         +                throw new [1;35mIOException[0m[1m([0m[32m"Entry is outside the target directory: "[0m +  [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.getName[0m[1m([0m[1m)[0m[1m)[0m;                                                               [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                      if [1m([0m[1;35mnextEntry.isDirectory[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                         [2m                [0m
[2;36m                    [0m         -                if [1m([0m!nullTarget && ![1;35mFiles.isDirectory[0m[1m([0mtargetPath[1m)[0m &&               [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1m([0mtargetPath[1m)[0m == null[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         -                    throw new [1;35mIOException[0m[1m([0m[32m"Failed to create directory "[0m +          [2m                [0m
[2;36m                    [0m         targetPath[1m)[0m;                                                                        [2m                [0m
[2;36m                    [0m         +                if [1m([0m!nullTarget && ![1;35mFiles.isDirectory[0m[1m([0mnormalizedTargetPath[1m)[0m &&     [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1m([0mnormalizedTargetPath[1m)[0m == null[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[32m"Failed to create directory "[0m +          [2m                [0m
[2;36m                    [0m         normalizedTargetPath[1m)[0m;                                                              [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m else [1m{[0m                                                               [2m                [0m
[2;36m                    [0m         -                final Path parent = nullTarget ? null : [1;35mtargetPath.getParent[0m[1m([0m[1m)[0m;    [2m                [0m
[2;36m                    [0m         +                final Path parent = nullTarget ? null :                            [2m                [0m
[2;36m                    [0m         [1;35mnormalizedTargetPath.getParent[0m[1m([0m[1m)[0m;                                                   [2m                [0m
[2;36m                    [0m                          if [1m([0m!nullTarget && ![1;35mFiles.isDirectory[0m[1m([0mparent[1m)[0m &&                   [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1m([0mparent[1m)[0m == null[1m)[0m [1m{[0m                                          [2m                [0m
[2;36m                    [0m                              throw new [1;35mIOException[0m[1m([0m[32m"Failed to create directory "[0m + parent[1m)[0m; [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                          if [1m([0mnullTarget[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m                              [1;35mwriter.accept[0m[1m([0mnextEntry, NullOutputStream.INSTANCE[1m)[0m;           [2m                [0m
[2;36m                    [0m                          [1m}[0m else [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         -                    try [1m([0mOutputStream outputStream =                               [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1m([0mtargetPath[1m)[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         +                    try [1m([0mOutputStream outputStream =                               [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1m([0mnormalizedTargetPath[1m)[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m                                  [1;35mwriter.accept[0m[1m([0mnextEntry, outputStream[1m)[0m;                    [2m                [0m
[2;36m                    [0m                              [1m}[0m                                                              [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3311455272931291867/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A Jazzer fuzzing run triggered a security check failure for file path traversal in  [2m                [0m
[2;36m                    [0m         the Apache Commons Compress ‚ÄúExpander‚Äù example. The fuzzer input caused the         [2m                [0m
[2;36m                    [0m         expander logic to attempt writing to a path containing ‚Äú..[35m/../[0m[95mjazzer-traversal[0m,‚Äù    [2m                [0m
[2;36m                    [0m         which was caught by the `FilePathTraversal` sanitizer, resulting in a               [2m                [0m
[2;36m                    [0m         `FuzzerSecurityIssueCritical` exception.                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue Overview                                                                    [2m                [0m
[2;36m                    [0m           The fuzzing harness invokes `[1;35mExpander.expand[0m[1m([0m[33m...[0m[1m)[0m` to decompress archive entries. [2m                [0m
[2;36m                    [0m         During one run, an archive entry‚Äôs path included upwards directory components       [2m                [0m
[2;36m                    [0m         [1m([0m`..[35m/[0m[95m..[0m`[1m)[0m, leading to an attempted write outside the intended extraction directory. [2m                [0m
[2;36m                    [0m         Jazzer‚Äôs `FilePathTraversal` sanitizer detected this and threw a                    [2m                [0m
[2;36m                    [0m         `FuzzerSecurityIssueCritical`.                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Vulnerability Type                                                                [2m                [0m
[2;36m                    [0m           This is a File Path Traversal vulnerability: user-controlled file names within an [2m                [0m
[2;36m                    [0m         archive can escape the target directory, potentially overwriting arbitrary files.   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Key Observations                                                                  [2m                [0m
[2;36m                    [0m           ‚Ä¢ The exception stack trace shows calls through `[1;35mFilePathTraversal.check[0m[1m([0m[33m...[0m[1m)[0m` ‚Üí  [2m                [0m
[2;36m                    [0m         `[1;35mcheckPath[0m[1m([0m[33m...[0m[1m)[0m` ‚Üí `[1;35mpathFirstArgHook[0m[1m([0m[33m...[0m[1m)[0m`, indicating the sanitizer is active at   [2m                [0m
[2;36m                    [0m         the point where the expander writes a file.                                         [2m                [0m
[2;36m                    [0m           ‚Ä¢ The path check failure originates from `[1;35mExpander.expand[0m[1m([0m[33m...[0m[1m)[0m` in the Apache     [2m                [0m
[2;36m                    [0m         Commons Compress examples, specifically around line [1;36m86[0m and subsequent overloaded    [2m                [0m
[2;36m                    [0m         `expand` methods [1m([0mlines [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, [1;36m460[0m[1m)[0m.                                        [2m                [0m
[2;36m                    [0m           ‚Ä¢ The harness [1m([0m`ExpanderFuzzer.fuzzerTestOneInput`[1m)[0m simply feeds the input to     [2m                [0m
[2;36m                    [0m         `[1;35mExpander.expand[0m[1m([0m[33m...[0m[1m)[0m`; it is not the root cause but serves as the entry point for  [2m                [0m
[2;36m                    [0m         discovery.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Areas for Further Investigation                                                   [2m                [0m
[2;36m                    [0m           [1;36m1[0m. `org.apache.commons.compress.archivers.examples.Expander` class, with emphasis [2m                [0m
[2;36m                    [0m         on methods at the following locations:                                              [2m                [0m
[2;36m                    [0m              ‚Äì [1;35mexpand[0m[1m([0mFile, File[1m)[0m around line [1;36m86[0m                                            [2m                [0m
[2;36m                    [0m              ‚Äì recursive expand overloads at lines [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, [1;36m460[0m                       [2m                [0m
[2;36m                    [0m           [1;36m2[0m. Interaction between entry names in the archive and the file creation logic‚Äîhow [2m                [0m
[2;36m                    [0m         entry paths are normalized and sanitized.                                           [2m                [0m
[2;36m                    [0m           [1;36m3[0m. Configuration or invocation of the `FilePathTraversal` sanitizer in the Jazzer [2m                [0m
[2;36m                    [0m         setup to understand its exact checking semantics.                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3311455272931291867/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:86[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:460[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:400[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:324[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:204[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a87e9aa6b0374484[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Archiver.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.FileVisitOption;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.EnumSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZArchiveEntry;[0m          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZOutputFile;[0m            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * Provides a high level API for creating archives.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * @since [0m[1;36m1.17[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * @since [0m[1;36m1.21[0m[39m Supports [0m[1;39m{[0m[39m@link Path[0m[1;39m}[0m[39m.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:public class Archiver [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private static class ArchiverFileVisitor<O extends ArchiveOutputStream<E>, E[0m [2m                [0m
[2;36m                    [0m         [39mextends ArchiveEntry> extends SimpleFileVisitor<Path> [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        private final O outputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        private final Path directory;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        private final LinkOption[0m[1;39m[[0m[1;39m][0m[39m linkOptions;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        private [0m[1;35mArchiverFileVisitor[0m[1;39m([0m[39mfinal O target, final Path directory, final [0m [2m                [0m
[2;36m                    [0m         [39mLinkOption[0m[33m...[0m[39m linkOptions[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            this.outputStream = target;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            this.directory = directory;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            this.linkOptions = linkOptions == null ? IOUtils.EMPTY_LINK_[0m[1;33mOPTIONS[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m: [0m[1;35mlinkOptions.clone[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        public FileVisitResult [0m[1;35mpreVisitDirectory[0m[1;39m([0m[39mfinal Path dir, final [0m          [2m                [0m
[2;36m                    [0m         [39mBasicFileAttributes attrs[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            return [0m[1;35mvisit[0m[1;39m([0m[39mdir, attrs, false[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        protected FileVisitResult [0m[1;35mvisit[0m[1;39m([0m[39mfinal Path path, final [0m                  [2m                [0m
[2;36m                    [0m         [39mBasicFileAttributes attrs, final boolean isFile[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mObjects.requireNonNull[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;35mObjects.requireNonNull[0m[1;39m([0m[39mattrs[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            final String name = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mdirectory.relativize[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[32m'\\', '[0m[35m/[0m[39m'[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                final E archiveEntry = [0m[1;35moutputStream.createArchiveEntry[0m[1;39m([0m[39mpath, [0m    [2m                [0m
[2;36m                    [0m         [39misFile || [0m[1;35mname.endsWith[0m[1;39m([0m[32m"/"[0m[1;39m)[0m[39m ? name : name + [0m[32m"/"[0m[39m, linkOptions[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;35moutputStream.putArchiveEntry[0m[1;39m([0m[39marchiveEntry[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                if [0m[1;39m([0m[39misFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Refactor this as a BiConsumer on Java [0m[1;36m8[0m[39m?[0m                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35moutputStream.write[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;35moutputStream.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return FileVisitResult.CONTINUE;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        public FileVisitResult [0m[1;35mvisitFile[0m[1;39m([0m[39mfinal Path file, final [0m                 [2m                [0m
[2;36m                    [0m         [39mBasicFileAttributes attrs[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            return [0m[1;35mvisit[0m[1;39m([0m[39mfile, attrs, true[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * No [0m[1;39m{[0m[39m@link FileVisitOption[0m[1;39m}[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    public static final EnumSet<FileVisitOption> EMPTY_FileVisitOption = [0m        [2m                [0m
[2;36m                    [0m         [1;35mEnumSet.noneOf[0m[1;39m([0m[39mFileVisitOption.class[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Constructs a new instance.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    public [0m[1;35mArchiver[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m empty[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m by recursively including all files and[0m [2m                [0m
[2;36m                    [0m         [39mdirectories in [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     * @param target    the stream to write the new archive to.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal ArchiveOutputStream<?> target, final File [0m         [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mtarget, [0m[1;35mdirectory.toPath[0m[1;39m([0m[1;39m)[0m[39m, EMPTY_FileVisitOption[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m by recursively including all files and[0m [2m                [0m
[2;36m                    [0m         [39mdirectories in [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * @param target    the stream to write the new archive to.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException if an I/O error occurs or the archive cannot be [0m     [2m                [0m
[2;36m                    [0m         [39mcreated for other reasons.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal ArchiveOutputStream<?> target, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mtarget, directory, EMPTY_FileVisitOption[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m by recursively including all files and[0m [2m                [0m
[2;36m                    [0m         [39mdirectories in [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * @param target           the stream to write the new archive to.[0m          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     * @param directory        the directory that contains the files to [0m        [2m                [0m
[2;36m                    [0m         [39marchive.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     * @param fileVisitOptions linkOptions to configure the traversal of the [0m   [2m                [0m
[2;36m                    [0m         [39msource [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:     * @param linkOptions      indicating how symbolic links are handled.[0m       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:     * @throws IOException if an I/O error occurs or the archive cannot be [0m     [2m                [0m
[2;36m                    [0m         [39mcreated for other reasons.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal ArchiveOutputStream<?> target, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mdirectory, final EnumSet<FileVisitOption> fileVisitOptions,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            final LinkOption[0m[33m...[0m[39m linkOptions[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;35mFiles.walkFileTree[0m[1;39m([0m[39mdirectory, fileVisitOptions, Integer.MAX_VALUE, new [0m [2m                [0m
[2;36m                    [0m         [39mArchiverFileVisitor<>[0m[1;39m([0m[39mtarget, directory, linkOptions[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;35mtarget.finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m by recursively including all files and[0m [2m                [0m
[2;36m                    [0m         [39mdirectories in [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * @param target    the file to write the new archive to.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal SevenZOutputFile target, final File directory[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mtarget, [0m[1;35mdirectory.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m by recursively including all files and[0m [2m                [0m
[2;36m                    [0m         [39mdirectories in [0m[1;39m{[0m[39m@code directory[0m[1;39m}[0m[39m.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     * @param target    the file to write the new archive to.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal SevenZOutputFile target, final Path directory[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[35m/[0m[35m/[0m[39m This custom SimpleFileVisitor goes away with Java [0m[1;36m8[0m[39m's BiConsumer.[0m    [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;35mFiles.walkFileTree[0m[1;39m([0m[39mdirectory, new [0m                                      [2m                [0m
[2;36m                    [0m         [39mArchiverFileVisitor<ArchiveOutputStream<ArchiveEntry>, ArchiveEntry>[0m[1;39m([0m[39mnull, [0m         [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            @Override[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            protected FileVisitResult [0m[1;35mvisit[0m[1;39m([0m[39mfinal Path path, final [0m             [2m                [0m
[2;36m                    [0m         [39mBasicFileAttributes attrs, final boolean isFile[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                [0m[1;35mObjects.requireNonNull[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mObjects.requireNonNull[0m[1;39m([0m[39mattrs[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                final String name = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mdirectory.relativize[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[32m'\\', '[0m[35m/[0m[39m'[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                    final SevenZArchiveEntry archiveEntry = [0m                    [2m                [0m
[2;36m                    [0m         [1;35mtarget.createArchiveEntry[0m[1;39m([0m[39mpath, isFile || [0m[1;35mname.endsWith[0m[1;39m([0m[32m"/"[0m[1;39m)[0m[39m ? name : name + [0m[32m"/"[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    [0m[1;35mtarget.putArchiveEntry[0m[1;39m([0m[39marchiveEntry[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                    if [0m[1;39m([0m[39misFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                        [0m[35m/[0m[35m/[0m[39m Refactor this as a BiConsumer on Java [0m[1;36m8[0m              [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                        [0m[1;35mtarget.write[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                    [0m[1;35mtarget.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                return FileVisitResult.CONTINUE;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;35mtarget.finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:     * @param format    the archive format. This uses the same format as [0m       [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:     * @param target    the file to write the new archive to.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final File target, final File [0m      [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mformat, [0m[1;35mtarget.toPath[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mdirectory.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Archiver.jav[0m[1;92ma:200[0m[39m-[0m[1;36m350[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mformat, [0m[1;35mtarget.toPath[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mdirectory.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:     * This method creates a wrapper around the target stream which is never [0m   [2m                [0m
[2;36m                    [0m         [39mclosed and thus leaks resources, please use[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     * [0m[1;39m{[0m[39m@link #[0m[1;35mcreate[0m[1;39m([0m[39mString,OutputStream,File,CloseableConsumer[0m[1;39m)[0m[1;39m}[0m[39m instead.[0m     [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:     * @param format    the archive format. This uses the same format as [0m       [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:     * @param target    the stream to write the new archive to.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:     * @deprecated this method leaks resources[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final OutputStream target, final [0m   [2m                [0m
[2;36m                    [0m         [39mFile directory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mformat, target, directory, CloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:     * This method creates a wrapper around the archive stream and the caller [0m  [2m                [0m
[2;36m                    [0m         [39mof this method is responsible for closing it - probably at the same time as[0m         [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:     * closing the stream itself. The caller is informed about the wrapper [0m     [2m                [0m
[2;36m                    [0m         [39mobject via the [0m[1;39m{[0m[39m@code[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * closeableConsumer[0m[1;39m}[0m[39m callback as soon as it is no longer needed by this [0m   [2m                [0m
[2;36m                    [0m         [39mclass.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * @param format            the archive format. This uses the same format [0m  [2m                [0m
[2;36m                    [0m         [39mas accepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @param target            the stream to write the new archive to.[0m         [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * @param directory         the directory that contains the files to [0m       [2m                [0m
[2;36m                    [0m         [39marchive.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * @param closeableConsumer is informed about the stream wrapped around the[0m [2m                [0m
[2;36m                    [0m         [39mpassed in stream[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:     * @since [0m[1;36m1.19[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final OutputStream target, final [0m   [2m                [0m
[2;36m                    [0m         [39mFile directory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            final ArchiveOutputStream<? extends ArchiveEntry> [0m                  [2m                [0m
[2;36m                    [0m         [39marchiveOutputStream = [0m                                                              [2m                [0m
[2;36m                    [0m         [1;35mArchiveStreamFactory.DEFAULT.createArchiveOutputStream[0m[1;39m([0m[39mformat, target[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:            [0m[1;35mcreate[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39marchiveOutputStream[0m[1;39m)[0m[39m, directory[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:     * @param format    the archive format. This uses the same format as [0m       [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:     * @param target    the file to write the new archive to.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final Path target, final Path [0m      [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        if [0m[1;39m([0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39mtarget, [0m        [2m                [0m
[2;36m                    [0m         [39mStandardOpenOption.WRITE, StandardOpenOption.CREATE,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:                    StandardOpenOption.TRUNCATE_EXISTING[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[39mformat, channel, directory[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        try [0m[1;39m([0m[39m@[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"resource"[0m[1;39m)[0m[39m [0m[35m/[0m[35m/[0m[39m ArchiveOutputStream wraps [0m        [2m                [0m
[2;36m                    [0m         [39mnewOutputStream result[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        ArchiveOutputStream<?> outputStream = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mArchiveStreamFactory.DEFAULT.createArchiveOutputStream[0m[1;39m([0m[39mformat, [0m                     [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:            [0m[1;35mcreate[0m[1;39m([0m[39moutputStream, directory, EMPTY_FileVisitOption[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:     * This method creates a wrapper around the target channel which is never [0m  [2m                [0m
[2;36m                    [0m         [39mclosed and thus leaks resources, please use[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:     * [0m[1;39m{[0m[39m@link #[0m[1;35mcreate[0m[1;39m([0m[39mString,SeekableByteChannel,File,CloseableConsumer[0m[1;39m)[0m[1;39m}[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39minstead.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:     * @param format    the archive format. This uses the same format as [0m       [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:     * @param target    the channel to write the new archive to.[0m                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:     * @deprecated this method leaks resources[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel target, [0m  [2m                [0m
[2;36m                    [0m         [39mfinal File directory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[1;35mcreate[0m[1;39m([0m[39mformat, target, directory, CloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:     * This method creates a wrapper around the archive channel and the caller [0m [2m                [0m
[2;36m                    [0m         [39mof this method is responsible for closing it - probably at the same time as[0m         [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:     * closing the channel itself. The caller is informed about the wrapper [0m    [2m                [0m
[2;36m                    [0m         [39mobject via the [0m[1;39m{[0m[39m@code[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:     * closeableConsumer[0m[1;39m}[0m[39m callback as soon as it is no longer needed by this [0m   [2m                [0m
[2;36m                    [0m         [39mclass.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:     * @param format            the archive format. This uses the same format [0m  [2m                [0m
[2;36m                    [0m         [39mas accepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:     * @param target            the channel to write the new archive to.[0m        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:     * @param directory         the directory that contains the files to [0m       [2m                [0m
[2;36m                    [0m         [39marchive.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:     * @param closeableConsumer is informed about the stream wrapped around the[0m [2m                [0m
[2;36m                    [0m         [39mpassed in stream[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:     * @throws ArchiveException if the archive cannot be created for other [0m     [2m                [0m
[2;36m                    [0m         [39mreasons[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:     * @since [0m[1;36m1.19[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel target, [0m  [2m                [0m
[2;36m                    [0m         [39mfinal File directory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[39mformat, [0m[1;35mc.track[0m[1;39m([0m[1;35mChannels.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.ZIP.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39mnew [0m[1;35mZipArchiveOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m, directory[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39mnew [0m[1;35mSevenZOutputFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m, directory[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                [0m[35m/[0m[35m/[0m[39m never reached as prefersSeekableByteChannel only returns [0m    [2m                [0m
[2;36m                    [0m         [39mtrue for ZIP and 7z[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:                throw new [0m[1;35mArchiveException[0m[1;39m([0m[32m"Don't know how to handle format "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mformat[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:     * Creates an archive [0m[1;39m{[0m[39m@code target[0m[1;39m}[0m[39m using the format [0m[1;39m{[0m[39m@code[0m                [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:     * format[0m[1;39m}[0m[39m by recursively including all files and directories in [0m[1;39m{[0m[39m@code [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m[1;39m}[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:     * @param format    the archive format. This uses the same format as [0m       [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:     * @param target    the channel to write the new archive to.[0m                [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:     * @param directory the directory that contains the files to archive.[0m       [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:     * @throws IOException           if an I/O error occurs[0m                     [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:     * @throws IllegalStateException if the format does not support [0m[1;39m{[0m[39m@code [0m     [2m                [0m
[2;36m                    [0m         [39mSeekableByteChannel[0m[1;39m}[0m[39m.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    public void [0m[1;35mcreate[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel target, [0m  [2m                [0m
[2;36m                    [0m         [39mfinal Path directory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:        if [0m[1;39m([0m[1;35mArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            try [0m[1;39m([0m[39mSevenZOutputFile sevenZFile = new [0m[1;35mSevenZOutputFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[39msevenZFile, directory[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.ZIP.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            try [0m[1;39m([0m[39mZipArchiveOutputStream archiveOutputStream = new [0m              [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:                [0m[1;35mcreate[0m[1;39m([0m[39marchiveOutputStream, directory, EMPTY_FileVisitOption[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[39mformat[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:64[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param targetDirectory May be null to simulate output to dev/null on [0m     [2m                [0m
[2;36m                    [0m         [39mLinux and NUL on Windows.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:70[0m[39m-[0m[1;36m75[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:70[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - The generic `expand` method in Expander computes:[0m                              [2m                [0m
[2;36m                    [0m         [39m       ```[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m       Path targetPath = [0m[1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m       ```[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     but never normalizes or bounds-checks `targetPath`.  Consequently entry names [0m [2m                [0m
[2;36m                    [0m         [39mcontaining ‚Äú..[0m[35m/[0m[39m‚Äù can produce a path outside `targetDirPath`, leading to [0m            [2m                [0m
[2;36m                    [0m         [39mpath‚Äêtraversal.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - The `FilePathTraversal` sanitizer in Jazzer flags this when [0m                   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m` is invoked on a location outside the intended [0m  [2m                [0m
[2;36m                    [0m         [39mextraction folder.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Outline:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   A. Immediately after computing `targetPath`, normalize it and verify it is still[0m [2m                [0m
[2;36m                    [0m         [39ma child of `targetDirPath`.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   B. On failure, abort expansion of that entry with an `IOException` indicating [0m   [2m                [0m
[2;36m                    [0m         [39mpath traversal.  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   C. Proceed using the normalized path for directory creation and file writing.[0m    [2m                [0m
[2;36m                    [0m         [39m   D. Preserve existing behavior for entries that resolve within `targetDirPath`.[0m   [2m                [0m
[2;36m                    [0m         [39m   E. Do not alter harness, fuzzing logic, or utility classes unrelated to [0m         [2m                [0m
[2;36m                    [0m         [39mExpander.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m1[0m[39m. In Expander.java‚Äôs `expand` method [0m[1;39m([0m[39maround line [0m[1;36m73[0m[39m in the [0m[1;36m64[0m[39m‚Äì[0m[1;36m93[0m[39m snippet[0m[1;39m)[0m[39m:[0m     [2m                [0m
[2;36m                    [0m         [39m      a. Replace:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m         ```java[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m         Path targetPath = [0m[1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      b. Insert:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m         ```java[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m         Path rawTargetPath = [0m[1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m         Path normalizedTargetPath = [0m[1;35mrawTargetPath.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39m![0m[1;35mnormalizedTargetPath.startsWith[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Entry is outside the target directory: "[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39m                                   + [0m[1;35mnextEntry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      c. Use `normalizedTargetPath` in place of `targetPath` for all subsequent [0m    [2m                [0m
[2;36m                    [0m         [39moperations [0m[1;39m([0m[39mdirectory creation, `Files.newOutputStream`, etc.[0m[1;39m)[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m2[0m[39m. Ensure that both the directory‚Äêcreation branch and the file‚Äêwriting branch [0m   [2m                [0m
[2;36m                    [0m         [39mreference `normalizedTargetPath` [0m[1;39m([0m[39mand its parent[0m[1;39m)[0m[39m consistently.[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m3[0m[39m. Retain the `nullTarget` logic [0m[1;39m([0m[39mfor dev/null cases[0m[1;39m)[0m[39m unchanged.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Normalizing and performing a prefix check against `targetDirPath` is a [0m        [2m                [0m
[2;36m                    [0m         [39mstandard safe‚Äêextraction pattern.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Throwing an `IOException` preserves the method signature and cascades error [0m   [2m                [0m
[2;36m                    [0m         [39mbehavior back to callers/harness, matching existing exception types.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - Using `normalizedTargetPath` prevents bypass by mixed path separators or [0m      [2m                [0m
[2;36m                    [0m         [39mredundant ‚Äú.[0m[35m/[0m[39m‚Äù segments.  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - This minimal change does not impact archiver logic, other examples, or unit [0m   [2m                [0m
[2;36m                    [0m         [39mtests targeting valid use cases.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Side‚ÄêEffects & Mitigation:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Legitimate entries whose names begin with ‚Äú..‚Äù will now be explicitly [0m         [2m                [0m
[2;36m                    [0m         [39mrejected. This is desirable: archives should not be able to escape extraction [0m      [2m                [0m
[2;36m                    [0m         [39mroots.  [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Consumers relying on `Expander` to silently ignore traversal entries will see [0m [2m                [0m
[2;36m                    [0m         [39mexceptions; documentation should note this stricter behavior.  [0m                     [2m                [0m
[2;36m                    [0m         [39m   - No new external dependencies or API changes are introduced.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - This strategy aligns with the ‚Äúsafe extraction‚Äù pattern in `java.util.zip` [0m    [2m                [0m
[2;36m                    [0m         [39mextraction guidelines and mirrors analogous logic in other projects‚Äô archivers [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39me.g., Apache Ant‚Äôs Zip expanders[0m[1;39m)[0m[39m.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<code_range>src/main/java/org/apache/commons/compress/archivers/examples/Expander.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:70[0m[39m-[0m[1;36m93[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=760173;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=362738;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=406102;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=583878;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpv6jz05w3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/apache-commons-compress_cc-delta-04_vul[0m [2m               [0m
[2;36m                    [0m         [35mn_6/[0m[95magent-output-1767292427.2068706[0m                                                  [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/apache-commons-compress_cc-delta-04_vuln_6.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=865231;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=153672;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m[01/02/26 03:33:48][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=690272;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=106966;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=613333;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=464565;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
