--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -753,13 +753,13 @@
 static
 int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Intent, cmsCIEXYZ* BlackPoint)
 {
+    if (Pipeline == NULL || Pipeline->Elements == NULL)
+        return 0;
+
     const char* PreMaj;
     const char* PostMaj;
     const char* PreMin, *PostMin;
-    cmsStage* mpe;
-        
-    mpe = Pipeline->Elements;
-
+    cmsStage* mpe = Pipeline->Elements;
     switch (cmsStageInputChannels(mpe)) {
     case 3:
         _cmsIOPrintf(m, "[ /CIEBasedDEF\n");
@@ -783,20 +783,17 @@
 
     _cmsIOPrintf(m, "<<\n");
 
-    if (cmsStageType(mpe) == cmsSigCurveSetElemType) {
-
+    if (mpe != NULL && cmsStageType(mpe) == cmsSigCurveSetElemType) {
         _cmsIOPrintf(m, "/DecodeDEF [ ");
         EmitNGamma(m, cmsStageOutputChannels(mpe), _cmsStageGetPtrToCurveSet(mpe));
         _cmsIOPrintf(m, "]\n");
-
-        mpe = mpe ->Next;
-    }
-
-    if (cmsStageType(mpe) == cmsSigCLutElemType) {
-
-            _cmsIOPrintf(m, "/Table ");
-            WriteCLUT(m, mpe, PreMaj, PostMaj, PreMin, PostMin, FALSE, (cmsColorSpaceSignature) 0);
-            _cmsIOPrintf(m, "]\n");
+        mpe = mpe->Next;
+    }
+
+    if (mpe != NULL && cmsStageType(mpe) == cmsSigCLutElemType) {
+        _cmsIOPrintf(m, "/Table ");
+        WriteCLUT(m, mpe, PreMaj, PostMaj, PreMin, PostMin, FALSE, (cmsColorSpaceSignature)0);
+        _cmsIOPrintf(m, "]\n");
     }
 
     EmitLab2XYZ(m);
