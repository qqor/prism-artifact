{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-delta-03_curl-007",
  "source_directory": "/home/user/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.17306080000000001,
    "prompt_tokens": 80496,
    "completion_tokens": 19208
  },
  "variant": "sound",
  "diff": "--- a/lib/alliswellprotocoll.c\n+++ b/lib/alliswellprotocoll.c\n@@ -247,15 +247,15 @@\n     case ALLISWELLPROTOCOLL_DO3:\n       if(result || !nread)\n         break;\n-      if(memcmp(response, vnormal->state3, 128) == 0) {\n+      /* Require full response before comparing */\n+      if(nread < 128) {\n+        result = CURLE_WEIRD_SERVER_REPLY;\n+      }\n+      else if(memcmp(response, vnormal->state3, 128) == 0 ||\n+              strcasecmp(\"complete\\r\\n\", response) == 0) {\n         vnstate(data, ALLISWELLPROTOCOLL_STOP);\n         Curl_pp_sendf(data, &conn->proto.vnormal.pp, \"%s\", \"OK\\r\\n\");\n-        *(unsigned int *)result = CURLE_OK;\n-      }\n-      else if(strcasecmp(\"complete\\r\\n\", response) == 0) {\n-        Curl_pp_sendf(data, &conn->proto.vnormal.pp, \"%s\", \"OK\\r\\n\");\n         result = CURLE_OK;\n-        vnstate(data, ALLISWELLPROTOCOLL_STOP);\n       }\n       else {\n         result = CURLE_WEIRD_SERVER_REPLY;\n",
  "stdout": "",
  "stderr": ""
}