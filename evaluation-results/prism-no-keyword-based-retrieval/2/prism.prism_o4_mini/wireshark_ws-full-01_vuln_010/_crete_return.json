{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-full-01_vuln_010",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.5063575,
    "prompt_tokens": 361453,
    "completion_tokens": 24718
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-netbios.c\n+++ b/epan/dissectors/packet-netbios.c\n@@ -718,16 +718,17 @@\n     proto_tree_add_item(ttree, hf_netb_trace_initiator, tvb, offset + NB_INIT_NAME, 16, ENC_ASCII | ENC_NA);\n     proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);\n \n-\t/* Convert signature field to a string */\n-\twhile ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) ) {\n+\t/* Determine the maximum number of raw signature bytes */\n+\tgint max_raw = (flag & 0x80)\n+\t                ? (NB_SIZE_HMAC / 2)\n+\t                : (NB_SIZE_TMAC / 2);\n+\t/* Convert up to max_raw bytes of the signature field to hex */\n+\tfor (i = 0; i < max_raw && tvb_offset_exists(tvb, offset + NB_SIGNATURE + i); i++) {\n \t\tbyte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);\n-\n \t\tsignature[index++] = hex_digits[byte >> 4];\n \t\tsignature[index++] = hex_digits[byte & 0x0F];\n-\n-\t\ti++;\n-\t}\n-\n+\t}\n+\t/* Null-terminate within the allocated buffer */\n \tsignature[index] = '\\0';\n \t\n \tproto_tree_add_string(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, i - 1, signature);\n",
  "stdout": "",
  "stderr": ""
}