--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1104,9 +1104,14 @@
 
 	hdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);
 	command = tvb_get_uint8( tvb, offset + NB_COMMAND);
-					/* limit command so no table overflows */
-	command = MIN(command, array_length(dissect_netb));
-
+	/* clamp command to last valid dispatch entry */
+	{
+		const guint max_cmd = array_length(dissect_netb);
+		if (max_cmd > 0) {
+			/* any out-of-range command maps to the final handler */
+			command = MIN(command, max_cmd - 1);
+		}
+	}
 		/* print command name */
 	command_name = val_to_str_ext(command, &cmd_vals_ext, "Unknown (0x%02x)");
 	switch ( command ) {
