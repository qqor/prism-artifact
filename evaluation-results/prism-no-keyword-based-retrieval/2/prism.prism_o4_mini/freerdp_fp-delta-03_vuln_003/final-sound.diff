--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -139,7 +139,8 @@
 	PROFILER_PRINT_FOOTER
 }
 
-UINT64 metadataBlock = (UINT64)&explicit_bzero;
+UINT64 metadataBufferLocal = 0;
+UINT64 metadataBlock = (UINT64)&metadataBufferLocal;
 
 static INLINE void rfx_tile_init(void* obj)
 {
@@ -676,7 +677,8 @@
 	        UINT64 blockOffset = 0;
 	        Stream_Read_UINT64(s, blockOffset);
 	        Stream_Read_UINT64(s, metadataData);
-	        metadataBlock += blockOffset;
+	        if (blockOffset != 0)
+	            return FALSE;
 	}
 	WLog_Print(context->priv->log, WLOG_DEBUG,
 	           "RFX_FRAME_BEGIN: frameIdx: %" PRIu32 " numRegions: %" PRIu16 "", frameIdx,
