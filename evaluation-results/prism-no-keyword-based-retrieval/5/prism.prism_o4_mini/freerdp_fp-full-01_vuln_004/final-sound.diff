--- a/libfreerdp/core/mcs.h
+++ b/libfreerdp/core/mcs.h
@@ -144,7 +144,7 @@
 	BOOL globalChannelJoined;
 	BOOL messageChannelJoined;
 
-	INT8 channelCount;
+	UINT8 channelCount;
 	rdpMcsChannel* channels;
 };
 

--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1854,13 +1854,19 @@
 	if (blockLength < 4)
 		return FALSE;
 
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
-
+	/* Read the on-wire unsigned channel count */
+	Stream_Read_UINT8(s, mcs->channelCount);
+
+	/* Reject values larger than our allocation */
 	if (mcs->channelCount > CHANNEL_MAX_COUNT)
 		return FALSE;
+
+	/* Ensure the buffer contains enough bytes for all channel entries */
+	{
+		size_t needed = 4 + (size_t)mcs->channelCount * 12;
+		if (blockLength < needed)
+			return FALSE;
+	}
 
 	/* channelDefArray */
 	for (UINT32 i = 0; i < mcs->channelCount; i++)
