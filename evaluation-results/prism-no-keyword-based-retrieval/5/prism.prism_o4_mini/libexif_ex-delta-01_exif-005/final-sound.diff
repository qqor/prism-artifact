--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -84,11 +84,13 @@
 
     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);
 
-    /* Sanity check the offset */
-    if (buf_size < 6 + 16 + tcount * 6 + 4) {
+    /* Sanity check the total entries size */
+    const unsigned entry_size = 12;
+    const unsigned header_offset = 6 + 16;
+    const unsigned next_ifd_size = 4;
+    if (buf_size < header_offset + tcount * entry_size + next_ifd_size) {
         exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
                  "ExifMnoteDataApple", "Short MakerNote");
-        /*printf("%s(%d)\n", __FUNCTION__, __LINE__);*/
         return;
     }
 
@@ -107,9 +109,16 @@
     }
 
     for (i = 0; i < tcount; i++) {
-        d->entries[i].tag = exif_get_short(buf + ofs, d->order);
-        d->entries[i].format = exif_get_short(buf + ofs + 2, d->order);
-        d->entries[i].components = exif_get_long(buf + ofs + 4, d->order);
+        unsigned base = ofs + i * entry_size;
+        /* per-entry bounds check */
+        if (base + entry_size > buf_size) {
+            exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
+                     "ExifMnoteDataApple", "MakerNote entry exceeds buffer");
+            break;
+        }
+        d->entries[i].tag = exif_get_short(buf + base, d->order);
+        d->entries[i].format = exif_get_short(buf + base + 2, d->order);
+        d->entries[i].components = exif_get_long(buf + base + 4, d->order);
         d->entries[i].order = d->order;
         dsize = exif_format_get_size(d->entries[i].format) * d->entries[i].components;
         if (dsize > 4) {
