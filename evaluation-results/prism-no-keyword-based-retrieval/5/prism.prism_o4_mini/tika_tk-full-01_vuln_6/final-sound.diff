--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -24,6 +24,7 @@
 
 import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
 import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
+import org.apache.commons.io.FilenameUtils;
 
 /**
  * Super simple utility class to untar a tar file
@@ -33,6 +34,7 @@
     public static void main(String[] args) throws IOException {
         Path inputFile = Paths.get(args[0]);
         Path extractDir = Paths.get(args[1]);
+        Path baseDir = extractDir.toAbsolutePath().normalize();
         try (InputStream is = Files.newInputStream(inputFile);
                 TarArchiveInputStream tais = new TarArchiveInputStream(is)) {
 
@@ -40,7 +42,19 @@
 
             while (tae != null) {
                 if (tae.isFile()) {
-                    Path target = extractDir.resolve(tae.getName()).normalize();
+                    String entryName = tae.getName().replace('\u0000', ' ');
+                    String normalizedName = FilenameUtils.normalize(entryName, true);
+                    if (normalizedName == null) {
+                        normalizedName = FilenameUtils.getName(entryName);
+                    }
+                    int prefixLength = FilenameUtils.getPrefixLength(normalizedName);
+                    if (prefixLength > 0) {
+                        normalizedName = normalizedName.substring(prefixLength);
+                    }
+                    Path target = baseDir.resolve(normalizedName).toAbsolutePath().normalize();
+                    if (!target.startsWith(baseDir)) {
+                        throw new IOException("Tar entry is outside of the target dir: " + normalizedName);
+                    }
                     if (!Files.isDirectory(target.getParent())) {
                         Files.createDirectories(target.getParent());
                     }
