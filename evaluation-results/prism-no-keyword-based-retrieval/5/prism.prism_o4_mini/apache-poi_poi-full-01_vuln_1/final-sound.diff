--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
@@ -168,6 +168,9 @@
                   if (mplen < 0) {
                      throw new IOException("Did not expect negative value: " + mplen);
                   }
+                  if (mplen > 1024 * 1024) {
+                     throw new IOException("Attribute name too large: " + mplen);
+                  }
                   byte[] mpdata = new byte[mplen];
                   if (IOUtils.readFully(inp, mpdata) < 0) {
                      throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");
