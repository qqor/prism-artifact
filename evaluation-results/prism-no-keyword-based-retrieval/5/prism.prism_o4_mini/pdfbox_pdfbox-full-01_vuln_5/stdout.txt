[2;36m[12/29/25 12:52:26][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=893745;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=110012;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp6bspir70[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766980346.9044704[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/pdfbox_pdfbox-full-01_vuln_5.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=128607;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=963908;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:53:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=312813;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=75926;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m90.59[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=758435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=603144;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=393575;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=69826;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=98250;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m90[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=196713;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=703309;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:53:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.49[0m seconds;                ]8;id=755685;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=654718;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/29/25 12:53:59][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=827234;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=488121;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=220802;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=49755;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=622828;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=678739;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=142164;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=591182;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:54:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.39[0m seconds;                ]8;id=746293;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=591741;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=845106;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=532806;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:54:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.53[0m seconds;                ]8;id=120483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=587883;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/29/25 12:54:07][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=449;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=337545;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx1710m'[0m to reproduce[1m)[0m                                               [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1m([0mType1Lexer.jav[1;92ma:507[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1m([0mType1Lexer.jav[1;92ma:232[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1m([0mType1Lexer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1m([0mType1Parser.jav[1;92ma:877[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1m([0mType1Parser.jav[1;92ma:109[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1m([0mType1Parser.jav[1;92ma:63[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1m([0mType1Font.jav[1;92ma:71[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at org.apache.pdfbox.pdmodel.font.PDType1Font.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8400.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb9400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb8c00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init[0m[1m>[0m[1m([0mPDType1Font.jav[1;92ma:227[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1m([0mPDFontFactory.jav[1;92ma:140[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1m([0mPDResources.jav[1;92ma:170[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1m([0mSetFontAndSize [2m                [0m
[2;36m                    [0m         .jav[1;92ma:72[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1m([0mPDFStreamEngine.jav [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1m([0mPDFStreamEng [2m                [0m
[2;36m                    [0m         ine.jav[1;92ma:557[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1m([0mPDFStreamEngine.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1m([0mPDFStreamEngine.jav[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1m([0mLegacyPDFStreamEngine.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1m([0mPDFTextStripper.jav[1;92ma:378[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1m([0mPDFTextStripper.jav[1;92ma:303[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1m([0mPDFTextStripper.jav[1;92ma:251[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1m([0mPDFTextStripper.jav[1;92ma:218[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1m([0mPDFExtractTextFuzzer.jav[1;92ma:41[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cb8400.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cb9400.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cb8c00.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 0d88e419df5aef8d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 12:54:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=434979;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=809913;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 12:55:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=239633;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=185311;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 12:56:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=488015;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=20713;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=506635;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=120880;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:56:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.53[0m seconds;                ]8;id=984986;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=916788;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=462676;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=258446;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmppe4cbh29[0m                                                 ]8;id=816073;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=764303;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/29/25 12:57:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m68.07[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=743483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536619;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=580742;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=43963;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:57:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m13.21[0m seconds;              ]8;id=982581;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=389732;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=216378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=229448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:57:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.15[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=244652;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=867049;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=803202;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=74950;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=352288;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=860075;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=451533;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=176767;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 12:57:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.55[0m seconds;                ]8;id=127185;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=168650;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/29/25 12:57:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=765016;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=894199;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.54[0m seconds;                ]8;id=437943;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=656569;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/29/25 12:57:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=824106;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=280499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.55[0m seconds;                ]8;id=787231;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=38607;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=180327;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=154363;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         @@ [1;36m-496[0m,[1;36m11[0m +[1;36m496[0m,[1;36m17[0m @@                                                               [2m                [0m
[2;36m                    [0m                  return null;                                                               [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static final int MAX_CHARSTRING_LENGTH = 10_000_000;                   [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m               * Reads a binary CharString.                                                  [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              private Token [1;35mreadCharString[0m[1m([0mint length[1m)[0m throws IOException                    [2m                [0m
[2;36m                    [0m              [1m{[0m                                                                              [2m                [0m
[2;36m                    [0m         +        if [1m([0mlength [1m<[0m[39m [0m[1;36m0[0m[39m || length > MAX_CHARSTRING_LENGTH[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length out of bounds: "[0m[39m + length[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         try[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                   [2m                [0m
[2;36m                    [0m         [39m+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java[0m                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-157[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m157[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[39m || size > MAX_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB segment size out of bounds: "[0m[39m + size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m             long newTotal = total + size;[0m                                          [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8400.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb9400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb8c00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA fuzzing run against the PDF text‐extraction harness [0m[1;39m([0m[39m`PDFExtractTextFuzzer`[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mtriggered a Java OutOfMemoryError during parsing of a Type [0m[1;36m1[0m[39m font within Apache [0m    [2m                [0m
[2;36m                    [0m         [39mPDFBox/FontBox. The Jazzer fuzzer classified this as a low‐severity security issue [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m“FuzzerSecurityIssueLow”[0m[1;39m)[0m[39m, reporting “Out of memory [0m[1;39m([0m[39muse ‘-Xmx1710m’ to [0m           [2m                [0m
[2;36m                    [0m         [39mreproduce[0m[1;39m)[0m[39m”. The failure occurred when the Type1Lexer attempted to allocate an [0m     [2m                [0m
[2;36m                    [0m         [39mexcessively large array, exceeding the JVM’s limits.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  • FuzzerSecurityIssueLow: OutOfMemoryError  [0m                                      [2m                [0m
[2;36m                    [0m         [39m  • Java exception indicates “Requested array size exceeds VM limit.”[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- What happened  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  • During fuzzed PDF processing, the Type1Lexer [0m[1;39m([0m[39mApache FontBox[0m[1;39m)[0m[39m invoked [0m          [2m                [0m
[2;36m                    [0m         [39m`readCharString` and attempted to create an oversized array.  [0m                      [2m                [0m
[2;36m                    [0m         [39m  • The JVM threw `java.lang.OutOfMemoryError` when the requested allocation [0m       [2m                [0m
[2;36m                    [0m         [39mexceeded configured `-Xmx` limits.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Stack-trace highlights  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m  • org.apache.fontbox.type1.Type1Lexer.readCharString [0m[1;39m([0m[39mline [0m[1;36m507[0m[1;39m)[0m[39m  [0m                 [2m                [0m
[2;36m                    [0m         [39m  • org.apache.fontbox.type1.Type1Lexer.readToken [0m[35m/[0m[39m nextToken  [0m                     [2m                [0m
[2;36m                    [0m         [39m  • org.apache.fontbox.type1.Type1Parser.parseASCII and parse  [0m                     [2m                [0m
[2;36m                    [0m         [39m  • org.apache.fontbox.type1.Type1Font.createWithPFB  [0m                              [2m                [0m
[2;36m                    [0m         [39m  • org.apache.pdfbox.pdmodel.font.PDType1Font constructor  [0m                        [2m                [0m
[2;36m                    [0m         [39m  • org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont  [0m                       [2m                [0m
[2;36m                    [0m         [39m  • org.apache.pdfbox.pdmodel.PDResources.getFont  [0m                                 [2m                [0m
[2;36m                    [0m         [39m  • org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process  [0m          [2m                [0m
[2;36m                    [0m         [39m  • PDFStreamEngine → PDFTextStripper → PDFExtractTextFuzzer.fuzzerTestOneInput[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Important observations  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m  • The crash is driven by malformed or adversarial font data leading to an [0m        [2m                [0m
[2;36m                    [0m         [39mexcessively large allocation request.  [0m                                             [2m                [0m
[2;36m                    [0m         [39m  • The fuzz harness simply drives the existing PDFBox text‐extraction logic and is[0m [2m                [0m
[2;36m                    [0m         [39mnot itself the root cause.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m  • A reproducer can be obtained by running the fuzzer with increased heap [0m[1;39m([0m[39me.g. [0m   [2m                [0m
[2;36m                    [0m         [39m`-Xmx1710m`[0m[1;39m)[0m[39m.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code areas for investigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  • Apache FontBox: Type1Lexer [0m[1;39m([0m[39m`readCharString`, `readToken`, `nextToken`[0m[1;39m)[0m[39m and [0m    [2m                [0m
[2;36m                    [0m         [39mType1Parser methods.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  • Font creation pipeline in PDFBox: Type1Font, PDType1Font, PDFontFactory, [0m       [2m                [0m
[2;36m                    [0m         [39mPDResources.  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  • PDF content‐stream processing path in PDFStreamEngine and PDFTextStripper.  [0m    [2m                [0m
[2;36m                    [0m         [39m  • Memory-allocation or bounds-checking policies around Type [0m[1;36m1[0m[39m charstring parsing.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8400.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb9400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cb8c00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:450[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:                        [0m[35m/[0m[35m/[0m[39m end of string[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m, Token.STRING[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m'[0m[32m)[0m[32m'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:                    openParens--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                case '\\':[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:                    [0m[35m/[0m[35m/[0m[39m escapes: \n \r \t \b \f \\ \[0m[1;39m([0m[39m \[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:                    char c1 = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:                    switch [0m[1;39m([0m[39mc1[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:                        case [0m[32m'n'[0m[39m:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                        case [0m[32m'r'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m; break;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                        case [0m[32m't'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m'\t'[0m[1;39m)[0m[39m; break;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                        case [0m[32m'b'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m'\b'[0m[1;39m)[0m[39m; break;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        case [0m[32m'f'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m'\f'[0m[1;39m)[0m[39m; break;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                        case [0m[32m'\\': sb.append[0m[32m([0m[32m'[0m[39m\\'[0m[1;39m)[0m[39m; break;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                        case [0m[32m'[0m[32m([0m[32m'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m[39m; break;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:                        case [0m[32m'[0m[32m)[0m[32m'[0m[39m: [0m[1;35msb.append[0m[1;39m([0m[32m'[0m[32m)[0m[32m'[0m[1;39m)[0m[39m; break;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:                        default:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:                            break;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:                    [0m[1;39m}[0m[39m   [0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:                    [0m[35m/[0m[35m/[0m[39m octal \ddd[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:                    if [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc1[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:                        String num = [0m[1;35mString.valueOf[0m[1;39m([0m[39mnew char[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[39m c1, [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                            int code = [0m[1;35mInteger.parseInt[0m[1;39m([0m[39mnum, [0m[1;36m8[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                            [0m[1;35msb.append[0m[1;39m([0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m code[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                        catch [0m[1;39m([0m[39mNumberFormatException ex[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                case [0m[32m'\r'[0m[39m:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                case [0m[32m'\n'[0m[39m:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:850[0m[39m-[0m[1;36m930[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:        Token token = [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:        switch [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:            case [0m[32m"NP"[0m[39m:[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:            case [0m[32m"|"[0m[39m:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:            case [0m[32m"noaccess"[0m[39m:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:                token = [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:            default:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"put"[0m[1;39m)[0m[1;39m)[0m[39m [0m                                     [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected NP"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:     * @return token, never null[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    private Token [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m[39m throws IOException[0m                      [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:        if [0m[1;39m([0m[39mtoken == null || [0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m != kind[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected "[0m[39m + kind[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:        return token;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:     * and does not have the given value.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    private void [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind, String name[0m[1;39m)[0m[39m throws IOException[0m          [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:        Token token = [0m[1;35mread[0m[1;39m([0m[39mkind[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[39m == null || ![0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected "[0m[39m + name[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:     * Reads the next token if and only if it is of the given kind and[0m          [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:     * has the given value.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:     * @return token or null if not the expected one[0m                            [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    private Token [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.Kind kind, String name[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mkind[0m[1;39m)[0m[39m && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:            return [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:     * Type [0m[1;36m1[0m[39m Decryption [0m[1;39m([0m[39meexec, charstring[0m[1;39m)[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:     * @param cipherBytes cipher text[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:     * @param r key[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:     * @param n number of random bytes [0m[1;39m([0m[39mlenIV[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:     * @return plain text[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mdecrypt[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m cipherBytes, int r, int n[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:        [0m[35m/[0m[35m/[0m[39m lenIV of [0m[1;36m-1[0m[39m means no encryption [0m[1;39m([0m[39mnot documented[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m-1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:            return cipherBytes;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:        [0m[35m/[0m[35m/[0m[39m empty charstrings and charstrings of insufficient length[0m             [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:        if [0m[1;39m([0m[39mcipherBytes.length == [0m[1;36m0[0m[39m || n > cipherBytes.length[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:350[0m[39m-[0m[1;36m450[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:            while [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        if [0m[1;39m([0m[39mradix != null[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:            int val;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:            try[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:                val = [0m[1;35mInteger.parseInt[0m[1;39m([0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m, [0m                          [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mradix.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:            catch [0m[1;39m([0m[39mNumberFormatException ex[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid number '"[0m[39m + sb + [0m[32m"'"[0m[39m, ex[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[1;35mInteger.toString[0m[1;39m([0m[39mval[0m[1;39m)[0m[39m, Token.INTEGER[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        return new [0m[1;35mToken[0m[1;39m([0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m, Token.REAL[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:     * Reads a sequence of regular characters, i.e. not delimiters[0m              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:     * or whitespace[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:    private String [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:        while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:            [0m[1;35mbuffer.mark[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:            char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:            if [0m[1;39m([0m[1;35mCharacter.isWhitespace[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m ||[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:                c == [0m[32m'[0m[32m([0m[32m'[0m[39m || c == [0m[32m'[0m[32m)[0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:                c == [0m[32m'<'[0m[39m || c == [0m[32m'>'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                c == [0m[32m'[0m[32m[[0m[32m'[0m[39m || c == [0m[32m'[0m[32m][0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:                c == [0m[32m'[0m[32m{[0m[32m'[0m[39m || c == [0m[32m'[0m[32m}[0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                c == [0m[32m'/'[0m[39m || c == [0m[32m'%'[0m[39m [0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:                [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:        if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:     * Reads a line comment.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    private String [0m[1;35mreadComment[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:            char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:            if [0m[1;39m([0m[39mc == [0m[32m'\r'[0m[39m || c == [0m[32m'\n'[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:     * Reads a [0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    private Token [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:            char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:            [0m[35m/[0m[35m/[0m[39m string context[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            switch [0m[1;39m([0m[39mc[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                case [0m[32m'[0m[32m([0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    openParens++;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                case [0m[32m'[0m[32m)[0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:                    if [0m[1;39m([0m[39mopenParens == [0m[1;36m0[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:                        [0m[35m/[0m[35m/[0m[39m end of string[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:200[0m[39m-[0m[1;36m350[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"NULL byte in font, skipped"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                    skip = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                    [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                    [0m[35m/[0m[35m/[0m[39m regular character: try parse as number[0m                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    Token number = [0m[1;35mtryReadNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    if [0m[1;39m([0m[39mnumber != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                        return number;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                        [0m[35m/[0m[35m/[0m[39m otherwise this must be a name[0m                        [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        String name = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:     * Reads a number or returns null.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    private Token [0m[1;35mtryReadNumber[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        [0m[1;35mbuffer.mark[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        StringBuilder radix = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        boolean hasDigit = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional + or -[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'+'[0m[39m || c == [0m[32m'-'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        while [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            hasDigit = true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional .[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'.'[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        else if [0m[1;39m([0m[39mc == [0m[32m'#'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            [0m[35m/[0m[35m/[0m[39m PostScript radix number takes the form base#number[0m               [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:            radix = sb;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:            sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        else if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m || !hasDigit[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            [0m[35m/[0m[35m/[0m[39m failure[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        else if [0m[1;39m([0m[39mc != [0m[32m'e'[0m[39m && c != [0m[32m'E'[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            [0m[35m/[0m[35m/[0m[39m integer[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m, Token.INTEGER[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[35m/[0m[35m/[0m[39m required digit[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        if [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        else if [0m[1;39m([0m[39mc != [0m[32m'e'[0m[39m && c != [0m[32m'E'[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:            [0m[35m/[0m[35m/[0m[39m failure[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        while [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional E[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'E'[0m[39m || c == [0m[32m'e'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            [0m[35m/[0m[35m/[0m[39m optional minus[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:            if [0m[1;39m([0m[39mc == [0m[32m'-'[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[35m/[0m[35m/[0m[39m required digit[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            if [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                [0m[35m/[0m[35m/[0m[39m failure[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:1[0m[39m-[0m[1;36m150[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.awt.geom.GeneralPath;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.LinkedHashMap;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.fontbox.EncodedFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.fontbox.cff.Type1CharString;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.fontbox.cff.Type1CharStringParser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.fontbox.encoding.Encoding;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.fontbox.pfb.PfbParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * Represents an Adobe Type [0m[1;36m1[0m[39m [0m[1;39m([0m[39m.pfb[0m[1;39m)[0m[39m font. Thread safe.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * @author John Hewson[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class Type1Font implements Type1CharStringReader, EncodedFont, [0m     [2m                [0m
[2;36m                    [0m         [39mFontBoxFont[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param pfbStream .pfb input stream, including headers[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @param pfbBytes .pfb data, including headers[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * Constructs a new Type1Font object from two header-less .pfb segments.[0m     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @param segment1 The first segment, without header[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * @param segment2 The second segment, without header[0m                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * @return A new Type1Font instance[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public static Type1Font [0m[1;35mcreateWithSegments[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m segment1, byte[0m[1;39m[[0m[1;39m][0m[39m segment2[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mthrows IOException[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[39msegment1, segment2[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[35m/[0m[39m font dictionary[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    String fontName = [0m[32m""[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    Encoding encoding = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    int paintType;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    int fontType;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    List<Number> fontMatrix = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    List<Number> fontBBox = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    int uniqueID;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    float strokeWidth;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    String fontID = [0m[32m""[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[35m/[0m[39m FontInfo dictionary[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    String version = [0m[32m""[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    String notice = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    String fullName = [0m[32m""[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    String familyName = [0m[32m""[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    String weight = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    float italicAngle;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    boolean isFixedPitch;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    float underlinePosition;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    float underlineThickness;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[35m/[0m[35m/[0m[39m Private dictionary[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    List<Number> blueValues = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    List<Number> otherBlues = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    List<Number> familyBlues = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    List<Number> familyOtherBlues = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    float blueScale;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    int blueShift;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    int blueFuzz;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    List<Number> stdHW = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    List<Number> stdVW = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    List<Number> stemSnapH = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    List<Number> stemSnapV = [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    boolean forceBold;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    int languageGroup;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[35m/[0m[35m/[0m[39m Subrs array, and CharStrings dictionary[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    final List<byte[0m[1;39m[[0m[1;39m][0m[39m> subrs = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    final Map<String, byte[0m[1;39m[[0m[1;39m][0m[39m> charstrings = new LinkedHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[35m/[0m[35m/[0m[39m private caches[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    private final Map<String, Type1CharString> charStringCache = new [0m           [2m                [0m
[2;36m                    [0m         [39mConcurrentHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    private Type1CharStringParser charStringParser = null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[35m/[0m[35m/[0m[39m raw data[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m segment1;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m segment2;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:     * Constructs a new Type1Font, called by Type1Parser.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[1;35mType1Font[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m segment1, byte[0m[1;39m[[0m[1;39m][0m[39m segment2[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        this.segment1 = segment1;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        this.segment2 = segment2;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * Returns the [0m[35m/[0m[95mSubrs[0m[39m array as raw bytes.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:     * @return Type [0m[1;36m1[0m[39m char string bytes[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.fontbox.pfb;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * Parser for a pfb-file.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * @author Ben Litchfield[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * @author Michael Niedermair[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[35m/[0m[39m sample [0m[1;39m([0m[39mpfb-file[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m00000000[0m[39m [0m[1;36m80[0m[39m [0m[1;36m01[0m[39m 8b [0m[1;36m15[0m[39m  [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m25[0m[39m [0m[1;36m21[0m[39m  [0m[1;36m50[0m[39m [0m[1;36m53[0m[39m 2d [0m[1;36m41[0m[39m  [0m[1;36m64[0m[39m 6f [0m[1;36m62[0m[39m [0m[1;36m65[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[35m/[0m[35m/[0m[39m          [0m[33m...[0m[33m...[0m[39m%!PS-Adobe[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @param filename  the file name[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @throws IOException if an IO-error occurs.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal String filename[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mFiles.readAllBytes[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * Parse the pfb-array.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param pfb   The pfb-Array[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException in an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m We now have ASCII and binary segments. Lets arrange these so that [0m   [2m                [0m
[2;36m                    [0m         [39mthe ASCII segments[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[35m/[0m[35m/[0m[39m come first, then the binary segments, then the last ASCII segment if[0m [2m                [0m
[2;36m                    [0m         [39mit is[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m[1;36m0000[0m[33m...[0m[39m cleartomark[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        pfbdata = new byte[0m[1;39m[[0m[39mtotal[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m cleartomarkSegment = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        int dstPos = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy the ASCII segments[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            if [0m[1;39m([0m[1;35mtypeList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m != ASCII_MARKER[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = [0m[1;35mbarrList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            if [0m[1;39m([0m[39mi == [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m && ar.length < [0m[1;36m600[0m[39m && new [0m             [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[39mar[0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"cleartomark"[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                cleartomarkSegment = ar;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mar, [0m[1;36m0[0m[39m, pfbdata, dstPos, ar.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            dstPos += ar.length;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:502[0m[39m-[0m[1;36m510[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:227[0m[39m-[0m[1;36m234[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:158[0m[39m-[0m[1;36m166[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:52[0m[39m-[0m[1;36m57[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Introduce defensive bounds checks on all untrusted length fields before [0m         [2m                [0m
[2;36m                    [0m         [39mallocating arrays:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   a. In [0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m:[0m                                     [2m                [0m
[2;36m                    [0m         [39m      - Define a new private constant MAX_CHARSTRING_LENGTH [0m[1;39m([0m[39me.g. 10_000_000[0m[1;39m)[0m[39m.[0m      [2m                [0m
[2;36m                    [0m         [39m      - As the very first step in readCharString, validate:[0m                         [2m                [0m
[2;36m                    [0m         [39m          if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > MAX_CHARSTRING_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m              throw new [0m[1;35mIOException[0m[1;39m([0m[32m"CharString length out of bounds: "[0m[39m + length[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m          [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      - Only then proceed to [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m and new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m.[0m                     [2m                [0m
[2;36m                    [0m         [39m   b. In [0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m:[0m                                                [2m                [0m
[2;36m                    [0m         [39m      - After computing the [0m[1;36m4[0m[39m-byte segment length, and before any array allocation:[0m [2m                [0m
[2;36m                    [0m         [39m          if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[39m || size > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m              throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB segment size too large: "[0m[39m + size[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m          [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      - Then compute newTotal = total + size and keep the existing cumulative check[0m [2m                [0m
[2;36m                    [0m         [39magainst MAX_LENGTH.[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Centralize the constants:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - In Type1Lexer, add:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       private static final int MAX_CHARSTRING_LENGTH = 10_000_000; [0m                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m([0m[39mchoose a value large enough for legitimate fonts but small enough to block [0m   [2m                [0m
[2;36m                    [0m         [39mabsurd input[0m[1;39m)[0m[39m.[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - In PfbParser the existing MAX_LENGTH [0m[1;39m([0m[39m100_000_000[0m[1;39m)[0m[39m governs both cumulative and[0m [2m                [0m
[2;36m                    [0m         [39mper-segment bounds.[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Rationale and preservation of logic:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - By validating lengths immediately upon parsing, we prevent maliciously large [0m  [2m                [0m
[2;36m                    [0m         [39mallocations [0m[1;39m([0m[39mthe root cause of the OutOfMemoryError[0m[1;39m)[0m[39m.[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Legitimate charstrings and PFB segments under the threshold will still be [0m     [2m                [0m
[2;36m                    [0m         [39mparsed unchanged.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Existing tests and the PDFExtractTextFuzzer harness will continue to exercise [0m [2m                [0m
[2;36m                    [0m         [39mthe same code paths; only inputs that request absurdly large allocations are [0m       [2m                [0m
[2;36m                    [0m         [39mrejected with IOException.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Potential side effects and mitigations:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Extremely large but valid charstrings or PFB segments [0m[1;39m([0m[39mabove the chosen [0m       [2m                [0m
[2;36m                    [0m         [39mthresholds[0m[1;39m)[0m[39m will now fail to parse. If real-world fonts approach these sizes, the [0m  [2m                [0m
[2;36m                    [0m         [39mthresholds can be tuned upward or made configurable via system properties.[0m          [2m                [0m
[2;36m                    [0m         [39m   - No changes to fuzz harness, test code, or utility functions. We confine [0m       [2m                [0m
[2;36m                    [0m         [39mpatches to the FontBox code where untrusted lengths are processed.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. References to similar code patterns:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - PfbParser already enforces a cumulative maximum [0m[1;39m([0m[39mMAX_LENGTH[0m[1;39m)[0m[39m for all segments;[0m [2m                [0m
[2;36m                    [0m         [39mour per-segment check parallels that pattern.[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Other parts of the code base [0m[1;39m([0m[39me.g. CFF parser[0m[1;39m)[0m[39m may have analogous guard [0m       [2m                [0m
[2;36m                    [0m         [39mclauses; consult those for threshold values when tuning MAX_CHARSTRING_LENGTH.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 12:57:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=846235;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=696810;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=81949;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=981387;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp6bspir70[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766980658.1389697[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/pdfbox_pdfbox-full-01_vuln_5.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=822058;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=67229;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=488016;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=412435;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=683317;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=294492;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
