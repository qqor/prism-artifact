{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_5",
  "source_directory": "/home/user/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.19212050000000003,
    "prompt_tokens": 115219,
    "completion_tokens": 14859
  },
  "variant": "sound",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java\n@@ -496,11 +496,17 @@\n         return null;\n     }\n \n+    private static final int MAX_CHARSTRING_LENGTH = 10_000_000;\n+\n     /**\n      * Reads a binary CharString.\n      */\n     private Token readCharString(int length) throws IOException\n     {\n+        if (length < 0 || length > MAX_CHARSTRING_LENGTH)\n+        {\n+            throw new IOException(\"CharString length out of bounds: \" + length);\n+        }\n         try\n         {\n             buffer.get(); // space\n\n--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java\n@@ -157,6 +157,10 @@\n             size += in.read() << 8;\n             size += in.read() << 16;\n             size += in.read() << 24;\n+            if (size < 0 || size > MAX_LENGTH)\n+            {\n+                throw new IOException(\"PFB segment size out of bounds: \" + size);\n+            }\n             LOG.debug(\"record type: {}, segment size: {}\", recordType, size);\n             long newTotal = total + size;\n             if (newTotal > MAX_LENGTH) {\n",
  "stdout": "",
  "stderr": ""
}