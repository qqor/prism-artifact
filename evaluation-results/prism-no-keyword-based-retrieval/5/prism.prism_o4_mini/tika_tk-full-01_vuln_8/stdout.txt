[2;36m[12/29/25 16:19:13][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=947618;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=635123;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpqp19k6dm[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_8/[0m[95magent-output-176[0m [2m               [0m
[2;36m                    [0m         [95m6992753.0123413[0m                                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-full-01_vuln_8.toml    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=575388;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=810397;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:21:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m118.55[0m ]8;id=883603;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=668710;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=846706;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=729425;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=924459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807529;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=637762;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=133736;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m118[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=641015;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536812;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:21:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.59[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=902380;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=449042;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:21:14][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=366552;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=190125;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=678548;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=889859;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=804201;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=604799;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=25491;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=472876;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:21:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m2.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=514406;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=204227;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:21:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=346772;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=46283;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.57[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=921984;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=853075;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:21:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=31992;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=161008;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 16:21:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=183158;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=438530;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 16:23:08][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=606007;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=796654;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 16:26:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=602874;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=722075;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=334917;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=491573;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:26:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.59[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=31788;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=173363;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=703097;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=543557;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpxyflg7ki[0m                                                 ]8;id=299023;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=1340;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/29/25 16:26:43][0m[2;36m [0m[1;31mERROR   [0m Failed to build the challenge                                                         ]8;id=628696;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=913900;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#53\[2m53[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_8/agent-output-176[0m ]8;id=4584;file:///home/user/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=429621;file:///home/user/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m6992753.0123413/[0m[95mbuild_failed_stdout.txt[0m: [35m/[0m[95msrc[0m [35m/src/project-parent/[0m[95mtika[0m               [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/[0m[95mtika[0m                                                             [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         [33mCC[0m=[35mclang[0m                                                                             [2m               [0m
[2;36m                    [0m         [33mCXX[0m=[35mclang[0m++                                                                          [2m               [0m
[2;36m                    [0m         [33mCFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                            [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -fno-[33msanitize[0m=[35mleak[0m      [2m               [0m
[2;36m                    [0m         [33mCXXFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                          [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -[33mstdlib[0m=[35mlibc[0m++          [2m               [0m
[2;36m                    [0m         -fno-[33msanitize[0m=[35mleak[0m                                                                   [2m               [0m
[2;36m                    [0m         [33mRUSTFLAGS[0m=--cfg fuzzing -[33mZsanitizer[0m=[35maddress[0m -[33mCdebuginfo[0m=[1;36m1[0m -Cforce-frame-pointers     [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         + [33m__REAL_MAVEN_REPO[0m=[35m/root/.m2/[0m[95mrepository[0m                                             [2m               [0m
[2;36m                    [0m         + [33m__SHARED_MAVEN_REPO[0m=[35m/work/[0m[95mmavencache[0m                                               [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -L [35m/root/.m2/[0m[95mrepository[0m [32m'[0m[32m][0m[32m'[0m                                                [2m               [0m
[2;36m                    [0m         + unset __REAL_MAVEN_REPO                                                            [2m               [0m
[2;36m                    [0m         + unset __SHARED_MAVEN_REPO                                                          [2m               [0m
[2;36m                    [0m         + [33mPROJECT[0m=[35mtika[0m                                                                       [2m               [0m
[2;36m                    [0m         + [33mMAIN_REPOSITORY[0m=[4;94mhttps[0m[4;94m://github.com/apache/tika/[0m                                    [2m               [0m
[2;36m                    [0m         + [33mMAVEN_ARGS[0m=[32m'-Djavac.src.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -Djavac.target.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -DskipTests [0m          [2m               [0m
[2;36m                    [0m         [32m-Dcheckstyle.skip -Dossindex.skip -am -pl :tika-app'[0m                                 [2m               [0m
[2;36m                    [0m         + cd [35m/src/[0m[95mproject-parent[0m                                                             [2m               [0m
[2;36m                    [0m         + set_project_version_in_fuzz_targets_dependency                                     [2m               [0m
[2;36m                    [0m         ++ cd tika                                                                           [2m               [0m
[2;36m                    [0m         ++ [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m                                             [2m               [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-help-plugin:[1;36m3.2[0m.[1;92m0:e[0mvaluate                            [2m               [0m
[2;36m                    [0m         -[33mDexpression[0m=[35mproject[0m.version -q -DforceStdout                                        [2m               [0m
[2;36m                    [0m         + [33mPROJECT_VERSION[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                                                     [2m               [0m
[2;36m                    [0m         + cd fuzz-targets                                                                    [2m               [0m
[2;36m                    [0m         + [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m versions:use-dep-version                     [2m               [0m
[2;36m                    [0m         -[33mDexcludes[0m=[35mcom[0m.code-intelligence:jazzer -[33mDdepVersion[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                  [2m               [0m
[2;36m                    [0m         -[33mDforceVersion[0m=[35mtrue[0m                                                                  [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Scanning for projects[33m...[0m                                                      [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ----------------------[1m<[0m[39m com.fuzzer:fuzz-targets >-----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building fuzz [0m[1;36m0.0[0m[39m.[0m[1;36m1[0m[39m-SNAPSHOT[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- versions:[0m[1;36m2.20[0m[39m.[0m[1;36m1[0m[39m:use-dep-version [0m[1;39m([0m[39mdefault-cli[0m[1;39m)[0m[39m @ fuzz-targets ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.tika:tika-app:jar:[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT to version [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD SUCCESS[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m0.818[0m[39m s[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2025[0m[39m-[0m[1;36m12[0m[39m-29T[0m[1;92m07:26:09[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [39m+ cd tika[0m                                                                            [2m               [0m
[2;36m                    [0m         [39m+ [0m[35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m[39m install -Djavac.src.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m [0m              [2m               [0m
[2;36m                    [0m         [39m-Djavac.target.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m -DskipTests -Dcheckstyle.skip -Dossindex.skip -am -pl [0m     [2m               [0m
[2;36m                    [0m         [39m:tika-app -Dmaven.repo.[0m[33mlocal[0m[39m=[0m[35m/out/[0m[95mm2[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for projects[0m[33m...[0m                                                      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Build Order:[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent                                                 [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core                                                [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization                                          [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules                                         [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package                    [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules                                [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module                               [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons                                           [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons                                         [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module                                  [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP                                                 [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection                                     [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes                                                  [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI                                              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------< org.apache.tika:tika-parent >---------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                        [0m[1;39m[[0m[1;36m1[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parent ---[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parent ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parent ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parent ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parent ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parent ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-parent [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parent ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parent ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-parent/[0m[95mpom.xml[0m[39m to [0m                   [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parent/4.0.0-SNAPSHOT/[0m[95mtika-parent-4.0.0-SNAPSHOT.pom[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ---------------------< org.apache.tika:tika-core >----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika core [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                          [0m[1;39m[[0m[1;36m2[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-core/[0m[95mpom.xml[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------[0m[1;39m[[0m[39m bundle [0m[1;39m][0m[39m-------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-core ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-core ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-core ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-core ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-core ---[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-core ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying appended resource: META-INF/LICENSE[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m6[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed source code.[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m362[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m      [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Some input files use unchecked or unsafe operations.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m COMPILATION WARNING : [0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/exception/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/fork/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mpackage-info.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m  [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/metadata/[0m[95mpackage-in[0m [2m               [0m
[2;36m                    [0m         [95mfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m       [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/[0m[95mpackage-info.java[0m[39m:[0m[1;39m[[0m [2m               [0m
[2;36m                    [0m         [1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated and [0m [2m               [0m
[2;36m                    [0m         [39mmarked for removal[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/external/[0m[95mpac[0m [2m               [0m
[2;36m                    [0m         [95mkage-info.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been[0m [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/[0m[95mpackage-info.ja[0m [2m               [0m
[2;36m                    [0m         [95mva[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/xpath/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/utils/[0m[95mpackage-info.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m          [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mTikaInputStream.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m342[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                         [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mDefaultDetec[0m [2m               [0m
[2;36m                    [0m         [95mtor.java[0m[39m:[0m[1;39m[[0m[1;36m97[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m org.apache.tika.detect.OverrideDetector in org.apache.tika.detect [0m  [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mProbabilisticM[0m [2m               [0m
[2;36m                    [0m         [95mimeDetectionSelector.java[0m[39m:[0m[1;39m[[0m[1;36m162[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in [0m                 [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.mime.MimeTypes has been deprecated[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mXmlRootExtra[0m [2m               [0m
[2;36m                    [0m         [95mctor.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                     [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/embedder/[0m[95mExternalEm[0m [2m               [0m
[2;36m                    [0m         [95mbedder.java[0m[39m:[0m[1;39m[[0m[1;36m428[0m[39m,[0m[1;36m72[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in org.apache.tika.io.TikaInputStream has [0m    [2m               [0m
[2;36m                    [0m         [39mbeen deprecated[0m                                                                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParserCon[0m [2m               [0m
[2;36m                    [0m         [95mtainerExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m128[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.io.TikaInputStream has been deprecated[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m32[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                       [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m21[0m[39m warnings [0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDet[0m [2m               [0m
[2;36m                    [0m         [95mector.java[0m[39m:[0m[1;39m[[0m[1;36m88[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m               [0m
[2;36m                    [0m         [39m  symbol:   variable StringUtils[0m                                                     [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.detect.ShellCodeDetector[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDet[0m [2m               [0m
[2;36m                    [0m         [95mector.java[0m[39m:[0m[1;39m[[0m[1;36m106[0m[39m,[0m[1;36m21[0m[1;39m][0m[39m variable isShell is already defined in method [0m                   [2m               [0m
[2;36m                    [0m         [1;35mdetect[0m[1;39m([0m[39mjava.io.InputStream,org.apache.tika.metadata.Metadata[0m[1;39m)[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m2[0m[39m errors [0m                                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m15.945[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m6.398[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m32.159[0m[39m s[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2025[0m[39m-[0m[1;36m12[0m[39m-29T[0m[1;92m07:26:42[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m  [2m               [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDet[0m [2m               [0m
[2;36m                    [0m         [95mector.java[0m[39m:[0m[1;39m[[0m[1;36m88[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   variable StringUtils[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.detect.ShellCodeDetector[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDet[0m [2m               [0m
[2;36m                    [0m         [95mector.java[0m[39m:[0m[1;39m[[0m[1;36m106[0m[39m,[0m[1;36m21[0m[1;39m][0m[39m variable isShell is already defined in method [0m                   [2m               [0m
[2;36m                    [0m         [1;35mdetect[0m[1;39m([0m[39mjava.io.InputStream,org.apache.tika.metadata.Metadata[0m[1;39m)[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors and possible solutions, please read [0m   [2m               [0m
[2;36m                    [0m         [39mthe following articles:[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m[39m [0m                                                                    [2m               [0m
[2;36m                    [0m         [4;94mhttp://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m After correcting the problems, you can resume the build with the command[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   mvn <args[0m[1m>[0m -rf :tika-core                                                  [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_8/agent-output-176[0m ]8;id=645378;file:///home/user/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=948603;file:///home/user/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m6992753.0123413/[0m[95mbuild_failed_stderr.txt[0m: INFO:__main__:Running: docker build -t      [2m               [0m
[2;36m                    [0m         aixcc-afc/tika:latest --file                                                         [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/projects/tika/[0m[95mDockerfile[0m         [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/projects/[0m[95mtika.[0m                   [2m               [0m
[2;36m                    [0m         #[1;36m1[0m [1m[[0minternal[1m][0m load build definition from Dockerfile                                  [2m               [0m
[2;36m                    [0m         #[1;36m1[0m transferring dockerfile: [1;36m1.[0m74kB done                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m2[0m [1m[[0minternal[1m][0m load .dockerignore                                                     [2m               [0m
[2;36m                    [0m         #[1;36m2[0m transferring context: 2B done                                                     [2m               [0m
[2;36m                    [0m         #[1;36m2[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m3[0m [1m[[0minternal[1m][0m load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m         [2m               [0m
[2;36m                    [0m         #[1;36m3[0m DONE [1;36m0.[0m2s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m4[0m [1m[[0m [1;36m1[0m/[1;36m11[0m[1m][0m FROM                                                                      [2m               [0m
[2;36m                    [0m         ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m@sh[1;92ma256:57e0[0m8d1cd9d73456deaa0e25b92754e7 [2m               [0m
[2;36m                    [0m         4c09e4407c8e82cd461d10660a0b2fd3                                                     [2m               [0m
[2;36m                    [0m         #[1;36m4[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m5[0m [1m[[0minternal[1m][0m load build context                                                     [2m               [0m
[2;36m                    [0m         #[1;36m5[0m transferring context: [1;36m1.[0m73kB done                                                 [2m               [0m
[2;36m                    [0m         #[1;36m5[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m6[0m [1m[[0m [1;36m3[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/usr/[0m[95mmy-bin[0m && mv [35m/usr/bin/[0m[95mtesseract[0m [35m/usr/my-bin/[0m[95mtesseract[0m      [2m               [0m
[2;36m                    [0m         #[1;36m6[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m7[0m [1m[[0m[1;36m10[0m/[1;36m11[0m[1m][0m COPY build.sh [35m/src/[0m                                                       [2m               [0m
[2;36m                    [0m         #[1;36m7[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m8[0m [1m[[0m [1;36m4[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/[0m[95mexif[0m && cp [35m/usr/bin/[0m[95mexiftool[0m [35m/[0m[95mexif[0m && chmod -R a+rwx [35m/[0m[95mexif[0m     [2m               [0m
[2;36m                    [0m         #[1;36m8[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m9[0m [1m[[0m [1;36m2[0m/[1;36m11[0m[1m][0m RUN set -eux     && apt-get update     && apt-get install --yes           [2m               [0m
[2;36m                    [0m         --no-install-recommends         tesseract-ocr         tesseract-ocr-eng              [2m               [0m
[2;36m                    [0m         exiftool                                                                             [2m               [0m
[2;36m                    [0m         #[1;36m9[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m10[0m [1m[[0m [1;36m7[0m/[1;36m11[0m[1m][0m COPY project-parent [35m/src/project-parent/[0m                                 [2m               [0m
[2;36m                    [0m         #[1;36m10[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m11[0m [1m[[0m [1;36m5[0m/[1;36m11[0m[1m][0m COPY pkgs/maven.zip [35m/src/[0m[95mmaven.zip[0m                                       [2m               [0m
[2;36m                    [0m         #[1;36m11[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m12[0m [1m[[0m [1;36m9[0m/[1;36m11[0m[1m][0m RUN tar -zxf [35m/src/[0m[95mtika.tar.gz[0m -C [35m/src/[0m[95mproject-parent[0m && rm               [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mtika.tar.gz[0m                                                                     [2m               [0m
[2;36m                    [0m         #[1;36m12[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m [1m[[0m [1;36m6[0m/[1;36m11[0m[1m][0m RUN unzip [35m/src/[0m[95mmaven.zip[0m -d [35m/src/[0m[95mmaven[0m && rm [35m/src/[0m[95mmaven.zip[0m              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m [1m[[0m [1;36m8[0m/[1;36m11[0m[1m][0m COPY pkgs/tika.tar.gz [35m/src/[0m[95mtika.tar.gz[0m                                   [2m               [0m
[2;36m                    [0m         #[1;36m14[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m15[0m [1m[[0m[1;36m11[0m/[1;36m11[0m[1m][0m WORKDIR [35m/src/project-parent/[0m[95mtika[0m                                         [2m               [0m
[2;36m                    [0m         #[1;36m15[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting to image                                                               [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting layers done                                                            [2m               [0m
[2;36m                    [0m         #[1;36m16[0m writing image                                                                    [2m               [0m
[2;36m                    [0m         sh[1;92ma256:5270[0m33ee8623777b6013c328ab72c9ee47f32e5560aa4a5e422555531485db34 done         [2m               [0m
[2;36m                    [0m         #[1;36m16[0m naming to docker.io/aixcc-afc/tika:latest done                                   [2m               [0m
[2;36m                    [0m         #[1;36m16[0m DONE [1;36m0.[0m0s                                                                        [2m               [0m
[2;36m                    [0m         INFO:__main__:Keeping existing build artifacts as-is [1m([0mif any[1m)[0m.                       [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m -e [33mSANITIZER[0m=[35maddress[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -e   [2m               [0m
[2;36m                    [0m         [33mPROJECT_NAME[0m=[35mtika[0m -e [33mHELPER[0m=[3;92mTrue[0m -e [33mFUZZING_LANGUAGE[0m=[35mjvm[0m -e [33mBASH_ENV[0m=[35m/work/[0m[95mbashrc0[0m   [2m               [0m
[2;36m                    [0m         -e [33mMAVEN_OPTS[0m=-Dmaven.repo.[33mlocal[0m=[35m/work/[0m[95mmavencache[0m -v                                 [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m:[35m/[0m[95mlocal-source-mount[0m:ro -v                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika/[0m:[35m/[0m[95mout[0m -v          [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m:[35m/[0m[95mwork[0m -t         [2m               [0m
[2;36m                    [0m         aixcc-afc/tika:latest [35m/bin/[0m[95mbash[0m -c [32m'pushd $SRC && rm -rf /src/project-parent/tika &&[0m [2m               [0m
[2;36m                    [0m         [32mcp -r /local-source-mount /src/project-parent/tika && popd && compile'[0m.              [2m               [0m
[2;36m                    [0m         ERROR:__main__:Building fuzzers failed.                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m41.96[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=759727;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=934779;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=10464;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=159276;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:26:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=898816;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=793310;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:26:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=319826;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536246;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:26:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.23[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=583469;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=783151;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=786049;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=367894;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-38[0m,[1;36m8[0m +[1;36m38[0m,[1;36m12[0m @@                                                                  [2m                [0m
[2;36m                    [0m          import org.apache.tika.mime.MediaType;                                             [2m                [0m
[2;36m                    [0m          import org.apache.tika.utils.FileProcessResult;                                    [2m                [0m
[2;36m                    [0m          import org.apache.tika.utils.ProcessUtils;                                         [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.StringUtils;                                          [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m         +import org.apache.tika.detect.FileCommandDetector;                                 [2m                [0m
[2;36m                    [0m         +import org.apache.tika.mime.MediaType;                                             [2m                [0m
[2;36m                    [0m         +import java.io.BufferedReader;                                                     [2m                [0m
[2;36m                    [0m         +import java.io.IOException;                                                        [2m                [0m
[2;36m                    [0m         +import java.nio.charset.StandardCharsets;                                          [2m                [0m
[2;36m                    [0m         +import java.util.Locale;                                                           [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Simple detector to determine if a shell script is no-arg shell script.          [2m                [0m
[2;36m                    [0m           *[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m         @@ [1;36m-97[0m,[1;36m11[0m +[1;36m101[0m,[1;36m30[0m @@                                                                [2m                [0m
[2;36m                    [0m                  Path tmpDir = [1;35mFiles.createTempDirectory[0m[1m([0mcwd, [32m"tika-shell-detect-"[0m[1m)[0m;        [2m                [0m
[2;36m                    [0m                  Path tmpFile = [1;35mtmpDir.resolve[0m[1m([0mfileName[1m)[0m;                                   [2m                [0m
[2;36m                    [0m                  [1;35mFiles.copy[0m[1m([0m[1;35mtis.getPath[0m[1m([0m[1m)[0m, tmpFile, StandardCopyOption.REPLACE_EXISTING[1m)[0m;   [2m                [0m
[2;36m                    [0m         -        ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mfileName[1m)[0m;                          [2m                [0m
[2;36m                    [0m         -        [1;35mpb.directory[0m[1m([0m[1;35mtmpDir.toFile[0m[1m([0m[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Safe shell script detection: use file command and fallback shebang      [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            FileProcessResult result = [1;35mProcessUtils.execute[0m[1m([0mpb, [1;36m20000[0m, [1;36m100000[0m,     [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1m)[0m;                                                                            [2m                [0m
[2;36m                    [0m         -            if [1m([0m[1;35mresult.getExitValue[0m[1m([0m[1m)[0m == [1;36m0[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +            boolean isShell = false;                                               [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Primary: [32m'file'[0m command detection                                   [2m                [0m
[2;36m                    [0m         +            if [1m([0m[1;35mFileCommandDetector.checkHasFile[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         +                FileCommandDetector fcd = new [1;35mFileCommandDetector[0m[1m([0m[1m)[0m;               [2m                [0m
[2;36m                    [0m         +                MediaType mt = [1;35mfcd.detect[0m[1m([0m[1;35mFiles.newInputStream[0m[1m([0mtmpFile[1m)[0m,           [2m                [0m
[2;36m                    [0m         metadata[1m)[0m;                                                                          [2m                [0m
[2;36m                    [0m         +                String mtString = [1;35mmt.toString[0m[1m([0m[1m)[0m[1;35m.toLowerCase[0m[1m([0mLocale.ROOT[1m)[0m;          [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35mmtString.contains[0m[1m([0m[32m"shell"[0m[1m)[0m || [1;35mmtString.contains[0m[1m([0m[32m"x-sh"[0m[1m)[0m ||     [2m                [0m
[2;36m                    [0m         [1;35mmtString.contains[0m[1m([0m[32m"script"[0m[1m)[0m[1m)[0m [1m{[0m                                                      [2m                [0m
[2;36m                    [0m         +                    isShell = true;                                                [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Fallback: shebang inspection                                        [2m                [0m
[2;36m                    [0m         +            if [1m([0m!isShell[1m)[0m [1m{[0m                                                        [2m                [0m
[2;36m                    [0m         +                try [1m([0mBufferedReader reader = [1;35mFiles.newBufferedReader[0m[1m([0mtmpFile,      [2m                [0m
[2;36m                    [0m         StandardCharsets.UTF_8[1m)[0m[1m)[0m [1m{[0m                                                          [2m                [0m
[2;36m                    [0m         +                    String firstLine = [1;35mreader.readLine[0m[1m([0m[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +                    if [1m([0mfirstLine != null && [1;35mfirstLine.startsWith[0m[1m([0m[32m"#!"[0m[1m)[0m[1m)[0m [1m{[0m         [2m                [0m
[2;36m                    [0m         +                        isShell = true;                                            [2m                [0m
[2;36m                    [0m         +                    [1m}[0m                                                              [2m                [0m
[2;36m                    [0m         +                [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                          [2m                [0m
[2;36m                    [0m         +                    [35m/[0m[35m/[0m ignore—fail closed                                          [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            if [1m([0misShell[1m)[0m [1m{[0m                                                         [2m                [0m
[2;36m                    [0m                          [1;35mmetadata.set[0m[1m([0mSHELL_NO_ARGS, true[1m)[0m;                                 [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                  [1m}[0m finally [1m{[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m COMPILATION ERROR :                                                         [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m -------------------------------------------------------------                [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m:[1m[[0m[1;36m88[0m,[1;36m13[0m[1m][0m cannot find symbol                                              [2m                [0m
[2;36m                    [0m           symbol:   variable StringUtils                                                    [2m                [0m
[2;36m                    [0m           location: class org.apache.tika.detect.ShellCodeDetector                          [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m:[1m[[0m[1;36m106[0m,[1;36m21[0m[1m][0m variable isShell is already defined in method                  [2m                [0m
[2;36m                    [0m         [1;35mdetect[0m[1m([0mjava.io.InputStream,org.apache.tika.metadata.Metadata[1m)[0m                       [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m [1;36m2[0m errors                                                                     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m -------------------------------------------------------------                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Reactor Summary for Apache Tika parent [1;36m4.0[0m.[1;36m0[0m-SNAPSHOT:                       [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                              [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika parent [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SUCCESS [1m[[0m [1;36m15.945[0m s[1m][0m     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika core [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m.. FAILURE [1m[[0m  [1;36m6.398[0m s[1m][0m     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika serialization [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m.. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika parser modules [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika standard parser modules and package [33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika standard parser modules [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika ZIP commons [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika Apple parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m.. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika audiovideo parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika text parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika html parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika XML parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika mail commons [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika XMP commons [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika image parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m.. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika OCR parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika mail parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika Microsoft parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika cad parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika code parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika crypto parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika digest commons [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika font parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika miscellaneous office format parser module SKIPPED                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika news parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika PDF parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika package parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika WARC parser module [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika handlers [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m tika-handler-boilerpipe [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika standard parser package [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika XMP [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika language detection [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika langdetect test commons [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika Optimaize langdetect [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika pipes [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika emitters [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika filesystem emitter [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika Async CLI [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Apache Tika application [33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m. SKIPPED                 [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m BUILD FAILURE                                                                [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Total time:  [1;36m32.159[0m s                                                        [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Finished at: [1;36m2025[0m-[1;36m12[0m-29T[1;92m07:26:42[0mZ                                            [2m                [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ------------------------------------------------------------------------     [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m Failed to execute goal                                                      [2m                [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-compiler-plugin:[1;36m3.14[0m.[1;92m0:c[0mompile [1m([0mdefault-compile[1m)[0m on  [2m                [0m
[2;36m                    [0m         project tika-core: Compilation failure: Compilation failure:                        [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m:[1m[[0m[1;36m88[0m,[1;36m13[0m[1m][0m cannot find symbol                                              [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m   symbol:   variable StringUtils                                            [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m   location: class org.apache.tika.detect.ShellCodeDetector                  [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m:[1m[[0m[1;36m106[0m,[1;36m21[0m[1m][0m variable isShell is already defined in method                  [2m                [0m
[2;36m                    [0m         [1;35mdetect[0m[1m([0mjava.io.InputStream,org.apache.tika.metadata.Metadata[1m)[0m                       [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m -> [1m[[0mHelp [1;36m1[0m[1m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m To see the full stack trace of the errors, re-run Maven with the -e switch. [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m Re-run Maven using the -X switch to enable full debug logging.              [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m                                                                             [2m                [0m
[2;36m                    [0m         [1m[[0mERROR[1m][0m For more information about the errors                                       [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A Jazzer security fuzzer run triggered a `FuzzerSecurityIssueCritical: OS Command   [2m                [0m
[2;36m                    [0m         Injection` during Apache Tika document processing. Attacker-controlled input        [2m                [0m
[2;36m                    [0m         reaches a `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m` call in `[1;35mProcessUtils.execute[0m[1m([0m[1m)[0m`, allowing       [2m                [0m
[2;36m                    [0m         arbitrary OS command execution. The exception was raised in the Tika parsing        [2m                [0m
[2;36m                    [0m         pipeline, specifically within the `[1;35mShellCodeDetector.detect[0m[1m([0m[1m)[0m` logic.               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue: An OS command injection vulnerability has been detected. Input supplied to [2m                [0m
[2;36m                    [0m         the fuzzer ultimately influences the arguments passed to `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m`,  [2m                [0m
[2;36m                    [0m         enabling execution of arbitrary external commands.                                  [2m                [0m
[2;36m                    [0m         - Vulnerability type: OS Command Injection                                          [2m                [0m
[2;36m                    [0m         - Key observations:                                                                 [2m                [0m
[2;36m                    [0m           - The exception originates at                                                     [2m                [0m
[2;36m                    [0m         `com.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook`.  [2m                [0m
[2;36m                    [0m           - The problematic call sequence is:                                               [2m                [0m
[2;36m                    [0m             [1;36m1[0m. `[1;35mTikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` →                               [2m                [0m
[2;36m                    [0m             [1;36m2[0m. `[1;35mTikaCLI.main[0m[1m([0m[1m)[0m` →                                                           [2m                [0m
[2;36m                    [0m             [1;36m3[0m. `[1;35mTikaCLI.process[0m[1m([0m[1m)[0m` →                                                        [2m                [0m
[2;36m                    [0m             [1;36m4[0m. `[1;35mShellCodeDetector.detect[0m[1m([0m[1m)[0m` →                                               [2m                [0m
[2;36m                    [0m             [1;36m5[0m. `[1;35mProcessUtils.execute[0m[1m([0m[33m...[0m[1m)[0m` →                                                [2m                [0m
[2;36m                    [0m             [1;36m6[0m. `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m`                                                     [2m                [0m
[2;36m                    [0m           - The harness [1m([0m`TikaAppUnpackerFuzzer`[1m)[0m simply invokes the Tika parsing logic and [2m                [0m
[2;36m                    [0m         is not itself the root cause; it serves as an entry point for fuzz-driven           [2m                [0m
[2;36m                    [0m         discovery.                                                                          [2m                [0m
[2;36m                    [0m         - Areas for investigation:                                                          [2m                [0m
[2;36m                    [0m           - ShellCodeDetector.detect: how command-line arguments are constructed from input [2m                [0m
[2;36m                    [0m           - ProcessUtils.execute: its use of `ProcessBuilder` and argument handling         [2m                [0m
[2;36m                    [0m           - CompositeDetector and upstream parser classes [1m([0mPackageParser, CompositeParser,  [2m                [0m
[2;36m                    [0m         AutoDetectParser[1m)[0m to understand the full data flow from input bytes to shell        [2m                [0m
[2;36m                    [0m         invocation                                                                          [2m                [0m
[2;36m                    [0m           - Any other Tika components that invoke external processes based on untrusted     [2m                [0m
[2;36m                    [0m         data                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         This investigation will provide a holistic view of how untrusted input is           [2m                [0m
[2;36m                    [0m         propagated into OS command execution.                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1;39m([0m[39mProcessUtils.jav[0m[1;92ma:94[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1;39m([0m[39mShellCodeDetector.jav[0m[1;92ma:103[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1;39m([0m[39mCompositeDetector.jav[0m[1;92ma:84[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.cli.TikaCLI$[0m[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mTikaCLI.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:481[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:386[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:336[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:259[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.tika.cli.TikaCLI$[0m[1;35mOutputType.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:1056[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:485[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.main[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:237[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:54[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: d7514645016ef7a8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:87[0m[39m-[0m[1;36m108[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:40[0m[39m-[0m[1;36m43[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.utils.ProcessUtils;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:87[0m[39m-[0m[1;36m95[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    public static FileProcessResult [0m[1;35mexecute[0m[1;39m([0m[39mProcessBuilder pb,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                            long timeoutMillis,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                                            int maxStdoutBuffer, int [0m            [2m                [0m
[2;36m                    [0m         [39mmaxStdErrBuffer[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        Process p = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        String id = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            p = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            id = [0m[1;35mregister[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:108[0m[39m-[0m[1;36m116[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                complete = [0m[1;35mp.waitFor[0m[1;39m([0m[39mtimeoutMillis, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                elapsed = [0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m - start;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                if [0m[1;39m([0m[39mcomplete[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                    exitValue = [0m[1;35mp.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                    [0m[1;35moutThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mp.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/FileCommandDetector.jav[0m[1;92ma:1[0m[39m-[0m[1;36m120[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.detect;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.file.StandardCopyOption.REPLACE_EXISTING;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.io.BoundedInputStream;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.ExternalProcess;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.utils.FileProcessResult;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.ProcessUtils;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * This runs the linux [0m[32m'file'[0m[39m command against a file.  If[0m                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * this is called on a TikaInputStream, it will use the underlying Path[0m          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * or spool the full file to disk and then run file against that.[0m                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * If this is run against any other type of InputStream, it will spool[0m           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * up to [0m[1;39m{[0m[39m@link #maxBytes[0m[1;39m}[0m[39m to disk and then run the detector.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * As with all detectors, mark must be supported.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * If you want to use file's mime type in the parse, e.g.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * to select the parser in AutoDetectParser, set [0m[1;39m{[0m[39m@link [0m                         [2m                [0m
[2;36m                    [0m         [39mFileCommandDetector#[0m[1;35msetUseMime[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[1;39m}[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * to true.  The default behavior is to store the value as [0m[1;39m{[0m[39m@link [0m               [2m                [0m
[2;36m                    [0m         [39mFileCommandDetector#FILE_MIME[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: * but rely on other detectors for the [0m[32m"active"[0m[39m mime used by Tika.[0m               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:public class FileCommandDetector implements Detector [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m: file has some diff mimes names for some very common mimes[0m            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[35m/[0m[95mshould[0m[39m we map file mimes to Tika mimes, e.g. text/xml -> application/xml??[0m [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public static Property FILE_MIME = [0m[1;35mProperty.externalText[0m[1;39m([0m[32m"file:mime"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Logger LOGGER = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFileCommandDetector.class[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final long DEFAULT_TIMEOUT_MS = [0m[1;36m6000[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String DEFAULT_FILE_COMMAND_PATH = [0m[32m"file"[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static boolean HAS_WARNED = false;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private Boolean hasFileCommand = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private String fileCommandPath = DEFAULT_FILE_COMMAND_PATH;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private int maxBytes = 1_000_000;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private long timeoutMs = DEFAULT_TIMEOUT_MS;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private boolean useMime = false;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static boolean [0m[1;35mcheckHasFile[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        return [0m[1;35mcheckHasFile[0m[1;39m([0m[39mDEFAULT_FILE_COMMAND_PATH[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static boolean [0m[1;35mcheckHasFile[0m[1;39m([0m[39mString fileCommandPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m commandline = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mfileCommandPath, [0m[32m"-v"[0m[1;39m}[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return [0m[1;35mExternalParser.check[0m[1;39m([0m[39mcommandline[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * @param input    document input stream, or <code>null<[0m[35m/[0m[95mcode[0m[39m>[0m               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * @param metadata input metadata for the document[0m                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * @return mime as identified by the file command or [0m                        [2m                [0m
[2;36m                    [0m         [39mapplication/octet-stream otherwise[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39mhasFileCommand == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            hasFileCommand = [0m[1;35mcheckHasFile[0m[1;39m([0m[39mthis.fileCommandPath[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39m!hasFileCommand[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            if [0m[1;39m([0m[39m!HAS_WARNED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"'file' command isn't working: '"[0m[39m + fileCommandPath [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m"'"[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                HAS_WARNED = true;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        TikaInputStream tis = [0m[1;35mTikaInputStream.cast[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        if [0m[1;39m([0m[39mtis != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[35m/[0m[35m/[0m[95mspool[0m[39m the full file to disk, if called with a TikaInputStream[0m     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[35m/[0m[35m/[0m[95mand[0m[39m there is no underlying file[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            return [0m[1;35mdetectOnPath[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, metadata[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;35minput.mark[0m[1;39m([0m[39mmaxBytes[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            Path tmpFile = [0m[1;35mtmp.createTempFile[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mFiles.copy[0m[1;39m([0m[39mnew [0m[1;35mBoundedInputStream[0m[1;39m([0m[39mmaxBytes, input[0m[1;39m)[0m[39m, tmpFile, [0m       [2m                [0m
[2;36m                    [0m         [39mREPLACE_EXISTING[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            return [0m[1;35mdetectOnPath[0m[1;39m([0m[39mtmpFile, metadata[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            [0m[1;35minput.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private MediaType [0m[1;35mdetectOnPath[0m[1;39m([0m[39mPath path, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:87[0m[39m-[0m[1;36m108[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:87[0m[39m-[0m[1;36m95[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    public static FileProcessResult [0m[1;35mexecute[0m[1;39m([0m[39mProcessBuilder pb,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                            long timeoutMillis,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                                            int maxStdoutBuffer, int [0m            [2m                [0m
[2;36m                    [0m         [39mmaxStdErrBuffer[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        Process p = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        String id = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            p = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            id = [0m[1;35mregister[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:108[0m[39m-[0m[1;36m116[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                complete = [0m[1;35mp.waitFor[0m[1;39m([0m[39mtimeoutMillis, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                elapsed = [0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m - start;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                if [0m[1;39m([0m[39mcomplete[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                    exitValue = [0m[1;35mp.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                    [0m[1;35moutThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mp.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/FileCommandDetector.jav[0m[1;92ma:119[0m[39m-[0m[1;36m127[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private MediaType [0m[1;35mdetectOnPath[0m[1;39m([0m[39mPath path, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m args =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39mfileCommandPath[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [32m"-b"[0m[39m, [0m[32m"--mime-type"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mpath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        ProcessBuilder builder = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mbuilder, timeoutMs, [0m    [2m                [0m
[2;36m                    [0m         [1;36m10000[0m[39m, [0m[1;36m10000[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, true[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview and Root Cause  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   The vulnerability stems from [0m[1;35mShellCodeDetector.detect[0m[1;39m([0m[1;39m)[0m[39m copying user‐supplied [0m   [2m                [0m
[2;36m                    [0m         [39m“scripts” into a temp directory and then directly executing them via  [0m              [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   because `fileName` is lightly sanitized but still attacker‐controlled. This [0m     [2m                [0m
[2;36m                    [0m         [39mallows arbitrary OS command injection.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Critical Logic to Preserve  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The detector’s goal: identify and flag shell scripts [0m[1;39m([0m[39mno‐arg scripts[0m[1;39m)[0m[39m in [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata [0m[1;39m([0m[39m`SHELL_NO_ARGS`[0m[1;39m)[0m[39m.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Preservation of the temp‐file staging and cleanup logic.  [0m                     [2m                [0m
[2;36m                    [0m         [39m   - Behavior when “file” command is unavailable [0m[1;39m([0m[39me.g., Windows[0m[1;39m)[0m[39m—a fallback [0m        [2m                [0m
[2;36m                    [0m         [39mmechanism is needed.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. High‐Level Patch Steps  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   A. Remove any direct invocation of the user’s script.  [0m                          [2m                [0m
[2;36m                    [0m         [39m   B. Replace it with a safe, trusted detection mechanism that does not execute [0m    [2m                [0m
[2;36m                    [0m         [39marbitrary code:  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m      i.   Primary path: invoke the system “file” command [0m[1;39m([0m[39mtrusted, fixed binary[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mon the temp file and parse its output for shell‐script signatures.  [0m                [2m                [0m
[2;36m                    [0m         [39m      ii.  Secondary [0m[1;39m([0m[39mfallback[0m[1;39m)[0m[39m path: read the file’s first line for a shebang [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`#!`[0m[1;39m)[0m[39m indicating a shell script.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   C. If either detection path identifies a shell script, set [0m                      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m`.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   D. Retain the existing temp‐dir creation, file copying, and cleanup sequences.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Detailed Implementation Plan  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   In tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   a. Imports and Static Flags  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m     - Add:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m         import org.apache.tika.detect.FileCommandDetector;[0m                         [2m                [0m
[2;36m                    [0m         [39m         import org.apache.tika.mime.MediaType; [0m[35m/[0m[35m/[0m[39m if needed[0m                        [2m                [0m
[2;36m                    [0m         [39m     - Add at class scope:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m         private static final boolean HAS_FILE_CMD = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mFileCommandDetector.checkHasFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Replace the vulnerable block [0m[1;39m([0m[39mlines [0m[1;36m100[0m[39m–[0m[1;36m107[0m[1;39m)[0m[39m:  [0m                               [2m                [0m
[2;36m                    [0m         [39m     ```java[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m Original unsafe code:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[33m...[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m; [0m[1;39m}[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m New safe detection:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m     boolean isShell = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;36m1[0m[1;39m)[0m[39m Primary: [0m[32m'file'[0m[39m command detection[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mHAS_FILE_CMD[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m         FileCommandDetector fcd = new [0m[1;35mFileCommandDetector[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Reuse existing metadata, but isolate the tmp file[0m                       [2m                [0m
[2;36m                    [0m         [39m         MediaType mt = [0m[1;35mfcd.detect[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtmpFile[0m[1;39m)[0m[39m, metadata[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m         String mtString = [0m[1;35mmt.toString[0m[1;39m([0m[1;39m)[0m[1;35m.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mmtString.contains[0m[1;39m([0m[32m"shell"[0m[1;39m)[0m[39m || [0m[1;35mmtString.contains[0m[1;39m([0m[32m"x-sh"[0m[1;39m)[0m[39m || [0m            [2m                [0m
[2;36m                    [0m         [1;35mmtString.contains[0m[1;39m([0m[32m"script"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m             isShell = true;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m Fallback: shebang inspection[0m                                             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39m!isShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m([0m[39mBufferedReader reader = [0m[1;35mFiles.newBufferedReader[0m[1;39m([0m[39mtmpFile, [0m             [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m             String firstLine = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mfirstLine != null && [0m[1;35mfirstLine.startsWith[0m[1;39m([0m[32m"#!"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [39m                 isShell = true;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m ignore—fail closed [0m[1;39m([0m[39mi.e., do not mark shell[0m[1;39m)[0m[39m [0m                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   c. Maintain the existing finally‐block to delete `tmpDir`.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Justification  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - By invoking only the trusted “file” binary [0m[1;39m([0m[39mvia FileCommandDetector[0m[1;39m)[0m[39m, we do [0m   [2m                [0m
[2;36m                    [0m         [39mnot execute any user‐supplied code but still leverage an OS‐based magic‐number [0m     [2m                [0m
[2;36m                    [0m         [39minspection.  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - The fallback shebang check is purely static and inspects only the first line. [0m [2m                [0m
[2;36m                    [0m         [39mNo subprocess is launched.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Existing functionality—in particular the staging of the input into a temp [0m     [2m                [0m
[2;36m                    [0m         [39mfile—is left intact. All callers downstream [0m[1;39m([0m[39mCompositeParser, TikaCLI, etc.[0m[1;39m)[0m[39m see [0m   [2m                [0m
[2;36m                    [0m         [39mthe same metadata flag.  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Tests that assert shell‐script detection will continue to pass: tests [0m         [2m                [0m
[2;36m                    [0m         [39mexpecting true when content begins with `#!` or file binary classifies as shell [0m    [2m                [0m
[2;36m                    [0m         [39mscript.  [0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Potential Side Effects & Mitigations  [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - If the system lacks “file” [0m[1;39m([0m[33mHAS_FILE_CMD[0m[39m==false[0m[1;39m)[0m[39m, detection depends on a [0m      [2m                [0m
[2;36m                    [0m         [39msimple shebang heuristic. This may under‐detect edge cases [0m[1;39m([0m[39me.g., scripts without [0m  [2m                [0m
[2;36m                    [0m         [39mshebang[0m[1;39m)[0m[39m but is far safer than executing untrusted code.  [0m                          [2m                [0m
[2;36m                    [0m         [39m   - Performance: spawning a “file” process is comparable to the original behavior [0m [2m                [0m
[2;36m                    [0m         [39min environments that had shell available, and the fallback is a cheap file read.  [0m  [2m                [0m
[2;36m                    [0m         [39m   - Cross‐platform: On Windows [0m[1;39m([0m[39mwhere “file” is unlikely[0m[1;39m)[0m[39m, the shebang fallback is[0m [2m                [0m
[2;36m                    [0m         [39mused.  [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - No changes are made to fuzz harnesses or tests; no existing tests should [0m      [2m                [0m
[2;36m                    [0m         [39mbreak.  [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - We avoid catching overly broad exceptions—only IO errors around the fallback [0m  [2m                [0m
[2;36m                    [0m         [39mare caught and silently ignored [0m[1;39m([0m[39mfail‐closed[0m[1;39m)[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Preservation of Harness and Tests  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - The patch only touches ShellCodeDetector; it does not modify any harness, [0m     [2m                [0m
[2;36m                    [0m         [39mfuzzing code, external libraries, or test code.  [0m                                   [2m                [0m
[2;36m                    [0m         [39m   - All existing Tika tests for shell detection should be run to confirm expected [0m [2m                [0m
[2;36m                    [0m         [39mbehavior; any missing test can be supplemented by adding a simple unit test for [0m    [2m                [0m
[2;36m                    [0m         [39mshebang detection [0m[1;39m([0m[39moutside the scope of this patch[0m[1;39m)[0m[39m.  [0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 16:26:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=858482;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=590609;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 16:28:17][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=890724;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=492512;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 16:29:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=373799;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=661546;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=639783;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=614653;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.54[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=172286;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=705100;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:29:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=442120;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=19009;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpyhn4kqr2[0m                                                 ]8;id=702069;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=198446;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/29/25 16:30:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m91.10[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=619024;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=231074;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=26145;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=410491;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:31:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m30.66[0m seconds;                ]8;id=125864;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=584431;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=281546;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=906559;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 16:31:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m13.35[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=246656;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=577006;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=283851;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=912624;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=473311;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=17786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=324449;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=489972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.57[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=853322;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=501997;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:31:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=59709;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=61524;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.61[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=416196;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=662441;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:31:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=872988;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=121223;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.54[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=181868;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=227059;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 16:31:27][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=703078;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=513689;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-36[0m,[1;36m9[0m +[1;36m36[0m,[1;36m9[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import org.apache.tika.metadata.Property;                                          [2m                [0m
[2;36m                    [0m          import org.apache.tika.metadata.TikaCoreProperties;                                [2m                [0m
[2;36m                    [0m          import org.apache.tika.mime.MediaType;                                             [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.FileProcessResult;                                    [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.ProcessUtils;                                         [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.StringUtils;                                          [2m                [0m
[2;36m                    [0m         +import org.apache.tika.detect.FileCommandDetector;                                 [2m                [0m
[2;36m                    [0m         +import java.io.BufferedReader;                                                     [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Simple detector to determine if a shell script is no-arg shell script.          [2m                [0m
[2;36m                    [0m         @@ [1;36m-81[0m,[1;36m7[0m +[1;36m81[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                      return MediaType.OCTET_STREAM;                                         [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  String fileName = [1;35mmetadata.get[0m[1m([0mTikaCoreProperties.RESOURCE_NAME_KEY[1m)[0m;      [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mStringUtils.isBlank[0m[1m([0mfileName[1m)[0m[1m)[0m [1m{[0m                                       [2m                [0m
[2;36m                    [0m         +        if [1m([0mfileName == null || [1;35mfileName.trim[0m[1m([0m[1m)[0m[1;35m.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                       [2m                [0m
[2;36m                    [0m                      return [1;35misShell[0m[1m([0misShell[1m)[0m;                                               [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  [35m/[0m[35m/[0m[95mnow[0m test for no-arg shell script                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-97[0m,[1;36m11[0m +[1;36m97[0m,[1;36m30[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  Path tmpDir = [1;35mFiles.createTempDirectory[0m[1m([0mcwd, [32m"tika-shell-detect-"[0m[1m)[0m;        [2m                [0m
[2;36m                    [0m                  Path tmpFile = [1;35mtmpDir.resolve[0m[1m([0mfileName[1m)[0m;                                   [2m                [0m
[2;36m                    [0m                  [1;35mFiles.copy[0m[1m([0m[1;35mtis.getPath[0m[1m([0m[1m)[0m, tmpFile, StandardCopyOption.REPLACE_EXISTING[1m)[0m;   [2m                [0m
[2;36m                    [0m         -        ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mfileName[1m)[0m;                          [2m                [0m
[2;36m                    [0m         -        [1;35mpb.directory[0m[1m([0m[1;35mtmpDir.toFile[0m[1m([0m[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Safe shell script detection: use file command and fallback shebang      [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            FileProcessResult result = [1;35mProcessUtils.execute[0m[1m([0mpb, [1;36m20000[0m, [1;36m100000[0m,     [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1m)[0m;                                                                            [2m                [0m
[2;36m                    [0m         -            if [1m([0m[1;35mresult.getExitValue[0m[1m([0m[1m)[0m == [1;36m0[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +            boolean isNoArgShell = false;                                          [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Primary: [32m'file'[0m command detection                                   [2m                [0m
[2;36m                    [0m         +            if [1m([0m[1;35mFileCommandDetector.checkHasFile[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         +                FileCommandDetector fcd = new [1;35mFileCommandDetector[0m[1m([0m[1m)[0m;               [2m                [0m
[2;36m                    [0m         +                MediaType mt = [1;35mfcd.detect[0m[1m([0m[1;35mFiles.newInputStream[0m[1m([0mtmpFile[1m)[0m,           [2m                [0m
[2;36m                    [0m         metadata[1m)[0m;                                                                          [2m                [0m
[2;36m                    [0m         +                String mtString = [1;35mmt.toString[0m[1m([0m[1m)[0m[1;35m.toLowerCase[0m[1m([0mLocale.ROOT[1m)[0m;          [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35mmtString.contains[0m[1m([0m[32m"shell"[0m[1m)[0m || [1;35mmtString.contains[0m[1m([0m[32m"x-sh"[0m[1m)[0m ||     [2m                [0m
[2;36m                    [0m         [1;35mmtString.contains[0m[1m([0m[32m"script"[0m[1m)[0m[1m)[0m [1m{[0m                                                      [2m                [0m
[2;36m                    [0m         +                    isNoArgShell = true;                                           [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Fallback: shebang inspection                                        [2m                [0m
[2;36m                    [0m         +            if [1m([0m!isNoArgShell[1m)[0m [1m{[0m                                                   [2m                [0m
[2;36m                    [0m         +                try [1m([0mBufferedReader reader = [1;35mFiles.newBufferedReader[0m[1m([0mtmpFile,      [2m                [0m
[2;36m                    [0m         StandardCharsets.UTF_8[1m)[0m[1m)[0m [1m{[0m                                                          [2m                [0m
[2;36m                    [0m         +                    String firstLine = [1;35mreader.readLine[0m[1m([0m[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +                    if [1m([0mfirstLine != null && [1;35mfirstLine.startsWith[0m[1m([0m[32m"#!"[0m[1m)[0m[1m)[0m [1m{[0m         [2m                [0m
[2;36m                    [0m         +                        isNoArgShell = true;                                       [2m                [0m
[2;36m                    [0m         +                    [1m}[0m                                                              [2m                [0m
[2;36m                    [0m         +                [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                          [2m                [0m
[2;36m                    [0m         +                    [35m/[0m[35m/[0m ignore—fail closed                                          [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            if [1m([0misNoArgShell[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m                          [1;35mmetadata.set[0m[1m([0mSHELL_NO_ARGS, true[1m)[0m;                                 [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                  [1m}[0m finally [1m{[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m         The fuzzer harness reported a critical OS Command Injection when Apache Tika’s      [2m                [0m
[2;36m                    [0m         ShellCodeDetector invoked an external process via ProcessBuilder [1m([0mthrough           [2m                [0m
[2;36m                    [0m         ProcessUtils.execute[1m)[0m. To remediate, the proposed patch removed the direct          [2m                [0m
[2;36m                    [0m         ProcessBuilder call and substituted a two-phase detection using the native `file`   [2m                [0m
[2;36m                    [0m         command [1m([0mvia `FileCommandDetector`[1m)[0m and a fallback shebang check. After applying    [2m                [0m
[2;36m                    [0m         the patch, the build failed with two compilation errors:                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1m)[0m A lingering reference to `StringUtils` that was neither imported nor defined,    [2m                [0m
[2;36m                    [0m         and                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[1m)[0m A duplicate declaration of the local variable `isShell` within the `detect`      [2m                [0m
[2;36m                    [0m         method.                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1[0m. Initial Issue                                                                    [2m                [0m
[2;36m                    [0m            - A Jazzer-based fuzzer triggered `FuzzerSecurityIssueCritical: OS Command       [2m                [0m
[2;36m                    [0m         Injection` in `[1;35mShellCodeDetector.detect[0m[1m([0m[33m...[0m[1m)[0m`.                                      [2m                [0m
[2;36m                    [0m            - The stack trace showed `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m` being invoked on a file name   [2m                [0m
[2;36m                    [0m         that originated from untrusted input, leading to remote code execution risk.        [2m                [0m
[2;36m                    [0m            - The vulnerable call path was:                                                  [2m                [0m
[2;36m                    [0m              ShellCodeDetector → [1;35mProcessUtils.execute[0m[1m([0mProcessBuilder[1m)[0m →                     [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder.start[0m[1m([0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. Patch Attempt                                                                    [2m                [0m
[2;36m                    [0m            - In `ShellCodeDetector.java`, the patch:                                        [2m                [0m
[2;36m                    [0m              • Removed the lines that built and executed a `ProcessBuilder` on the          [2m                [0m
[2;36m                    [0m         temporary file.                                                                     [2m                [0m
[2;36m                    [0m              • Added imports for `FileCommandDetector`, `BufferedReader`, `IOException`,    [2m                [0m
[2;36m                    [0m         `StandardCharsets`, and `Locale`.                                                   [2m                [0m
[2;36m                    [0m              • Introduced a boolean flag `isShell`, first set by detecting “shell” in the   [2m                [0m
[2;36m                    [0m         output of the `file` command [1m([0mif available[1m)[0m, then, if still false, by reading the   [2m                [0m
[2;36m                    [0m         first line of the file for a `#!` shebang.                                          [2m                [0m
[2;36m                    [0m              • Conditionally set the metadata key `SHELL_NO_ARGS` when `isShell == true`.   [2m                [0m
[2;36m                    [0m            - The patch left behind:                                                         [2m                [0m
[2;36m                    [0m              • A reference to `StringUtils` on line [1;36m88[0m that no longer had an import or any  [2m                [0m
[2;36m                    [0m         definition.                                                                         [2m                [0m
[2;36m                    [0m              • A second declaration of `boolean isShell` on line [1;36m106[0m, conflicting with an   [2m                [0m
[2;36m                    [0m         earlier declaration at line [1;36m101[0m.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. Patch Result [35m/[0m Compilation Log                                                   [2m                [0m
[2;36m                    [0m            - Maven compiler errors in `ShellCodeDetector.java`:                             [2m                [0m
[2;36m                    [0m              [1m[[0mERROR[1m][0m cannot find symbol: variable `StringUtils` [1m([0mlocation: class            [2m                [0m
[2;36m                    [0m         `ShellCodeDetector`[1m)[0m                                                                [2m                [0m
[2;36m                    [0m              [1m[[0mERROR[1m][0m variable `isShell` is already defined in method `[1;35mdetect[0m[1m([0m[33m...[0m[1m)[0m`          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. Further Investigation                                                            [2m                [0m
[2;36m                    [0m            - Review the full `[1;35mdetect[0m[1m([0mInputStream, Metadata[1m)[0m` method in                      [2m                [0m
[2;36m                    [0m         `ShellCodeDetector.java` to locate:                                                 [2m                [0m
[2;36m                    [0m              • Any remaining references to `StringUtils` or other removed utilities.        [2m                [0m
[2;36m                    [0m              • Both declarations of `isShell` to consolidate them into a single variable.   [2m                [0m
[2;36m                    [0m            - Verify that `FileCommandDetector` exists in the codebase, is imported          [2m                [0m
[2;36m                    [0m         correctly, and that its `[1;35mcheckHasFile[0m[1m([0m[1m)[0m` and `[1;35mdetect[0m[1m([0m[33m...[0m[1m)[0m` methods match the usage. [2m                [0m
[2;36m                    [0m            - Examine neighboring logic in `ShellCodeDetector` for any additional            [2m                [0m
[2;36m                    [0m         dependencies on `ProcessUtils` or other removed classes.                            [2m                [0m
[2;36m                    [0m            - Audit other detectors or utility classes in Tika that may follow a similar     [2m                [0m
[2;36m                    [0m         pattern for shell/script detection to ensure consistency.                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1;39m([0m[39mProcessUtils.jav[0m[1;92ma:94[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1;39m([0m[39mShellCodeDetector.jav[0m[1;92ma:103[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1;39m([0m[39mCompositeDetector.jav[0m[1;92ma:84[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.cli.TikaCLI$[0m[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mTikaCLI.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:481[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:386[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:336[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:259[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.tika.cli.TikaCLI$[0m[1;35mOutputType.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:1056[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:485[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.main[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:237[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:54[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: d7514645016ef7a8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m[39m:[0m[1;39m[[0m[1;36m88[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                              [2m                [0m
[2;36m                    [0m         [39m  symbol:   variable StringUtils[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.detect.ShellCodeDetector[0m                          [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m[39m:[0m[1;39m[[0m[1;36m106[0m[39m,[0m[1;36m21[0m[1;39m][0m[39m variable isShell is already defined in method [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdetect[0m[1;39m([0m[39mjava.io.InputStream,org.apache.tika.metadata.Metadata[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m2[0m[39m errors [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m15.945[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m6.398[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m32.159[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2025[0m[39m-[0m[1;36m12[0m[39m-29T[0m[1;92m07:26:42[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m[39m:[0m[1;39m[[0m[1;36m88[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   variable StringUtils[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.detect.ShellCodeDetector[0m                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mShellCodeDe[0m [2m                [0m
[2;36m                    [0m         [95mtector.java[0m[39m:[0m[1;39m[[0m[1;36m106[0m[39m,[0m[1;36m21[0m[1;39m][0m[39m variable isShell is already defined in method [0m                 [2m                [0m
[2;36m                    [0m         [1;35mdetect[0m[1;39m([0m[39mjava.io.InputStream,org.apache.tika.metadata.Metadata[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:1[0m[39m-[0m[1;36m43[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.detect;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.StandardCopyOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.commons.io.FileUtils;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.FileProcessResult;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.utils.ProcessUtils;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:44[0m[39m-[0m[1;36m110[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * Simple detector to determine if a shell script is no-arg shell script.[0m        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:public class ShellCodeDetector implements Detector [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public static final Property SHELL_NO_ARGS = [0m                                [2m                [0m
[2;36m                    [0m         [1;35mProperty.externalBoolean[0m[1;39m([0m[32m"sh:no_args"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final int MAX_LENGTH = [0m[1;36m64[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final MediaType SHELL_SCRIPT = [0m[1;35mMediaType.application[0m[1;39m([0m[32m"x-sh"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static final int SNIFF_LENGTH = [0m[1;36m4[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        boolean isShell = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            if [0m[1;39m([0m[1;35mname.endsWith[0m[1;39m([0m[32m".sh"[0m[1;39m)[0m[39m || [0m[1;35mname.endsWith[0m[1;39m([0m[32m".bash"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39minput == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[1;35minput.mark[0m[1;39m([0m[39mSNIFF_LENGTH[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minput, SNIFF_LENGTH[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            String firstBytes = new [0m[1;35mString[0m[1;39m([0m[39mbytes, StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            if [0m[1;39m([0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!/"[0m[1;39m)[0m[39m || [0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!\\ "[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m||[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!\t"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEOFException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;35minput.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39m! isShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return MediaType.OCTET_STREAM;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        String fileName = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        return SHELL_SCRIPT;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:111[0m[39m-[0m[1;36m119[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    private MediaType [0m[1;35misShell[0m[1;39m([0m[39mboolean isShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        if [0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            return SHELL_SCRIPT;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        return MediaType.OCTET_STREAM;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/FileCommandDetector.jav[0m[1;92ma:1[0m[39m-[0m[1;36m130[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.detect;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.file.StandardCopyOption.REPLACE_EXISTING;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.io.BoundedInputStream;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.ExternalProcess;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.utils.FileProcessResult;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.ProcessUtils;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * This runs the linux [0m[32m'file'[0m[39m command against a file.  If[0m                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * this is called on a TikaInputStream, it will use the underlying Path[0m          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * or spool the full file to disk and then run file against that.[0m                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * If this is run against any other type of InputStream, it will spool[0m           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * up to [0m[1;39m{[0m[39m@link #maxBytes[0m[1;39m}[0m[39m to disk and then run the detector.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * As with all detectors, mark must be supported.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * If you want to use file's mime type in the parse, e.g.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * to select the parser in AutoDetectParser, set [0m[1;39m{[0m[39m@link [0m                         [2m                [0m
[2;36m                    [0m         [39mFileCommandDetector#[0m[1;35msetUseMime[0m[1;39m([0m[39mboolean[0m[1;39m)[0m[1;39m}[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * to true.  The default behavior is to store the value as [0m[1;39m{[0m[39m@link [0m               [2m                [0m
[2;36m                    [0m         [39mFileCommandDetector#FILE_MIME[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: * but rely on other detectors for the [0m[32m"active"[0m[39m mime used by Tika.[0m               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:public class FileCommandDetector implements Detector [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m: file has some diff mimes names for some very common mimes[0m            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[35m/[0m[95mshould[0m[39m we map file mimes to Tika mimes, e.g. text/xml -> application/xml??[0m [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public static Property FILE_MIME = [0m[1;35mProperty.externalText[0m[1;39m([0m[32m"file:mime"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Logger LOGGER = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFileCommandDetector.class[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final long DEFAULT_TIMEOUT_MS = [0m[1;36m6000[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String DEFAULT_FILE_COMMAND_PATH = [0m[32m"file"[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static boolean HAS_WARNED = false;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private Boolean hasFileCommand = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private String fileCommandPath = DEFAULT_FILE_COMMAND_PATH;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private int maxBytes = 1_000_000;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private long timeoutMs = DEFAULT_TIMEOUT_MS;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private boolean useMime = false;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static boolean [0m[1;35mcheckHasFile[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        return [0m[1;35mcheckHasFile[0m[1;39m([0m[39mDEFAULT_FILE_COMMAND_PATH[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static boolean [0m[1;35mcheckHasFile[0m[1;39m([0m[39mString fileCommandPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m commandline = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mfileCommandPath, [0m[32m"-v"[0m[1;39m}[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return [0m[1;35mExternalParser.check[0m[1;39m([0m[39mcommandline[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * @param input    document input stream, or <code>null<[0m[35m/[0m[95mcode[0m[39m>[0m               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * @param metadata input metadata for the document[0m                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * @return mime as identified by the file command or [0m                        [2m                [0m
[2;36m                    [0m         [39mapplication/octet-stream otherwise[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39mhasFileCommand == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            hasFileCommand = [0m[1;35mcheckHasFile[0m[1;39m([0m[39mthis.fileCommandPath[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39m!hasFileCommand[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            if [0m[1;39m([0m[39m!HAS_WARNED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                [0m[1;35mLOGGER.warn[0m[1;39m([0m[32m"'file' command isn't working: '"[0m[39m + fileCommandPath [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m"'"[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                HAS_WARNED = true;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        TikaInputStream tis = [0m[1;35mTikaInputStream.cast[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        if [0m[1;39m([0m[39mtis != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[35m/[0m[35m/[0m[95mspool[0m[39m the full file to disk, if called with a TikaInputStream[0m     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[35m/[0m[35m/[0m[95mand[0m[39m there is no underlying file[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            return [0m[1;35mdetectOnPath[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, metadata[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;35minput.mark[0m[1;39m([0m[39mmaxBytes[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            Path tmpFile = [0m[1;35mtmp.createTempFile[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mFiles.copy[0m[1;39m([0m[39mnew [0m[1;35mBoundedInputStream[0m[1;39m([0m[39mmaxBytes, input[0m[1;39m)[0m[39m, tmpFile, [0m       [2m                [0m
[2;36m                    [0m         [39mREPLACE_EXISTING[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            return [0m[1;35mdetectOnPath[0m[1;39m([0m[39mtmpFile, metadata[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            [0m[1;35minput.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private MediaType [0m[1;35mdetectOnPath[0m[1;39m([0m[39mPath path, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m args =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39mfileCommandPath[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [32m"-b"[0m[39m, [0m[32m"--mime-type"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mpath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        ProcessBuilder builder = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mbuilder, timeoutMs, [0m    [2m                [0m
[2;36m                    [0m         [1;36m10000[0m[39m, [0m[1;36m10000[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, true[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/StringUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.utils;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:public class StringUtils [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     * The empty String [0m[1;39m{[0m[39m@code [0m[32m""[0m[1;39m}[0m[39m.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     * @since [0m[1;36m2.0[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    public static final String EMPTY = [0m[32m""[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * A String for a space character.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * @since [0m[1;36m3.2[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public static final String SPACE = [0m[32m" "[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    static int PAD_LIMIT = [0m[1;36m10000[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public static boolean [0m[1;35misEmpty[0m[1;39m([0m[39mfinal CharSequence cs[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        return cs == null || [0m[1;35mcs.isEmpty[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public static boolean [0m[1;35misBlank[0m[1;39m([0m[39mfinal String s[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        return s == null || [0m[1;35ms.isBlank[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * <p>Left pad a String with a specified String.<[0m[35m/[0m[95mp[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * <p>Pad to a size of [0m[1;39m{[0m[39m@code size[0m[1;39m}[0m[39m.<[0m[35m/[0m[95mp[0m[39m>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * <pre>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[39mnull, *, *[0m[1;39m)[0m[39m      = null[0m                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m""[0m[39m, [0m[1;36m3[0m[39m, [0m[32m"z"[0m[1;39m)[0m[39m      = [0m[32m"zzz"[0m                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m3[0m[39m, [0m[32m"yz"[0m[1;39m)[0m[39m  = [0m[32m"bat"[0m                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m5[0m[39m, [0m[32m"yz"[0m[1;39m)[0m[39m  = [0m[32m"yzbat"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m8[0m[39m, [0m[32m"yz"[0m[1;39m)[0m[39m  = [0m[32m"yzyzybat"[0m                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m1[0m[39m, [0m[32m"yz"[0m[1;39m)[0m[39m  = [0m[32m"bat"[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m-1[0m[39m, [0m[32m"yz"[0m[1;39m)[0m[39m = [0m[32m"bat"[0m                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m5[0m[39m, null[0m[1;39m)[0m[39m  = [0m[32m"  bat"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * [0m[1;35mStringUtils.leftPad[0m[1;39m([0m[32m"bat"[0m[39m, [0m[1;36m5[0m[39m, [0m[32m""[0m[1;39m)[0m[39m    = [0m[32m"  bat"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * @param str    the String to pad out, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param size   the size to pad to[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @param padStr the String to pad with, null or empty treated as single [0m    [2m                [0m
[2;36m                    [0m         [39mspace[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @return left padded String or original String if no padding is necessary,[0m [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * [0m[1;39m{[0m[39m@code null[0m[1;39m}[0m[39m if null String input[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public static String [0m[1;35mleftPad[0m[1;39m([0m[39mfinal String str, final int size, String [0m       [2m                [0m
[2;36m                    [0m         [39mpadStr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        if [0m[1;39m([0m[39mstr == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        if [0m[1;39m([0m[1;35misEmpty[0m[1;39m([0m[39mpadStr[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            padStr = SPACE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final int padLen = [0m[1;35mpadStr.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        final int strLen = [0m[1;35mstr.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final int pads = size - strLen;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39mpads <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return str; [0m[35m/[0m[35m/[0m[39m returns original String when possible[0m                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        if [0m[1;39m([0m[39mpadLen == [0m[1;36m1[0m[39m && pads <= PAD_LIMIT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return [0m[1;35mleftPad[0m[1;39m([0m[39mstr, size, [0m[1;35mpadStr.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[39mpads == padLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            return [0m[1;35mpadStr.concat[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpads < padLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            return [0m[1;35mpadStr.substring[0m[1;39m([0m[1;36m0[0m[39m, pads[0m[1;39m)[0m[1;35m.concat[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            final char[0m[1;39m[[0m[1;39m][0m[39m padding = new char[0m[1;39m[[0m[39mpads[0m[1;39m][0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            final char[0m[1;39m[[0m[1;39m][0m[39m padChars = [0m[1;35mpadStr.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < pads; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                padding[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = padChars[0m[1;39m[[0m[39mi % padLen[0m[1;39m][0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            return new [0m[1;35mString[0m[1;39m([0m[39mpadding[0m[1;39m)[0m[1;35m.concat[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    public static String [0m[1;35mleftPad[0m[1;39m([0m[39mfinal String str, final int size, final char [0m  [2m                [0m
[2;36m                    [0m         [39mpadChar[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        if [0m[1;39m([0m[39mstr == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        final int pads = size - [0m[1;35mstr.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        if [0m[1;39m([0m[39mpads <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            return str; [0m[35m/[0m[35m/[0m[39m returns original String when possible[0m                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        if [0m[1;39m([0m[39mpads > PAD_LIMIT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            return [0m[1;35mleftPad[0m[1;39m([0m[39mstr, size, [0m[1;35mString.valueOf[0m[1;39m([0m[39mpadChar[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        return [0m[1;35mrepeat[0m[1;39m([0m[39mpadChar, pads[0m[1;39m)[0m[1;35m.concat[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * <p>Returns padding using the specified delimiter repeated[0m                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * to a given length.<[0m[35m/[0m[95mp[0m[39m>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * <pre>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m'e'[0m[39m, [0m[1;36m0[0m[1;39m)[0m[39m  = [0m[32m""[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m'e'[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m  = [0m[32m"eee"[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m'e'[0m[39m, [0m[1;36m-2[0m[1;39m)[0m[39m = [0m[32m""[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * <p>Note: this method does not support padding with[0m                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * <a [0m                                                                      [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"http[0m[32m://www.unicode.org/glossary/#supplementary_character"[0m[39m>Unicode [0m            [2m                [0m
[2;36m                    [0m         [39mSupplementary Characters<[0m[35m/[0m[95ma[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     * as they require a pair of [0m[1;39m{[0m[39m@code char[0m[1;39m}[0m[39ms to be represented.[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * If you are needing to support full I18N of your applications[0m             [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * consider using [0m[1;39m{[0m[39m@link #[0m[1;35mrepeat[0m[1;39m([0m[39mString, int[0m[1;39m)[0m[1;39m}[0m[39m instead.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     * @param ch     character to repeat[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     * @param repeat number of times to repeat char, negative treated as zero[0m   [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:     * @return String with repeated character[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:     * @see #[0m[1;35mrepeat[0m[1;39m([0m[39mString, int[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    public static String [0m[1;35mrepeat[0m[1;39m([0m[39mfinal char ch, final int repeat[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        if [0m[1;39m([0m[39mrepeat <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            return EMPTY;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        final char[0m[1;39m[[0m[1;39m][0m[39m buf = new char[0m[1;39m[[0m[39mrepeat[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        for [0m[1;39m([0m[39mint i = repeat - [0m[1;36m1[0m[39m; i >= [0m[1;36m0[0m[39m; i--[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            buf[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = ch;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[35m/[0m[35m/[0m[39m Padding[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[35m/[0m[35m/[0m[95m-----------------------------------------------------------------------[0m   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:     * <p>Repeat a String [0m[1;39m{[0m[39m@code repeat[0m[1;39m}[0m[39m times to form a[0m                        [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:     * new String.<[0m[35m/[0m[95mp[0m[39m>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:     * <pre>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[39mnull, [0m[1;36m2[0m[1;39m)[0m[39m = null[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m""[0m[39m, [0m[1;36m0[0m[1;39m)[0m[39m   = [0m[32m""[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m""[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m   = [0m[32m""[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m"a"[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m  = [0m[32m"aaa"[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m"ab"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m = [0m[32m"abab"[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     * [0m[1;35mStringUtils.repeat[0m[1;39m([0m[32m"a"[0m[39m, [0m[1;36m-2[0m[1;39m)[0m[39m = [0m[32m""[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     * <[0m[35m/[0m[95mpre[0m[39m>[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:     * @param str    the String to repeat, may be null[0m                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:     * @param repeat number of times to repeat str, negative treated as zero[0m    [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:     * @return a new String consisting of the original String repeated,[0m         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:     * [0m[1;39m{[0m[39m@code null[0m[1;39m}[0m[39m if null String input[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    public static String [0m[1;35mrepeat[0m[1;39m([0m[39mfinal String str, final int repeat[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        [0m[35m/[0m[35m/[0m[39m Performance tuned for [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mJDK1.[0m[1;36m4[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        if [0m[1;39m([0m[39mstr == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        if [0m[1;39m([0m[39mrepeat <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            return EMPTY;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        final int inputLength = [0m[1;35mstr.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        if [0m[1;39m([0m[39mrepeat == [0m[1;36m1[0m[39m || inputLength == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            return str;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        if [0m[1;39m([0m[39minputLength == [0m[1;36m1[0m[39m && repeat <= PAD_LIMIT[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            return [0m[1;35mrepeat[0m[1;39m([0m[1;35mstr.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m, repeat[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        final int outputLength = inputLength * repeat;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        switch [0m[1;39m([0m[39minputLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            case [0m[1;36m1[0m[39m:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                return [0m[1;35mrepeat[0m[1;39m([0m[1;35mstr.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m, repeat[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            case [0m[1;36m2[0m[39m:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                final char ch0 = [0m[1;35mstr.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                final char ch1 = [0m[1;35mstr.charAt[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                final char[0m[1;39m[[0m[1;39m][0m[39m output2 = new char[0m[1;39m[[0m[39moutputLength[0m[1;39m][0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                for [0m[1;39m([0m[39mint i = repeat * [0m[1;36m2[0m[39m - [0m[1;36m2[0m[39m; i >= [0m[1;36m0[0m[39m; i--, i--[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                    output2[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = ch0;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                    output2[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m = ch1;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                return new [0m[1;35mString[0m[1;39m([0m[39moutput2[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            default:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:41[0m[39m-[0m[1;36m42[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:83[0m[39m-[0m[1;36m87[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        String fileName = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:55[0m[39m-[0m[1;36m63[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        boolean isShell = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            if [0m[1;39m([0m[1;35mname.endsWith[0m[1;39m([0m[32m".sh"[0m[1;39m)[0m[39m || [0m[1;35mname.endsWith[0m[1;39m([0m[32m".bash"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39minput == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:83[0m[39m-[0m[1;36m110[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        String fileName = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        return SHELL_SCRIPT;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/FileCommandDetector.jav[0m[1;92ma:119[0m[39m-[0m[1;36m130[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private MediaType [0m[1;35mdetectOnPath[0m[1;39m([0m[39mPath path, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m args =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39mfileCommandPath[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [32m"-b"[0m[39m, [0m[32m"--mime-type"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mpath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        ProcessBuilder builder = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mbuilder, timeoutMs, [0m    [2m                [0m
[2;36m                    [0m         [1;36m10000[0m[39m, [0m[1;36m10000[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, true[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:55[0m[39m-[0m[1;36m63[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        boolean isShell = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            if [0m[1;39m([0m[1;35mname.endsWith[0m[1;39m([0m[32m".sh"[0m[1;39m)[0m[39m || [0m[1;35mname.endsWith[0m[1;39m([0m[32m".bash"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39minput == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:41[0m[39m-[0m[1;36m43[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview of Issues and Root Causes[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Compilation Error [0m[1;36m1[0m[39m [0m[1;39m([0m[39m“cannot find symbol: StringUtils”[0m[1;39m)[0m[39m: The recent patch [0m     [2m                [0m
[2;36m                    [0m         [39mremoved the import for `org.apache.tika.utils.StringUtils` but left a call to [0m      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m`.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Compilation Error [0m[1;36m2[0m[39m [0m[1;39m([0m[39m“variable isShell is already defined”[0m[1;39m)[0m[39m: The patch [0m        [2m                [0m
[2;36m                    [0m         [39mintroduced a second local `boolean isShell` inside the no-arg detection block, [0m     [2m                [0m
[2;36m                    [0m         [39mconflicting with the existing `isShell` declared at the top of `[0m[1;35mdetect[0m[1;39m([0m[1;39m)[0m[39m`.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Preserve Critical Logic[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   – We must keep the high-level two-phase, safe no-arg shell detection introduced [0m [2m                [0m
[2;36m                    [0m         [39mby the patch:  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m     a. Invoke the native `file` command via `FileCommandDetector` when available. [0m [2m                [0m
[2;36m                    [0m         [39m     b. Fallback to a file-based shebang [0m[1;39m([0m[39m#![0m[1;39m)[0m[39m check.  [0m                              [2m                [0m
[2;36m                    [0m         [39m   – We must continue to return `SHELL_SCRIPT` for scripts, and set the metadata [0m   [2m                [0m
[2;36m                    [0m         [39m`SHELL_NO_ARGS` on successful no-arg detection.  [0m                                   [2m                [0m
[2;36m                    [0m         [39m   – We must not reintroduce the direct `ProcessBuilder` call that triggered the OS[0m [2m                [0m
[2;36m                    [0m         [39mcommand injection risk.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Fix Steps[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   A. Restore or Replace `StringUtils.isBlank` Usage[0m                                [2m                [0m
[2;36m                    [0m         [39m     - Option [0m[1;36m1[0m[39m [0m[1;39m([0m[39mminimal change[0m[1;39m)[0m[39m: Re-add the import  [0m                               [2m                [0m
[2;36m                    [0m         [39m         `import org.apache.tika.utils.StringUtils;`  [0m                              [2m                [0m
[2;36m                    [0m         [39m       so that the existing `[0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m` call compiles.  [0m        [2m                [0m
[2;36m                    [0m         [39m     - Option [0m[1;36m2[0m[39m [0m[1;39m([0m[39mremove dependency[0m[1;39m)[0m[39m: Replace  [0m                                      [2m                [0m
[2;36m                    [0m         [39m         `if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;39m)[0m[39m [0m[33m...[0m[39m`  [0m                                 [2m                [0m
[2;36m                    [0m         [39m       with a JDK check such as  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m         `if [0m[1;39m([0m[39mfileName == null || [0m[1;35mfileName.trim[0m[1;39m([0m[1;39m)[0m[1;35m.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[33m...[0m[39m`  [0m                 [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m([0m[39mno additional import required[0m[1;39m)[0m[39m.  [0m                                           [2m                [0m
[2;36m                    [0m         [39m     – We recommend Option [0m[1;36m1[0m[39m to align with existing code style and avoid [0m           [2m                [0m
[2;36m                    [0m         [39mduplicating logic.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   B. Eliminate the Duplicate `isShell` Declaration[0m                                 [2m                [0m
[2;36m                    [0m         [39m     - Rename the inner flag for no-arg detection from `boolean isShell` to [0m        [2m                [0m
[2;36m                    [0m         [39m`boolean isNoArgShell`.  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m     - Update all references inside that block to use `isNoArgShell` instead of [0m    [2m                [0m
[2;36m                    [0m         [39m`isShell`.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     - This preserves the outer `isShell` [0m[1;39m([0m[39mscript-vs-binary[0m[1;39m)[0m[39m and removes the [0m       [2m                [0m
[2;36m                    [0m         [39mcompilation conflict.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   C. Clean Up Imports[0m                                                              [2m                [0m
[2;36m                    [0m         [39m     - Ensure the following imports are present:  [0m                                  [2m                [0m
[2;36m                    [0m         [39m         import java.io.BufferedReader;  [0m                                           [2m                [0m
[2;36m                    [0m         [39m         import java.io.IOException;  [0m                                              [2m                [0m
[2;36m                    [0m         [39m         import java.nio.charset.StandardCharsets;  [0m                                [2m                [0m
[2;36m                    [0m         [39m         import java.util.Locale;  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m         import org.apache.tika.detect.FileCommandDetector;  [0m                       [2m                [0m
[2;36m                    [0m         [39m         import org.apache.tika.utils.StringUtils;  [0m                                [2m                [0m
[2;36m                    [0m         [39m     - Remove unused imports for `ProcessUtils` and `FileProcessResult` since [0m      [2m                [0m
[2;36m                    [0m         [39mdirect ProcessBuilder execution is gone.  [0m                                          [2m                [0m
[2;36m                    [0m         [39m     - Eliminate any duplicated imports [0m[1;39m([0m[39me.g., two `org.apache.tika.mime.MediaType`[0m [2m                [0m
[2;36m                    [0m         [39mlines[0m[1;39m)[0m[39m.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Revised Method Structure[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   – After copying the streamed input to `tmpFile`, replace the old ProcessBuilder [0m [2m                [0m
[2;36m                    [0m         [39mblock with:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m     try [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         boolean isNoArgShell = false;[0m                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m1[0m[39m: [0m[32m'file'[0m[39m command detection[0m                                       [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mFileCommandDetector.checkHasFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [39m             FileCommandDetector fcd = new [0m[1;35mFileCommandDetector[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m             MediaType mt = [0m[1;35mfcd.detect[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtmpFile[0m[1;39m)[0m[39m, metadata[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m             String mtString = [0m[1;35mmt.toString[0m[1;39m([0m[1;39m)[0m[1;35m.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35mmtString.contains[0m[1;39m([0m[32m"shell"[0m[1;39m)[0m[39m || [0m[1;35mmtString.contains[0m[1;39m([0m[32m"x-sh"[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m                     || [0m[1;35mmtString.contains[0m[1;39m([0m[32m"script"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m                 isNoArgShell = true;[0m                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Phase [0m[1;36m2[0m[39m: fallback shebang check[0m                                         [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39m!isNoArgShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m([0m[39mBufferedReader reader =[0m                                           [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mFiles.newBufferedReader[0m[1;39m([0m[39mtmpFile, StandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [39m                 String firstLine = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m                 if [0m[1;39m([0m[39mfirstLine != null && [0m[1;35mfirstLine.startsWith[0m[1;39m([0m[32m"#!"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [39m                     isNoArgShell = true;[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException ignored[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m                 [0m[35m/[0m[35m/[0m[39m fail closed[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39misNoArgShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     return SHELL_SCRIPT;[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Justification and Side-Effect Mitigation[0m                                         [2m                [0m
[2;36m                    [0m         [39m   – This approach directly addresses the two compile errors without undermining [0m   [2m                [0m
[2;36m                    [0m         [39mthe safe detection logic.  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   – Renaming the inner flag avoids accidental changes to the outer `isShell`, [0m     [2m                [0m
[2;36m                    [0m         [39mwhich controls whether we even reach no-arg detection.  [0m                            [2m                [0m
[2;36m                    [0m         [39m   – Restoring `StringUtils` import keeps existing code style; tests that rely on [0m  [2m                [0m
[2;36m                    [0m         [39mthis class continue to pass unchanged.  [0m                                            [2m                [0m
[2;36m                    [0m         [39m   – Removing `ProcessUtils` and `FileProcessResult` imports is safe because we no [0m [2m                [0m
[2;36m                    [0m         [39mlonger call `ProcessUtils.execute`.  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   – No changes are made to fuzzing harness code or other detectors; existing [0m      [2m                [0m
[2;36m                    [0m         [39mbehavior and API contracts remain intact.  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   – In case other detectors follow a similar pattern, ensure consistency by [0m       [2m                [0m
[2;36m                    [0m         [39mreviewing and aligning their import and flag-naming conventions.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   – Similar logic in `[0m[1;35mFileCommandDetector.detectOnPath[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` and other Tika [0m       [2m                [0m
[2;36m                    [0m         [39mdetectors that use a local `hasXyz` or `isAbc` naming pattern for fallbacks.  [0m      [2m                [0m
[2;36m                    [0m         [39m   – Original Tika `StringUtils` usage for blank checks elsewhere in the codebase. [0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=439752;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=101898;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=441172;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=154838;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpqp19k6dm[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_8/[0m[95magent-output-176[0m [2m               [0m
[2;36m                    [0m         [95m6993487.3175032[0m                                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-full-01_vuln_8.toml    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=772853;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=868356;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[12/29/25 16:31:28][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=379837;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=551068;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=423166;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=334426;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
