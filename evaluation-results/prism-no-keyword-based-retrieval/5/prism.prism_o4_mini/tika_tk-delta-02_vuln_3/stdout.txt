[2;36m[12/29/25 14:53:55][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=390087;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=558213;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpiaiqre2x[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-02_vuln_3/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66987635.8031693[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-02_vuln_3.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=372492;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383811;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 14:55:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m118.30[0m ]8;id=907082;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=804085;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=963892;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=134908;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=338586;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=771819;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=837087;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=665621;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m118[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=81505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=40934;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.61[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=800365;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=114072;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 14:55:56][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=828204;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=251946;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=236120;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=708246;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=152631;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=645577;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=457523;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=210379;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 14:55:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m2.57[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=610972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=440099;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=257370;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=438374;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 14:56:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.54[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=36175;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=546555;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 14:56:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=540386;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=670150;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazzer.com:[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init[0m[1m>[0m[1m([0mHttpClient.jav[1;92ma:246[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:351[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:373[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1m([0mHttpURLConne [2m                [0m
[2;36m                    [0m         ction.jav[1;92ma:1309[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1m([0mHttpURLConnection.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:3221[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.URLConnection.getContentType[0m[1m([0mURLConnection.jav[1;92ma:520[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.io.TikaInputStream.get[0m[1m([0mTikaInputStream.jav[1;92ma:606[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.io.TikaInputStream.get[0m[1m([0mTikaInputStream.jav[1;92ma:570[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1m([0mM3U8Parser.jav[1;92ma:170[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1m([0mM3U8Parser.jav[1;92ma:92[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1m([0mM3U8Parser.jav[1;92ma:77[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1m([0mM3U8ParserFuzzer.jav[1;92ma:64[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1m([0mM3U8ParserFuzzer.jav[1;92ma:39[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: b782adc79e9c6729                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 14:56:17][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=181655;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=164950;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 14:57:41][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=998138;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=983321;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 15:01:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=788778;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=502440;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=693987;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=482269;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=243607;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=143143;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=260507;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=94671;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmporx_h0vt[0m                                                 ]8;id=524714;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=816093;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/29/25 15:02:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m90.38[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=682159;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=997209;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=501810;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=107528;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 15:03:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m29.25[0m seconds;                ]8;id=156017;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=458298;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=18856;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=946932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 15:03:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m9.27[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=260929;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=11572;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=529406;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=83891;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=701644;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=406554;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=752641;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=628815;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 15:03:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.58[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=422829;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=203426;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 15:03:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=905072;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=846497;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 15:03:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.60[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=278972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=131379;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=138341;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=403731;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 15:03:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.61[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=547761;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910283;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=272073;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=171272;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/io/TikaInputStream.java               [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/io/TikaInputStream.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-566[0m,[1;36m6[0m +[1;36m566[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m               * @return a TikaInputStream instance                                          [2m                [0m
[2;36m                    [0m               * @throws IOException if the resource can not be accessed                     [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    [35m/[0m[35m/[0m SSRF Protection: context-based flag for allowing [1;35mHTTP[0m[1m([0mS[1m)[0m fetches            [2m                [0m
[2;36m                    [0m         +    public static final Class[1m<[0m[1;95mBoolean[0m[39m> ALLOW_REMOTE_STREAMS = Boolean.class;[0m       [2m                [0m
[2;36m                    [0m         [39m     public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [39m         return [0m[1;35mget[0m[1;39m([0m[39murl, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-583[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m585[0m[39m,[0m[1;36m27[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m      * @throws IOException if the resource can not be accessed[0m                     [2m                [0m
[2;36m                    [0m         [39m      *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+        return [0m[1;35mget[0m[1;39m([0m[39murl, metadata, new [0m[1;35morg.apache.tika.parser.ParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+     * Creates a TikaInputStream from the resource at the given URL, with [0m         [2m                [0m
[2;36m                    [0m         [39mParseContext support.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+     *[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+     * @param url      resource URL[0m                                                [2m                [0m
[2;36m                    [0m         [39m+     * @param metadata metadata instance[0m                                           [2m                [0m
[2;36m                    [0m         [39m+     * @param context  parse context carrying ALLOW_REMOTE_STREAMS flag[0m            [2m                [0m
[2;36m                    [0m         [39m+     * @return a TikaInputStream instance[0m                                          [2m                [0m
[2;36m                    [0m         [39m+     * @throws IOException if the resource cannot be accessed or SSRF protection [0m  [2m                [0m
[2;36m                    [0m         [39mtriggers[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+     *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata, [0m                 [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext context[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m SSRF Protection: block [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m fetches by default unless allowed in [0m    [2m                [0m
[2;36m                    [0m         [39mcontext[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+        String protocol = [0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[32m"http"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprotocol[0m[1;39m)[0m[39m || [0m                                  [2m                [0m
[2;36m                    [0m         [32m"https"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mprotocol[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m+            Boolean allow = [0m[1;35mcontext.get[0m[1;39m([0m[39mALLOW_REMOTE_STREAMS[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mallow == null || !allow[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Remote resource fetching disabled for SSRF [0m [2m                [0m
[2;36m                    [0m         [32mprotection: "[0m[39m + url[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Special handling for [0m[4;94mfile://[0m[39m URLs[0m                                       [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[32m"file"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audi[0m [2m                [0m
[2;36m                    [0m         [39movideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java[0m               [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audi[0m [2m                [0m
[2;36m                    [0m         [39movideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java[0m               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-167[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m167[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         EmbeddedDocumentExtractor ex = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m         Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m-            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [39m+            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata, context[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [39m                         true[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server-Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability was flagged by the Jazzer fuzzer[0m [2m                [0m
[2;36m                    [0m         [39mwhen processing an M3U8 playlist. The fuzzer-triggered exception indicates that [0m    [2m                [0m
[2;36m                    [0m         [39muntrusted data [0m[1;39m([0m[39ma URL or host derived from the test input[0m[1;39m)[0m[39m was used to open a [0m      [2m                [0m
[2;36m                    [0m         [39msocket connection, resulting in an attempted connection to jazzer.com on port [0m[1;36m80[0m[39m. [0m  [2m                [0m
[2;36m                    [0m         [39mThis behavior exposes the application to SSRF risks, where an attacker-supplied [0m    [2m                [0m
[2;36m                    [0m         [39mlink can lead to unauthorized requests to internal or external systems.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  The fuzzer run produced a [0m                                                        [2m                [0m
[2;36m                    [0m         [39mcom.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium indicating a Server-Side[0m [2m                [0m
[2;36m                    [0m         [39mRequest Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m. The stack trace shows that untrusted data ultimately drove [0m [2m                [0m
[2;36m                    [0m         [39ma java.net.Socket.connect call, allowing the application to reach out to an [0m        [2m                [0m
[2;36m                    [0m         [39marbitrary host [0m[1;39m([0m[39mjazzer.com:[0m[1;36m80[0m[1;39m)[0m[39m.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability Type  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  SSRF – the application is performing network requests based on data that can be [0m  [2m                [0m
[2;36m                    [0m         [39mcontrolled by an attacker, opening the door to internal service exposure, data [0m     [2m                [0m
[2;36m                    [0m         [39mexfiltration, or pivoting attacks.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Key Observations  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. The exception originates in the SSRF sanitizer [0m                                [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mServerSideRequestForgery.checkSsrf[0m[1;39m)[0m[39m, triggered during a Socket.connect invocation.[0m [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. The network request path flows through standard Java HTTP classes [0m[1;39m([0m[39mHttpClient,[0m [2m                [0m
[2;36m                    [0m         [39mHttpURLConnection[0m[1;39m)[0m[39m.  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Control passed from the Apache Tika M3U8Parser [0m[1;39m([0m[39mhandleLink → _parse → parse[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39minto TikaInputStream.get, which under the hood uses URLConnection to fetch remote [0m  [2m                [0m
[2;36m                    [0m         [39mresources.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. The fuzzer harness [0m[1;39m([0m[39mM3U8ParserFuzzer.fuzzerTestOneInput → parseOne[0m[1;39m)[0m[39m is the [0m    [2m                [0m
[2;36m                    [0m         [39mentry point but not the root cause; it simply feeds the parser with crafted data.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code Areas for Investigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  • org.apache.tika.parser.m3.M3U8Parser.handleLink – how links are extracted and [0m  [2m                [0m
[2;36m                    [0m         [39mpassed for fetching  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m  • org.apache.tika.io.TikaInputStream.get – how URL connections are configured and[0m [2m                [0m
[2;36m                    [0m         [39minvoked  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  • Use of java.net.HttpURLConnection [0m[35m/[0m[39m Socket in the codebase, especially without [0m [2m                [0m
[2;36m                    [0m         [39mhostname/IP validation  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m  • ServerSideRequestForgery sanitizer integration points to understand which [0m      [2m                [0m
[2;36m                    [0m         [39mrequests bypass or trigger the check  [0m                                              [2m                [0m
[2;36m                    [0m         [39m  • M3U8ParserFuzzer harness to review how untrusted input is structured and fed [0m   [2m                [0m
[2;36m                    [0m         [39minto the parser[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInvestigating these components will provide a holistic view of how untrusted data [0m  [2m                [0m
[2;36m                    [0m         [39mflows to network APIs and where additional validation or controls may be needed.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.m3;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.text.DecimalFormat;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.text.NumberFormat;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.metadata.XMPDM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * Basic parser for m3u8 files[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public class M3U8Parser implements Parser [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public static final String M3U8_PREFIX = [0m[32m"m3u8:"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static final Property PLAY_LIST_LINK = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalTextBag[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"link"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public static final Property M3U8_VERSION = [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalInteger[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"version"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static final Property PLAY_LIST_TYPE = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalText[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"type"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private static final Set<MediaType> SUPPORTED = [0m[1;35mSet.of[0m[1;39m([0m                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            [0m[1;35mMediaType.application[0m[1;39m([0m[32m"vnd.apple.mpegurl"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final String TAR[0m[1;33mGET[0m[39m_DURATION = [0m[32m"#EXT-X-TAR[0m[1;33mGET[0m[32mDURATION:"[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final String EXTINF = [0m[32m"#EXTINF:"[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    private static final String ENDLIST = [0m[32m"#EXT-X-ENDLIST"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final String EXTVERSION = [0m[32m"#EXT-X-VERSION:"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final String EXTKEY = [0m[32m"#EXT-X-KEY:"[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String EXTPLAYLISTTYPE = [0m[32m"#EXT-X-PLAYLIST-TYPE:"[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        return SUPPORTED;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[39mstream, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream stream, XHTMLContentHandler xhtml, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                        ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m([0m[39mBufferedReader reader = new [0m[1;35mBufferedReader[0m[1;39m([0m[39mnew [0m                     [2m                [0m
[2;36m                    [0m         [1;35mInputStreamReader[0m[1;39m([0m[39mstream,[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                StandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            String line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            while [0m[1;39m([0m[39mline != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[32m"##"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[35m/[0m[35m/[0m[95mcomment[0m[39m -- do nothing[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                    [0m[1;35mparseDuration[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION, line, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTINF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    [0m[1;35mhandleLink[0m[1;39m([0m[39mline, reader, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mENDLIST[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTVERSION[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                    Integer val = [0m[1;35mgetInt[0m[1;39m([0m[39mEXTVERSION, line[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                    if [0m[1;39m([0m[39mval != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mM3U8_VERSION, val[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTKEY[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:90[0m[39m-[0m[1;36m180[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                    [0m[1;35mparseDuration[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION, line, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTINF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    [0m[1;35mhandleLink[0m[1;39m([0m[39mline, reader, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mENDLIST[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTVERSION[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                    Integer val = [0m[1;35mgetInt[0m[1;39m([0m[39mEXTVERSION, line[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                    if [0m[1;39m([0m[39mval != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mM3U8_VERSION, val[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTKEY[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.IS_ENCRYPTED, true[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTPLAYLISTTYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                    String t = [0m[1;35mline.substring[0m[1;39m([0m[1;35mEXTPLAYLISTTYPE.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mPLAY_LIST_TYPE, t[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    private Integer [0m[1;35mgetInt[0m[1;39m([0m[39mString key, String line[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        int i = [0m[1;35mline.indexOf[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mi < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        if [0m[1;39m([0m[39mi >= [0m[1;35mline.length[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        if [0m[1;39m([0m[1;35mkey.length[0m[1;39m([0m[1;39m)[0m[39m >= [0m[1;35mline.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        String substring = [0m[1;35mline.substring[0m[1;39m([0m[1;35mkey.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            return [0m[1;35mInteger.parseInt[0m[1;39m([0m[39msubstring[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNumberFormatException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[35m/[0m[35m/[0m[95mlog[0m[39m? swallow for now[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    private Double [0m[1;35mgetDouble[0m[1;39m([0m[39mString key, String line[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int i = [0m[1;35mline.indexOf[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        if [0m[1;39m([0m[39mi < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        if [0m[1;39m([0m[39mi >= [0m[1;35mline.length[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        if [0m[1;39m([0m[1;35mkey.length[0m[1;39m([0m[1;39m)[0m[39m >= [0m[1;35mline.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        String substring = [0m[1;35mline.substring[0m[1;39m([0m[1;35mkey.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            return [0m[1;35mDouble.parseDouble[0m[1;39m([0m[39msubstring[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNumberFormatException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[95mlog[0m[39m? swallow for now[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    private void [0m[1;35mhandleLink[0m[1;39m([0m[39mString line, BufferedReader reader,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                            XHTMLContentHandler xhtml, Metadata metadata,[0m       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        String nextLine = [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mreader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        if [0m[1;39m([0m[39mnextLine == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mformat[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mnextLine.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m               [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        true[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    private String [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mBufferedReader reader[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        String line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            if [0m[1;39m([0m[39mline == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:550[0m[39m-[0m[1;36m620[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:            Path path = [0m[1;35mPaths.get[0m[1;39m([0m[39muri[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:                return [0m[1;35mget[0m[1;39m([0m[39mpath, metadata[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        return [0m[1;35mget[0m[1;39m([0m[1;35muri.toURL[0m[1;39m([0m[1;39m)[0m[39m, metadata[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:     * Creates a TikaInputStream from the resource at the given URL.[0m            [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:     * Note that you must always explicitly close the returned stream as in[0m     [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:     * some cases it may end up writing the resource to a temporary file.[0m       [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:     * @param url resource URL[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:     * @return a TikaInputStream instance[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:     * @throws IOException if the resource can not be accessed[0m                  [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:        return [0m[1;35mget[0m[1;39m([0m[39murl, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:     * Creates a TikaInputStream from the resource at the given URL. The[0m        [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:     * available input metadata is stored in the given metadata instance.[0m       [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:     * Note that you must always explicitly close the returned stream as in[0m     [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:     * some cases it may end up writing the resource to a temporary file.[0m       [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:     * @param url      resource URL[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:     * @param metadata metadata instance[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:     * @return a TikaInputStream instance[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:     * @throws IOException if the resource can not be accessed[0m                  [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[35m/[0m[35m/[0m[39m Special handling for [0m[4;94mfile://[0m[39m URLs[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                Path path = [0m[1;35mPaths.get[0m[1;39m([0m[1;35murl.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:                if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:                    return [0m[1;35mget[0m[1;39m([0m[39mpath, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mURISyntaxException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                [0m[35m/[0m[35m/[0m[39m fall through[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        String path = [0m[1;35murl.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        int slash = [0m[1;35mpath.lastIndexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        if [0m[1;39m([0m[39mslash + [0m[1;36m1[0m[39m < [0m[1;35mpath.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m works even with [0m[1;36m-1[0m[39m![0m                 [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mpath.substring[0m[1;39m([0m[39mslash + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:        String type = [0m[1;35mconnection.getContentType[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, type[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:        String encoding = [0m[1;35mconnection.getContentEncoding[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:        if [0m[1;39m([0m[39mencoding != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_ENCODING, encoding[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:        int length = [0m[1;35mconnection.getContentLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:        if [0m[1;39m([0m[39mlength >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH, [0m[1;35mInteger.toString[0m[1;39m([0m[39mlength[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:160[0m[39m-[0m[1;36m175[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mformat[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mnextLine.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m               [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        true[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:580[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:     * @param url      resource URL[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:     * @param metadata metadata instance[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:     * @return a TikaInputStream instance[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:     * @throws IOException if the resource can not be accessed[0m                  [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[35m/[0m[35m/[0m[39m Special handling for [0m[4;94mfile://[0m[39m URLs[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                Path path = [0m[1;35mPaths.get[0m[1;39m([0m[1;35murl.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:                if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:                    return [0m[1;35mget[0m[1;39m([0m[39mpath, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mURISyntaxException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                [0m[35m/[0m[35m/[0m[39m fall through[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        String path = [0m[1;35murl.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        int slash = [0m[1;35mpath.lastIndexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        if [0m[1;39m([0m[39mslash + [0m[1;36m1[0m[39m < [0m[1;35mpath.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m works even with [0m[1;36m-1[0m[39m![0m                 [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mpath.substring[0m[1;39m([0m[39mslash + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:        String type = [0m[1;35mconnection.getContentType[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, type[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:        String encoding = [0m[1;35mconnection.getContentEncoding[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:        if [0m[1;39m([0m[39mencoding != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_ENCODING, encoding[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:        int length = [0m[1;35mconnection.getContentLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:        if [0m[1;39m([0m[39mlength >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH, [0m[1;35mInteger.toString[0m[1;39m([0m[39mlength[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:        return new [0m[1;35mTikaInputStream[0m[1;39m([0m[39mnew [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mconnection.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:                new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m, length, [0m[1;35mgetExtension[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:     * Fills the given buffer with upcoming bytes from this stream without[0m      [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:     * advancing the current stream position. The buffer is filled up unless[0m    [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:     * the end of stream is encountered before that. This method will block[0m     [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:     * if not enough bytes are immediately available.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:     * @param buffer byte buffer[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:     * @return number of bytes written to the buffer[0m                            [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:     * @throws IOException if the stream can not be read[0m                        [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:    public int [0m[1;35mpeek[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m buffer[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:        int n = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[1;35mmark[0m[1;39m([0m[39mbuffer.length[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        int m = [0m[1;35mread[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:        while [0m[1;39m([0m[39mm != [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:            n += m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            if [0m[1;39m([0m[39mn < buffer.length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:                m = [0m[1;35mread[0m[1;39m([0m[39mbuffer, n, buffer.length - n[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:                m = [0m[1;36m-1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:        [0m[1;35mreset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:585[0m[39m-[0m[1;36m594[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[35m/[0m[35m/[0m[39m Special handling for [0m[4;94mfile://[0m[39m URLs[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                Path path = [0m[1;35mPaths.get[0m[1;39m([0m[1;35murl.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:                if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:                    return [0m[1;35mget[0m[1;39m([0m[39mpath, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mURISyntaxException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                [0m[35m/[0m[35m/[0m[39m fall through[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:596[0m[39m-[0m[1;36m604[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        String path = [0m[1;35murl.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        int slash = [0m[1;35mpath.lastIndexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        if [0m[1;39m([0m[39mslash + [0m[1;36m1[0m[39m < [0m[1;35mpath.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m works even with [0m[1;36m-1[0m[39m![0m                 [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mpath.substring[0m[1;39m([0m[39mslash + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:598[0m[39m-[0m[1;36m606[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        String path = [0m[1;35murl.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        int slash = [0m[1;35mpath.lastIndexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        if [0m[1;39m([0m[39mslash + [0m[1;36m1[0m[39m < [0m[1;35mpath.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m works even with [0m[1;36m-1[0m[39m![0m                 [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mpath.substring[0m[1;39m([0m[39mslash + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:        String type = [0m[1;35mconnection.getContentType[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview and Root Cause  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   The SSRF arises because M3U8Parser.handleLink hands an attacker-controlled URL [0m  [2m                [0m
[2;36m                    [0m         [39mstraight into [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mURL[0m[1;39m)[0m[39m, which calls [0m                                [2m                [0m
[2;36m                    [0m         [1;35mURLConnection.openConnection[0m[1;39m([0m[1;39m)[0m[35m/[0m[95mgetInputStream[0m[1;39m([0m[1;39m)[0m[39m without any host or protocol [0m       [2m                [0m
[2;36m                    [0m         [39mchecks. The socket-level connect fires, and Jazzer’s SSRF sanitizer flags it.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Centralized Mitigation in [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mURL, Metadata[0m[1;39m)[0m[39m  [0m                   [2m                [0m
[2;36m                    [0m         [39m   To stop *all* parsers [0m[1;39m([0m[39mincluding M3U8Parser[0m[1;39m)[0m[39m from blindly opening network [0m       [2m                [0m
[2;36m                    [0m         [39mconnections to arbitrary hosts, introduce a guard at the top of the URL-based entry[0m [2m                [0m
[2;36m                    [0m         [39mpoint in TikaInputStream. This ensures that any call to fetch a remote resource [0m    [2m                [0m
[2;36m                    [0m         [39mover [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m is blocked unless explicitly allowed.  [0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   a. In `TikaInputStream.java`, `public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, [0m       [2m                [0m
[2;36m                    [0m         [39mMetadata metadata[0m[1;39m)[0m[39m` [0m[1;39m([0m[39maround the file-protocol handling and immediately before [0m      [2m                [0m
[2;36m                    [0m         [39mcalling `[0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m:  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m      - Inspect `[0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[39m`.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m      - If the protocol is `[0m[32m"http"[0m[39m` or `[0m[32m"https"[0m[39m`, *by default* throw an [0m            [2m                [0m
[2;36m                    [0m         [39m`IOException` with a clear message [0m[1;39m([0m[39me.g. “Remote resource fetching disabled for [0m    [2m                [0m
[2;36m                    [0m         [39msecurity [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m”[0m[1;39m)[0m[39m.  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m      - Leave existing [0m[4;94mfile://[0m[39m handling intact [0m[1;39m([0m[39mso local files still work[0m[1;39m)[0m[39m.  [0m       [2m                [0m
[2;36m                    [0m         [39m      - Allow all other protocols [0m[1;39m([0m[39mjar, resource, ftp, etc.[0m[1;39m)[0m[39m to continue through [0m   [2m                [0m
[2;36m                    [0m         [39mthe existing logic.  [0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Provide an escape hatch for users who legitimately need remote fetching:  [0m    [2m                [0m
[2;36m                    [0m         [39m      - Define a new ParseContext key, e.g.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m        ```java[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        public static final Class<Boolean> ALLOW_REMOTE_STREAMS = Boolean.class;[0m    [2m                [0m
[2;36m                    [0m         [39m        ```  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m      - In the same guard, check `[0m[1;35mcontext.get[0m[1;39m([0m[39mALLOW_REMOTE_STREAMS[0m[1;39m)[0m[39m`, and only [0m     [2m                [0m
[2;36m                    [0m         [39mblock [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m if that flag is missing or false. If it’s true, allow the fetch as [0m   [2m                [0m
[2;36m                    [0m         [39mbefore.  [0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Impacted Components  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Tika core: `[0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mURL, Metadata[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mand the overload `[0m[1;35mget[0m[1;39m([0m[39mURL[0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mthat delegates to it[0m[1;39m)[0m[39m.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - No need to touch M3U8Parser or any other parser—this single change [0m            [2m                [0m
[2;36m                    [0m         [39mautomatically protects every parser path that relies on URL connections in [0m         [2m                [0m
[2;36m                    [0m         [39mTikaInputStream.  [0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Preservation of Existing Functionality  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Local and file-based inputs continue to work unmodified.  [0m                     [2m                [0m
[2;36m                    [0m         [39m   - Non-HTTP protocols [0m[1;39m([0m[39mjar, resource, ftp, etc.[0m[1;39m)[0m[39m remain unaffected.  [0m             [2m                [0m
[2;36m                    [0m         [39m   - Remote [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m fetch remains available *only* when a user explicitly opts in [0m  [2m                [0m
[2;36m                    [0m         [39mvia the new context flag.  [0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Step-by-Step Patch Outline  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   a. In `tika-core/src/main/java/org/apache/tika/io/TikaInputStream.java`:  [0m       [2m                [0m
[2;36m                    [0m         [39m      - Add at the top of the `[0m[1;35mget[0m[1;39m([0m[39mURL, Metadata[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mbefore [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m:  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m        ```java[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m SSRF Protection: block [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m fetches by default.[0m                       [2m                [0m
[2;36m                    [0m         [39m        String scheme = [0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[32m"http"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mscheme[0m[1;39m)[0m[39m || [0m[32m"https"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mscheme[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m            Boolean allow = [0m[1;35mmetadataOrContext.get[0m[1;39m([0m[39mParseContext.class[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m                                [0m[1;35m.get[0m[1;39m([0m[39mALLOW_REMOTE_STREAMS[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m            if [0m[1;39m([0m[39mallow == null || !allow[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Remote resource fetching disabled for SSRF [0m  [2m                [0m
[2;36m                    [0m         [32mprotection: "[0m[39m + url[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m            [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        ```  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m      - Define `public static final Class<Boolean> ALLOW_REMOTE_STREAMS = [0m          [2m                [0m
[2;36m                    [0m         [39mBoolean.class;` in a central config class [0m[1;39m([0m[39mor within TikaInputStream[0m[1;39m)[0m[39m.  [0m            [2m                [0m
[2;36m                    [0m         [39m      - Add analogous guard in the single-argument overload `[0m[1;35mget[0m[1;39m([0m[39mURL[0m[1;39m)[0m[39m` if needed.  [0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Document the new `ALLOW_REMOTE_STREAMS` flag in JavaDoc and the Tika [0m         [2m                [0m
[2;36m                    [0m         [39mreference guide, noting that remote [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m loading is disabled by default to [0m      [2m                [0m
[2;36m                    [0m         [39mprevent SSRF, and can be re-enabled if the caller truly intends to fetch external [0m  [2m                [0m
[2;36m                    [0m         [39mcontent.  [0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Why This Approach  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - **Single insertion point**: Patches one method in Tika core and automatically [0m [2m                [0m
[2;36m                    [0m         [39msecures *every* consumer of `[0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mURL[0m[1;39m)[0m[39m`.  [0m                           [2m                [0m
[2;36m                    [0m         [39m   - **Safe-by-default**: Disallows arbitrary remote fetch unless explicitly [0m       [2m                [0m
[2;36m                    [0m         [39menabled, eliminating the primary SSRF vector.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m   - **Minimal disruption**: Local file parsing and other protocols remain [0m         [2m                [0m
[2;36m                    [0m         [39muntouched. Clients that need remote access can simply set one Boolean on their [0m     [2m                [0m
[2;36m                    [0m         [39mParseContext.  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - **No harness/test changes**: Fuzzer harness will no longer trigger a [0m          [2m                [0m
[2;36m                    [0m         [39mSocket.connect for [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m URLs, so the Jazzer SSRF sanitizer won’t fire. Existing [0m [2m                [0m
[2;36m                    [0m         [39munit tests for local files pass unchanged.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Potential Side Effects & Mitigation  [0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Any existing code or tests that rely on Tika fetching remote [0m[1;35mHTTP[0m[1;39m([0m[39mS[0m[1;39m)[0m[39m content [0m  [2m                [0m
[2;36m                    [0m         [39mwill now see IOExceptions.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m     *Mitigation*: Update those tests or client code to set `ALLOW_REMOTE_STREAMS =[0m [2m                [0m
[2;36m                    [0m         [39mtrue` in the ParseContext. Document the behavior change in release notes.  [0m         [2m                [0m
[2;36m                    [0m         [39m   - Library users unaware of the new flag will observe remote fetch failures.  [0m    [2m                [0m
[2;36m                    [0m         [39m     *Mitigation*: Clearly call out the change in the migration guide and JavaDoc.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. References & Similar Patterns  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Other parsers in Apache libraries often guard network calls behind explicit [0m   [2m                [0m
[2;36m                    [0m         [39m“allowNetwork” flags.  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - The same pattern [0m[1;39m([0m[39mguard + IOException[0m[1;39m)[0m[39m is used elsewhere in Tika to prevent [0m   [2m                [0m
[2;36m                    [0m         [39muncontrolled resource loading [0m[1;39m([0m[39me.g., XML external entity protections[0m[1;39m)[0m[39m.  [0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 15:03:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=954628;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=333247;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=252803;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=22843;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpiaiqre2x[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-02_vuln_3/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66988209.04671[0m                                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-02_vuln_3.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=423621;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=44544;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=753514;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=268850;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m[12/29/25 15:03:30][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=517734;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=693512;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
