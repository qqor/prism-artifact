{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-delta-01_vuln_001",
  "source_directory": "/home/user/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.2273876,
    "prompt_tokens": 76468,
    "completion_tokens": 32562
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/crypto/certificate.c\n+++ b/libfreerdp/crypto/certificate.c\n@@ -1534,9 +1534,9 @@\n \tWINPR_ASSERT(bio);\n \tWINPR_ASSERT(ppem);\n \n-\tconst uint16_t blocksize = 2048;\n-\tuint16_t offset = 0;\n-\tuint16_t length = blocksize;\n+    const size_t blocksize = 2048;\n+    size_t offset = 0;\n+    size_t length = blocksize;\n \tchar* pem = NULL;\n \n \t*ppem = NULL;\n@@ -1563,11 +1563,31 @@\n \t\tif (status == 0)\n \t\t\tbreak;\n \n-\t\toffset += (size_t)status;\n-\t\tlength += blocksize;\n-\n-\t}\n-\tpem[offset] = '\\0';\n+        offset += (size_t)status;\n+\n+        /* Grow buffer if needed before next read */\n+        if (length - offset < blocksize)\n+        {\n+            size_t new_length = length + blocksize;\n+            char* tmp = (char*)realloc(pem, new_length + 1);\n+            if (!tmp)\n+                goto fail;\n+            pem = tmp;\n+            length = new_length;\n+        }\n+\n+    }\n+\n+    /* Ensure space for null terminator */\n+    if (length <= offset)\n+    {\n+        char* tmp = (char*)realloc(pem, offset + 1);\n+        if (!tmp)\n+            goto fail;\n+        pem = tmp;\n+    }\n+\n+    pem[offset] = '\\0';\n \t*ppem = pem;\n \tif (plength)\n \t\t*plength = offset;\n",
  "stdout": "",
  "stderr": ""
}