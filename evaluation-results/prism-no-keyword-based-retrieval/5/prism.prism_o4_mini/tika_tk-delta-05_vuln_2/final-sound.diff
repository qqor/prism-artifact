--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -1157,6 +1157,10 @@
             } catch (IllegalArgumentException e) {
                 LOG.warn("couldn't url decode name {}", normalizedName);
             }
+            // prevent directory traversal: remove any parent directory segments
+            if (normalizedName.contains("..")) {
+                normalizedName = FilenameUtils.getName(normalizedName);
+            }
             File outputFile = new File(extractDir, normalizedName);
             //if file already exists, prepend uuid
             if (outputFile.exists()) {
