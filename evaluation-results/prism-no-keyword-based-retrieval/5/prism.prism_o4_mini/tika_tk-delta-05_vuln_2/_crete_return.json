{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-05_vuln_2",
  "source_directory": "/home/user/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.2253647,
    "prompt_tokens": 144349,
    "completion_tokens": 15132
  },
  "variant": "sound",
  "diff": "--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n@@ -1157,6 +1157,10 @@\n             } catch (IllegalArgumentException e) {\n                 LOG.warn(\"couldn't url decode name {}\", normalizedName);\n             }\n+            // prevent directory traversal: remove any parent directory segments\n+            if (normalizedName.contains(\"..\")) {\n+                normalizedName = FilenameUtils.getName(normalizedName);\n+            }\n             File outputFile = new File(extractDir, normalizedName);\n             //if file already exists, prepend uuid\n             if (outputFile.exists()) {\n",
  "stdout": "",
  "stderr": ""
}