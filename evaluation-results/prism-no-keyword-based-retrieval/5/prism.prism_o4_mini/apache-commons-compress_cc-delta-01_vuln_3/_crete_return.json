{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-01_vuln_3",
  "source_directory": "/home/qqor/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.22707629999999998,
    "prompt_tokens": 159149,
    "completion_tokens": 11821
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -219,9 +219,12 @@\n      * Since they are parsed into long values, maximum length of each is the same as Long.MAX_VALUE which is 19 digits.\n      * </p>\n      */\n-    private static final Pattern PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN = Pattern.compile(\n-            \"(-?(?:\\\\d{1,19}|(?:.|\\\\d)*))(?:\\\\.\\\\d{1,19})?\");\n-\n+    // Maximum length for PAX time field: optional '-' + up to 19 digits + optional '.' + up to 19 digits\n+    private static final int MAX_PAX_TIME_STRING_LENGTH = 40;\n+\n+    // Strict numeric validation: no unbounded constructs\n+    private static final Pattern PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN =\n+        Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d{1,19})?\");\n     private static FileTime fileTimeFromOptionalSeconds(final long seconds) {\n         return seconds <= 0 ? null : FileTimes.fromUnixTime(seconds);\n     }\n@@ -271,6 +274,9 @@\n                                                           final String value) throws IOException {\n \n         // Validate field values to prevent denial of service attacks with BigDecimal values (see JDK-6560193)\n+        if (value.length() > MAX_PAX_TIME_STRING_LENGTH) {\n+            throw new IOException(\"Corrupted PAX header. Time field too long: '\" + value + \"'\");\n+        }\n         Matcher fileTimesMatcher = PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN.matcher(value);\n         if (! fileTimesMatcher.matches()) {\n             throw new IOException(\n",
  "stdout": "",
  "stderr": ""
}