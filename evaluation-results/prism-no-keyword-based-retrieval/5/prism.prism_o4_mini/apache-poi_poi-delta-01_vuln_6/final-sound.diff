--- a/poi-ooxml/src/main/java/org/apache/poi/xssf/extractor/XSSFEventBasedExcelExtractor.java
+++ b/poi-ooxml/src/main/java/org/apache/poi/xssf/extractor/XSSFEventBasedExcelExtractor.java
@@ -73,7 +73,9 @@
     implements POIXMLTextExtractor, ExcelExtractor {
 
     private static final Logger LOGGER = PoiLogManager.getLogger(XSSFEventBasedExcelExtractor.class);
-    private static final Pattern MAJOR_VERSION_PATTERN = Pattern.compile("(-?(?:\\d{1,30})*)(?:\\.(\\dc?)*)");
+    private static final Pattern MAJOR_VERSION_PATTERN =
+        Pattern.compile("^(-?[0-9]{1,30})(?:\\.([0-9]{1,30}))?$");
+    private static final int MAX_APP_VERSION_LENGTH = 100;
     protected final OPCPackage container;
     protected final POIXMLProperties properties;
 
@@ -526,6 +528,10 @@
             if (appVersionString.isEmpty()) {
                 return;
             }
+            if (appVersionString.length() > MAX_APP_VERSION_LENGTH) {
+                appVersionBuffer.setLength(0);
+                return;
+            }
             Matcher m = MAJOR_VERSION_PATTERN.matcher(appVersionString);
             if (m.find()) {
                 text.append("MajorVersion: ").append(m.group(1)).append("\n");
