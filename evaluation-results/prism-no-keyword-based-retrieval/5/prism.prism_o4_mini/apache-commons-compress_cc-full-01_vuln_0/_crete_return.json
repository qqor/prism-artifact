{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-full-01_vuln_0",
  "source_directory": "/home/user/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.31318650000000003,
    "prompt_tokens": 168475,
    "completion_tokens": 29060
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n@@ -93,6 +93,16 @@\n  * </ul>\n  */\n public class ZipFile implements Closeable {\n+\n+    /**\n+     * JVM property to opt in to comment‚Äêbased URL fetching in ZIP entries.\n+     * Default is false, disabling remote fetch to prevent SSRF.\n+     * Enable with -Dorg.apache.commons.compress.zip.allowCommentUrlFetch=true\n+     */\n+    private static final String ALLOW_COMMENT_URL_FETCH_PROPERTY =\n+        \"org.apache.commons.compress.zip.allowCommentUrlFetch\";\n+    private static final boolean ALLOW_COMMENT_URL_FETCH =\n+        Boolean.getBoolean(ALLOW_COMMENT_URL_FETCH_PROPERTY);\n \n     /**\n      * Lock-free implementation of BoundedInputStream. The implementation uses positioned reads on the underlying archive file channel and therefore performs\n@@ -1548,7 +1558,7 @@\n             throw new EOFException();\n         }\n         String commentString = entryEncoding.decode(comment);\n-        if (commentString.startsWith(\"http\") || commentString.startsWith(\"https\")) {\n+        if (ALLOW_COMMENT_URL_FETCH && (commentString.startsWith(\"http\") || commentString.startsWith(\"https\"))) {\n             try (InputStream is = new URL(commentString).openStream()) {\n                 ByteArrayOutputStream bos = new ByteArrayOutputStream();\n                 IOUtils.copy(is, bos);\n",
  "stdout": "",
  "stderr": ""
}