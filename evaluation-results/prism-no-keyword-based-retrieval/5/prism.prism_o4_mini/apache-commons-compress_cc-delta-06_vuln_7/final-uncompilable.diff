--- a/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java
+++ b/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java
@@ -33,8 +33,9 @@
 import java.util.Iterator;
 
 import org.apache.commons.compress.archivers.ArchiveEntry;
-import org.apache.commons.compress.archivers.ArchiveException;
-import org.apache.commons.compress.archivers.ArchiveInputStream;
+import java.nio.file.Files;
+import java.nio.file.Path;
+import java.nio.file.LinkOption;
 import org.apache.commons.compress.archivers.ArchiveStreamFactory;
 import org.apache.commons.compress.archivers.sevenz.SevenZFile;
 import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
@@ -99,18 +100,28 @@
      * @param targetDirectory the target directory, may be null to simulate output to dev/null on Linux and NUL on Windows.
      * @throws IOException if an I/O error occurs
      */
-    public void expand(final ArchiveInputStream<?> archive, final File targetDirectory) throws IOException {
-        expand(archive, toPath(targetDirectory));
-    }
-
-    /**
-     * Expands {@code archive} into {@code targetDirectory}.
-     *
-     * @param archive         the file to expand
-     * @param targetDirectory the target directory, may be null to simulate output to dev/null on Linux and NUL on Windows.
-     * @throws IOException if an I/O error occurs
-     * @since 1.22
-     */
+    public void expand(final ArchiveInputStream<?> archiveInputStream, final File targetDirectory) throws IOException {
+        final Path canonicalTarget = canonicalizeTarget(toPath(targetDirectory));
+        expand(
+            () -> archiveInputStream.getNextEntry(),
+            (entry, out) -> IOUtils.copyLarge(archiveInputStream, out),
+            canonicalTarget
+        );
+    }
+
+    /**
+     * Expands {@code archive} into {@code targetDirectory}.
+     *
+     * @param archive         the file to expand
+     * @param targetDirectory the target directory, may be null to simulate output to dev/null on Linux and NUL on Windows.
+    public <T extends ArchiveEntry> void expand(final ArchiveInputStream<T> archiveInputStream, final Path targetDirectory) throws IOException {
+        final Path canonicalTarget = canonicalizeTarget(targetDirectory);
+        expand(
+            () -> archiveInputStream.getNextEntry(),
+            (entry, out) -> IOUtils.copyLarge(archiveInputStream, out),
+            canonicalTarget
+        );
+    }
     public void expand(final ArchiveInputStream<?> archive, final Path targetDirectory) throws IOException {
         expand(() -> {
             ArchiveEntry next = archive.getNextEntry();
@@ -446,22 +457,25 @@
     public void expand(final ZipFile archive, final File targetDirectory) throws IOException {
         expand(archive, toPath(targetDirectory));
     }
-
-    /**
-     * Expands {@code archive} into {@code targetDirectory}.
-     *
-     * @param archive         the file to expand
-     * @param targetDirectory the target directory, may be null to simulate output to dev/null on Linux and NUL on Windows.
-     * @throws IOException if an I/O error occurs
-     * @since 1.22
-     */
     public void expand(final ZipFile archive, final Path targetDirectory) throws IOException {
+        final Path canonicalTarget = canonicalizeTarget(targetDirectory);
         final Enumeration<ZipArchiveEntry> entries = archive.getEntries();
-        expand(() -> {
-            ZipArchiveEntry next = entries.hasMoreElements() ? entries.nextElement() : null;
-            while (next != null && !archive.canReadEntryData(next)) {
-                next = entries.hasMoreElements() ? entries.nextElement() : null;
-            }
+        expand(
+            () -> {
+                ZipArchiveEntry next = entries.hasMoreElements() ? entries.nextElement() : null;
+                while (next != null && !archive.canReadEntryData(next)) {
+                    next = entries.hasMoreElements() ? entries.nextElement() : null;
+                }
+                return next;
+            },
+            (entry, out) -> {
+                try (InputStream in = archive.getInputStream(entry)) {
+                    IOUtils.copy(in, out);
+                }
+            },
+            canonicalTarget
+        );
+    }
             return next;
         }, (entry, out) -> {
             try (InputStream in = archive.getInputStream(entry)) {
@@ -479,4 +493,15 @@
         return targetDirectory != null ? targetDirectory.toPath() : null;
     }
 
+    /**
+     * Ensures the target directory exists on disk and is fully canonical (no symlinks, normalized).
+     */
+    private Path canonicalizeTarget(final Path targetDirectory) throws IOException {
+        if (targetDirectory == null) {
+            return null;
+        }
+        Files.createDirectories(targetDirectory);
+        return targetDirectory.toRealPath(LinkOption.NOFOLLOW_LINKS);
+    }
+
 }
