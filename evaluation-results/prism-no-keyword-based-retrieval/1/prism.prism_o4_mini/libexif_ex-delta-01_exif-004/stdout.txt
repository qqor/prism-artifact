[2;36m[12/31/25 10:48:54][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=594924;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=188121;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgna10ef3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/libexif_ex-delta-01_exif-004/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1767145734.9977121[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-01_exif-[1;36m004.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/31/25 10:48:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=732904;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=697002;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/31/25 10:49:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=63531;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m22.80[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=113496;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=814193;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=249295;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=932276;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=555938;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=604246;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m22[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=531256;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=813497;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:49:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=211087;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=946989;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=512593;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=916406;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=846901;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=29602;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=361420;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=684410;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=871673;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=285602;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:49:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=147195;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=333081;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=566230;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=934881;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:49:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.48[0m seconds;               ]8;id=803079;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=206353;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 10:49:21][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=156089;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=61976;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_loader_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m [1m<[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2942139360[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706ae738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ca706af25e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706af260[0m[39m,[0m[1;36m0x55ca706ba4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000013f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ca7058cff2[0m[39m bp [0m[1;36m0x7ffd5061e300[0m[39m sp [0m[1;36m0x7ffd5061dac0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m256[0m[39m at [0m[1;36m0x51100000013f[0m[39m thread T0[0m                                        [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058cff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705eeb87[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705d1f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e6ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ca7046678d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_mnote_data_apple_load--exif_data_load_data[0m         [2m                [0m
[2;36m                    [0m         [1;36m0x51100000013f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m255[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000040[0m[39m,[0m[1;36m0x51100000013f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058f2c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m108:6[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_copy [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m150:14[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e5c33[0m[39m in exif_loader_write [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m241:9[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea42[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m62:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_loader_alloc--exif_loader_copy[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m[39m in [0m                        [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_load[0m                                                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgbqk4rik[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2942139360[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706ae738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ca706af25e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706af260[0m[39m,[0m[1;36m0x55ca706ba4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000013f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ca7058cff2[0m[39m bp [0m[1;36m0x7ffd5061e300[0m[39m sp [0m[1;36m0x7ffd5061dac0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m256[0m[39m at [0m[1;36m0x51100000013f[0m[39m thread T0[0m                                        [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058cff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705eeb87[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705d1f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e6ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ca7046678d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_mnote_data_apple_load--exif_data_load_data[0m         [2m                [0m
[2;36m                    [0m         [1;36m0x51100000013f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m255[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000040[0m[39m,[0m[1;36m0x51100000013f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058f2c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m108:6[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_copy [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m150:14[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e5c33[0m[39m in exif_loader_write [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m241:9[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea42[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m62:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_loader_alloc--exif_loader_copy[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m[39m in [0m                        [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_load[0m                                                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x511000000100[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m07[0m[1m][0mfa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000180[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000200[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x511000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m13[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgbqk4rik[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_loader_fuzzer -[33mruns[0m=[1;36m100[0m.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 10:49:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=763324;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=547629;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 10:50:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=18733;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=784233;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 10:50:44][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=728804;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=863990;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=340930;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=496164;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:50:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=385141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=307285;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=499296;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=773084;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp1pxgdceq[0m                                                 ]8;id=391257;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=240371;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/31/25 10:51:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m19.89[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=861574;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=502285;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=121247;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=135225;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:51:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.83[0m seconds;              ]8;id=360466;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=306417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=324738;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=719176;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:51:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m1.11[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=847095;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=62597;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=71735;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=947658;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=77704;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=980327;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=912917;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=646718;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.51[0m seconds;               ]8;id=17459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=913193;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 10:51:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=11157;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=864928;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 10:51:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.53[0m seconds;               ]8;id=687864;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=159862;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=691439;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=33952;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=490647;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=166762;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=813589;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=150478;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         +++ b/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-117[0m,[1;36m11[0m +[1;36m117[0m,[1;36m11[0m @@                                                               [2m                [0m
[2;36m                    [0m                  [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m                      dofs = ofs + [1;36m8[0m;                                                        [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -       if [1m([0mdofs > buf_size[1m)[0m [1m{[0m                                                      [2m                [0m
[2;36m                    [0m         -               exif_log [1m([0mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,                      [2m                [0m
[2;36m                    [0m         -                                  [32m"ExifMnoteApplet"[0m, [32m"Tag size overflow detected [0m  [2m                [0m
[2;36m                    [0m         [32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m, dofs, buf_size[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         -               continue;                                                           [2m                [0m
[2;36m                    [0m         -       [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m         +    if [1m([0mdofs > buf_size || dsize > buf_size - dofs[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         +        exif_log [1m([0mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,                             [2m                [0m
[2;36m                    [0m         +                                  [32m"ExifMnoteApple"[0m, [32m"Tag size overflow detected [0m   [2m                [0m
[2;36m                    [0m         [32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m, dofs + dsize, buf_size[1m)[0m;                                          [2m                [0m
[2;36m                    [0m         +        continue;                                                                  [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                  ofs += [1;36m12[0m;                                                                 [2m                [0m
[2;36m                    [0m                  d->entries[1m[[0mi[1m][0m.data = [1;35mexif_mem_alloc[0m[1m([0mmd->mem, dsize[1m)[0m;                       [2m                [0m
[2;36m                    [0m                  if [1m([0m!d->entries[1m[[0mi[1m][0m.data[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_loader_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m [1m<[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2942139360[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706ae738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ca706af25e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706af260[0m[39m,[0m[1;36m0x55ca706ba4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000013f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ca7058cff2[0m[39m bp [0m[1;36m0x7ffd5061e300[0m[39m sp [0m[1;36m0x7ffd5061dac0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m256[0m[39m at [0m[1;36m0x51100000013f[0m[39m thread T0[0m                                        [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058cff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705eeb87[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705d1f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e6ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ca7046678d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_mnote_data_apple_load--exif_data_load_data[0m         [2m                [0m
[2;36m                    [0m         [1;36m0x51100000013f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m255[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000040[0m[39m,[0m[1;36m0x51100000013f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058f2c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m108:6[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_copy [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m150:14[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e5c33[0m[39m in exif_loader_write [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m241:9[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea42[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m62:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_loader_alloc--exif_loader_copy[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m[39m in [0m                        [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_load[0m                                                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgbqk4rik[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-based buffer overflow was detected by AddressSanitizer in the libexif [0m       [2m                [0m
[2;36m                    [0m         [39mcomponent while processing a fuzzed input. The overflow occurs in the function [0m     [2m                [0m
[2;36m                    [0m         [39m`exif_mnote_data_apple_load`, where a [0m[1;36m256[0m[39m-byte read via `memcpy` exceeds the [0m       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m-byte buffer allocated for maker‐note data. The crash is reproducible under [0m     [2m                [0m
[2;36m                    [0m         [39mlibFuzzer with AddressSanitizer instrumentation.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type: heap-buffer-overflow  [0m                                                [2m                [0m
[2;36m                    [0m         [39m- Trigger: Running `exif_loader_fuzzer` with a specially crafted `[0m[35m/[0m[95mtestcase[0m[39m` input.[0m [2m                [0m
[2;36m                    [0m         [39m- Faulting operation: A `memcpy` reads [0m[1;36m256[0m[39m bytes [0m[1;39m([0m[39m`READ of size [0m[1;36m256[0m[39m`[0m[1;39m)[0m[39m into a buffer[0m [2m                [0m
[2;36m                    [0m         [39mof size [0m[1;36m255[0m[39m.  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Crash location:  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  - AddressSanitizer report points to line [0m[1;36m131[0m[39m in [0m                                  [2m                [0m
[2;36m                    [0m         [39m`src/libexif/libexif/apple/exif-mnote-data-apple.c` inside [0m                         [2m                [0m
[2;36m                    [0m         [39m`exif_mnote_data_apple_load`.  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m  - Call stack:  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. `__asan_memcpy` interceptor  [0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. `exif_mnote_data_apple_load`  [0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. `exif_data_load_data` in `exif-data.c`  [0m                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. `exif_loader_get_data` in `exif-loader.c`  [0m                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m5[0m[39m. `LLVMFuzzerTestOneInput` in the fuzzer harness  [0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Observations:  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  - The buffer is allocated via `calloc` in `exif_loader_alloc` [0m[1;39m([0m[39mcalled through [0m    [2m                [0m
[2;36m                    [0m         [39m`exif_loader_copy` and `exif_loader_write`[0m[1;39m)[0m[39m, resulting in a [0m[1;36m255[0m[39m-byte region.  [0m      [2m                [0m
[2;36m                    [0m         [39m  - Immediately afterward, `exif_mnote_data_apple_load` attempts to read one [0m       [2m                [0m
[2;36m                    [0m         [39madditional byte, touching address `[0m[1;36m0x51100000013f[0m[39m`, which lies just past the [0m       [2m                [0m
[2;36m                    [0m         [39mallocated region.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  - The fuzzer harness merely invokes the library routines and is not the root [0m     [2m                [0m
[2;36m                    [0m         [39mcause; it serves to expose the underlying overflow.  [0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Areas for investigation to gain a complete understanding:  [0m                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. `exif-mnote-data-apple.c` around the implementation of [0m                        [2m                [0m
[2;36m                    [0m         [39m`exif_mnote_data_apple_load`, specifically the logic that determines how many bytes[0m [2m                [0m
[2;36m                    [0m         [39mto copy and how the buffer size is computed.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Allocation routines in `exif-loader.c` [0m[1;39m([0m[39m`exif_loader_alloc`, [0m                  [2m                [0m
[2;36m                    [0m         [39m`exif_loader_copy`, `exif_loader_write`[0m[1;39m)[0m[39m to review the buffer sizing and any [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata used to track lengths.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Data loading orchestration in `exif-data.c` [0m[1;39m([0m[39m`exif_data_load_data`[0m[1;39m)[0m[39m to see how[0m [2m                [0m
[2;36m                    [0m         [39mmaker-note segments are parsed and passed to the Apple‐specific loader.  [0m           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Any input‐sanitization or length‐checking code upstream of the offending [0m      [2m                [0m
[2;36m                    [0m         [39m`memcpy`.  [0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo assumptions are made about the root cause or potential fixes in this report.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2942139360[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706ae738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ca706af25e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ca706af260[0m[39m,[0m[1;36m0x55ca706ba4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x51100000013f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ca7058cff2[0m[39m bp [0m[1;36m0x7ffd5061e300[0m[39m sp [0m[1;36m0x7ffd5061dac0[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m256[0m[39m at [0m[1;36m0x51100000013f[0m[39m thread T0[0m                                        [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m26[0m[39m [0m[1;39m([0m[39mmulti-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058cff1[0m[39m in __asan_memcpy [0m                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_interceptors_memintrinsics.cpp[0m[39m:[0m[1;92m63:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705eeb87[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705d1f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e6ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ca7046678d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __asan_memcpy--exif_mnote_data_apple_load--exif_data_load_data[0m         [2m                [0m
[2;36m                    [0m         [1;36m0x51100000013f[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m255[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x511000000040[0m[39m,[0m[1;36m0x51100000013f[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ca7058f2c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m108:6[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ca705e6334[0m[39m in exif_loader_copy [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m150:14[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ca705e5c33[0m[39m in exif_loader_write [0m[35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m241:9[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ca705cea42[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m62:3[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ca70483330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ca7046e5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ca7047403f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ca7049f2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f56fc908082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_loader_alloc--exif_loader_copy[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m131:9[0m[39m in [0m                        [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_load[0m                                                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x510fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000000[0m[39m: fa fa fa fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x511000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x511000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m13[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgbqk4rik[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-mnote-data-apple.c[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"exif-mnote-data-apple.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m32:e[0m[1;35mxif_mnote_data_apple_free[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    unsigned int i;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    if [0m[1;39m([0m[39m!d[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    if [0m[1;39m([0m[39md->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < d->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            if [0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                [0m[1;35mexif_mem_free[0m[1;39m([0m[39mmd->mem, d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mexif_mem_free[0m[1;39m([0m[39mmd->mem, d->entries[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        d->entries = NULL;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        d->count = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    return;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m140:e[0m[1;35mxif_mnote_data_apple_set_offset[0m[1;39m([0m[39mExifMnoteData *md, unsigned int o[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    if [0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md[0m[1;39m)[0m[39m->offset = o;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m151:e[0m[1;35mxif_mnote_data_apple_set_byte_order[0m[1;39m([0m[39mExifMnoteData *md , ExifByteOrder o[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    unsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    if [0m[1;39m([0m[39m!d || d->order == o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < d->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        if [0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size != [0m[1;39m([0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mexif_array_set_byte_order[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format, d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data,[0m     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                                  d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components, [0m                    [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order, o[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = o;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    d->order = o;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m175:e[0m[1;35mxif_mnote_data_apple_count[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    return md ? [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md[0m[1;39m)[0m[39m->count : [0m[1;36m0[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m182:e[0m[1;35mxif_mnote_data_apple_get_id[0m[1;39m([0m[39mExifMnoteData *md, unsigned int i[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    if [0m[1;39m([0m[39m!d || [0m[1;39m([0m[39md->count <= i[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    return d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:static const char *[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m193:e[0m[1;35mxif_mnote_data_apple_get_name[0m[1;39m([0m[39mExifMnoteData *md, unsigned int i[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    if [0m[1;39m([0m[39m!d || [0m[1;39m([0m[39md->count <= i[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    return [0m[1;35mmnote_apple_tag_get_name[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-loader.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-loader.c[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2002[0m[39m Lutz Mueller <lutz@users.sourceforge.net>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful, [0m              [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of [0m               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details. [0m                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include <libexif/exif-loader.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <libexif/i18n.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include <sys/types.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#undef JPEG_MARKER_DCT[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define JPEG_MARKER_DCT  [0m[1;36m0xc0[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#undef JPEG_MARKER_DHT[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#define JPEG_MARKER_DHT  [0m[1;36m0xc4[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#undef JPEG_MARKER_SOI[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#define JPEG_MARKER_SOI  [0m[1;36m0xd8[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#undef JPEG_MARKER_DQT[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#define JPEG_MARKER_DQT  [0m[1;36m0xdb[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#undef JPEG_MARKER_APP0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#define JPEG_MARKER_APP0 [0m[1;36m0xe0[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#undef JPEG_MARKER_APP1[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#define JPEG_MARKER_APP1 [0m[1;36m0xe1[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#undef JPEG_MARKER_APP2[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#define JPEG_MARKER_APP2 [0m[1;36m0xe2[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:#undef JPEG_MARKER_APP4[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#define JPEG_MARKER_APP4 [0m[1;36m0xe4[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#undef JPEG_MARKER_APP5[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define JPEG_MARKER_APP5 [0m[1;36m0xe5[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#undef JPEG_MARKER_APP11[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define JPEG_MARKER_APP11 [0m[1;36m0xeb[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#undef JPEG_MARKER_APP13[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define JPEG_MARKER_APP13 [0m[1;36m0xed[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#undef JPEG_MARKER_APP14[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#define JPEG_MARKER_APP14 [0m[1;36m0xee[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#undef JPEG_MARKER_COM[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#define JPEG_MARKER_COM [0m[1;36m0xfe[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39mEL_READ = [0m[1;36m0[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39mEL_READ_SIZE_BYTE_24,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mEL_READ_SIZE_BYTE_16,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39mEL_READ_SIZE_BYTE_08,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mEL_READ_SIZE_BYTE_00,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mEL_SKIP_BYTES,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mEL_EXIF_FOUND,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m}[0m[39m ExifLoaderState;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mEL_DATA_FORMAT_UNKNOWN,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39mEL_DATA_FORMAT_EXIF,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39mEL_DATA_FORMAT_JPEG,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mEL_DATA_FORMAT_FUJI_RAW[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m[39m ExifLoaderDataFormat;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m*! \internal *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:struct _ExifLoader [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mExifLoaderState state;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mExifLoaderDataFormat data_format;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[35m/[0m[39m*! Small buffer used for detection of format *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39munsigned char b[0m[1;39m[[0m[1;36m12[0m[1;39m][0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[35m/[0m[39m*! Number of bytes in the small buffer \c b *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39munsigned char b_len;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39munsigned int size;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39munsigned char *buf;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39munsigned int bytes_read;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39munsigned int ref_count;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mExifLog *log;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mExifMem *mem;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[35m/[0m[39m*! Magic number for EXIF header *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static const unsigned char ExifHeader[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x45[0m[39m, [0m[1;36m0x78[0m[39m, [0m[1;36m0x69[0m[39m, [0m[1;36m0x66[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[1;39m}[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:static void *[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m101:e[0m[39mxif_loader_alloc [0m[1;39m([0m[39mExifLoader *l, unsigned int i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mvoid *d;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!l || !i[0m[1;39m)[0m[39m [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39md = exif_mem_alloc [0m[1;39m([0m[39ml->mem, i[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mif [0m[1;39m([0m[39md[0m[1;39m)[0m[39m [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39m        [0m[39mreturn d;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39mEXIF_LOG_NO_MEMORY [0m[1;39m([0m[39ml->log, [0m[32m"ExifLog"[0m[39m, i[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:void[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m117:e[0m[39mxif_loader_write_file [0m[1;39m([0m[39mExifLoader *l, const char *path[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mFILE *f;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mint size;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39munsigned char data[0m[1;39m[[0m[1;36m1024[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!l || !path[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mf = fopen [0m[1;39m([0m[39mpath, [0m[32m"rb"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!f[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39ml->log, EXIF_LOG_CODE_NONE, [0m[32m"ExifLoader"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[1;35m_[0m[1;39m([0m[32m"The file '%s' could not be opened."[0m[1;39m)[0m[39m, path[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mwhile [0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m        [0m[39msize = fread [0m[1;39m([0m[39mdata, [0m[1;36m1[0m[39m, sizeof [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m, f[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39msize <= [0m[1;36m0[0m[1;39m)[0m[39m [0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!exif_loader_write [0m[1;39m([0m[39ml, data, size[0m[1;39m)[0m[1;39m)[0m[39m [0m                            [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mfclose [0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m143:e[0m[39mxif_loader_copy [0m[1;39m([0m[39mExifLoader *eld, unsigned char *buf, unsigned int len[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!eld || [0m[1;39m([0m[39mlen && !buf[0m[1;39m)[0m[39m || [0m[1;39m([0m[39meld->bytes_read >= eld->size[0m[1;39m)[0m[1;39m)[0m[39m [0m               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[35m/[0m[39m* If needed, allocate the buffer. *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!eld->buf[0m[1;39m)[0m[39m [0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39meld->buf = exif_loader_alloc [0m[1;39m([0m[39meld, eld->size[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!eld->buf[0m[1;39m)[0m[39m [0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[35m/[0m[39m* Copy memory *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mlen = MIN [0m[1;39m([0m[39mlen, eld->size - eld->bytes_read[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mmemcpy [0m[1;39m([0m[39meld->buf + eld->bytes_read, buf, len[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39meld->bytes_read += len;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39meld->bytes_read >= eld->size[0m[1;39m)[0m[39m ? [0m[1;36m0[0m[39m : [0m[1;36m1[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:unsigned char[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m163:e[0m[39mxif_loader_write [0m[1;39m([0m[39mExifLoader *eld, unsigned char *buf, unsigned int len[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!eld || [0m[1;39m([0m[39mlen && !buf[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mswitch [0m[1;39m([0m[39meld->state[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mcase EL_EXIF_FOUND:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39m        [0m[39mreturn exif_loader_copy [0m[1;39m([0m[39meld, buf, len[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mcase EL_SKIP_BYTES:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39meld->size > len[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m        [0m[39m        [0m[39meld->size -= len; [0m                                          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn [0m[1;36m1[0m[39m; [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39mlen -= eld->size;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mbuf += eld->size;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[39m        [0m[39meld->size = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[39meld->b_len = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m        [0m[39mswitch [0m[1;39m([0m[39meld->data_format[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39mcase EL_DATA_FORMAT_FUJI_RAW:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[39m        [0m[39meld->state = EL_READ_SIZE_BYTE_24;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[39m        [0m[39mdefault:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39m        [0m[39meld->state = EL_READ;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mcase EL_READ:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!len[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39meld->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifLoader"[0m[39m,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Scanning %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of data..."[0m[39m, len[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:900[0m[39m-[0m[1;36m1100[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39ml = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ml > ds[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39md += l;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mds -= l;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Unknown marker or data. Give up. *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF marker not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m3[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:    [0m[39m        [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[39m        [0m[39md++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[39m        [0m[39mds--;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39md[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | d[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"We have to deal with %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m of EXIF data."[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[39m        [0m[39m  len[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39md += [0m[1;36m2[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[39m        [0m[39mds = len - [0m[1;36m2[0m[39m;   [0m[35m/[0m[39m* we do not want the full rest size, but only the [0m [2m                [0m
[2;36m                    [0m         [39msize of the tag *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:    [0m[39m * Verify the exif header[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m[39m * [0m[1;39m([0m[39moffset [0m[1;36m2[0m[39m, length [0m[1;36m6[0m[1;39m)[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:    [0m[39m        [0m[39mLOG_TOO_SMALL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m936[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m937[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmemcmp [0m[1;39m([0m[39md, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"EXIF header not found."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Found EXIF header."[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:    [0m[35m/[0m[39m* Sanity check the data length *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds < [0m[1;36m14[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[35m/[0m[39m* The JPEG APP1 section can be no longer than [0m[1;36m64[0m[39m KiB [0m[1;39m([0m[39mincluding a[0m          [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:    [0m[39m   [0m[1;36m16[0m[39m-bit length[0m[1;39m)[0m[39m, so cap the data length to protect against overflow[0m       [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[39m   in future offset calculations *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39mfullds = ds;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds > [0m[1;36m0xfffe[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39m        [0m[39mds = [0m[1;36m0xfffe[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[35m/[0m[39m* Byte order [0m[1;39m([0m[39moffset [0m[1;36m6[0m[39m, length [0m[1;36m2[0m[1;39m)[0m[39m *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!memcmp [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:    [0m[39m        [0m[39mdata->priv->order = EXIF_BYTE_ORDER_INTEL;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:    [0m[39melse if [0m[1;39m([0m[39m!memcmp [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:    [0m[39m        [0m[39mdata->priv->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:    [0m[39melse [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"Unknown encoding."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:    [0m[35m/[0m[39m* Fixed value *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:    [0m[39mif [0m[1;39m([0m[39mexif_get_short [0m[1;39m([0m[39md + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m != [0m[1;36m0x002a[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m1[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:    [0m[39mn = exif_get_short [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m + offset, data->priv->order[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:    [0m[35m/[0m[39m* offset < [0m[1;36m2[0m[39m<<[0m[1;36m16[0m[39m, n is [0m[1;36m16[0m[39m bit at most, so this op will not overflow *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m + [0m[1;36m12[0m[39m * n + [0m[1;36m4[0m[39m > ds[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m + offset + [0m[1;36m2[0m[39m + [0m[1;36m12[0m[39m * n, data->priv->order[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"IFD 1 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Sanity check. ds is ensured to be above [0m[1;36m6[0m[39m above, offset is 16bit[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39moffset > ds - [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus offset of IFD1."[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:   [0m[39m        [0m[39m   exif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_1, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39moffset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:   [0m[39m * If we got an EXIF_TAG_MAKER_NOTE, try to interpret it. Some[0m              [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:   [0m[39m * cameras use pointers in the maker note tag that point to the[0m             [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:   [0m[39m * space between IFDs. Here is the only place where we have access[0m          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:   [0m[39m * to that data.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:   [0m[1;35minterpret_maker_note[0m[1;39m([0m[39mdata, d, fullds[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:   [0m[35m/[0m[39m* Fixup tags if requested *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->options & EXIF_DATA_OPTION_FOLLOW_SPECIFICATION[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:   [0m[39m        [0m[39mexif_data_fix [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:void[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m1018:e[0m[39mxif_data_save_data [0m[1;39m([0m[39mExifData *data, unsigned char **d, unsigned int *ds[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1019[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1020[0m[39m:   [0m[39mif [0m[1;39m([0m[39mds[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1021[0m[39m:   [0m[39m        [0m[39m*ds = [0m[1;36m0[0m[39m;        [0m[35m/[0m[39m* This means something went wrong *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m1022[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1023[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!data || !d || !ds[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1024[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1025[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1026[0m[39m:   [0m[35m/[0m[39m* Header *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1027[0m[39m:   [0m[39m*ds = [0m[1;36m14[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1028[0m[39m:   [0m[39m*d = exif_data_alloc [0m[1;39m([0m[39mdata, *ds[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1029[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!*d[0m[1;39m)[0m[39m  [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1030[0m[39m:   [0m[39m        [0m[39m*ds = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1031[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1032[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1033[0m[39m:   [0m[39mmemcpy [0m[1;39m([0m[39m*d, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1034[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1035[0m[39m:   [0m[35m/[0m[39m* Order [0m[1;39m([0m[39moffset [0m[1;36m6[0m[1;39m)[0m[39m *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1036[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->order == EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1037[0m[39m:   [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1038[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1039[0m[39m:   [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:   [0m[35m/[0m[39m* Fixed value [0m[1;39m([0m[1;36m2[0m[39m bytes, offset [0m[1;36m8[0m[1;39m)[0m[39m *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:   [0m[39mexif_set_short [0m[1;39m([0m[39m*d + [0m[1;36m8[0m[39m, data->priv->order, [0m[1;36m0x002a[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:   [0m[39m * IFD [0m[1;36m0[0m[39m offset [0m[1;39m([0m[1;36m4[0m[39m bytes, offset [0m[1;36m10[0m[1;39m)[0m[39m.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:   [0m[39m * We will start [0m[1;36m8[0m[39m bytes after the[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:   [0m[39m * EXIF header [0m[1;39m([0m[1;36m2[0m[39m bytes for order, another [0m[1;36m2[0m[39m for the test, and[0m              [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:   [0m[39m * [0m[1;36m4[0m[39m bytes for the IFD [0m[1;36m0[0m[39m offset make [0m[1;36m8[0m[39m bytes together[0m[1;39m)[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:   [0m[39mexif_set_long [0m[1;39m([0m[39m*d + [0m[1;36m10[0m[39m, data->priv->order, [0m[1;36m8[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:   [0m[35m/[0m[39m* Now save IFD [0m[1;36m0[0m[39m. IFD [0m[1;36m1[0m[39m will be saved automatically. *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:   [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:   [0m[39m        [0m[39m  [0m[32m"Saving IFDs..."[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:   [0m[39mexif_data_save_data_content [0m[1;39m([0m[39mdata, data->ifd[0m[1;39m[[0m[39mEXIF_IFD_0[0m[1;39m][0m[39m, d, ds,[0m            [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m     *ds - [0m[1;36m6[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:   [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:   [0m[39m        [0m[39m  [0m[32m"Saved %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m EXIF data."[0m[39m, *ds[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1062:E[0m[39mxifData *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m1063:e[0m[39mxif_data_new_from_file [0m[1;39m([0m[39mconst char *path[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:   [0m[39mExifData *edata;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:   [0m[39mExifLoader *loader;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:   [0m[39mloader = exif_loader_new [0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:   [0m[39mexif_loader_write_file [0m[1;39m([0m[39mloader, path[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:   [0m[39medata = exif_loader_get_data [0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:   [0m[39mexif_loader_unref [0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:   [0m[39mreturn [0m[1;39m([0m[39medata[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:void[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m1077:e[0m[39mxif_data_ref [0m[1;39m([0m[39mExifData *data[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:   [0m[39mdata->priv->ref_count++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:void[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m1086:e[0m[39mxif_data_unref [0m[1;39m([0m[39mExifData *data[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m[39m [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:   [0m[39mdata->priv->ref_count--;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!data->priv->ref_count[0m[1;39m)[0m[39m [0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:   [0m[39m        [0m[39mexif_data_free [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:void[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m1097:e[0m[39mxif_data_free [0m[1;39m([0m[39mExifData *data[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:   [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:   [0m[39mExifMem *mem = [0m[1;39m([0m[39mdata && data->priv[0m[1;39m)[0m[39m ? data->priv->mem : NULL;[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:200[0m[39m-[0m[1;36m275[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataFuji"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39m  mnote_fuji_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag size overflow [0m  [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[39m        [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m             [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39m        [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m             [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.size = s;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* The data in this case is merely a pointer *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mdataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, n->order[0m[1;39m)[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m + n->offset;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag data [0m   [2m                [0m
[2;36m                    [0m         [32mpast end of "[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"buffer [0m[32m([0m[32m%u >= %u[0m[32m)[0m[32m"[0m[39m, [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs +[0m [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data = exif_mem_alloc [0m[1;39m([0m[39men->mem, s[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dataofs, s[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m268:e[0m[39mxif_mnote_data_fuji_count [0m[1;39m([0m[39mExifMnoteData *n[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39mreturn n ? [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataFuji *[0m[1;39m)[0m[39m n[0m[1;39m)[0m[39m->count : [0m[1;36m0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:static unsigned int[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m274:e[0m[39mxif_mnote_data_fuji_get_id [0m[1;39m([0m[39mExifMnoteData *d, unsigned int n[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:150[0m[39m-[0m[1;36m215[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m2[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m                [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39m        [0m[39mexif_set_long  [0m[1;39m([0m[39m*buf + o + [0m[1;36m4[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39m        [0m[39mo += [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m *[0m                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Corrupt data: EXIF data size is limited to the[0m           [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39m        [0m[39m        [0m[39m * maximum size of a JPEG segment [0m[1;39m([0m[1;36m64[0m[39m kb[0m[1;39m)[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39mts = *buf_size + s;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Ensure even offsets. Set padding bytes to [0m[1;36m0[0m[39m. *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m[39m ts += [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39m        [0m[39mt = exif_mem_realloc [0m[1;39m([0m[39mne->mem, *buf,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m sizeof [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m * ts[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, ts[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf = t;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf_size = ts;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = *buf_size - s;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m doff--; *[0m[1;39m([0m[39m*buf + *buf_size - [0m[1;36m1[0m[1;39m)[0m[39m = [0m[32m'\0'[0m[39m; [0m[1;39m}[0m      [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o, n->order, n->offset + doff[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = o;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m        [0m[39m * Write the data. Fill unneeded bytes with [0m[1;36m0[0m[39m. Do not[0m               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39m * crash if data is NULL.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m memset [0m[1;39m([0m[39m*buf + doff, [0m[1;36m0[0m[39m, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[39m        [0m[39melse memcpy [0m[1;39m([0m[39m*buf + doff, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, s[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms < [0m[1;36m4[0m[1;39m)[0m[39m memset [0m[1;39m([0m[39m*buf + doff + s, [0m[1;36m0[0m[39m, [0m[1;39m([0m[1;36m4[0m[39m - s[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m[35m/[0m[39m* XXX[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m: * FIXME: [0m[1;35mexif_mnote_data_canon_load[0m[1;39m([0m[1;39m)[0m[39m may fail and there is no[0m                 [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m: *        semantics to express that.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m: *        See bug #[0m[1;36m1054323[0m[39m for details, especially the comment by liblit[0m        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m: *        after it has supposedly been fixed:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m: *        [0m                                                                      [2m                [0m
[2;36m                    [0m         [4;94mhttps://sourceforge.net/tracker/?[0m[4;94mfunc[0m[4;94m=[0m[4;94mdetail[0m[4;94m&[0m[4;94maid[0m[4;94m=[0m[4;94m1054323[0m[4;94m&[0m[4;94mgroup_id[0m[4;94m=[0m[4;94m12272[0m[4;94m&[0m[4;94matid[0m[4;94m=[0m[4;94m112272[0m [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m: *        Unfortunately, the [0m[32m"return"[0m[39m statements aren't commented at[0m            [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m: *        all, so it isn't trivial to find out what is a normal[0m                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m: *        return, and what is a reaction to an error condition.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:180[0m[39m-[0m[1;36m250[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[39mdatao -= [0m[1;36m10[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Reset next IFD pointer *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o2 + [0m[1;36m2[0m[39m + n->count * [0m[1;36m12[0m[39m, n->order, [0m[1;36m0[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o2, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->count[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[35m/[0m[39m* Save each entry *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mo = o2 + i * [0m[1;36m12[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m0[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag - base[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m2[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mexif_set_long  [0m[1;39m([0m[39m*buf + o + [0m[1;36m4[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[39m        [0m[39mo += [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m *[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m           [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Corrupt data: EXIF data size is limited to the[0m           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39m        [0m[39m * maximum size of a JPEG segment [0m[1;39m([0m[1;36m64[0m[39m kb[0m[1;39m)[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = *buf_size;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39m        [0m[39mts = *buf_size + s;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39mt = exif_mem_realloc [0m[1;39m([0m[39mne->mem, *buf,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m sizeof [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m * ts[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mts[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf = t;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf_size = ts;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o, n->order, datao + doff[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = o;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Write the data. *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*buf + doff, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Most certainly damaged input file *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemset [0m[1;39m([0m[39m*buf + doff, [0m[1;36m0[0m[39m, s[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[39mxif_mnote_data_olympus_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39m        [0m[39m      const unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m en;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39msize_t i, tcount, o, o2, datao = [0m[1;36m6[0m[39m, base = [0m[1;36m0[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:115[0m[39m-[0m[1;36m124[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:115[0m[39m-[0m[1;36m124[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:126[0m[39m-[0m[1;36m133[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Identify the vulnerable check in libexif/apple/exif-mnote-data-apple.c  [0m         [2m                [0m
[2;36m                    [0m         [39m   In exif_mnote_data_apple_load, after computing:  [0m                                [2m                [0m
[2;36m                    [0m         [39m     • dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mformat[0m[1;39m)[0m[39m * components  [0m                          [2m                [0m
[2;36m                    [0m         [39m     • dofs = [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m ? [0m[1;39m([0m[39md->offset + [0m[33m...[0m[1;39m)[0m[39m : [0m[1;39m([0m[39mofs + [0m[1;36m8[0m[1;39m)[0m[39m  [0m                         [2m                [0m
[2;36m                    [0m         [39m   the code only tests “if [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m … continue;”, which fails to ensure [0m   [2m                [0m
[2;36m                    [0m         [39mthe full dsize bytes lie inside the buffer.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Align the Apple loader’s bounds checking with the safe pattern used in the Fuji,[0m [2m                [0m
[2;36m                    [0m         [39mCanon, and Olympus loaders:  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   • Replace the single‐condition check with a two‐part guard that verifies both:  [0m [2m                [0m
[2;36m                    [0m         [39m     a[0m[1;39m)[0m[39m dofs does not exceed buf_size, and  [0m                                        [2m                [0m
[2;36m                    [0m         [39m     b[0m[1;39m)[0m[39m dsize does not exceed the remaining bytes [0m[1;39m([0m[39mbuf_size – dofs[0m[1;39m)[0m[39m.  [0m              [2m                [0m
[2;36m                    [0m         [39m   • Concretely, change:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m           [0m[1;35mexif_log[0m[1;39m([0m[33m...[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, [0m       [2m                [0m
[2;36m                    [0m         [39mbuf_size[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m           continue;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     to:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mdofs > buf_size || dsize > buf_size - dofs[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m           [0m[1;35mexif_log[0m[1;39m([0m[33m...[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs + [0m      [2m                [0m
[2;36m                    [0m         [39mdsize, buf_size[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m           continue;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Implementation steps:  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m   a. Open libexif/apple/exif-mnote-data-apple.c.  [0m                                 [2m                [0m
[2;36m                    [0m         [39m   b. Locate the loop over tags in exif_mnote_data_apple_load, around lines [0m        [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m–[0m[1;36m124[0m[39m.  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   c. Replace the existing “if [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m” block with the enhanced bounds [0m   [2m                [0m
[2;36m                    [0m         [39mcheck above.  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   d. Adjust the log message to reflect the full requested read [0m[1;39m([0m[39mdofs + dsize vs [0m   [2m                [0m
[2;36m                    [0m         [39mbuf_size[0m[1;39m)[0m[39m.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   e. Recompile and rerun libFuzzer+ASan to confirm the overflow is eliminated and [0m [2m                [0m
[2;36m                    [0m         [39mno regressions occur.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification and preservation of functionality:  [0m                               [2m                [0m
[2;36m                    [0m         [39m   • This patch prevents any memcpy from reading beyond the provided buffer by [0m     [2m                [0m
[2;36m                    [0m         [39mensuring the entire chunk [0m[1;39m[[0m[39mdofs, dofs+dsize[0m[1;39m)[0m[39m is in‐bounds.  [0m                        [2m                [0m
[2;36m                    [0m         [39m   • It mirrors the robust checking patterns already present in other maker‐note [0m   [2m                [0m
[2;36m                    [0m         [39mloaders, ensuring consistency across formats.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m   • Only the Apple loader is modified; all existing logic [0m[1;39m([0m[39mmemory allocation, [0m     [2m                [0m
[2;36m                    [0m         [39mordering, tag parsing[0m[1;39m)[0m[39m remains intact, so functionality for valid inputs is [0m        [2m                [0m
[2;36m                    [0m         [39mpreserved.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   • Upstream callers and fuzz harness code are untouched, maintaining [0m             [2m                [0m
[2;36m                    [0m         [39mcompatibility with existing tests and fuzz targets.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential side effects and mitigation:  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   • Some malformed EXIF streams may now skip Apple maker‐note entries that [0m        [2m                [0m
[2;36m                    [0m         [39mpreviously read partial data; however, this is an appropriate safety trade‐off.  [0m   [2m                [0m
[2;36m                    [0m         [39m   • No new dependencies or API changes are introduced.  [0m                           [2m                [0m
[2;36m                    [0m         [39m   • If performance concerns arise, this simple arithmetic check has negligible [0m    [2m                [0m
[2;36m                    [0m         [39moverhead.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References:  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   • Fuji loader’s [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[39m before memcpy  [0m              [2m                [0m
[2;36m                    [0m         [39m   • Canon loader’s “if [0m[1;39m([0m[39ms > buf_size – data_offset[0m[1;39m)[0m[39m” guard  [0m                       [2m                [0m
[2;36m                    [0m         [39m   • Olympus loader’s similar offset+size check  [0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 10:51:13][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=814031;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=149260;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=197584;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=71852;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgna10ef3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/libexif_ex-delta-01_exif-004/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1767145873.3008687[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-01_exif-[1;36m004.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=526926;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=98580;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=721728;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=616579;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=553939;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=495219;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
