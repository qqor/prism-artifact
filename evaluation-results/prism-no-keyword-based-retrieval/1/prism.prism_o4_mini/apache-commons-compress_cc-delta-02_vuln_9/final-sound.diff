--- a/src/main/java/org/apache/commons/compress/compressors/z/ZCompressorInputStream.java
+++ b/src/main/java/org/apache/commons/compress/compressors/z/ZCompressorInputStream.java
@@ -80,6 +80,13 @@
         }
         blockMode = (thirdByte & BLOCK_MODE_MASK) != 0;
         maxCodeSize = thirdByte & MAX_CODE_SIZE_MASK;
+        // Enforce LZW code size to prevent excessive memory allocation (valid range 9–16)
+        if (maxCodeSize < DEFAULT_CODE_SIZE || maxCodeSize > 16) {
+            throw new IOException(
+                "Invalid LZW max code size: " + maxCodeSize +
+                " (supported range: " + DEFAULT_CODE_SIZE + "–16)"
+            );
+        }
         if (blockMode) {
             setClearCode(DEFAULT_CODE_SIZE);
         }
