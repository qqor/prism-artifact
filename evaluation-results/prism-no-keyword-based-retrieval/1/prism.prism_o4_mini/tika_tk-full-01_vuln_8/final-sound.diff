--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -97,7 +97,8 @@
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
         Path tmpFile = tmpDir.resolve(fileName);
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
+        // Use shell in parse-only mode (-n) to avoid executing attacker-controlled script
+        ProcessBuilder pb = new ProcessBuilder("sh", "-n", fileName);
         pb.directory(tmpDir.toFile());
         try {
             FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
