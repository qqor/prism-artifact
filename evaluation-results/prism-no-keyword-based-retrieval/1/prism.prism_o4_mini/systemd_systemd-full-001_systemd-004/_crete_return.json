{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-004",
  "source_directory": "/home/qqor/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 0.13852960000000003,
    "prompt_tokens": 79192,
    "completion_tokens": 11686
  },
  "variant": "sound",
  "diff": "--- a/src/shared/condition.c\n+++ b/src/shared/condition.c\n@@ -97,12 +97,19 @@\n }\n \n Condition* condition_free_list_type(Condition *head, ConditionType type) {\n-        LIST_FOREACH(conditions, c, head)\n+        Condition **link = &head;\n+        Condition *c;\n+\n+        while ((c = *link)) {\n                 if (type < 0 || c->type == type) {\n-                        condition_free(c);\n+                        *link = c->conditions_next;\n+                        free(c->parameter);\n+                        mfree(c);\n+                } else {\n+                        link = &c->conditions_next;\n                 }\n-\n-        assert(type >= 0 || !head);\n+        }\n+\n         return head;\n }\n \n\n--- a/src/udev/net/link-config.c\n+++ b/src/udev/net/link-config.c\n@@ -61,7 +61,7 @@\n         strv_free(config->dropins);\n \n         net_match_clear(&config->match);\n-        condition_free_list(config->conditions);\n+        config->conditions = condition_free_list(config->conditions);\n \n         free(config->description);\n         strv_free(config->properties);\n",
  "stdout": "",
  "stderr": ""
}