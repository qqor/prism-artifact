--- a/src/reformat.c
+++ b/src/reformat.c
@@ -799,22 +799,34 @@
                         int a, b;
                         if (i % 2 == 0){
                             a = 1;
-                        }else{
+                        } else {
                             a = -1;
                         }
                         if (j % 2 == 0){
                             b = 1;
-                        }else{
+                        } else {
                             b = -1;
                         }
-                        uspill_image[i][j] -= pSpillCb;
-                        vspill_image[i][j] -= pSpillCb;
-                        uspill_image[i+a][j] -= pSpillCb;
-                        vspill_image[i+a][j] -= pSpillCr;
-                        uspill_image[i][j+b] -= pSpillCb;
-                        vspill_image[i][j+b] -= pSpillCr;
-                        uspill_image[i+a][j+b] -= pSpillCb;
-                        vspill_image[i+a][j+b] -= pSpillCr;
+                        // clamp offsets to stay within image boundaries
+                        if ((int)i + a < 0) { a = 0; }
+                        if ((int)j + b < 0) { b = 0; }
+                        if (i + (uint32_t)a >= image->width) { a = 0; }
+                        if (j + (uint32_t)b >= image->height) { b = 0; }
+
+                        uspill_image[i][j]   -= pSpillCb;
+                        vspill_image[i][j]   -= pSpillCr;
+                        if (i + (uint32_t)a < image->width) {
+                            uspill_image[i + a][j]   -= pSpillCb;
+                            vspill_image[i + a][j]   -= pSpillCr;
+                        }
+                        if (j + (uint32_t)b < image->height) {
+                            uspill_image[i][j + b]   -= pSpillCb;
+                            vspill_image[i][j + b]   -= pSpillCr;
+                        }
+                        if ((i + (uint32_t)a < image->width) && (j + (uint32_t)b < image->height)) {
+                            uspill_image[i + a][j + b] -= pSpillCb;
+                            vspill_image[i + a][j + b] -= pSpillCr;
+                        }
                     }   
                 }
             }
