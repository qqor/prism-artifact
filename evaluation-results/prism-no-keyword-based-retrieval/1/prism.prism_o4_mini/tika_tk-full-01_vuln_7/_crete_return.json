{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.7249363000000002,
    "prompt_tokens": 355977,
    "completion_tokens": 75764
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n@@ -19,6 +19,7 @@\n import java.io.Serializable;\n import java.util.HashMap;\n import java.util.Map;\n+import org.apache.tika.config.Field;\n \n public class TextAndCSVConfig implements Serializable {\n \n@@ -55,4 +56,15 @@\n         nameToDelimiterMap.entrySet()\n                           .forEach(e -> delimiterToNameMap.put(e.getValue(), e.getKey()));\n     }\n+\n+    @Field\n+    private boolean allowRemoteResources = false;\n+\n+    public boolean isAllowRemoteResources() {\n+        return allowRemoteResources;\n+    }\n+\n+    public void setAllowRemoteResources(boolean allowRemoteResources) {\n+        this.allowRemoteResources = allowRemoteResources;\n+    }\n }\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -248,6 +248,7 @@\n                              Metadata metadata,\n                              ParseContext context) throws IOException, SAXException {\n         xhtml.startElement(TD);\n+        TextAndCSVConfig config = context.get(TextAndCSVConfig.class, defaultTextAndCSVConfig);\n         Matcher m = HYPERLINK_PATTERN.matcher(cellContent);\n         if (m.find()) {\n             String url = m.group(1);\n@@ -258,7 +259,9 @@\n             xhtml.startElement(\"a\", \"href\", url);\n             xhtml.characters(name);\n             xhtml.endElement(\"a\");\n-            processURL(url, name, xhtml, metadata, context);\n+            if (config.isAllowRemoteResources()) {\n+                processURL(url, name, xhtml, metadata, context);\n+            }\n         } else {\n             xhtml.characters(cellContent);\n         }\n",
  "stdout": "",
  "stderr": ""
}