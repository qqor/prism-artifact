--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -1125,7 +1125,7 @@
             }
         }
 
-        private File getOutputFile(String name, Metadata metadata, MediaType contentType) {
+        private File getOutputFile(String name, Metadata metadata, MediaType contentType) throws IOException {
             String ext = getExtension(contentType);
             if (name.indexOf('.') == -1 && contentType != null) {
                 name += ext;
@@ -1158,12 +1158,21 @@
                 LOG.warn("couldn't url decode name {}", normalizedName);
             }
             File outputFile = new File(extractDir, normalizedName);
-            //if file already exists, prepend uuid
+            // Security check: enforce no path traversal outside extractDir
+            File canonicalBaseDir = extractDir.getCanonicalFile();
+            File canonicalOutputFile = outputFile.getCanonicalFile();
+            String basePath = canonicalBaseDir.getPath();
+            String outputPath = canonicalOutputFile.getPath();
+            if (!outputPath.equals(basePath) && !outputPath.startsWith(basePath + File.separator)) {
+                throw new IOException("Invalid embedded file path (path traversal detected): " + normalizedName);
+            }
+            // Use the resolved canonical path for actual output
+            outputFile = canonicalOutputFile;
+            // if file already exists, prepend uuid
             if (outputFile.exists()) {
                 String fileName = FilenameUtils.getName(normalizedName);
-                outputFile = new File(extractDir, UUID
-                        .randomUUID()
-                        .toString() + "-" + fileName);
+                outputFile = new File(extractDir,
+                        UUID.randomUUID().toString() + "-" + fileName);
             }
             return outputFile;
         }
