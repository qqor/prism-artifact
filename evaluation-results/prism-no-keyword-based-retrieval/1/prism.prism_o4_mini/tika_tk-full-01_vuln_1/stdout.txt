[2;36m[12/22/25 05:35:25][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=867930;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=92995;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp7rvvlgcd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_1/[0m[95magent-output-176[0m [2m               [0m
[2;36m                    [0m         [95m6349325.481036[0m                                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/tika_tk-full-01_vuln_1.toml             [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=869298;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=128842;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:37:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m100.54[0m ]8;id=295492;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=307480;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=842046;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=657521;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=111235;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=566306;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=528893;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=251913;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m100[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=422732;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=64453;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.61[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=420240;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=34271;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/22/25 05:37:08][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=895422;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=855296;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=503994;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=40956;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=155215;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=65344;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=980332;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=981991;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:37:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m2.65[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=289245;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=871864;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=437526;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=595718;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:37:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.59[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=484937;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=189589;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/22/25 05:37:22][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=686597;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=889580;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote [2m                [0m
[2;36m                    [0m         Code Execution                                                                      [2m                [0m
[2;36m                    [0m         Unrestricted class/object creation based on externally controlled data may allow    [2m                [0m
[2;36m                    [0m         remote code execution depending on available classes on the classpath.              [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFinding[0m[1m([0mZer.jav[1;92ma:110[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFindingIfEnabled[0m[1m([0mZer.jav[1;92ma:105[0m[1m)[0m                             [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.readObject[0m[1m([0mZer.jav[1;92ma:377[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1m([0mObjectStreamClass.jav[1;92ma:1231[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readSerialData[0m[1m([0mObjectInputStream.jav[1;92ma:2434[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1m([0mObjectInputStream.jav[1;92ma:2268[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject0[0m[1m([0mObjectInputStream.jav[1;92ma:1744[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:514[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:472[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1m([0mRTFEmbO [2m                [0m
[2;36m                    [0m         bjHandler.jav[1;92ma:217[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1m([0mTextExtractor.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:1475[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:482[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:466[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1m([0mRTFParser.jav[1;92ma:96[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1m([0mRTFParser.jav[1;92ma:70[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.parseOne[0m[1m([0mRTFParserFuzzer.jav[1;92ma:53[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1m([0mRTFParserFuzzer.jav[1;92ma:40[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: aa5f725795b842b8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote [2m                [0m
[2;36m                    [0m         Code Execution                                                                      [2m                [0m
[2;36m                    [0m         Unrestricted class/object creation based on externally controlled data may allow    [2m                [0m
[2;36m                    [0m         remote code execution depending on available classes on the classpath.              [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFinding[0m[1m([0mZer.jav[1;92ma:110[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFindingIfEnabled[0m[1m([0mZer.jav[1;92ma:105[0m[1m)[0m                             [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.readObject[0m[1m([0mZer.jav[1;92ma:377[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1m([0mObjectStreamClass.jav[1;92ma:1231[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readSerialData[0m[1m([0mObjectInputStream.jav[1;92ma:2434[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1m([0mObjectInputStream.jav[1;92ma:2268[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject0[0m[1m([0mObjectInputStream.jav[1;92ma:1744[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:514[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:472[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1m([0mRTFEmbO [2m                [0m
[2;36m                    [0m         bjHandler.jav[1;92ma:217[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1m([0mTextExtractor.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:1475[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:482[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:466[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1m([0mRTFParser.jav[1;92ma:96[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1m([0mRTFParser.jav[1;92ma:70[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.parseOne[0m[1m([0mRTFParserFuzzer.jav[1;92ma:53[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1m([0mRTFParserFuzzer.jav[1;92ma:40[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: aa5f725795b842b8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/22/25 05:37:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=715183;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=488651;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/22/25 05:38:09][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=653135;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=907280;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/22/25 05:38:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=862935;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=488076;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=790722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=559163;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:38:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=429231;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=894644;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=806002;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=152932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpv557mbuc[0m                                                 ]8;id=193347;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=166492;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/22/25 05:39:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m78.43[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=638082;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=920978;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=407966;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=636136;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:40:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m30.02[0m seconds;                ]8;id=465528;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=354890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=909315;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=407220;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:40:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m12.85[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=906867;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=482548;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=357362;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=599028;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=778665;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=73131;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=957612;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=255802;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:40:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=333743;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=945050;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/22/25 05:40:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=4879;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=970948;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:40:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.62[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=714116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=320090;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=395626;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=609375;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/22/25 05:40:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=684128;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=337897;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=725479;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=655048;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr [2m                [0m
[2;36m                    [0m         osoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.ja [2m                [0m
[2;36m                    [0m         va                                                                                  [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr [2m                [0m
[2;36m                    [0m         osoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.ja [2m                [0m
[2;36m                    [0m         va                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-18[0m,[1;36m8[0m +[1;36m18[0m,[1;36m6[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import java.io.IOException;                                                        [2m                [0m
[2;36m                    [0m          import java.io.InputStream;                                                        [2m                [0m
[2;36m                    [0m         -import java.io.ObjectInputStream;                                                  [2m                [0m
[2;36m                    [0m         -import java.nio.charset.StandardCharsets;                                          [2m                [0m
[2;36m                    [0m          import java.util.concurrent.atomic.AtomicInteger;                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.commons.io.FilenameUtils;                                        [2m                [0m
[2;36m                    [0m         @@ [1;36m-211[0m,[1;36m17[0m +[1;36m209[0m,[1;36m13[0m @@                                                               [2m                [0m
[2;36m                    [0m                      [1;35mextractObj[0m[1m([0mbytes, handler, metadata[1m)[0m;                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  [1m}[0m else if [1m([0mstate == EMB_STATE.JAVA_OBJDATA[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         -            try [1m{[0m                                                                  [2m                [0m
[2;36m                    [0m         -                Object obj = new [1;35mObjectInputStream[0m[1m([0m                                [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1m([0m[1m)[0m[1;35m.setByteArray[0m[1m([0mbytes[1m)[0m                    [2m                [0m
[2;36m                    [0m         -                                [1;35m.get[0m[1m([0m[1m)[0m[1m)[0m[1;35m.readObject[0m[1m([0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m         -                [1;35mmetadata.set[0m[1m([0mRTFMetadata.EMB_CLASS, [1;35mobj.getClass[0m[1m([0m[1m)[0m[1;35m.getName[0m[1m([0m[1m)[0m[1m)[0m;     [2m                [0m
[2;36m                    [0m         -                [1;35mmetadata.set[0m[1m([0mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,      [2m                [0m
[2;36m                    [0m         -                        [1;35mMediaType.text[0m[1m([0m[32m"plain"[0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m[1m)[0m;                       [2m                [0m
[2;36m                    [0m         -                [1;35mextractObj[0m[1m([0m[1;35mobj.toString[0m[1m([0m[1m)[0m[1;35m.getBytes[0m[1m([0mStandardCharsets.UTF_8[1m)[0m,        [2m                [0m
[2;36m                    [0m         handler, metadata[1m)[0m;                                                                 [2m                [0m
[2;36m                    [0m         -            [1m}[0m catch [1m([0mClassNotFoundException e[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         -                throw new [1;35mTikaException[0m[1m([0m[32m"Not found"[0m, e[1m)[0m;                           [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            [35m/[0m[35m/[0m Security hardening: skip unsafe deserialization of embedded Java    [2m                [0m
[2;36m                    [0m         objects.                                                                            [2m                [0m
[2;36m                    [0m         +            [1;35mmetadata.set[0m[1m([0mRTFMetadata.EMB_CLASS, [32m"java-object-data"[0m[1m)[0m;               [2m                [0m
[2;36m                    [0m         +            [1;35mmetadata.set[0m[1m([0m                                                          [2m                [0m
[2;36m                    [0m         +                    TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,               [2m                [0m
[2;36m                    [0m         +                    [1;35mMediaType.application[0m[1m([0m[32m"octet-stream"[0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m               [2m                [0m
[2;36m                    [0m         +            [1m)[0m;                                                                     [2m                [0m
[2;36m                    [0m         +            [1;35mextractObj[0m[1m([0mbytes, handler, metadata[1m)[0m;                                  [2m                [0m
[2;36m                    [0m                  [1m}[0m else if [1m([0mstate == EMB_STATE.NADA[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m                      [35m/[0m[35m/[0m[95mswallow...no[0m start for pict or embed?!                               [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote [2m                [0m
[2;36m                    [0m         Code Execution                                                                      [2m                [0m
[2;36m                    [0m         Unrestricted class/object creation based on externally controlled data may allow    [2m                [0m
[2;36m                    [0m         remote code execution depending on available classes on the classpath.              [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFinding[0m[1m([0mZer.jav[1;92ma:110[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFindingIfEnabled[0m[1m([0mZer.jav[1;92ma:105[0m[1m)[0m                             [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.readObject[0m[1m([0mZer.jav[1;92ma:377[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1m([0mObjectStreamClass.jav[1;92ma:1231[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readSerialData[0m[1m([0mObjectInputStream.jav[1;92ma:2434[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1m([0mObjectInputStream.jav[1;92ma:2268[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject0[0m[1m([0mObjectInputStream.jav[1;92ma:1744[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:514[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:472[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1m([0mRTFEmbO [2m                [0m
[2;36m                    [0m         bjHandler.jav[1;92ma:217[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1m([0mTextExtractor.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:1475[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:482[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:466[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1m([0mRTFParser.jav[1;92ma:96[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1m([0mRTFParser.jav[1;92ma:70[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.parseOne[0m[1m([0mRTFParserFuzzer.jav[1;92ma:53[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1m([0mRTFParserFuzzer.jav[1;92ma:40[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: aa5f725795b842b8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A Jazzer fuzzing run triggered a `FuzzerSecurityIssueHigh: Remote Code Execution`   [2m                [0m
[2;36m                    [0m         exception during the parsing of an RTF document. The issue arises when Apache       [2m                [0m
[2;36m                    [0m         Tika’s RTF parser deserializes embedded object data, allowing uncontrolled class or [2m                [0m
[2;36m                    [0m         object creation from untrusted input. The exception was raised deep in the RTF      [2m                [0m
[2;36m                    [0m         parsing stack [1m([0mspecifically in `RTFEmbObjHandler.handleCompletedObject`[1m)[0m,           [2m                [0m
[2;36m                    [0m         indicating a potential remote code execution vulnerability.                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - What the issue is                                                                 [2m                [0m
[2;36m                    [0m           During fuzz testing, untrusted RTF data caused Apache Tika’s RTF parser to invoke [2m                [0m
[2;36m                    [0m         `ObjectInputStream.readObject`, leading to the creation of arbitrary classes or     [2m                [0m
[2;36m                    [0m         objects on the classpath. Jazzer flagged this as a high-severity security issue     [2m                [0m
[2;36m                    [0m         [1m([0m`Remote Code Execution`[1m)[0m.                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Vulnerability type                                                                [2m                [0m
[2;36m                    [0m           The issue is classified as “Remote Code Execution” via unsafe deserialization     [2m                [0m
[2;36m                    [0m         [1m([0munrestricted class/object creation based on externally controlled data[1m)[0m.           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Important observations and findings                                               [2m                [0m
[2;36m                    [0m           • The failure originates in                                                       [2m                [0m
[2;36m                    [0m         `org.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject`,      [2m                [0m
[2;36m                    [0m         which calls Java deserialization routines on embedded object streams.               [2m                [0m
[2;36m                    [0m           • The stack trace shows repeated calls through standard Java serialization        [2m                [0m
[2;36m                    [0m         [1m([0m`ObjectInputStream.readObject0`, etc.[1m)[0m, confirming that deserialization is taking  [2m                [0m
[2;36m                    [0m         place on attacker-controlled data.                                                  [2m                [0m
[2;36m                    [0m           • The RTF parsing harness [1m([0m`com.example.RTFParserFuzzer`[1m)[0m simply feeds data into  [2m                [0m
[2;36m                    [0m         Tika’s `[1;35mRTFParser.parse[0m[1m([0m[33m...[0m[1m)[0m`, indicating that the fuzzing entry point is not the   [2m                [0m
[2;36m                    [0m         root cause but exposed the unsafe behavior in Tika.                                 [2m                [0m
[2;36m                    [0m           • Jazzer’s security report [1m([0m`FuzzerSecurityIssueHigh`[1m)[0m specifically identifies    [2m                [0m
[2;36m                    [0m         the risk of remote code execution if a malicious payload triggers the               [2m                [0m
[2;36m                    [0m         deserialization path.                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Code areas to investigate for a holistic view                                     [2m                [0m
[2;36m                    [0m           [1;36m1[0m. `org.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler` – examine how embedded [2m                [0m
[2;36m                    [0m         OLE/RTF objects are extracted and deserialized.                                     [2m                [0m
[2;36m                    [0m           [1;36m2[0m. `org.apache.tika.parser.microsoft.rtf.TextExtractor` – review how it manages   [2m                [0m
[2;36m                    [0m         object streams and passes them to the handler.                                      [2m                [0m
[2;36m                    [0m           [1;36m3[0m. `org.apache.tika.parser.microsoft.rtf.RTFParser` – trace the parsing logic     [2m                [0m
[2;36m                    [0m         that leads to the invocation of the embedded object handler.                        [2m                [0m
[2;36m                    [0m           [1;36m4[0m. Serialization-related classes in use [1m([0m`ObjectInputStream` flows[1m)[0m to identify   [2m                [0m
[2;36m                    [0m         any unchecked deserialization paths.                                                [2m                [0m
[2;36m                    [0m           [1;36m5[0m. The fuzzing harness [1m([0m`com.example.RTFParserFuzzer`[1m)[0m as a reproducible entry    [2m                [0m
[2;36m                    [0m         point, to ensure that test cases can be replayed against the code under review.     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote[0m [2m                [0m
[2;36m                    [0m         [39mCode Execution[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mUnrestricted class/object creation based on externally controlled data may allow[0m    [2m                [0m
[2;36m                    [0m         [39mremote code execution depending on available classes on the classpath.[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFinding[0m[1;39m([0m[39mZer.jav[0m[1;92ma:110[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFindingIfEnabled[0m[1;39m([0m[39mZer.jav[0m[1;92ma:105[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.readObject[0m[1;39m([0m[39mZer.jav[0m[1;92ma:377[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1;39m([0m[39mNative [0m  [2m                [0m
[2;36m                    [0m         [39mMethod[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1;39m([0m[39mNativeMethodAccessor[0m [2m                [0m
[2;36m                    [0m         [39mImpl.jav[0m[1;92ma:77[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1;39m([0m[39mDelegatingMethod[0m [2m                [0m
[2;36m                    [0m         [39mAccessorImpl.jav[0m[1;92ma:43[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.reflect.Method.invoke[0m[1;39m([0m[39mMethod.jav[0m[1;92ma:568[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1;39m([0m[39mObjectStreamClass.jav[0m[1;92ma:1231[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readSerialData[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2434[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2268[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject0[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:1744[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:514[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:472[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[39mRTFEmbO[0m [2m                [0m
[2;36m                    [0m         [39mbjHandler.jav[0m[1;92ma:217[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1;39m([0m[39mTextExtractor.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1475[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:482[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:466[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:96[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:70[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.parseOne[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: aa5f725795b842b8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:19[0m[39m-[0m[1;36m23[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ObjectInputStream;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:188[0m[39m-[0m[1;36m225[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    protected void [0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        if [0m[1;39m([0m[39mstate == EMB_STATE.OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            RTFObjDataParser objParser = new [0m[1;35mRTFObjDataParser[0m[1;39m([0m[39mmemoryLimitInKb[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                byte[0m[1;39m[[0m[1;39m][0m[39m objBytes = [0m[1;35mobjParser.parse[0m[1;39m([0m[39mbytes, metadata, [0m             [2m                [0m
[2;36m                    [0m         [39munknownFilenameCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[39mobjBytes, handler, metadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.PICT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            String filePath = [0m[1;35mmetadata.get[0m[1;39m([0m[39mRTFMetadata.RTF_PICT_META_PREFIX + [0m  [2m                [0m
[2;36m                    [0m         [32m"wzDescription"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            if [0m[1;39m([0m[39mfilePath != null && [0m[1;35mfilePath.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID, [0m      [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m             [2m                [0m
[2;36m                    [0m         [1;35mFilenameUtils.getName[0m[1;39m([0m[39mfilePath[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.ORIGINAL_RESOURCE_NAME, [0m        [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.THUMBNAIL, [0m[1;35mBoolean.toString[0m[1;39m([0m[39minObject[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39misPictBitmap[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                        TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE, [0m       [2m                [0m
[2;36m                    [0m         [32m"image/x-rtf-raw-bitmap"[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                                [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.NADA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:14[0m [2m                [0m
[2;36m                    [0m         [1;92m65[0m[39m-[0m[1;36m1472[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:        if [0m[1;39m([0m[39mgroupState.objdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:            groupState.objdata = false;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:14[0m [2m                [0m
[2;36m                    [0m         [1;92m73[0m[39m-[0m[1;36m1480[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.javaobjdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:            groupState.javaobjdata = false;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.pictDepth > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:90[0m[39m-[0m[1;36m97[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    public void [0m[1;35mparseInline[0m[1;39m([0m[39mInputStream is, ContentHandler handler, Metadata [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata, ParseContext context[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        RTFEmbObjHandler embObjHandler =[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m                [2m                [0m
[2;36m                    [0m         [1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        final TextExtractor ert = new [0m[1;35mTextExtractor[0m[1;39m([0m[39mhandler, metadata, [0m          [2m                [0m
[2;36m                    [0m         [39membObjHandler[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mert.setIgnoreListMarkup[0m[1;39m([0m[39mignoreListMarkup[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;35mert.extract[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The vulnerability is the unconditional invocation of Java deserialization [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mObjectInputStream.readObject[0m[1;39m)[0m[39m in the `handleCompletedObject` method when `state ==[0m [2m                [0m
[2;36m                    [0m         [39mEMB_STATE.JAVA_OBJDATA`. An attacker-controlled RTF payload can trick Tika into [0m    [2m                [0m
[2;36m                    [0m         [39mdeserializing malicious objects.[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - All other parsing code paths remain valid and must continue to correctly [0m      [2m                [0m
[2;36m                    [0m         [39mhandle embedded object data [0m[1;39m([0m[39mplain OBJDATA, PICT, etc.[0m[1;39m)[0m[39m. Only the Java-object [0m      [2m                [0m
[2;36m                    [0m         [39mbranch is unsafe.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. High-Level Fix[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Eliminate the unsafe deserialization path. Instead of calling `new [0m            [2m                [0m
[2;36m                    [0m         [1;35mObjectInputStream[0m[1;39m([0m[33m...[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m`, treat the raw serialized bytes as [0m            [2m                [0m
[2;36m                    [0m         [39muninterpreted data.  This preserves the ability to extract and hand off embedded [0m   [2m                [0m
[2;36m                    [0m         [39mcontent to downstream handlers—without ever instantiating arbitrary classes.[0m        [2m                [0m
[2;36m                    [0m         [39m   - Update metadata to reflect that the content is now “opaque” data rather than a[0m [2m                [0m
[2;36m                    [0m         [39mdeserialized Java object.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   a. In RTFEmbObjHandler.handleCompletedObject [0m[1;39m([0m[39mlines ~[0m[1;36m213[0m[39m–[0m[1;36m225[0m[1;39m)[0m[39m:[0m                   [2m                [0m
[2;36m                    [0m         [39m      – Remove [0m[1;39m([0m[39mor comment out[0m[1;39m)[0m[39m the entire try-block that constructs an [0m            [2m                [0m
[2;36m                    [0m         [39mObjectInputStream and calls `[0m[1;35mreadObject[0m[1;39m([0m[1;39m)[0m[39m`.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m      – Instead, unconditionally forward the raw byte array [0m[1;39m([0m[39m`bytes`[0m[1;39m)[0m[39m via [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m`.[0m                                             [2m                [0m
[2;36m                    [0m         [39m      – Populate metadata keys to indicate that this was “embedded Java data” but [0m  [2m                [0m
[2;36m                    [0m         [39mwas not deserialized:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m         • `RTFMetadata.EMB_CLASS` = “java-object-data”  [0m                           [2m                [0m
[2;36m                    [0m         [39m         • `TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE` = [0m                     [2m                [0m
[2;36m                    [0m         [39m`application/octet-stream`  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m      – Optionally record a warning in metadata or via [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` to note that Java deserialization was [0m  [2m                [0m
[2;36m                    [0m         [39mskipped for security.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   b. Remove imports that are no longer needed after the patch [0m                     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`java.io.ObjectInputStream`, `java.nio.charset.StandardCharsets` if unused[0m[1;39m)[0m[39m.[0m       [2m                [0m
[2;36m                    [0m         [39m   c. Add a unit test [0m[1;39m([0m[39mor adjust existing ones[0m[1;39m)[0m[39m verifying that RTF streams [0m         [2m                [0m
[2;36m                    [0m         [39mcontaining `JAVA_OBJDATA` no longer throw exceptions, and that the handler receives[0m [2m                [0m
[2;36m                    [0m         [39mthe raw bytes.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - **Security**: By refusing to instantiate untrusted Java classes, we fully [0m     [2m                [0m
[2;36m                    [0m         [39meliminate the unsafe deserialization vector.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m   - **Backward Compatibility**: Consumers still receive the embedded data as a [0m    [2m                [0m
[2;36m                    [0m         [39mbinary blob and can choose to post-process or reimplement safe deserialization [0m     [2m                [0m
[2;36m                    [0m         [39mbehind their own controls. No public API signatures change.  [0m                       [2m                [0m
[2;36m                    [0m         [39m   - **Minimal Impact**: Only a single branch in `handleCompletedObject` is [0m        [2m                [0m
[2;36m                    [0m         [39maltered. All other object and picture handling remain intact.  [0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Side Effects & Mitigation[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - **Behavioral Change**: Downstream users expecting Tika to deserialize embedded[0m [2m                [0m
[2;36m                    [0m         [39mJava objects will now get raw bytes instead of a Java-object’s `[0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m`. This [0m  [2m                [0m
[2;36m                    [0m         [39mis an intentional hardening.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - **Testing**: Add integration tests feeding RTF documents with known [0m           [2m                [0m
[2;36m                    [0m         [39m`JAVA_OBJDATA` payloads. Confirm that:[0m                                              [2m                [0m
[2;36m                    [0m         [39m       * No RCE is possible.[0m                                                        [2m                [0m
[2;36m                    [0m         [39m       * The raw serialized data arrives unmodified.[0m                                [2m                [0m
[2;36m                    [0m         [39m   - **Documentation**: Update Tika’s RTF parser docs to state that embedded Java [0m  [2m                [0m
[2;36m                    [0m         [39mobject deserialization is disabled for security reasons.  [0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Implementation Outline[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   In `RTFEmbObjHandler.java`:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Security hardening: skip unsafe deserialization of embedded Java [0m       [2m                [0m
[2;36m                    [0m         [39mobjects.[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[32m"java-object-data"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmetadata.set[0m[1;39m([0m                                                              [2m                [0m
[2;36m                    [0m         [39m             TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m                       [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mMediaType.application[0m[1;39m([0m[32m"octet-stream"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Forward raw serialized bytes as opaque data[0m                             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   Remove the prior block that performed `new [0m[1;35mObjectInputStream[0m[1;39m([0m[33m...[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m`.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   No changes are required in `RTFParser`, `TextExtractor`, or any harness.  This [0m  [2m                [0m
[2;36m                    [0m         [39mpatch fully resolves the high-severity RCE finding while preserving all other RTF [0m  [2m                [0m
[2;36m                    [0m         [39mparsing behaviors.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=54432;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=618133;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=141891;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=219235;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp7rvvlgcd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-full-01_vuln_1/[0m[95magent-output-176[0m [2m               [0m
[2;36m                    [0m         [95m6349646.7676[0m                                                                         [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/tika_tk-full-01_vuln_1.toml             [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/22/25 05:40:47][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=935386;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=631539;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=412258;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=42530;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=560258;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=741772;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
