[2;36m[12/21/25 23:43:51][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=835416;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=312018;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp2osnifmj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/freerdp_fp-full-01_vuln_004/[0m[95magent-outpu[0m [2m               [0m
[2;36m                    [0m         [95mt-1766328231.1885765[0m                                                                 [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/freerdp_fp-full-01_vuln_004.toml        [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=713272;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=582488;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/21/25 23:44:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=708016;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=775780;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m25.53[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=624306;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=690844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=652255;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=490135;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=453059;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=153937;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m25[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=170620;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=204995;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:44:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.53[0m seconds;               ]8;id=560259;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=965883;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/21/25 23:44:18][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=394929;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=111791;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=691310;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=744939;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=672394;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=571934;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=568782;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=363724;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:44:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.34[0m seconds;               ]8;id=408045;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=218729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=991931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=768950;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:44:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.50[0m seconds;               ]8;id=887456;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=582159;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/21/25 23:44:21][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=958074;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=703255;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x55d7ff177d91[0m bp [1;36m0x7fffa79cbb10[0m sp [1;36m0x7fffa79cbb08[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d7ff177d90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d7ff177d90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d7ff177d90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d7ff17200b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d7ff0ba2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d7fee91efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d7fee19785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d7fee19785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d7fecd0100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d7fecbb375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d7fecc0e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55d7fecec0b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7fe459d1e082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55d7fecb355d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d7feddc099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d7ff0bf9b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d7fee91ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d7fee19785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d7fee19785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d7fecd0100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d7fecbb375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d7fecc0e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d7fecec0b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7fe459d1e082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x55d7ff177d91[0m bp [1;36m0x7fffa79cbb10[0m sp [1;36m0x7fffa79cbb08[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d7ff177d90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d7ff177d90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d7ff177d90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d7ff17200b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d7ff0ba2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d7fee91efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d7fee19785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d7fee19785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d7fecd0100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d7fecbb375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d7fecc0e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55d7fecec0b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7fe459d1e082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55d7fecb355d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d7feddc099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d7ff0bf9b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d7fee91ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d7fee19785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d7fee19785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d7fecd0100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d7fecbb375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d7fecc0e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d7fecec0b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7fe459d1e082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/21/25 23:44:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=73656;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=448341;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/21/25 23:47:22][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=387342;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=445205;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/21/25 23:47:53][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=173966;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=371977;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=185805;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=365471;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=507716;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=990235;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=968631;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=521958;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2qkutn6s[0m                                                 ]8;id=135813;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=305226;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/21/25 23:48:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m21.67[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=713800;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=635894;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=957122;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=201212;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:48:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m14.44[0m seconds;             ]8;id=326618;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=574083;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=790305;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=17394;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:48:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m3.23[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=599956;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=928853;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=977988;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=824867;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=7152;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=591940;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=196089;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=800524;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.49[0m seconds;               ]8;id=556814;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=159886;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/21/25 23:48:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=562953;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=753746;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:48:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.50[0m seconds;               ]8;id=477626;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=635389;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=264395;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=295086;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:48:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.52[0m seconds;               ]8;id=290671;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=789756;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=299861;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=736331;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/core/gcc.c                                                         [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/core/gcc.c                                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-1850[0m,[1;36m15[0m +[1;36m1850[0m,[1;36m29[0m @@                                                             [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0ms[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mmcs[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       const size_t blockLength = [1;35mStream_GetRemainingLength[0m[1m([0ms[1m)[0m;                    [2m                [0m
[2;36m                    [0m         -       if [1m([0mblockLength [1m<[0m[39m [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[35m/[0m[39m* Read and validate channelCount *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [39m+       [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39msize_t rem = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mif [0m[1;39m([0m[39mrem < [0m[1;36m1[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mUINT8 count;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, count[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mif [0m[1;39m([0m[39mcount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mmcs->channelCount = count;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[35m/[0m[39m* Each channel entry is[0m                                            [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m   CHANNEL_NAME_LEN+[0m[1;36m1[0m[39m bytes [0m[1;39m([0m[39mName[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39m      [0m[1;39m([0m[39moptions[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39m      [0m[1;39m([0m[39mChannelId[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m   = entrySize bytes total *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mconst size_t entrySize = [0m[1;39m([0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39msize_t need = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mcount * entrySize;[0m                            [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m < need[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+       [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x519000001d60[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d7ff177d91[0m[39m bp [0m[1;36m0x7fffa79cbb10[0m[39m sp [0m[1;36m0x7fffa79cbb08[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m8[0m[39m at [0m[1;36m0x519000001d60[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in Stream_Read [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in gcc_read_client_network_data [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in gcc_read_client_data_blocks [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7ff17200b[0m[39m in gcc_read_conference_create_request [0m                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7ff0ba2ff[0m[39m in mcs_recv_connect_initial [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7fee91efb[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7fecd0100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7fecbb375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d7fecc0e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7fecec0b2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7fe459d1e082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d7fecb355d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks[0m [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m992[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x519000001980[0m[39m,[0m[1;36m0x519000001d60[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7feddc099[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7ff0bf9b6[0m[39m in mcs_new [0m[35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7fee91ee4[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7fecd0100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7fecbb375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7fecc0e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7fecec0b2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7fe459d1e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request[0m     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m[39m in Stream_Read[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn AddressSanitizer report indicates a heap-based buffer overflow in FreeRDP during[0m [2m                [0m
[2;36m                    [0m         [39ma stream read operation. A write of [0m[1;36m8[0m[39m bytes occurs exactly at the end of a [0m[1;36m992[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mallocation, overrunning by [0m[1;36m0[0m[39m bytes past the valid region. The overflow is detected [0m [2m                [0m
[2;36m                    [0m         [39min `Stream_Read` and propagates through a series of GCC and MCS layer functions [0m    [2m                [0m
[2;36m                    [0m         [39mwhen processing a client’s conference create request. The error is reproducible [0m    [2m                [0m
[2;36m                    [0m         [39munder a fuzzing harness [0m[1;39m([0m[39m`TestFuzzCoreServer`[0m[1;39m)[0m[39m.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue:  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m  A heap-buffer-overflow is reported by AddressSanitizer. The out-of-bounds write [0m  [2m                [0m
[2;36m                    [0m         [39mhappens in `Stream_Read` [0m[1;39m([0m[39mwinpr/stream.h:[0m[1;36m703[0m[1;39m)[0m[39m when invoked by [0m                      [2m                [0m
[2;36m                    [0m         [39m`gcc_read_client_network_data` and further by `gcc_read_client_data_blocks` and [0m    [2m                [0m
[2;36m                    [0m         [39m`gcc_read_conference_create_request`. The write occurs at address `[0m[1;36m0x519000001d60[0m[39m`,[0m [2m                [0m
[2;36m                    [0m         [39mwhich lies immediately after a [0m[1;36m992[0m[39m-byte region allocated via `calloc` in `mcs_new`.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability Type:  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m  The report identifies a heap-based buffer overflow [0m[1;39m([0m[1;36m8[0m[39m-byte write beyond allocated[0m [2m                [0m
[2;36m                    [0m         [39mheap buffer[0m[1;39m)[0m[39m.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Important Observations:  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. The overflow is triggered during parsing of an MCS Connect Initial sequence [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`mcs_recv_connect_initial`[0m[1;39m)[0m[39m.  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. The buffer in question is allocated by `mcs_new` and used by MCS and GCC [0m      [2m                [0m
[2;36m                    [0m         [39mroutines.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. The overflow happens at the boundary of the allocated region, indicating [0m      [2m                [0m
[2;36m                    [0m         [39mmissing or incorrect length validation.  [0m                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. The stack trace is driven by a fuzzing entry point [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput` [0m  [2m                [0m
[2;36m                    [0m         [39min `TestFuzzCoreServer.c`[0m[1;39m)[0m[39m, but the harness itself is not the root cause.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code Areas for Investigation:  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m  • Stream handling macros and functions in winpr/stream.h, especially [0m             [2m                [0m
[2;36m                    [0m         [39m`Stream_Read`.  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m  • GCC layer parsing routines [0m[1;39m([0m[39m`gcc_read_client_network_data`, [0m                    [2m                [0m
[2;36m                    [0m         [39m`gcc_read_client_data_blocks`, `gcc_read_conference_create_request`[0m[1;39m)[0m[39m in [0m            [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.c.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m  • MCS connection routines [0m[1;39m([0m[39m`mcs_recv_connect_initial`, `mcs_new`[0m[1;39m)[0m[39m in [0m             [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.c.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m  • Overall length and boundary checks for data blocks in the MCS/GCC pipeline.  [0m   [2m                [0m
[2;36m                    [0m         [39m  • Interaction between the allocated buffer size [0m[1;39m([0m[1;36m992[0m[39m bytes[0m[1;39m)[0m[39m and the data [0m         [2m                [0m
[2;36m                    [0m         [39mread/write operations through the stream API.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x519000001d60[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d7ff177d91[0m[39m bp [0m[1;36m0x7fffa79cbb10[0m[39m sp [0m[1;36m0x7fffa79cbb08[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m8[0m[39m at [0m[1;36m0x519000001d60[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in Stream_Read [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in gcc_read_client_network_data [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7ff177d90[0m[39m in gcc_read_client_data_blocks [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7ff17200b[0m[39m in gcc_read_conference_create_request [0m                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7ff0ba2ff[0m[39m in mcs_recv_connect_initial [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7fee91efb[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7fecd0100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7fecbb375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d7fecc0e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7fecec0b2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7fe459d1e082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d7fecb355d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks[0m [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m992[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x519000001980[0m[39m,[0m[1;36m0x519000001d60[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7feddc099[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7ff0bf9b6[0m[39m in mcs_new [0m[35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7fee91ee4[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7fee19785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7fecd0100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7fecbb375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7fecc0e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7fecec0b2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7fe459d1e082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request[0m     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m[39m in Stream_Read[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/stream.h:[0m[1;36m698[0m[39m-[0m[1;36m705[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39mstatic INLINE void [0m[1;35mStream_Read[0m[1;39m([0m[39mwStream* _s, void* _b, size_t _n[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_b || [0m[1;39m([0m[39m_n == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[1;35mStream_GetRemainingCapacity[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m >= _n[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:    [0m[39m        [0m[1;35mmemcpy[0m[1;39m([0m[39m_b, [0m[1;39m([0m[39m_s->pointer[0m[1;39m)[0m[39m, [0m[1;39m([0m[39m_n[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39m_s, _n[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:1430[0m[39m-[0m[1;36m1446[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mrdpMcs* mcs = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:   [0m[39mmcs = [0m[1;39m([0m[39mrdpMcs*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[39mmcs->transport = transport;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m[1;36m34[0m[39m, [0m[1;36m2[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->minimumParameters, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0x420[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->maximumParameters, [0m[1;36m0xFFFF[0m[39m, [0m[1;36m0xFC17[0m[39m, [0m[1;36m0xFFFF[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0xFFFF[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->domainParameters, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:   [0m[39mmcs->channelCount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:   [0m[39mmcs->baseChannelId = MCS_GLOBAL_CHANNEL_ID + [0m[1;36m1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:   [0m[39mmcs->channels = [0m[1;39m([0m[39mrdpMcsChannel*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[39mCHANNEL_MAX_COUNT, [0m                  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:350[0m[39m-[0m[1;36m418[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m: * Read a GCC Conference Create Request.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m: * msdn[0m[1;39m{[0m[39mcc240836[0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m: * @param s stream[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m: * @param mcs The MCS instance[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m: * @return \b TRUE for success, \b FALSE otherwise[0m                              [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m360:B[0m[39mOOL [0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:    [0m[39mUINT16 length = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:    [0m[39mBYTE choice = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:    [0m[39mBYTE number = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[39mBYTE selection = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:    [0m[35m/[0m[39m* ConnectData *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_object_identifier[0m[1;39m([0m[39ms, t124_02_98_oid[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[35m/[0m[39m* ConnectDat[0m[1;92ma::c[0m[39monnectPDU [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_length[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:    [0m[35m/[0m[39m* ConnectGCCPDU *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_selection[0m[1;39m([0m[39ms, &selection[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    [0m[35m/[0m[39m* ConferenceCreateRequest::conferenceName *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_numeric_string[0m[1;39m([0m[39ms, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* ConferenceName::numeric *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_padding[0m[1;39m([0m[39ms, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* padding *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[35m/[0m[39m* UserData [0m[1;39m([0m[39mSET OF SEQUENCE[0m[1;39m)[0m[39m *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_number_of_sets[0m[1;39m([0m[39ms, &number[0m[1;39m)[0m[39m || number != [0m[1;36m1[0m[1;39m)[0m[39m [0m[35m/[0m[39m* one set of [0m     [2m                [0m
[2;36m                    [0m         [39mUserData *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[39m    choice != [0m[1;36m0xC0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* UserData::value present + select h221NonStandard [0m[1;39m([0m[1;36m1[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    [0m[35m/[0m[39m* h221NonStandard *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_octet_string[0m[1;39m([0m[39ms, h221_cs_key, [0m[1;36m4[0m[39m,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[39m                           [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* h221NonStandard, client-to-server H.[0m[1;36m221[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mkey, [0m[32m"Duca"[0m[39m *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    [0m[35m/[0m[39m* userData::value [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_length[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, length[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[39ms, mcs, length[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m70[0m[39m-[0m[1;36m140[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mDomainMCSPDU_AttachUserRequest = [0m[1;36m10[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39mDomainMCSPDU_AttachUserConfirm = [0m[1;36m11[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39mDomainMCSPDU_DetachUserRequest = [0m[1;36m12[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mDomainMCSPDU_DetachUserIndication = [0m[1;36m13[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39mDomainMCSPDU_ChannelJoinRequest = [0m[1;36m14[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39mDomainMCSPDU_ChannelJoinConfirm = [0m[1;36m15[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mDomainMCSPDU_ChannelLeaveRequest = [0m[1;36m16[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39mDomainMCSPDU_ChannelConveneRequest = [0m[1;36m17[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mDomainMCSPDU_ChannelConveneConfirm = [0m[1;36m18[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mDomainMCSPDU_ChannelDisbandRequest = [0m[1;36m19[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mDomainMCSPDU_ChannelDisbandIndication = [0m[1;36m20[0m[39m,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39mDomainMCSPDU_ChannelAdmitRequest = [0m[1;36m21[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39mDomainMCSPDU_ChannelAdmitIndication = [0m[1;36m22[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39mDomainMCSPDU_ChannelExpelRequest = [0m[1;36m23[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mDomainMCSPDU_ChannelExpelIndication = [0m[1;36m24[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mDomainMCSPDU_SendDataRequest = [0m[1;36m25[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mDomainMCSPDU_SendDataIndication = [0m[1;36m26[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39mDomainMCSPDU_UniformSendDataRequest = [0m[1;36m27[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39mDomainMCSPDU_UniformSendDataIndication = [0m[1;36m28[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mDomainMCSPDU_TokenGrabRequest = [0m[1;36m29[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mDomainMCSPDU_TokenGrabConfirm = [0m[1;36m30[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mDomainMCSPDU_TokenInhibitRequest = [0m[1;36m31[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39mDomainMCSPDU_TokenInhibitConfirm = [0m[1;36m32[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveRequest = [0m[1;36m33[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveIndication = [0m[1;36m34[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveResponse = [0m[1;36m35[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveConfirm = [0m[1;36m36[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mDomainMCSPDU_TokenPleaseRequest = [0m[1;36m37[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mDomainMCSPDU_TokenPleaseConfirm = [0m[1;36m38[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39mDomainMCSPDU_TokenReleaseRequest = [0m[1;36m39[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39mDomainMCSPDU_TokenReleaseConfirm = [0m[1;36m40[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mDomainMCSPDU_TokenTestRequest = [0m[1;36m41[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[39mDomainMCSPDU_TokenTestConfirm = [0m[1;36m42[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mDomainMCSPDU_enum_length = [0m[1;36m43[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m[39m DomainMCSPDU;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:typedef struct[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39mUINT32 maxChannelIds;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mUINT32 maxUserIds;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39mUINT32 maxTokenIds;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39mUINT32 numPriorities;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39mUINT32 minThroughput;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39mUINT32 maxHeight;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39mUINT32 maxMCSPDUsize;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39mUINT32 protocolVersion;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m[1;39m}[0m[39m DomainParameters;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:struct rdp_mcs[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39mrdpTransport* transport;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mUINT16 userId;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39mUINT16 baseChannelId;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39mUINT16 messageChannelId;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39mUINT32 flags;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39mDomainParameters domainParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mDomainParameters targetParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39mDomainParameters minimumParameters;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1853[0m[39m-[0m[1;36m1861[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m148[0m[39m-[0m[1;36m154[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:#define MCS_SEND_DATA_[0m[1;33mHEAD[0m[39mER_MAX_LENGTH [0m[1;36m8[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:#define MCS_TYPE_CONNECT_INITIAL [0m[1;36m0x65[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:#define MCS_TYPE_CONNECT_RESPONSE [0m[1;36m0x66[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:373[0m[39m-[0m[1;36m385[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_object_identifier[0m[1;39m([0m[39ms, t124_02_98_oid[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[35m/[0m[39m* ConnectDat[0m[1;92ma::c[0m[39monnectPDU [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_length[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:    [0m[35m/[0m[39m* ConnectGCCPDU *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_selection[0m[1;39m([0m[39ms, &selection[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m127[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1847[0m[39m-[0m[1;36m1861[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1847[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1865[0m[39m-[0m[1;36m1875[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview and Root Cause:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - The heap-buffer-overflow stems from `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[1;39m)[0m[39m` using [0m    [2m                [0m
[2;36m                    [0m         [39mincorrect “magic number” checks [0m[1;39m([0m[1;36m4[0m[39m + channelCount * [0m[1;36m12[0m[1;39m)[0m[39m against the stream’s [0m       [2m                [0m
[2;36m                    [0m         [39mremaining bytes and never validating that `channelCount` does not exceed the [0m       [2m                [0m
[2;36m                    [0m         [39mallocated `CHANNEL_MAX_COUNT`. Each channel entry in `mcs->channels` is actually [0m[1;36m8[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mName[0m[1;39m)[0m[39m + [0m[1;36m4[0m[39m [0m[1;39m([0m[39moptions[0m[1;39m)[0m[39m + [0m[1;36m2[0m[39m [0m[1;39m([0m[39mChannelId[0m[1;39m)[0m[39m = [0m[1;36m14[0m[39m bytes, not [0m[1;36m12[0m[39m. Furthermore, [0m              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mStream_Read[0m[1;39m([0m[1;39m)[0m[39m` relies solely on `[0m[1;35massert[0m[1;39m([0m[1;39m)[0m[39m` for bounds checking, so in release [0m     [2m                [0m
[2;36m                    [0m         [39mbuilds it will happily overrun the buffer if the checks are wrong or bypassed.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Strategy to Fix:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   a. In libfreerdp/core/gcc.c, locate `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, [0m   [2m                [0m
[2;36m                    [0m         [39mrdpMcs* mcs[0m[1;39m)[0m[39m`.[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   b. Remove the existing blockLength logic and “[0m[1;36m4[0m[39m + channelCount * [0m[1;36m12[0m[39m” check:[0m      [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        const size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   c. Replace with explicit, correct capacity checks:[0m                               [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[39m* Read and validate channelCount *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [39m        size_t rem = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mrem < [0m[1;36m1[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        UINT8 count;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, count[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mcount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        mcs->channelCount = count;[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[39m* Each channel entry is:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             CHANNEL_NAME_LEN+[0m[1;36m1[0m[39m bytes [0m[1;39m([0m[39mName[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m           + [0m[1;35msizeof[0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39m      [0m[1;39m([0m[39moptions[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m           + [0m[1;35msizeof[0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39m      [0m[1;39m([0m[39mChannelId[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m           = entrySize bytes total[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        size_t entrySize = [0m[1;39m([0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39m + [0m               [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        size_t need = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mcount * entrySize;[0m                                    [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m < need[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   d. Leave the subsequent loop that actually reads each channel’s fields [0m          [2m                [0m
[2;36m                    [0m         [39munchanged, since the above check guarantees the stream has enough data and `count` [0m [2m                [0m
[2;36m                    [0m         [39mfits in the allocated array.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   e. [0m[1;39m([0m[39mOptional[0m[1;39m)[0m[39m For better logging, replace the final `if [0m                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m < need[0m[1;39m)[0m[39m` with:[0m                                        [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, need[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m            return FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      so that on failure a descriptive log is emitted.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Justification:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Corrects the off-by-two-bytes and “magic number” mismatch: we now compute the [0m [2m                [0m
[2;36m                    [0m         [39mper-entry size directly from the channel struct layout rather than assuming “[0m[1;36m12[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes.”[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Prevents an attacker from specifying `channelCount` greater than [0m              [2m                [0m
[2;36m                    [0m         [39m`CHANNEL_MAX_COUNT`, eliminating any possibility of walking off the end of the [0m     [2m                [0m
[2;36m                    [0m         [39m`channels` array.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Leverages the existing API [0m[1;39m([0m[39m`Stream_GetRemainingLength` and optionally [0m        [2m                [0m
[2;36m                    [0m         [39m`Stream_CheckAndLogRequiredLength`[0m[1;39m)[0m[39m to enforce runtime bounds checking instead of [0m  [2m                [0m
[2;36m                    [0m         [39mfragile `[0m[1;35massert[0m[1;39m([0m[1;39m)[0m[39m`‐only guards.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Preservation of Existing Logic and Fuzz Harness:[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - The reading loop and overall structure of `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mremain unchanged once past the new checks. Functional behavior for valid, [0m          [2m                [0m
[2;36m                    [0m         [39mnon-malicious inputs is identical.[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - No modifications to harness, tests, or external dependencies are required; the[0m [2m                [0m
[2;36m                    [0m         [39mpatch only hardens the core parsing code.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Mitigation of Side Effects:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - The only new failure modes are where malformed or deliberately too-large [0m      [2m                [0m
[2;36m                    [0m         [39mchannelCount/stream lengths would previously have overflown memory; now they will [0m  [2m                [0m
[2;36m                    [0m         [39mfail gracefully with `FALSE`.[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - If downstream code expects to see `mcs->channelCount` unchanged on failure, [0m   [2m                [0m
[2;36m                    [0m         [39msetting `mcs->channelCount` only after the range check preserves that invariant.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References in Codebase:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Similar length-checking patterns exist elsewhere in FreeRDP, e.g., in [0m         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[1;39m)[0m[39m` which uses [0m                                  [2m                [0m
[2;36m                    [0m         [39m`Stream_CheckAndLogRequiredLength` before invoking sub-reads. Aligning with that [0m   [2m                [0m
[2;36m                    [0m         [39mpattern ensures consistency.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=409221;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=965877;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=841381;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=431744;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp2osnifmj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/freerdp_fp-full-01_vuln_004/[0m[95magent-outpu[0m [2m               [0m
[2;36m                    [0m         [95mt-1766328516.5139785[0m                                                                 [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/freerdp_fp-full-01_vuln_004.toml        [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=757054;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=744305;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[12/21/25 23:48:37][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=604397;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=838102;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=435187;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=128810;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
