--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1850,15 +1850,29 @@
 	WINPR_ASSERT(s);
 	WINPR_ASSERT(mcs);
 
-	const size_t blockLength = Stream_GetRemainingLength(s);
-	if (blockLength < 4)
-		return FALSE;
-
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
-
+	/* Read and validate channelCount */
+	{
+		size_t rem = Stream_GetRemainingLength(s);
+		if (rem < 1)
+			return FALSE;
+
+		UINT8 count;
+		Stream_Read_UINT8(s, count);
+		if (count > CHANNEL_MAX_COUNT)
+			return FALSE;
+
+		mcs->channelCount = count;
+
+		/* Each channel entry is
+		   CHANNEL_NAME_LEN+1 bytes (Name)
+		 + sizeof(UINT32)      (options)
+		 + sizeof(UINT16)      (ChannelId)
+		   = entrySize bytes total */
+		const size_t entrySize = (CHANNEL_NAME_LEN + 1) + sizeof(UINT32) + sizeof(UINT16);
+		size_t need = (size_t)count * entrySize;
+		if (Stream_GetRemainingLength(s) < need)
+			return FALSE;
+	}
 	if (mcs->channelCount > CHANNEL_MAX_COUNT)
 		return FALSE;
 
