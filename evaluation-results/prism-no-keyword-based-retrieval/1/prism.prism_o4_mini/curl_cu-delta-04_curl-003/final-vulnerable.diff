--- a/lib/doh.c
+++ b/lib/doh.c
@@ -1378,6 +1378,8 @@
                                        &hrr);
       if(result) {
         infof(data, "Failed to decode HTTPS RR");
+        de_cleanup(&de);
+        Curl_doh_cleanup(data);
         return result;
       }
       infof(data, "Some HTTPS RR to process");
