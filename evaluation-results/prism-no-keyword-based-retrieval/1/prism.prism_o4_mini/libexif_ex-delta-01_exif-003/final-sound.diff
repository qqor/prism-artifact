--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,13 +235,19 @@
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
+    static const char apple_sig[] = "Apple iOS";
+    const unsigned int sig_len = sizeof(apple_sig) - 1;
     int variant;
 
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
+    /* Guard against NULL pointers and too-small buffers */
+    if (!e || !e->data || e->size < sig_len)
+        return 0;
+
+    /* Compare only the first sig_len bytes */
+    if (memcmp(e->data, apple_sig, sig_len) == 0)
         variant = 1;
-    } else {
+    else
         variant = 0;
-    }
 
     return variant;
 }
