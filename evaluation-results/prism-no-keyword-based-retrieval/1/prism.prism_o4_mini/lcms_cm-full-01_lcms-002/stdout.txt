[2;36m[12/21/25 23:55:19][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=621225;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=660100;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmps9eg71v_[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/lcms_cm-full-01_lcms-002/[0m[95magent-output-1[0m [2m               [0m
[2;36m                    [0m         [95m766328919.2588208[0m                                                                    [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/lcms_cm-full-01_lcms-[1;36m002.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-little-cms[0m       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=849789;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=218588;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:55:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Building Cached for CLEAN environment[1m)[0m Took [1;36m19.98[0m  ]8;id=515345;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=793186;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=348465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=163465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=971648;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=159333;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=798180;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=632197;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m19[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=269786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=577636;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.44[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=394449;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=538588;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/21/25 23:55:40][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=962443;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=217036;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=33721;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=749124;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=837594;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=184733;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=921615;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=549125;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:55:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=362465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=682055;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=503599;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=913182;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.43[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=831104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=170794;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/21/25 23:55:43][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=717757;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=104990;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcms_virtual_profile_fuzzer[0m                                                 [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer cms_virtual_profile_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m  [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m -[33mdict[0m=[35mcms_virtual_profile_fuzzer[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m               [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m225[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2167618174[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m8001[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c60a8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d7d69c7fe9[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m8001[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c7ff0[0m[39m,[0m[1;36m0x55d7d69e7400[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7fd67e560d24[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x55d7d68dbc2e[0m[39m bp [0m[1;36m0x7ffed37a0690[0m[39m sp [0m[1;36m0x7ffed37a0688[0m                               [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x7fd67e560d24[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m27[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-stack-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d68dbc2d[0m[39m in UnrollChunkyBytes [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7d68f6121[0m[39m in CachedXFORM [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m537:21[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7d68ef011[0m[39m in cmsDoTransform [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m206:5[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in CreateNamedColorDevicelink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1103:9[0m  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1210:20[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7d68a0aaf[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/[0m[95mcms_virtual_profile_fuzzer.c[0m[39m:[0m[1;92m60:35[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7d67553a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7d6740615[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7d67460af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7d6771352[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd67eaf4082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7d67387fd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcms_virtual_profile_fuzzer+0x767fd[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UnrollChunkyBytes--CachedXFORM--cmsDoTransform[0m                         [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7fd67e560d24[0m[39m is located in stack of thread T0 at offset [0m[1;36m36[0m[39m in frame[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d6900a8f[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;36m1185[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: cmsTransform2DeviceLink[0m                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m36[0m[1;39m)[0m[39m [0m[32m'i.i'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1071[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m36[0m[39m overflows this [0m       [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m48[0m[39m, [0m[1;36m52[0m[1;39m)[0m[39m [0m[32m'dwFlags.addr'[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m64[0m[39m, [0m[1;36m68[0m[1;39m)[0m[39m [0m[32m'FrmIn'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m80[0m[39m, [0m[1;36m84[0m[1;39m)[0m[39m [0m[32m'FrmOut'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m96[0m[39m, [0m[1;36m104[0m[1;39m)[0m[39m [0m[32m'LUT'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1191[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560a80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7fd67e560d00[0m[39m: f1 f1 f1 f1[0m[1;39m[[0m[1;36m04[0m[1;39m][0m[39mf2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m00[0m[39m f3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560d80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlcms[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwjia1e17[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer cms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m -[0m[33mdict[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m               [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m225[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2167618174[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m8001[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c60a8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d7d69c7fe9[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m8001[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c7ff0[0m[39m,[0m[1;36m0x55d7d69e7400[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7fd67e560d24[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x55d7d68dbc2e[0m[39m bp [0m[1;36m0x7ffed37a0690[0m[39m sp [0m[1;36m0x7ffed37a0688[0m                               [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x7fd67e560d24[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m27[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-stack-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d68dbc2d[0m[39m in UnrollChunkyBytes [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7d68f6121[0m[39m in CachedXFORM [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m537:21[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7d68ef011[0m[39m in cmsDoTransform [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m206:5[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in CreateNamedColorDevicelink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1103:9[0m  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1210:20[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7d68a0aaf[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/[0m[95mcms_virtual_profile_fuzzer.c[0m[39m:[0m[1;92m60:35[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7d67553a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7d6740615[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7d67460af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7d6771352[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd67eaf4082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7d67387fd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcms_virtual_profile_fuzzer+0x767fd[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UnrollChunkyBytes--CachedXFORM--cmsDoTransform[0m                         [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7fd67e560d24[0m[39m is located in stack of thread T0 at offset [0m[1;36m36[0m[39m in frame[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d6900a8f[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;36m1185[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: cmsTransform2DeviceLink[0m                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m36[0m[1;39m)[0m[39m [0m[32m'i.i'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1071[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m36[0m[39m overflows this [0m       [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m48[0m[39m, [0m[1;36m52[0m[1;39m)[0m[39m [0m[32m'dwFlags.addr'[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m64[0m[39m, [0m[1;36m68[0m[1;39m)[0m[39m [0m[32m'FrmIn'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m80[0m[39m, [0m[1;36m84[0m[1;39m)[0m[39m [0m[32m'FrmOut'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m96[0m[39m, [0m[1;36m104[0m[1;39m)[0m[39m [0m[32m'LUT'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1191[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560a80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x7fd67e560d00[0m: f1 f1 f1 f1[1m[[0m[1;36m04[0m[1m][0mf2 [1;36m04[0m f2 [1;36m04[0m f2 [1;36m04[0m f2 [1;36m00[0m f3 f3 f3                   [2m                [0m
[2;36m                    [0m           [1;36m0x7fd67e560d80[0m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5                   [2m                [0m
[2;36m                    [0m           [1;36m0x7fd67e560e00[0m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5                   [2m                [0m
[2;36m                    [0m           [1;36m0x7fd67e560e80[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7fd67e560f00[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x7fd67e560f80[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlcms[0m:[35m/[0m[95mout[0m -v          [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwjia1e17[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         cms_virtual_profile_fuzzer -[33mruns[0m=[1;36m100[0m.                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/21/25 23:55:49][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=918756;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=817963;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/21/25 23:57:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=586692;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=52426;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/21/25 23:58:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=280169;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=80941;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=13916;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=749417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.46[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=328996;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=145230;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Patching[1m)[0m Started[33m...[0m                                ]8;id=393378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=35096;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpn221plrj[0m                                                 ]8;id=417978;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=379569;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/21/25 23:58:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Patching[1m)[0m Took [1;36m15.64[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=966520;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=205514;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Checking build[1m)[0m Started[33m...[0m                          ]8;id=495656;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=243116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:58:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Checking build[1m)[0m Took [1;36m4.95[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=321405;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=800124;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Running PoV[1m)[0m Started[33m...[0m                             ]8;id=828569;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=357403;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:58:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Running PoV[1m)[0m Took [1;36m1.41[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=957651;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222517;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Testing[1m)[0m Started[33m...[0m                                 ]8;id=971141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=318852;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=194957;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=742503;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=662578;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=530933;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:58:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.45[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=945471;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=425055;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=589104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=885346;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/21/25 23:58:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.48[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=931694;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=303655;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Started[33m...[0m                           ]8;id=222504;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=169187;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlcms Setting owner[1m)[0m Took [1;36m0.46[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=536844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=716973;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=600903;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=480079;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/cmsvirt.c                                                                 [2m                [0m
[2;36m                    [0m         +++ b/src/cmsvirt.c                                                                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-1098[0m,[1;36m9[0m +[1;36m1098[0m,[1;36m32[0m @@                                                              [2m                [0m
[2;36m                    [0m                  [1;35mFLOAT_SH[0m[1m([0m[1;36m0[0m[1m)[0m | [1;35mCOLORSPACE_SH[0m[1m([0m[1;35m_cmsLCMScolorSpace[0m[1m([0mv ->ExitColorSpace[1m)[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                  | [1;35mBYTES_SH[0m[1m([0m[1;36m2[0m[1m)[0m | [1;35mCHANNELS_SH[0m[1m([0m[1;35mcmsChannelsOfColorSpace[0m[1m([0mv ->ExitColorSpace[1m)[0m[1m)[0m[1m)[0m; [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    [35m/[0m[35m/[0m Apply the transfor to colorants.                                            [2m                [0m
[2;36m                    [0m         -    for [1m([0m[33mi[0m=[1;36m0[0m; i [1m<[0m[39m nColors; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, &i, nc2 ->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[35m/[0m[39m Prepare input buffer parameters for named color index[0m                       [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+        cmsUInt32Number InputFmt = v->InputFormat;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+        cmsUInt32Number nChan    = [0m[1;35mT_CHANNELS[0m[1;39m([0m[39mInputFmt[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m+        cmsUInt32Number BPC      = [0m[1;35mT_BYTES[0m[1;39m([0m[39mInputFmt[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m+        cmsUInt32Number Stride   = nChan * BPC;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Apply the transform to colorants.[0m                                       [2m                [0m
[2;36m                    [0m         [39m+        for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < nColors; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m+            cmsUInt8Number inBuf[0m[1;39m[[0m[39mStride[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mmemset[0m[1;39m([0m[39minBuf, [0m[1;36m0[0m[39m, Stride[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            switch [0m[1;39m([0m[39mBPC[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+                case [0m[1;36m1[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+                    inBuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt8Number[0m[1;39m)[0m[39m i;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+                    break;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+                case [0m[1;36m2[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+                    [0m[1;39m([0m[1;39m([0m[39mcmsUInt16Number*[0m[1;39m)[0m[39minBuf[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[39m i;[0m            [2m                [0m
[2;36m                    [0m         [39m+                    break;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+                case [0m[1;36m4[0m[39m:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+                    [0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number*[0m[1;39m)[0m[39minBuf[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[39m i;[0m            [2m                [0m
[2;36m                    [0m         [39m+                    break;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+                default:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+                    [0m[1;35mmemcpy[0m[1;39m([0m[39minBuf, &i, [0m[1;39m([0m[39mStride < [0m[1;35msizeof[0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m)[0m[39m ? Stride : [0m[1;35msizeof[0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, inBuf, nc2->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39m![0m[1;35mcmsWriteTag[0m[1;39m([0m[39mhICC, cmsSigNamedColor2Tag, [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39m nc2[0m[1;39m)[0m[1;39m)[0m[39m goto Error;[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer cms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m -[0m[33mdict[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m               [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m225[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2167618174[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m8001[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c60a8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d7d69c7fe9[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m8001[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c7ff0[0m[39m,[0m[1;36m0x55d7d69e7400[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7fd67e560d24[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x55d7d68dbc2e[0m[39m bp [0m[1;36m0x7ffed37a0690[0m[39m sp [0m[1;36m0x7ffed37a0688[0m                               [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x7fd67e560d24[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m27[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-stack-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d68dbc2d[0m[39m in UnrollChunkyBytes [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7d68f6121[0m[39m in CachedXFORM [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m537:21[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7d68ef011[0m[39m in cmsDoTransform [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m206:5[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in CreateNamedColorDevicelink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1103:9[0m  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1210:20[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7d68a0aaf[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/[0m[95mcms_virtual_profile_fuzzer.c[0m[39m:[0m[1;92m60:35[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7d67553a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7d6740615[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7d67460af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7d6771352[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd67eaf4082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7d67387fd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcms_virtual_profile_fuzzer+0x767fd[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UnrollChunkyBytes--CachedXFORM--cmsDoTransform[0m                         [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7fd67e560d24[0m[39m is located in stack of thread T0 at offset [0m[1;36m36[0m[39m in frame[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d6900a8f[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;36m1185[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: cmsTransform2DeviceLink[0m                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m36[0m[1;39m)[0m[39m [0m[32m'i.i'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1071[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m36[0m[39m overflows this [0m       [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m48[0m[39m, [0m[1;36m52[0m[1;39m)[0m[39m [0m[32m'dwFlags.addr'[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m64[0m[39m, [0m[1;36m68[0m[1;39m)[0m[39m [0m[32m'FrmIn'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m80[0m[39m, [0m[1;36m84[0m[1;39m)[0m[39m [0m[32m'FrmOut'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m96[0m[39m, [0m[1;36m104[0m[1;39m)[0m[39m [0m[32m'LUT'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1191[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560a80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7fd67e560d00[0m[39m: f1 f1 f1 f1[0m[1;39m[[0m[1;36m04[0m[1;39m][0m[39mf2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m00[0m[39m f3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560d80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlcms[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwjia1e17[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA stack-buffer-overflow was detected by AddressSanitizer in the Little CMS codebase[0m [2m                [0m
[2;36m                    [0m         [39mwhen running the `cms_virtual_profile_fuzzer`. The overflow occurs during execution[0m [2m                [0m
[2;36m                    [0m         [39mof the function `UnrollChunkyBytes` in `cmspack.c`, leading to an out-of-bounds [0m    [2m                [0m
[2;36m                    [0m         [39mread on the thread stack. The flaw is exposed through a fuzzer harness [0m             [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m that invokes a color transform path [0m                     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`cmsTransform2DeviceLink`[0m[1;39m)[0m[39m.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type: stack-buffer-overflow [0m[1;39m([0m[1;36m1[0m[39m-byte out-of-bounds read on stack[0m[1;39m)[0m[39m.[0m           [2m                [0m
[2;36m                    [0m         [39m- Detection: AddressSanitizer report triggered during a fuzzer run [0m[1;39m([0m[39m`-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m`[0m[1;39m)[0m[39m on[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/[0m[95mtestcase[0m[39m`.  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Call stack highlights:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. UnrollChunkyBytes [0m[1;39m([0m[39mcmspack.[0m[1;92mc:130[0m[1;39m)[0m[39m  [0m                                            [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. CachedXFORM [0m[1;39m([0m[39mcmsxform.[0m[1;92mc:537[0m[1;39m)[0m[39m  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. cmsDoTransform [0m[1;39m([0m[39mcmsxform.[0m[1;92mc:206[0m[1;39m)[0m[39m  [0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. CreateNamedColorDevicelink [0m[1;39m([0m[39mcmsvirt.[0m[1;92mc:1103[0m[1;39m)[0m[39m  [0m                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. cmsTransform2DeviceLink [0m[1;39m([0m[39mcmsvirt.[0m[1;92mc:1210[0m[39m and frame at line [0m[1;36m1185[0m[1;39m)[0m[39m  [0m              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m6[0m[39m. LLVMFuzzerTestOneInput [0m[1;39m([0m[39mcms_virtual_profile_fuzzer.[0m[1;92mc:60[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Key observations:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  • The overflow is reported at address [0m[1;36m0x7fd67e560d24[0m[39m, which lies immediately [0m     [2m                [0m
[2;36m                    [0m         [39mafter the [0m[1;36m4[0m[39m-byte array `i.i` in the stack frame of `cmsTransform2DeviceLink`.  [0m     [2m                [0m
[2;36m                    [0m         [39m  • AddressSanitizer’s shadow memory shows that byte at offset [0m[1;36m36[0m[39m [0m[1;39m([0m[39mjust beyond the [0m [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m-byte object[0m[1;39m)[0m[39m is being read.  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m  • The vulnerable function `UnrollChunkyBytes` propagates unchecked data leading [0m  [2m                [0m
[2;36m                    [0m         [39mto this invalid stack access.  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m  • This vulnerability is reachable through the named-color device-link [0m            [2m                [0m
[2;36m                    [0m         [39mtransformation path.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code areas to inspect for a holistic view:[0m                                        [2m                [0m
[2;36m                    [0m         [39m  • cmspack.c [0m[1;39m([0m[39mfunction `UnrollChunkyBytes`, data unpacking routines[0m[1;39m)[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [39m  • cmsxform.c [0m[1;39m([0m[39mfunctions `CachedXFORM` and `cmsDoTransform`[0m[1;39m)[0m[39m  [0m                     [2m                [0m
[2;36m                    [0m         [39m  • cmsvirt.c [0m[1;39m([0m[39mfunctions `CreateNamedColorDevicelink` and [0m                          [2m                [0m
[2;36m                    [0m         [39m`cmsTransform2DeviceLink`, stack-allocated buffers and struct layout[0m[1;39m)[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [39m  • The definitions of the variables allocated on the stack in [0m                     [2m                [0m
[2;36m                    [0m         [39m`cmsTransform2DeviceLink` [0m[1;39m([0m[39me.g., `i.i`, `FrmIn`, `FrmOut`, `LUT`[0m[1;39m)[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo assumptions about the cause beyond the overflow itself are made. The fuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mharness code serves only to trigger the issue and is not implicated in the root [0m    [2m                [0m
[2;36m                    [0m         [39mcause.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer cms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m -[0m[33mdict[0m[39m=[0m[35mcms_virtual_profile_fuzzer[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m               [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m225[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2167618174[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m8001[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c60a8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55d7d69c7fe9[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m8001[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m8001[0m[39m [0m[1;39m[[0m[1;36m0x55d7d69c7ff0[0m[39m,[0m[1;36m0x55d7d69e7400[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcms_virtual_profile_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: stack-buffer-overflow on address [0m[1;36m0x7fd67e560d24[0m[39m at [0m  [2m                [0m
[2;36m                    [0m         [39mpc [0m[1;36m0x55d7d68dbc2e[0m[39m bp [0m[1;36m0x7ffed37a0690[0m[39m sp [0m[1;36m0x7ffed37a0688[0m                               [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x7fd67e560d24[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m27[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-stack-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d68dbc2d[0m[39m in UnrollChunkyBytes [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d7d68f6121[0m[39m in CachedXFORM [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m537:21[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d7d68ef011[0m[39m in cmsDoTransform [0m[35m/src/lcms/src/[0m[95mcmsxform.c[0m[39m:[0m[1;92m206:5[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in CreateNamedColorDevicelink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1103:9[0m  [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d7d6900dd8[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;92m1210:20[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d7d68a0aaf[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/[0m[95mcms_virtual_profile_fuzzer.c[0m[39m:[0m[1;92m60:35[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d7d67553a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d7d6740615[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d7d67460af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d7d6771352[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd67eaf4082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d7d67387fd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcms_virtual_profile_fuzzer+0x767fd[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UnrollChunkyBytes--CachedXFORM--cmsDoTransform[0m                         [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x7fd67e560d24[0m[39m is located in stack of thread T0 at offset [0m[1;36m36[0m[39m in frame[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d7d6900a8f[0m[39m in cmsTransform2DeviceLink [0m[35m/src/lcms/src/[0m[95mcmsvirt.c[0m[39m:[0m[1;36m1185[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: cmsTransform2DeviceLink[0m                                                [2m                [0m
[2;36m                    [0m         [39m  This frame has [0m[1;36m5[0m[39m [0m[1;35mobject[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m32[0m[39m, [0m[1;36m36[0m[1;39m)[0m[39m [0m[32m'i.i'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1071[0m[1;39m)[0m[39m <== Memory access at offset [0m[1;36m36[0m[39m overflows this [0m       [2m                [0m
[2;36m                    [0m         [39mvariable[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m48[0m[39m, [0m[1;36m52[0m[1;39m)[0m[39m [0m[32m'dwFlags.addr'[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m64[0m[39m, [0m[1;36m68[0m[1;39m)[0m[39m [0m[32m'FrmIn'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m80[0m[39m, [0m[1;36m84[0m[1;39m)[0m[39m [0m[32m'FrmOut'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1187[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m[[0m[1;36m96[0m[39m, [0m[1;36m104[0m[1;39m)[0m[39m [0m[32m'LUT'[0m[39m [0m[1;39m([0m[39mline [0m[1;36m1191[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mHINT: this may be a false positive if your program uses some custom stack unwind [0m   [2m                [0m
[2;36m                    [0m         [39mmechanism, swapcontext or vfork[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m([0m[39mlongjmp and C++ exceptions *are* supported[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: stack-buffer-overflow [0m[35m/src/lcms/src/[0m[95mcmspack.c[0m[39m:[0m[1;92m130:13[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560a80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560b80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560c80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x7fd67e560d00[0m[39m: f1 f1 f1 f1[0m[1;39m[[0m[1;36m04[0m[1;39m][0m[39mf2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m04[0m[39m f2 [0m[1;36m00[0m[39m f3 f3 f3[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560d80[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e00[0m[39m: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560e80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x7fd67e560f80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlcms[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpwjia1e17[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmspack.[0m[1;92mc:94[0m[39m-[0m[1;36m154[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m[35m/[0m[35m/[0m[39m Does almost everything but is slow[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:static[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m96:c[0m[39mmsUInt8Number* [0m[1;35mUnrollChunkyBytes[0m[1;39m([0m[39mCMSREGISTER _cmsTRANSFORM* info,[0m               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                                  CMSREGISTER cmsUInt16Number wIn[0m[1;39m[[0m[1;39m][0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                                  CMSREGISTER cmsUInt8Number* accum,[0m             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                                  CMSREGISTER cmsUInt32Number Stride[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    cmsUInt32Number nChan      = [0m[1;35mT_CHANNELS[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    cmsUInt32Number DoSwap     = [0m[1;35mT_DOSWAP[0m[1;39m([0m[39minfo ->InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    cmsUInt32Number Reverse    = [0m[1;35mT_FLAVOR[0m[1;39m([0m[39minfo ->InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    cmsUInt32Number SwapFirst  = [0m[1;35mT_SWAPFIRST[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    cmsUInt32Number Extra      = [0m[1;35mT_EXTRA[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    cmsUInt32Number Premul     = [0m[1;35mT_PREMUL[0m[1;39m([0m[39minfo->InputFormat[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    cmsUInt32Number v;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    cmsUInt32Number i;  [0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    cmsUInt32Number alpha_factor = [0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    if [0m[1;39m([0m[39mExtraFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mPremul && Extra[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            alpha_factor = [0m[1;35m_cmsToFixedDomain[0m[1;39m([0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39maccum[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        accum += Extra;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        if [0m[1;39m([0m[39mPremul && Extra[0m[1;39m)[0m[39m        [0m                                            [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            alpha_factor = [0m[1;35m_cmsToFixedDomain[0m[1;39m([0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39maccum[0m[1;39m[[0m[39mnChan[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    for [0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i < nChan; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        cmsUInt32Number index = DoSwap ? [0m[1;39m([0m[39mnChan - i - [0m[1;36m1[0m[1;39m)[0m[39m : i;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        v = [0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39m*accum[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        v = Reverse ? [0m[1;35mREVERSE_FLAVOR_16[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m : v;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mPremul && alpha_factor > [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            v = [0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[39mv << [0m[1;36m16[0m[1;39m)[0m[39m [0m[35m/[0m[39m alpha_factor[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            if [0m[1;39m([0m[39mv > [0m[1;36m0xffff[0m[1;39m)[0m[39m v = [0m[1;36m0xffff[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        wIn[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[39m v;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        accum++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    if [0m[1;39m([0m[39m!ExtraFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        accum += Extra;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    if [0m[1;39m([0m[39mExtra == [0m[1;36m0[0m[39m && SwapFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        cmsUInt16Number tmp = wIn[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;35mmemmove[0m[1;39m([0m[39m&wIn[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, &wIn[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m[1;39m([0m[39mnChan-[0m[1;36m1[0m[1;39m)[0m[39m * [0m[1;35msizeof[0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        wIn[0m[1;39m[[0m[39mnChan-[0m[1;36m1[0m[1;39m][0m[39m = tmp;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    return accum;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmsvirt.[0m[1;92mc:1203[0m[39m-[0m[1;36m1212[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get the first mpe to check for named color[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:    mpe = [0m[1;35mcmsPipelineGetPtrToFirstStage[0m[1;39m([0m[39mxform ->Lut[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:    [0m[35m/[0m[35m/[0m[39m Check if is a named color transform[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:    if [0m[1;39m([0m[39mmpe != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:        if [0m[1;39m([0m[1;35mcmsStageType[0m[1;39m([0m[39mmpe[0m[1;39m)[0m[39m == cmsSigNamedColorElemType[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:            return [0m[1;35mCreateNamedColorDevicelink[0m[1;39m([0m[39mhTransform[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmsvirt.[0m[1;92mc:1067[0m[39m-[0m[1;36m1105[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1067:c[0m[39mmsHPROFILE [0m[1;35mCreateNamedColorDevicelink[0m[1;39m([0m[39mcmsHTRANSFORM xform[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:    _cmsTRANSFORM* v = [0m[1;39m([0m[39m_cmsTRANSFORM*[0m[1;39m)[0m[39m xform;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:    cmsHPROFILE hICC = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:    cmsUInt32Number i, nColors;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:    cmsNAMEDCOLORLIST *nc2 = NULL, *Original = NULL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:    [0m[35m/[0m[35m/[0m[39m Create an empty placeholder[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:    hICC = [0m[1;35mcmsCreateProfilePlaceholder[0m[1;39m([0m[39mv->ContextID[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:    if [0m[1;39m([0m[39mhICC == NULL[0m[1;39m)[0m[39m return NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[35m/[0m[35m/[0m[39m Critical information[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:    [0m[1;35mcmsSetDeviceClass[0m[1;39m([0m[39mhICC, cmsSigNamedColorClass[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:    [0m[1;35mcmsSetColorSpace[0m[1;39m([0m[39mhICC, v ->ExitColorSpace[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:    [0m[1;35mcmsSetPCS[0m[1;39m([0m[39mhICC, cmsSigLabData[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:    [0m[35m/[0m[35m/[0m[39m Tag profile with information[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mSetTextTags[0m[1;39m([0m[39mhICC, L"Named color devicelink"[0m[1;39m)[0m[1;39m)[0m[39m goto Error;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:    Original = [0m[1;35mcmsGetNamedColorList[0m[1;39m([0m[39mxform[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:    if [0m[1;39m([0m[39mOriginal == NULL[0m[1;39m)[0m[39m goto Error;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:    nColors = [0m[1;35mcmsNamedColorCount[0m[1;39m([0m[39mOriginal[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:    nc2     = [0m[1;35mcmsDupNamedColorList[0m[1;39m([0m[39mOriginal[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:    if [0m[1;39m([0m[39mnc2 == NULL[0m[1;39m)[0m[39m goto Error;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:    [0m[35m/[0m[35m/[0m[39m Colorant count now depends on the output space[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:    nc2 ->ColorantCount = [0m[1;35mcmsPipelineOutputChannels[0m[1;39m([0m[39mv ->Lut[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make sure we have proper formatters[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:    [0m[1;35mcmsChangeBuffersFormat[0m[1;39m([0m[39mxform, TYPE_NAMED_COLOR_INDEX,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:        [0m[1;35mFLOAT_SH[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m | [0m[1;35mCOLORSPACE_SH[0m[1;39m([0m[1;35m_cmsLCMScolorSpace[0m[1;39m([0m[39mv ->ExitColorSpace[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:        | [0m[1;35mBYTES_SH[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m | [0m[1;35mCHANNELS_SH[0m[1;39m([0m[1;35mcmsChannelsOfColorSpace[0m[1;39m([0m[39mv [0m                 [2m                [0m
[2;36m                    [0m         [39m->ExitColorSpace[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:    [0m[35m/[0m[35m/[0m[39m Apply the transfor to colorants.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:    for [0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i < nColors; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:        [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, &i, nc2 ->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmspack.[0m[1;92mc:94[0m[39m-[0m[1;36m154[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m[35m/[0m[35m/[0m[39m Does almost everything but is slow[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:static[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m96:c[0m[39mmsUInt8Number* [0m[1;35mUnrollChunkyBytes[0m[1;39m([0m[39mCMSREGISTER _cmsTRANSFORM* info,[0m               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                                  CMSREGISTER cmsUInt16Number wIn[0m[1;39m[[0m[1;39m][0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                                  CMSREGISTER cmsUInt8Number* accum,[0m             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                                  CMSREGISTER cmsUInt32Number Stride[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    cmsUInt32Number nChan      = [0m[1;35mT_CHANNELS[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    cmsUInt32Number DoSwap     = [0m[1;35mT_DOSWAP[0m[1;39m([0m[39minfo ->InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    cmsUInt32Number Reverse    = [0m[1;35mT_FLAVOR[0m[1;39m([0m[39minfo ->InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    cmsUInt32Number SwapFirst  = [0m[1;35mT_SWAPFIRST[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    cmsUInt32Number Extra      = [0m[1;35mT_EXTRA[0m[1;39m([0m[39minfo -> InputFormat[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    cmsUInt32Number Premul     = [0m[1;35mT_PREMUL[0m[1;39m([0m[39minfo->InputFormat[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    cmsUInt32Number v;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    cmsUInt32Number i;  [0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    cmsUInt32Number alpha_factor = [0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    if [0m[1;39m([0m[39mExtraFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mPremul && Extra[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            alpha_factor = [0m[1;35m_cmsToFixedDomain[0m[1;39m([0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39maccum[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        accum += Extra;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        if [0m[1;39m([0m[39mPremul && Extra[0m[1;39m)[0m[39m        [0m                                            [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            alpha_factor = [0m[1;35m_cmsToFixedDomain[0m[1;39m([0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39maccum[0m[1;39m[[0m[39mnChan[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    for [0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i < nChan; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        cmsUInt32Number index = DoSwap ? [0m[1;39m([0m[39mnChan - i - [0m[1;36m1[0m[1;39m)[0m[39m : i;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        v = [0m[1;35mFROM_8_TO_16[0m[1;39m([0m[39m*accum[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        v = Reverse ? [0m[1;35mREVERSE_FLAVOR_16[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m : v;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mPremul && alpha_factor > [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            v = [0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[39mv << [0m[1;36m16[0m[1;39m)[0m[39m [0m[35m/[0m[39m alpha_factor[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            if [0m[1;39m([0m[39mv > [0m[1;36m0xffff[0m[1;39m)[0m[39m v = [0m[1;36m0xffff[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        wIn[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[39m v;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        accum++;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    if [0m[1;39m([0m[39m!ExtraFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        accum += Extra;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    if [0m[1;39m([0m[39mExtra == [0m[1;36m0[0m[39m && SwapFirst[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        cmsUInt16Number tmp = wIn[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;35mmemmove[0m[1;39m([0m[39m&wIn[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, &wIn[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m[1;39m([0m[39mnChan-[0m[1;36m1[0m[1;39m)[0m[39m * [0m[1;35msizeof[0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        wIn[0m[1;39m[[0m[39mnChan-[0m[1;36m1[0m[1;39m][0m[39m = tmp;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    return accum;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmsvirt.[0m[1;92mc:1203[0m[39m-[0m[1;36m1212[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get the first mpe to check for named color[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:    mpe = [0m[1;35mcmsPipelineGetPtrToFirstStage[0m[1;39m([0m[39mxform ->Lut[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:    [0m[35m/[0m[35m/[0m[39m Check if is a named color transform[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:    if [0m[1;39m([0m[39mmpe != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:        if [0m[1;39m([0m[1;35mcmsStageType[0m[1;39m([0m[39mmpe[0m[1;39m)[0m[39m == cmsSigNamedColorElemType[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:            return [0m[1;35mCreateNamedColorDevicelink[0m[1;39m([0m[39mhTransform[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/cmsvirt.[0m[1;92mc:1067[0m[39m-[0m[1;36m1105[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1067:c[0m[39mmsHPROFILE [0m[1;35mCreateNamedColorDevicelink[0m[1;39m([0m[39mcmsHTRANSFORM xform[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:    _cmsTRANSFORM* v = [0m[1;39m([0m[39m_cmsTRANSFORM*[0m[1;39m)[0m[39m xform;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:    cmsHPROFILE hICC = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:    cmsUInt32Number i, nColors;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:    cmsNAMEDCOLORLIST *nc2 = NULL, *Original = NULL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:    [0m[35m/[0m[35m/[0m[39m Create an empty placeholder[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:    hICC = [0m[1;35mcmsCreateProfilePlaceholder[0m[1;39m([0m[39mv->ContextID[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:    if [0m[1;39m([0m[39mhICC == NULL[0m[1;39m)[0m[39m return NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[35m/[0m[35m/[0m[39m Critical information[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:    [0m[1;35mcmsSetDeviceClass[0m[1;39m([0m[39mhICC, cmsSigNamedColorClass[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:    [0m[1;35mcmsSetColorSpace[0m[1;39m([0m[39mhICC, v ->ExitColorSpace[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:    [0m[1;35mcmsSetPCS[0m[1;39m([0m[39mhICC, cmsSigLabData[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:    [0m[35m/[0m[35m/[0m[39m Tag profile with information[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mSetTextTags[0m[1;39m([0m[39mhICC, L"Named color devicelink"[0m[1;39m)[0m[1;39m)[0m[39m goto Error;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:    Original = [0m[1;35mcmsGetNamedColorList[0m[1;39m([0m[39mxform[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:    if [0m[1;39m([0m[39mOriginal == NULL[0m[1;39m)[0m[39m goto Error;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:    nColors = [0m[1;35mcmsNamedColorCount[0m[1;39m([0m[39mOriginal[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:    nc2     = [0m[1;35mcmsDupNamedColorList[0m[1;39m([0m[39mOriginal[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:    if [0m[1;39m([0m[39mnc2 == NULL[0m[1;39m)[0m[39m goto Error;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:    [0m[35m/[0m[35m/[0m[39m Colorant count now depends on the output space[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:    nc2 ->ColorantCount = [0m[1;35mcmsPipelineOutputChannels[0m[1;39m([0m[39mv ->Lut[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make sure we have proper formatters[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:    [0m[1;35mcmsChangeBuffersFormat[0m[1;39m([0m[39mxform, TYPE_NAMED_COLOR_INDEX,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:        [0m[1;35mFLOAT_SH[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m | [0m[1;35mCOLORSPACE_SH[0m[1;39m([0m[1;35m_cmsLCMScolorSpace[0m[1;39m([0m[39mv ->ExitColorSpace[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:        | [0m[1;35mBYTES_SH[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m | [0m[1;35mCHANNELS_SH[0m[1;39m([0m[1;35mcmsChannelsOfColorSpace[0m[1;39m([0m[39mv [0m                 [2m                [0m
[2;36m                    [0m         [39m->ExitColorSpace[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:    [0m[35m/[0m[35m/[0m[39m Apply the transfor to colorants.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:    for [0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i < nColors; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:        [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, &i, nc2 ->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - In CreateNamedColorDevicelink [0m[1;39m([0m[39mcmsvirt.c[0m[1;39m)[0m[39m, the loop[0m                            [2m                [0m
[2;36m                    [0m         [39m        for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < nColors; i++[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, &i, nc2->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m     passes a pointer to a [0m[1;36m4[0m[39m-byte stack variable `i` as the input buffer.[0m           [2m                [0m
[2;36m                    [0m         [39m   - Downstream, UnrollChunkyBytes [0m[1;39m([0m[39mcmspack.c[0m[1;39m)[0m[39m unpacks [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mT_CHANNELS[0m[1;39m([0m[39minfo->InputFormat[0m[1;39m)[0m[39m` bytes from that pointer, overrunning the [0m[1;36m4[0m[39m-byte [0m    [2m                [0m
[2;36m                    [0m         [39minteger and triggering the AddressSanitizer one-byte OOB read.[0m                      [2m                [0m
[2;36m                    [0m         [39m   - The fix is to supply cmsDoTransform with an actual byte buffer on the stack [0m   [2m                [0m
[2;36m                    [0m         [39msized to exactly the transform’s input stride [0m[1;39m([0m[39mbytes_per_channel × n_channels[0m[1;39m)[0m[39m, and[0m [2m                [0m
[2;36m                    [0m         [39mto pack the named-color index into that buffer, rather than relying on `&i`.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Outline [0m[1;39m([0m[39mno harness or external code changes[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m   A. In cmsvirt.c, within CreateNamedColorDevicelink:[0m                              [2m                [0m
[2;36m                    [0m         [39m      a. Retrieve the transform’s input format and compute:[0m                         [2m                [0m
[2;36m                    [0m         [39m         - `cmsUInt32Number InputFmt = v->InputFormat;`[0m                             [2m                [0m
[2;36m                    [0m         [39m         - `cmsUInt32Number nChan    = [0m[1;35mT_CHANNELS[0m[1;39m([0m[39mInputFmt[0m[1;39m)[0m[39m;`[0m                       [2m                [0m
[2;36m                    [0m         [39m         - `cmsUInt32Number BPC      = [0m[1;35mT_BYTES[0m[1;39m([0m[39mInputFmt[0m[1;39m)[0m[39m;`    [0m[35m/[0m[35m/[0m[39m bytes per channel[0m  [2m                [0m
[2;36m                    [0m         [39m         - `cmsUInt32Number Stride   = nChan * BPC;`[0m                                [2m                [0m
[2;36m                    [0m         [39m      b. At the top of the loop, declare a local byte buffer sized to Stride:[0m       [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         cmsUInt8Number inBuf[0m[1;39m[[0m[39m [0m[35m/[0m[39m* e.g. max [0m[1;36m16[0m[39m bytes *[0m[35m/[0m[39m [0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m([0m[39mOr use a VLA if enabled: `cmsUInt8Number inBuf[0m[1;39m[[0m[39mStride[0m[1;39m][0m[39m;`[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m      c. Zero-initialize the buffer:[0m                                                [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mmemset[0m[1;39m([0m[39minBuf, [0m[1;36m0[0m[39m, Stride[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      d. Pack the current index `i` into `inBuf` according to BPC:[0m                  [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         switch [0m[1;39m([0m[39mBPC[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [39m           case [0m[1;36m1[0m[39m:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             inBuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt8Number[0m[1;39m)[0m[39mi;[0m                                          [2m                [0m
[2;36m                    [0m         [39m             break;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m           case [0m[1;36m2[0m[39m:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m([0m[1;39m([0m[39mcmsUInt16Number*[0m[1;39m)[0m[39minBuf[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt16Number[0m[1;39m)[0m[39mi;[0m                     [2m                [0m
[2;36m                    [0m         [39m             break;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m           case [0m[1;36m4[0m[39m:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m([0m[1;39m([0m[39mcmsUInt32Number*[0m[1;39m)[0m[39minBuf[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mcmsUInt32Number[0m[1;39m)[0m[39mi;[0m                     [2m                [0m
[2;36m                    [0m         [39m             break;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m           default:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m Fallback: copy up to Stride bytes from &i[0m                           [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mmemcpy[0m[1;39m([0m[39minBuf, &i, [0m[1;35mmin[0m[1;39m([0m[39mStride, [0m[1;35msizeof[0m[1;39m([0m[39mi[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      e. Replace the existing call[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, &i,[0m                                                  [2m                [0m
[2;36m                    [0m         [39m                        nc2->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         with[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mcmsDoTransform[0m[1;39m([0m[39mxform, inBuf,[0m                                               [2m                [0m
[2;36m                    [0m         [39m                        nc2->List[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.DeviceColorant, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   B. Rationale[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m      - `inBuf` is guaranteed to be at least `Stride` bytes long, so [0m               [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes and its brethren will never read out-of-bounds.[0m                   [2m                [0m
[2;36m                    [0m         [39m      - Packing the integer manually matches the unpack logic’s expectations: it [0m   [2m                [0m
[2;36m                    [0m         [39mreads `nChan` channels of `BPC` bytes per channel.[0m                                  [2m                [0m
[2;36m                    [0m         [39m      - Does not alter any harness or fuzzer logic, preserves existing tests, and [0m  [2m                [0m
[2;36m                    [0m         [39monly touches the named-color devicelink path.[0m                                       [2m                [0m
[2;36m                    [0m         [39m   C. Edge-case Considerations[0m                                                      [2m                [0m
[2;36m                    [0m         [39m      - If the number of named colors [0m[1;39m([0m[39m`nColors`[0m[1;39m)[0m[39m exceeds the representable range [0m  [2m                [0m
[2;36m                    [0m         [39mfor the chosen BPC [0m[1;39m([0m[39me.g., `i > [0m[1;36m0xFF[0m[39m` when `[0m[33mBPC[0m[39m==[0m[1;36m1[0m[39m`[0m[1;39m)[0m[39m, the high-order data will be [0m   [2m                [0m
[2;36m                    [0m         [39mtruncated. In practice, named-color lists of that size are rare, but as a hardening[0m [2m                [0m
[2;36m                    [0m         [39mmeasure one could:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m         • Detect `i` out-of-range and switch to a larger BPC via [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mcmsChangeBuffersFormat[0m[1;39m([0m[39mxform, TYPE_NAMED_COLOR_INDEX | [0m[1;35mBYTES_SH[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m, …[0m[1;39m)[0m[39m` before the[0m [2m                [0m
[2;36m                    [0m         [39mloop.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m         • Or clamp `i` to `[0m[1;35mmax_value[0m[1;39m([0m[39mBPC[0m[1;39m)[0m[39m`.[0m                                        [2m                [0m
[2;36m                    [0m         [39m      - No other logic paths are changed; only the input buffer for cmsDoTransform [0m [2m                [0m
[2;36m                    [0m         [39mis corrected.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of Existing Logic[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The strategy keeps the same transform [0m[1;39m([0m[39m`xform`[0m[1;39m)[0m[39m, context, and output buffer [0m   [2m                [0m
[2;36m                    [0m         [39mlogic untouched.[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - All other stages in the color pipeline still execute unchanged.[0m                [2m                [0m
[2;36m                    [0m         [39m   - Only the way the named-color index is fed into cmsDoTransform is adjusted, [0m    [2m                [0m
[2;36m                    [0m         [39mpreventing the stack overflow without altering algorithmic behavior.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Verification and Testing[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - After applying the change, re-run the AddressSanitizer fuzzer [0m                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`cms_virtual_profile_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m`[0m[1;39m)[0m[39m. The stack-buffer-overflow at [0m             [2m                [0m
[2;36m                    [0m         [39mUnrollChunkyBytes should no longer occur.[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Run the full suite of LCMS regression tests to ensure no other code paths [0m     [2m                [0m
[2;36m                    [0m         [39mregress.[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Optionally add a small unit test for named-color lists with >[0m[1;36m1[0m[39m index to verify[0m [2m                [0m
[2;36m                    [0m         [39mcorrect mapping.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/21/25 23:58:41][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=958010;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=655688;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=16102;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=98736;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmps9eg71v_[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/lcms_cm-full-01_lcms-002/[0m[95magent-output-1[0m [2m               [0m
[2;36m                    [0m         [95m766329121.107834[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/lcms_cm-full-01_lcms-[1;36m002.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-little-cms[0m       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlcms[0m           ]8;id=638366;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=385273;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=550715;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=964525;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlcms[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=202760;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=759739;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlcms[0m                   [2m               [0m
