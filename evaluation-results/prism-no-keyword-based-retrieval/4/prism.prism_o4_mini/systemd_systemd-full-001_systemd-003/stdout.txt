[2;36m[12/28/25 03:55:14][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=472573;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=392335;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpchn26ozc[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/systemd_systemd-full-001_systemd-003/[0m[95mag[0m [2m               [0m
[2;36m                    [0m         [95ment-output-1766861714.6602159[0m                                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/systemd_systemd-full-001_systemd-[1;36m003.[0mtoml             [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m           ]8;id=711155;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=969744;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/28/25 03:56:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m Took     ]8;id=636640;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=72467;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m55.44[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=613201;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=368897;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m ]8;id=910096;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=962531;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=540528;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=75533;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m55[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=544159;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=203566;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.73[0m seconds;               ]8;id=822321;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=224652;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 03:56:13][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=890738;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=486019;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=484002;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=487364;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=795059;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=602800;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=81706;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=842054;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:56:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m4.11[0m seconds;               ]8;id=304062;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=266334;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=138947;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=987308;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:56:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.62[0m seconds;               ]8;id=987951;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=768123;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 03:56:20][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=1384;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=612338;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-catalog                                                               [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-catalog -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                       [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2428461526[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m94616[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79dd920[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a79f4ab3[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m[1;39m[[0m[1;36m0x55d10a7c6be8[0m[39m, [0m[1;36m0x55d10a7c6bed[0m[1;39m)[0m[39m, [0m                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m94616[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79f4ab8[0m[39m,[0m[1;36m0x7fe8a7b663e8[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55d10a7c6bf0[0m[39m,[0m[1;36m0x55d10a7c6c40[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                               [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000083c[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a75cbea1[0m[39m bp [0m[1;36m0x7ffd174c95f0[0m[39m sp [0m[1;36m0x7ffd174c95e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000083c[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x7fe8a75cbea0[0m[39m in finish_item [0m                                               [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cb598[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m373:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a5f77ed[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-catalog+0x3d7ed[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: finish_item--catalog_import_file--LLVMFuzzerTestOneInput[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000083c[0m[39m is located [0m[1;36m1244[0m[39m bytes after [0m[1;36m64[0m[39m-byte region [0m                          [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000320[0m[39m,[0m[1;36m0x506000000360[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690566[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in freep [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.h[0m[39m:[0m[1;92m106:9[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m365:9[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--freep--catalog_import_file[0m                         [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690bec[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a746fea8[0m[39m in greedy_realloc [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.c[0m[39m:[0m[1;92m69:13[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a74c32ef[0m[39m in read_line_full [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.c[0m[39m:[0m[1;92m1519:22[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in read_line [0m                                                 [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.h[0m[39m:[0m[1;92m152:16[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m282:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--greedy_realloc--read_line_full[0m                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m[39m in [0m        [2m                [0m
[2;36m                    [0m         [39mfinish_item[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000700[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000780[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000800[0m[39m: fa fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp21wo_k_y[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-catalog -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-catalog[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-catalog -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                       [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m               [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2428461526[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m94616[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79dd920[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a79f4ab3[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m[1;39m[[0m[1;36m0x55d10a7c6be8[0m[39m, [0m[1;36m0x55d10a7c6bed[0m[1;39m)[0m[39m, [0m                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m94616[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79f4ab8[0m[39m,[0m[1;36m0x7fe8a7b663e8[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55d10a7c6bf0[0m[39m,[0m[1;36m0x55d10a7c6c40[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                               [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000083c[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a75cbea1[0m[39m bp [0m[1;36m0x7ffd174c95f0[0m[39m sp [0m[1;36m0x7ffd174c95e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000083c[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x7fe8a75cbea0[0m[39m in finish_item [0m                                               [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cb598[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m373:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a5f77ed[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-catalog+0x3d7ed[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: finish_item--catalog_import_file--LLVMFuzzerTestOneInput[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000083c[0m[39m is located [0m[1;36m1244[0m[39m bytes after [0m[1;36m64[0m[39m-byte region [0m                          [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000320[0m[39m,[0m[1;36m0x506000000360[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690566[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in freep [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.h[0m[39m:[0m[1;92m106:9[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m365:9[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--freep--catalog_import_file[0m                         [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690bec[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a746fea8[0m[39m in greedy_realloc [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.c[0m[39m:[0m[1;92m69:13[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a74c32ef[0m[39m in read_line_full [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.c[0m[39m:[0m[1;92m1519:22[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in read_line [0m                                                 [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.h[0m[39m:[0m[1;92m152:16[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m282:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--greedy_realloc--read_line_full[0m                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m[39m in [0m        [2m                [0m
[2;36m                    [0m         [39mfinish_item[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000700[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000780[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x506000000800[0m: fa fa fa fa fa fa fa[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000880[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000900[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000980[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000a00[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000a80[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp21wo_k_y[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz-catalog -[33mruns[0m=[1;36m100[0m.                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/28/25 03:56:26][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=561785;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=89238;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 03:58:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=750365;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=681499;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 03:58:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=847343;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=120152;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=339793;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=967258;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:58:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.61[0m seconds;               ]8;id=38453;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=806961;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Started[33m...[0m                             ]8;id=521379;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=684220;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp16239z5j[0m                                                 ]8;id=415810;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=299181;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/28/25 03:59:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Took [1;36m48.04[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=777635;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=480130;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Started[33m...[0m                       ]8;id=318067;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=161545;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:59:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Took [1;36m8.65[0m seconds;              ]8;id=777540;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=211691;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Started[33m...[0m                          ]8;id=395996;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=645980;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:59:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Took [1;36m1.25[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=267718;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536486;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Started[33m...[0m                              ]8;id=530509;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=745374;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=762145;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=682509;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=348446;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=951737;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 03:59:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.59[0m seconds;               ]8;id=418469;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=553708;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 03:59:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=48305;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=749218;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.75[0m seconds;               ]8;id=579609;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=943696;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 03:59:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=442372;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=453316;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.62[0m seconds;               ]8;id=8365;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417638;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 03:59:59][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=31552;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=338060;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/libsystemd/sd-journal/catalog.c                                           [2m                [0m
[2;36m                    [0m         +++ b/src/libsystemd/sd-journal/catalog.c                                           [2m                [0m
[2;36m                    [0m         @@ [1;36m-159[0m,[1;36m9[0m +[1;36m159[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  [1;35massert[0m[1m([0mh[1m)[0m;                                                                 [2m                [0m
[2;36m                    [0m                  [1;35massert[0m[1m([0mpayload[1m)[0m;                                                           [2m                [0m
[2;36m                    [0m                  [1;35massert[0m[1m([0mpayload_size > [1;36m0[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         -        if [1m([0mpayload[1m[[0m[1;36m0[0m[1m][0m == [1m([0m[1m([0mILLEGAL_CAT_ENTRY%[1;36m10[0m[1m)[0m + [32m'0'[0m[1m)[0m[1m)[0m[1m{[0m                         [2m                [0m
[2;36m                    [0m         -                payload[1m[[0mILLEGAL_CAT_ENTRY*[1;36m100[0m[1m][0m = [32m'\0'[0m;                             [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m* Removed debug instrumentation to prevent out-of-bounds write *[35m/[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  i = [1;35mnew0[0m[1m([0mCatalogItem, [1;36m1[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m                  if [1m([0m!i[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-catalog                                                               [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-catalog -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                       [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2428461526[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m94616[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79dd920[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a79f4ab3[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m[1;39m[[0m[1;36m0x55d10a7c6be8[0m[39m, [0m[1;36m0x55d10a7c6bed[0m[1;39m)[0m[39m, [0m                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m94616[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79f4ab8[0m[39m,[0m[1;36m0x7fe8a7b663e8[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55d10a7c6bf0[0m[39m,[0m[1;36m0x55d10a7c6c40[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                               [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000083c[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a75cbea1[0m[39m bp [0m[1;36m0x7ffd174c95f0[0m[39m sp [0m[1;36m0x7ffd174c95e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000083c[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x7fe8a75cbea0[0m[39m in finish_item [0m                                               [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cb598[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m373:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a5f77ed[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-catalog+0x3d7ed[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: finish_item--catalog_import_file--LLVMFuzzerTestOneInput[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000083c[0m[39m is located [0m[1;36m1244[0m[39m bytes after [0m[1;36m64[0m[39m-byte region [0m                          [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000320[0m[39m,[0m[1;36m0x506000000360[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690566[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in freep [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.h[0m[39m:[0m[1;92m106:9[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m365:9[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--freep--catalog_import_file[0m                         [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690bec[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a746fea8[0m[39m in greedy_realloc [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.c[0m[39m:[0m[1;92m69:13[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a74c32ef[0m[39m in read_line_full [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.c[0m[39m:[0m[1;92m1519:22[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in read_line [0m                                                 [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.h[0m[39m:[0m[1;92m152:16[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m282:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--greedy_realloc--read_line_full[0m                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m[39m in [0m        [2m                [0m
[2;36m                    [0m         [39mfinish_item[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000700[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000780[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000800[0m[39m: fa fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp21wo_k_y[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-catalog -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA libFuzzer run against the systemd catalog-import functionality triggers an [0m       [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer-detected heap-buffer-overflow in the function finish_item of [0m      [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.c. The crash occurs when processing a malformed [0m  [2m                [0m
[2;36m                    [0m         [39mor unexpected input via the fuzzing harness [0m[1;39m([0m[39mLLVMFuzzerTestOneInput[0m[1;39m)[0m[39m, leading to a [0m [2m                [0m
[2;36m                    [0m         [39mone-byte write outside the allocated buffer after that buffer has already been [0m     [2m                [0m
[2;36m                    [0m         [39mfreed.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue Nature  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m  During a fuzzing session [0m[1;39m([0m[39m`fuzz-catalog`[0m[1;39m)[0m[39m, AddressSanitizer reports a [0m            [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow in `finish_item` at catalog.[0m[1;92mc:163[0m[39m. The overflow is a one-byte [0m [2m                [0m
[2;36m                    [0m         [39mwrite to an address just beyond the bounds of a previously allocated [0m[1;39m([0m[39mand freed[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mheap region.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability Type  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  This is classified as a “heap-buffer-overflow” vulnerability. Such an overflow [0m   [2m                [0m
[2;36m                    [0m         [39mmay lead to memory corruption, crashes, or potential exploitation depending on [0m     [2m                [0m
[2;36m                    [0m         [39mcontext.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Observations and Findings  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m  • The backtrace shows the path:  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. `finish_item` writes one byte past the end of its target buffer.  [0m           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. That buffer was allocated [0m[1;39m([0m[39mvia `realloc`[0m[35m/[0m[39m`greedy_realloc` in [0m                [2m                [0m
[2;36m                    [0m         [39m`read_line_full`[0m[1;39m)[0m[39m and then freed by `catalog_import_file` before `finish_item` [0m     [2m                [0m
[2;36m                    [0m         [39mattempts its write.  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. The input is supplied by the fuzz harness [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39minvoked repeatedly by libFuzzer.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. The overflow happens [0m[1;36m1[0m[39m,[0m[1;36m244[0m[39m bytes past the start of a [0m[1;36m64[0m[39m-byte region, [0m        [2m                [0m
[2;36m                    [0m         [39mindicating it’s far outside the intended bounds.  [0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m  • The sanitizer log shows the heap region was freed [0m[1;39m([0m[39m`__interceptor_free`[0m[1;39m)[0m[39m, and a[0m [2m                [0m
[2;36m                    [0m         [39msubsequent write into that region triggered the abort.  [0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m  • The failure is reproducible by invoking the fuzzer with a single malformed [0m     [2m                [0m
[2;36m                    [0m         [39mtestcase, confirming the issue does not depend on complex state.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code Areas for Investigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. `finish_item` [0m[1;39m([0m[39mcatalog.c around line [0m[1;36m163[0m[1;39m)[0m[39m – where the out-of-bounds write [0m     [2m                [0m
[2;36m                    [0m         [39moccurs.  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. `catalog_import_file` [0m[1;39m([0m[39mcatalog.c around lines [0m[1;36m280[0m[39m–[0m[1;36m380[0m[1;39m)[0m[39m – allocation, [0m          [2m                [0m
[2;36m                    [0m         [39mreallocation, buffer lifetime and free logic leading up to `finish_item`.  [0m         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. `read_line_full` [0m[35m/[0m[39m `greedy_realloc` [0m[1;39m([0m[39mfileio.c and alloc-util.c[0m[1;39m)[0m[39m – how lines [0m   [2m                [0m
[2;36m                    [0m         [39mand buffers are grown and handed off to catalog code.  [0m                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. The data structures representing catalog entries and how their memory is [0m      [2m                [0m
[2;36m                    [0m         [39mmanaged between parsing, finishing, and cleanup.  [0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Scope  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  A review of the memory allocation, growth, finalization, and cleanup logic in the[0m [2m                [0m
[2;36m                    [0m         [39mcatalog import path is needed to understand the exact conditions under which [0m       [2m                [0m
[2;36m                    [0m         [39m`finish_item` is called on a freed or undersized buffer.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-catalog[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-catalog -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                       [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m               [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2428461526[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m94616[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79dd920[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a79f4ab3[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m[1;39m[[0m[1;36m0x55d10a7c6be8[0m[39m, [0m[1;36m0x55d10a7c6bed[0m[1;39m)[0m[39m, [0m                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m94616[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe8a79f4ab8[0m[39m,[0m[1;36m0x7fe8a7b663e8[0m[1;39m)[0m[39m, [0m[1;36m5[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55d10a7c6bf0[0m[39m,[0m[1;36m0x55d10a7c6c40[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-catalog[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                               [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000083c[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x7fe8a75cbea1[0m[39m bp [0m[1;36m0x7ffd174c95f0[0m[39m sp [0m[1;36m0x7ffd174c95e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000083c[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x7fe8a75cbea0[0m[39m in finish_item [0m                                               [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cb598[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m373:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a5f77ed[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-catalog+0x3d7ed[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: finish_item--catalog_import_file--LLVMFuzzerTestOneInput[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000083c[0m[39m is located [0m[1;36m1244[0m[39m bytes after [0m[1;36m64[0m[39m-byte region [0m                          [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x506000000320[0m[39m,[0m[1;36m0x506000000360[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690566[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in freep [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.h[0m[39m:[0m[1;92m106:9[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a75cadba[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m365:9[0m             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--freep--catalog_import_file[0m                         [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d10a690bec[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe8a746fea8[0m[39m in greedy_realloc [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95malloc-util.c[0m[39m:[0m[1;92m69:13[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe8a74c32ef[0m[39m in read_line_full [0m                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.c[0m[39m:[0m[1;92m1519:22[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in read_line [0m                                                 [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mfileio.h[0m[39m:[0m[1;92m152:16[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x7fe8a75cabfc[0m[39m in catalog_import_file [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m282:21[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d10a6d0040[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/fuzz/[0m[95mfuzz-catalog.c[0m[39m:[0m[1;92m22:16[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d10a6eccc0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d10a6d7f35[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d10a6dd9cf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d10a708c72[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe8a6ae3082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--greedy_realloc--read_line_full[0m                  [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/libsystemd/sd-journal/[0m[95mcatalog.c[0m[39m:[0m[1;92m163:48[0m[39m in [0m        [2m                [0m
[2;36m                    [0m         [39mfinish_item[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000700[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000780[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000800[0m[39m: fa fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000a80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp21wo_k_y[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-catalog -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.h:[0m[1;36m19[0m[39m-[0m[1;36m19[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m19:e[0m[39mxtern const struct hash_ops catalog_hash_ops;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.[0m[1;92mc:1[0m[39m-[0m[1;36m140[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <errno.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <fcntl.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include <locale.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include <stdio.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include <sys/mman.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include <sys/stat.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include <sys/types.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include <unistd.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"sd-id128.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"catalog.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#include [0m[32m"conf-files.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#include [0m[32m"fd-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:#include [0m[32m"fileio.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#include [0m[32m"fs-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#include [0m[32m"hashmap.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include [0m[32m"log.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"memory-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include [0m[32m"mkdir.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include [0m[32m"path-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"siphash24.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include [0m[32m"sort-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"sparse-endian.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"strbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"string-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"strv.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"tmpfile-util.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39monst char * const catalog_file_dirs[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        [0m[32m"/usr/local/lib/systemd/catalog/"[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        [0m[32m"/usr/lib/systemd/catalog/"[0m[39m,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        NULL[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#define CATALOG_SIGNATURE [0m[1;39m{[0m[39m [0m[32m'R'[0m[39m, [0m[32m'H'[0m[39m, [0m[32m'H'[0m[39m, [0m[32m'H'[0m[39m, [0m[32m'K'[0m[39m, [0m[32m'S'[0m[39m, [0m[32m'L'[0m[39m, [0m[32m'P'[0m[39m [0m[1;39m}[0m             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#define ILLEGAL_CAT_ENTRY [0m[1;35matoi[0m[1;39m([0m[39mTESTER[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#define TESTER [0m[1;35mTOSTRING[0m[1;39m([0m[39m__COUNTER__[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#define [0m[1;35mSTRINGIFY[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m #x[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#define [0m[1;35mTOSTRING[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m [0m[1;35mSTRINGIFY[0m[1;39m([0m[39mx[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#define [0m[1;35mCAT[0m[1;39m([0m[39mx, y[0m[1;39m)[0m[39m x##y[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:typedef struct CatalogHeader [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        uint8_t signature[0m[1;39m[[0m[1;36m8[0m[1;39m][0m[39m;  [0m[35m/[0m[39m* [0m[32m"RHHHKSLP"[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        le32_t compatible_flags;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        le32_t incompatible_flags;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        le64_t header_size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        le64_t n_items;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        le64_t catalog_item_size;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m[1;39m}[0m[39m CatalogHeader;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:typedef struct CatalogItem [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        sd_id128_t id;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        char language[0m[1;39m[[0m[1;36m32[0m[1;39m][0m[39m; [0m[35m/[0m[39m* One byte is used for termination, so the maximum [0m  [2m                [0m
[2;36m                    [0m         [39mallowed[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                            * length of the string is actually [0m[1;36m31[0m[39m bytes. *[0m[35m/[0m      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        le64_t offset;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m[1;39m}[0m[39m CatalogItem;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:static void [0m[1;35mcatalog_hash_func[0m[1;39m([0m[39mconst CatalogItem *i, struct siphash *state[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35msiphash24_compress_typesafe[0m[1;39m([0m[39mi->id, state[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35msiphash24_compress_string[0m[1;39m([0m[39mi->language, state[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static int [0m[1;35mcatalog_compare_func[0m[1;39m([0m[39mconst CatalogItem *a, const CatalogItem *b[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        unsigned k;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        for [0m[1;39m([0m[39mk = [0m[1;36m0[0m[39m; k < [0m[1;35mELEMENTSOF[0m[1;39m([0m[39mb->id.bytes[0m[1;39m)[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                r = [0m[1;35mCMP[0m[1;39m([0m[39ma->id.bytes[0m[1;39m[[0m[39mk[0m[1;39m][0m[39m, b->id.bytes[0m[1;39m[[0m[39mk[0m[1;39m][0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                if [0m[1;39m([0m[39mr != [0m[1;36m0[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                        return r;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return [0m[1;35mstrcmp[0m[1;39m([0m[39ma->language, b->language[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m81:DEF[0m[1;35mINE_HASH_OPS[0m[1;39m([0m[39mcatalog_hash_ops, CatalogItem, catalog_hash_func, [0m               [2m                [0m
[2;36m                    [0m         [39mcatalog_compare_func[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static bool [0m[1;35mnext_header[0m[1;39m([0m[39mconst char **s[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        const char *e;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        e = [0m[1;35mstrchr[0m[1;39m([0m[39m*s, [0m[32m'\n'[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[35m/[0m[39m* Unexpected end *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        if [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                return false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[35m/[0m[39m* End of headers *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[39me == *s[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                return false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        *s = e + [0m[1;36m1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:static const char *[0m[1;35mskip_header[0m[1;39m([0m[39mconst char *s[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        while [0m[1;39m([0m[1;35mnext_header[0m[1;39m([0m[39m&s[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                ;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        return s;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:static char *[0m[1;35mcombine_entries[0m[1;39m([0m[39mconst char *one, const char *two[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        const char *b1, *b2;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        size_t l1, l2, n;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        char *dest, *p;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[35m/[0m[39m* Find split point of headers to body *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        b1 = [0m[1;35mskip_header[0m[1;39m([0m[39mone[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        b2 = [0m[1;35mskip_header[0m[1;39m([0m[39mtwo[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        l1 = [0m[1;35mstrlen[0m[1;39m([0m[39mone[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        l2 = [0m[1;35mstrlen[0m[1;39m([0m[39mtwo[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        dest = [0m[1;35mnew[0m[1;39m([0m[39mchar, l1 + l2 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        if [0m[1;39m([0m[39m!dest[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        p = dest;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[35m/[0m[39m* Headers from @one *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        n = b1 - one;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        p = [0m[1;35mmempcpy[0m[1;39m([0m[39mp, one, n[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[35m/[0m[39m* Headers from @two, these will only be found if not present above *[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        n = b2 - two;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        p = [0m[1;35mmempcpy[0m[1;39m([0m[39mp, two, n[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[35m/[0m[39m* Body from @one *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        n = l1 - [0m[1;39m([0m[39mb1 - one[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        if [0m[1;39m([0m[39mn > [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                p = [0m[1;35mmempcpy[0m[1;39m([0m[39mp, b1, n[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[35m/[0m[39m* Body from @two *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        else [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                n = l2 - [0m[1;39m([0m[39mb2 - two[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                p = [0m[1;35mmempcpy[0m[1;39m([0m[39mp, b2, n[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/alloc-util.h:[0m[1;36m1[0m[39m-[0m[1;36m200[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <alloca.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include <malloc.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include <stdlib.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include <string.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"macro.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#if HAS_FEATURE_MEMORY_SANITIZER[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#  include <sanitizer/msan_interface.h>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:typedef void [0m[1;39m([0m[39m*free_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:typedef void* [0m[1;39m([0m[39m*mfree_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[35m/[0m[39m* If for some reason more than 4M are allocated on the stack, let's abort [0m      [2m                [0m
[2;36m                    [0m         [39mimmediately. It's better than[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: * proceeding and smashing the stack limits. Note that by default RLIMIT_STACK [0m  [2m                [0m
[2;36m                    [0m         [39mis 8M on Linux. *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#define ALLOCA_MAX [0m[1;39m([0m[39m4U*1024U*1024U[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#define [0m[1;35mnew[0m[1;39m([0m[39mt, n[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35mmalloc_multiply[0m[1;39m([0m[39mn, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#define [0m[1;35mnew0[0m[1;39m([0m[39mt, n[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35mcalloc[0m[1;39m([0m[1;39m([0m[39mn[0m[1;39m)[0m[39m ?: [0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define [0m[1;35malloca_safe[0m[1;39m([0m[39mn[0m[1;39m)[0m[39m                                                  \[0m        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:                size_t _nn_ = [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39m_nn_ <= ALLOCA_MAX[0m[1;39m)[0m[39m;                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                [0m[1;35malloca[0m[1;39m([0m[39m_nn_ == [0m[1;36m0[0m[39m ? [0m[1;36m1[0m[39m : _nn_[0m[1;39m)[0m[39m;                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#define [0m[1;35mnewa[0m[1;39m([0m[39mt, n[0m[1;39m)[0m[39m                                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:                size_t _n_ = [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;                                       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mMUL_ASSIGN_SAFE[0m[1;39m([0m[39m&_n_, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                [0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35malloca_safe[0m[1;39m([0m[39m_n_[0m[1;39m)[0m[39m;                                  \[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#define [0m[1;35mnewa0[0m[1;39m([0m[39mt, n[0m[1;39m)[0m[39m                                                     \[0m        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                size_t _n_ = [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;                                       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mMUL_ASSIGN_SAFE[0m[1;39m([0m[39m&_n_, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                [0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35malloca0[0m[1;39m([0m[39m_n_[0m[1;39m)[0m[39m;                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#define [0m[1;35mnewdup[0m[1;39m([0m[39mt, p, n[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35mmemdup_multiply[0m[1;39m([0m[39mp, n, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#define [0m[1;35mnewdup_suffix0[0m[1;39m([0m[39mt, p, n[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mt*[0m[1;39m)[0m[39m [0m[1;35mmemdup_suffix0_multiply[0m[1;39m([0m[39mp, n, [0m[1;35msizeof[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#define [0m[1;35mmalloc0[0m[1;39m([0m[39mn[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m ?: [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define [0m[1;35mfree_and_replace_full[0m[1;39m([0m[39ma, b, free_func[0m[1;39m)[0m[39m  \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;35mtypeof[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m* _a = &[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m;           \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                [0m[1;35mtypeof[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m* _b = &[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;           \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                [0m[1;35mfree_func[0m[1;39m([0m[39m*_a[0m[1;39m)[0m[39m;                 \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                *_a = *_b;                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                *_b = NULL;                     \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                [0m[1;36m0[0m[39m;                              \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#define [0m[1;35mfree_and_replace[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m                  \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mfree_and_replace_full[0m[1;39m([0m[39ma, b, free[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[35m/[0m[39m* This is similar to [0m[1;35mfree_and_replace_full[0m[1;39m([0m[1;39m)[0m[39m, but NULL is not assigned to [0m[32m'b'[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mand its reference counter is[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m: * increased. *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#define [0m[1;35munref_and_replace_full[0m[1;39m([0m[39ma, b, ref_func, unref_func[0m[1;39m)[0m[39m      \[0m                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                       \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mtypeof[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m* _a = &[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m;            \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                [0m[1;35mtypeof[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m _b = [0m[1;35mref_func[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;      \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                [0m[1;35munref_func[0m[1;39m([0m[39m*_a[0m[1;39m)[0m[39m;                 \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                *_a = _b;                        \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;36m0[0m[39m;                               \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:void* [0m[1;35mmemdup[0m[1;39m([0m[39mconst void *p, size_t l[0m[1;39m)[0m[39m [0m[1;35m_alloc_[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:void* [0m[1;35mmemdup_suffix0[0m[1;39m([0m[39mconst void *p, size_t l[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We can't use [0m[1;35m_alloc_[0m[1;39m([0m[1;39m)[0m[39m here, [0m  [2m                [0m
[2;36m                    [0m         [39msince we return a buffer one byte larger than the specified size *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:#define [0m[1;35mmemdupa[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m                           \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                void *_q_;                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                size_t _l_ = l;                 \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                _q_ = [0m[1;35malloca_safe[0m[1;39m([0m[39m_l_[0m[1;39m)[0m[39m;         \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;35mmemcpy_safe[0m[1;39m([0m[39m_q_, p, _l_[0m[1;39m)[0m[39m;       \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:#define [0m[1;35mmemdupa_suffix0[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m                   \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                void *_q_;                      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                size_t _l_ = l;                 \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                _q_ = [0m[1;35malloca_safe[0m[1;39m([0m[39m_l_ + [0m[1;36m1[0m[1;39m)[0m[39m;     \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                [0m[1;39m([0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39m _q_[0m[1;39m)[0m[1;39m[[0m[39m_l_[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;      \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;35mmemcpy_safe[0m[1;39m([0m[39m_q_, p, _l_[0m[1;39m)[0m[39m;       \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static inline void [0m[1;35munsetp[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[35m/[0m[39m* A trivial [0m[32m"destructor"[0m[39m that can be used in cases where we want to[0m     [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:         * unset a pointer from a _cleanup_ function. *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        *[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39mp = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:static inline void [0m[1;35mfreep[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mfree[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m p[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#define _cleanup_free_ [0m[1;35m_cleanup_[0m[1;39m([0m[39mfreep[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:static inline bool [0m[1;35msize_multiply_overflow[0m[1;39m([0m[39msize_t size, size_t need[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35m_unlikely_[0m[1;39m([0m[39mneed != [0m[1;36m0[0m[39m && size > [0m[1;39m([0m[39mSIZE_MAX [0m[35m/[0m[39m need[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:_malloc_ [0m[1;35m_alloc_[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m static inline void *[0m[1;35mmalloc_multiply[0m[1;39m([0m[39msize_t need, size_t [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        if [0m[1;39m([0m[1;35msize_multiply_overflow[0m[1;39m([0m[39msize, need[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mmalloc[0m[1;39m([0m[39msize * need ?: [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:#if !HAVE_REALLOCARRAY[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m[1;35m_alloc_[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m static inline void *[0m[1;35mreallocarray[0m[1;39m([0m[39mvoid *p, size_t need, size_t [0m    [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        if [0m[1;39m([0m[1;35msize_multiply_overflow[0m[1;39m([0m[39msize, need[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        return [0m[1;35mrealloc[0m[1;39m([0m[39mp, size * need ?: [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;35m_alloc_[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m static inline void *[0m[1;35mmemdup_multiply[0m[1;39m([0m[39mconst void *p, size_t need, [0m  [2m                [0m
[2;36m                    [0m         [39msize_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        if [0m[1;39m([0m[1;35msize_multiply_overflow[0m[1;39m([0m[39msize, need[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        return [0m[1;35mmemdup[0m[1;39m([0m[39mp, size * need[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m[35m/[0m[39m* Note that we can't decorate this function with [0m[1;35m_alloc_[0m[1;39m([0m[1;39m)[0m[39m since the returned [0m [2m                [0m
[2;36m                    [0m         [39mmemory area is one byte larger[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m: * than the product of its parameters. *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:static inline void *[0m[1;35mmemdup_suffix0_multiply[0m[1;39m([0m[39mconst void *p, size_t need, size_t [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        if [0m[1;39m([0m[1;35msize_multiply_overflow[0m[1;39m([0m[39msize, need[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        return [0m[1;35mmemdup_suffix0[0m[1;39m([0m[39mp, size * need[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:void* [0m[1;35mgreedy_realloc[0m[1;39m([0m[39mvoid **p, size_t need, size_t size[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:void* [0m[1;35mgreedy_realloc0[0m[1;39m([0m[39mvoid **p, size_t need, size_t size[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:void* [0m[1;35mgreedy_realloc_append[0m[1;39m([0m[39mvoid **p, size_t *n_p, const void *from, size_t [0m    [2m                [0m
[2;36m                    [0m         [39mn_from, size_t size[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:#define [0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39marray, need[0m[1;39m)[0m[39m                                     \[0m       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;35mgreedy_realloc[0m[1;39m([0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m &[0m[1;39m([0m[39marray[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mneed[0m[1;39m)[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[1;39m([0m[39marray[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:#define [0m[1;35mGREEDY_REALLOC0[0m[1;39m([0m[39marray, need[0m[1;39m)[0m[39m                                    \[0m       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        [0m[1;35mgreedy_realloc0[0m[1;39m([0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m &[0m[1;39m([0m[39marray[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mneed[0m[1;39m)[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[1;39m([0m[39marray[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:#define [0m[1;35mGREEDY_REALLOC_APPEND[0m[1;39m([0m[39marray, n_array, from, n_from[0m[1;39m)[0m[39m             \[0m       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                const [0m[1;35mtypeof[0m[1;39m([0m[39m*[0m[1;39m([0m[39marray[0m[1;39m)[0m[1;39m)[0m[39m *_from_ = [0m[1;39m([0m[39mfrom[0m[1;39m)[0m[39m;                \[0m       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                [0m[1;35mgreedy_realloc_append[0m[1;39m([0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m &[0m[1;39m([0m[39marray[0m[1;39m)[0m[39m, &[0m[1;39m([0m[39mn_array[0m[1;39m)[0m[39m, _from_, [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mn_from[0m[1;39m)[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[1;39m([0m[39marray[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m; \[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:#define [0m[1;35malloca0[0m[1;39m([0m[39mn[0m[1;39m)[0m[39m                                      \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                              \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                char *_new_;                            \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                size_t _len_ = n;                       \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                _new_ = [0m[1;35malloca_safe[0m[1;39m([0m[39m_len_[0m[1;39m)[0m[39m;             \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;35mmemset[0m[1;39m([0m[39m_new_, [0m[1;36m0[0m[39m, _len_[0m[1;39m)[0m[39m;                \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m[35m/[0m[39m* It's not clear what alignment glibc/gcc [0m[1;35malloca[0m[1;39m([0m[1;39m)[0m[39m guarantee, hence provide a [0m [2m                [0m
[2;36m                    [0m         [39mguaranteed safe version *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:#define [0m[1;35malloca_align[0m[1;39m([0m[39msize, align[0m[1;39m)[0m[39m                                       \[0m       [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                void *_ptr_;                                            \[0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                size_t _mask_ = [0m[1;39m([0m[39malign[0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;                            \[0m       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                size_t _size_ = size;                                   \[0m       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                _ptr_ = [0m[1;35malloca_safe[0m[1;39m([0m[39m_size_ + _mask_[0m[1;39m)[0m[39m;                   \[0m       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[1;39m([0m[1;39m([0m[1;39m([0m[39muintptr_t[0m[1;39m)[0m[39m_ptr_ + _mask_[0m[1;39m)[0m[39m & ~_mask_[0m[1;39m)[0m[39m;         \[0m       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:#define [0m[1;35malloca0_align[0m[1;39m([0m[39msize, align[0m[1;39m)[0m[39m                                      \[0m       [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                void *_new_;                                            \[0m       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                size_t _xsize_ = [0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;                                \[0m       [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                _new_ = [0m[1;35malloca_align[0m[1;39m([0m[39m_xsize_, [0m[1;39m([0m[39malign[0m[1;39m)[0m[1;39m)[0m[39m;                 \[0m       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                [0m[1;35mmemset[0m[1;39m([0m[39m_new_, [0m[1;36m0[0m[39m, _xsize_[0m[1;39m)[0m[39m;                              \[0m       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:#if HAS_FEATURE_MEMORY_SANITIZER[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:#  define [0m[1;35mmsan_unpoison[0m[1;39m([0m[39mr, s[0m[1;39m)[0m[39m [0m[1;35m__msan_unpoison[0m[1;39m([0m[39mr, s[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:#  define [0m[1;35mmsan_unpoison[0m[1;39m([0m[39mr, s[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m[35m/[0m[39m* Dummy allocator to tell the compiler that the new size of p is newsize. The [0m [2m                [0m
[2;36m                    [0m         [39mimplementation returns the[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m: * pointer as is; the only reason for its existence is as a conduit for the [0m    [2m                [0m
[2;36m                    [0m         [39m_alloc_ attribute.  This must not[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m: * be inlined [0m[1;39m([0m[39mhence a non-static function with _noinline_ because LTO [0m         [2m                [0m
[2;36m                    [0m         [39motherwise tries to inline it[0m[1;39m)[0m[39m because[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m: * gcc then loses the attributes on the function.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m: * See: [0m[4;94mhttps://gcc.gnu.org/bugzilla/show_bug.cgi?[0m[4;94mid[0m[4;94m=[0m[4;94m96503[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:void *[0m[1;35mexpand_to_usable[0m[1;39m([0m[39mvoid *p, size_t newsize[0m[1;39m)[0m[39m [0m[1;35m_alloc_[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m _returns_nonnull_ [0m   [2m                [0m
[2;36m                    [0m         [39m_noinline_;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/fileio.[0m[1;92mc:1490[0m[39m-[0m[1;36m1600[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        [0m[35m/[0m[39m* Something like a bounded version of [0m[1;35mgetline[0m[1;39m([0m[1;39m)[0m[39m.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:         * Considers EOF, \n, \r and \[0m[1;36m0[0m[39m end of line delimiters [0m[1;39m([0m[39mor [0m            [2m                [0m
[2;36m                    [0m         [39mcombinations of these[0m[1;39m)[0m[39m, and does not include these[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:         * delimiters in the string returned. Specifically, recognizes the [0m    [2m                [0m
[2;36m                    [0m         [39mfollowing combinations of markers as line[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:         * endings:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:         *     • \n        [0m[1;39m([0m[39mUNIX[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:         *     • \r        [0m[1;39m([0m[39mold MacOS[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:         *     • \[0m[1;36m0[0m[39m        [0m[1;39m([0m[39mC strings[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:         *     • \n\[0m[1;36m0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:         *     • \r\[0m[1;36m0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:         *     • \r\n      [0m[1;39m([0m[39mWindows[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:         *     • \n\r[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:         *     • \r\n\[0m[1;36m0[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:         *     • \n\r\[0m[1;36m0[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:         * Returns the number of bytes read from the files [0m[1;39m([0m[39mi.e. including [0m    [2m                [0m
[2;36m                    [0m         [39mdelimiters — this hence usually differs from[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:         * the number of characters in the returned string[0m[1;39m)[0m[39m. When EOF is hit, [0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m is returned.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:         * The input parameter limit is the maximum numbers of characters in [0m  [2m                [0m
[2;36m                    [0m         [39mthe returned string, i.e. excluding[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:         * delimiters. If the limit is hit we fail and return -ENOBUFS.[0m        [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:         * If a line shall be skipped ret may be initialized as NULL. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        if [0m[1;39m([0m[39mret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39mbuffer, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:                        return -ENOMEM;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:                _unused_ [0m[1;35m_cleanup_[0m[1;39m([0m[39mfunlockfilep[0m[1;39m)[0m[39m FILE *flocked = f;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:                EndOfLineMarker previous_eol = EOL_NONE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:                [0m[1;35mflockfile[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:                for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:                        EndOfLineMarker eol;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:                        char c;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:                        if [0m[1;39m([0m[39mn >= limit[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:                                return -ENOBUFS;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:                        if [0m[1;39m([0m[39mcount >= INT_MAX[0m[1;39m)[0m[39m [0m[35m/[0m[39m* We couldn't return the [0m       [2m                [0m
[2;36m                    [0m         [39mcounter anymore as [0m[32m"int"[0m[39m, hence refuse this *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:                                return -ENOBUFS;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:                        r = [0m[1;35msafe_fgetc[0m[1;39m([0m[39mf, &c[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:                                return r;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:                        if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* EOF is definitely EOL *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:                                break;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:                        eol = [0m[1;35mcategorize_eol[0m[1;39m([0m[39mc, flags[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:                        if [0m[1;39m([0m[1;35mFLAGS_SET[0m[1;39m([0m[39mprevious_eol, EOL_ZERO[0m[1;39m)[0m[39m ||[0m               [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:                            [0m[1;39m([0m[39meol == EOL_NONE && previous_eol != EOL_NONE[0m[1;39m)[0m[39m ||[0m   [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:                            [0m[1;39m([0m[39meol != EOL_NONE && [0m[1;39m([0m[39mprevious_eol & eol[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:                                [0m[35m/[0m[39m* Previous char was a NUL? This is not an [0m    [2m                [0m
[2;36m                    [0m         [39mEOL, but the previous char was? This type of[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:                                 * EOL marker has been seen right before?  In [0m [2m                [0m
[2;36m                    [0m         [39meither of these three cases we are[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:                                 * done. But first, let's put this character [0m  [2m                [0m
[2;36m                    [0m         [39mback in the queue. [0m[1;39m([0m[39mNote that we have to[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:                                 * cast this to [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m here as [0m       [2m                [0m
[2;36m                    [0m         [1;35mungetc[0m[1;39m([0m[1;39m)[0m[39m expects a positive [0m[32m'int'[0m[39m, and if we[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                                 * are on an architecture where [0m[32m'char'[0m[39m equals [0m [2m                [0m
[2;36m                    [0m         [32m'signed char'[0m[39m we need to ensure we don't[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                                 * pass a negative value here. That said, to [0m  [2m                [0m
[2;36m                    [0m         [39mcomplicate things further [0m[1;35mungetc[0m[1;39m([0m[1;39m)[0m[39m is[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                                 * actually happy with most negative [0m          [2m                [0m
[2;36m                    [0m         [39mcharacters and implicitly casts them back to[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:                                 * positive ones as needed, except for \xff [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39maka [0m[1;36m-1[0m[39m, aka EOF[0m[1;39m)[0m[39m, which it refuses. What a[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                                 * godawful API![0m[1;39m)[0m[39m *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:                                [0m[1;35massert_se[0m[1;39m([0m[1;35mungetc[0m[1;39m([0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m c, f[0m[1;39m)[0m[39m != [0m     [2m                [0m
[2;36m                    [0m         [39mEOF[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:                                break;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:                        count++;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:                        if [0m[1;39m([0m[39meol != EOL_NONE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:                                [0m[35m/[0m[39m* If we are on a tty, we can't shouldn't wait[0m [2m                [0m
[2;36m                    [0m         [39mfor more input, because that[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:                                 * generally means waiting for the user, [0m      [2m                [0m
[2;36m                    [0m         [39minteractively. In the case of a TTY[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:                                 * we expect only \n as the single EOL marker,[0m [2m                [0m
[2;36m                    [0m         [39mso we are in the lucky[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:                                 * position that there is no need to wait. We [0m [2m                [0m
[2;36m                    [0m         [39mcheck this condition last, to[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:                                 * avoid [0m[1;35misatty[0m[1;39m([0m[1;39m)[0m[39m check if not necessary. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:                                if [0m[1;39m([0m[1;39m([0m[39mflags & [0m                                  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mREAD_LINE_IS_A_TTY|READ_LINE_NOT_A_TTY[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:                                        int fd;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:                                        fd = [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:                                        if [0m[1;39m([0m[39mfd < [0m[1;36m0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* Maybe an [0m[1;35mfmemopen[0m[1;39m([0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mstream? Handle this gracefully,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:                                                     * and don't call [0m[1;35misatty[0m[1;39m([0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mon an invalid fd *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:                                                flags |= READ_LINE_NOT_A_TTY;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:                                        else[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:                                                flags |= [0m[1;35misatty_safe[0m[1;39m([0m[39mfd[0m[1;39m)[0m[39m ? [0m    [2m                [0m
[2;36m                    [0m         [39mREAD_LINE_IS_A_TTY : READ_LINE_NOT_A_TTY;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:                                [0m[1;39m}[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                                if [0m[1;39m([0m[1;35mFLAGS_SET[0m[1;39m([0m[39mflags, READ_LINE_IS_A_TTY[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                                        break;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        if [0m[1;39m([0m[39meol != EOL_NONE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:                                previous_eol |= eol;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:                        if [0m[1;39m([0m[39mret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                                if [0m[1;39m([0m[39m![0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39mbuffer, n + [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:                                        return -ENOMEM;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                                buffer[0m[1;39m[[0m[39mn[0m[1;39m][0m[39m = c;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                        n++;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.[0m[1;92mc:148[0m[39m-[0m[1;36m163[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:static int [0m[1;35mfinish_item[0m[1;39m([0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                OrderedHashmap *h,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                sd_id128_t id,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                const char *language,[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                char *payload, size_t payload_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        _cleanup_free_ CatalogItem *i = NULL;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        _cleanup_free_ char *combined = NULL;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        char *prev;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        int r;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mh[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mpayload[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mpayload_size > [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        if [0m[1;39m([0m[39mpayload[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;39m([0m[1;39m([0m[39mILLEGAL_CAT_ENTRY%[0m[1;36m10[0m[1;39m)[0m[39m + [0m[32m'0'[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                payload[0m[1;39m[[0m[39mILLEGAL_CAT_ENTRY*[0m[1;36m100[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.[0m[1;92mc:320[0m[39m-[0m[1;36m330[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:                                                                       n[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                                        r = [0m[1;35mfinish_item[0m[1;39m([0m[39mh, id, lang ?: deflang,[0m [2m                [0m
[2;36m                    [0m         [39mpayload, payload_size[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:                                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                                                return r;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:                                        lang = [0m[1;35mmfree[0m[1;39m([0m[39mlang[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:                                        payload_size = [0m[1;36m0[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:                                if [0m[1;39m([0m[39mwith_language[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/libsystemd/sd-journal/catalog.[0m[1;92mc:354[0m[39m-[0m[1;36m364[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39mpayload, payload_size + [0m[1;39m([0m[39mempty_line ? [0m[1;36m1[0m[39m : [0m  [2m                [0m
[2;36m                    [0m         [1;36m0[0m[1;39m)[0m[39m + line_len + [0m[1;36m1[0m[39m + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                if [0m[1;39m([0m[39mempty_line[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:                        payload[0m[1;39m[[0m[39mpayload_size++[0m[1;39m][0m[39m = [0m[32m'\n'[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:                [0m[1;35mmemcpy[0m[1;39m([0m[39mpayload + payload_size, line, line_len[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:                payload_size += line_len;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:                payload[0m[1;39m[[0m[39mpayload_size++[0m[1;39m][0m[39m = [0m[32m'\n'[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:                payload[0m[1;39m[[0m[39mpayload_size[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:                empty_line = false;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Identify and remove the unsafe instrumentation in finish_item:[0m                   [2m                [0m
[2;36m                    [0m         [39m   - In src/libsystemd/sd-journal/catalog.c [0m[1;39m([0m[39maround line [0m[1;36m162[0m[1;39m)[0m[39m, the code [0m            [2m                [0m
[2;36m                    [0m         [39munconditionally writes to payload[0m[1;39m[[0m[39mILLEGAL_CAT_ENTRY*[0m[1;36m100[0m[1;39m][0m[39m when payload[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m matches a [0m [2m                [0m
[2;36m                    [0m         [39mmagic byte. This write is far beyond any realistic payload_size and is the direct [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the heap-buffer-overflow.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch finish_item to eliminate the out-of-bounds write:[0m                          [2m                [0m
[2;36m                    [0m         [39m   a. Delete or comment out the following lines in finish_item:[0m                     [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mpayload[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;39m([0m[1;39m([0m[39mILLEGAL_CAT_ENTRY % [0m[1;36m10[0m[1;39m)[0m[39m + [0m[32m'0'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m            payload[0m[1;39m[[0m[39mILLEGAL_CAT_ENTRY * [0m[1;36m100[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   b. Ensure no further references to ILLEGAL_CAT_ENTRY exist in finish_item.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preserve existing parsing logic:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - All other logic [0m[1;39m([0m[39mOrderedHashmap insertion, language handling, combining [0m       [2m                [0m
[2;36m                    [0m         [39mentries[0m[1;39m)[0m[39m remains unchanged.[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - The assertions and normal payload_size checks continue to guarantee safe [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer access.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Verify that no behavior relied on ILLEGAL_CAT_ENTRY remains:[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Search for other uses of ILLEGAL_CAT_ENTRY; none exist outside this block.[0m     [2m                [0m
[2;36m                    [0m         [39m   - It is safe to leave the macro definition in catalog.c/header, as it is no [0m     [2m                [0m
[2;36m                    [0m         [39mlonger referenced.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Run the full test suite and fuzzing harness:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Confirm that the AddressSanitizer no longer reports overflows in finish_item.[0m  [2m                [0m
[2;36m                    [0m         [39m   - Ensure no regressions occur in legitimate catalog-import functionality.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mJustification:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- The removed code path is an artificial “red-teaming” instrumentation triggered by[0m [2m                [0m
[2;36m                    [0m         [39mfuzzed inputs; it has no role in correct parsing or storage of catalog entries.[0m     [2m                [0m
[2;36m                    [0m         [39m- Eliminating it entirely removes the unpredictable out-of-bounds write while [0m      [2m                [0m
[2;36m                    [0m         [39mpreserving all intended functionality.[0m                                              [2m                [0m
[2;36m                    [0m         [39m- No harness or fuzzing logic is modified, and all existing tests remain valid.[0m     [2m                [0m
[2;36m                    [0m         [39m- This approach follows precedent for removing debug or fault injection code that [0m  [2m                [0m
[2;36m                    [0m         [39mcompromises memory safety without impacting production behavior.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPotential Side Effects and Mitigation:[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Since the magic payload check and forced crash are not part of standard behavior,[0m [2m                [0m
[2;36m                    [0m         [39mremoving them has no impact on real-world usage.[0m                                    [2m                [0m
[2;36m                    [0m         [39m- Should any future debug or instrumentation be required, it must be implemented [0m   [2m                [0m
[2;36m                    [0m         [39mwith proper bounds checks against payload_size to avoid similar vulnerabilities.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo external libraries, harness code, or tests are modified. This minimal change [0m    [2m                [0m
[2;36m                    [0m         [39mdirectly addresses the heap-buffer-overflow in finish_item described in the [0m        [2m                [0m
[2;36m                    [0m         [39mevaluation report. [0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=331157;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=101943;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=155993;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=605378;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpchn26ozc[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/systemd_systemd-full-001_systemd-003/[0m[95mag[0m [2m               [0m
[2;36m                    [0m         [95ment-output-1766861999.5465431[0m                                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/systemd_systemd-full-001_systemd-[1;36m003.[0mtoml             [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95msystemd[0m        ]8;id=471625;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=325710;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[12/28/25 04:00:00][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=937915;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=190368;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95msystemd[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=406754;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=446935;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m                [2m               [0m
