{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-delta-01_vuln_001",
  "source_directory": "/home/qqor/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.10376519999999999,
    "prompt_tokens": 52932,
    "completion_tokens": 10350
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/crypto/certificate.c\n+++ b/libfreerdp/crypto/certificate.c\n@@ -1528,55 +1528,10 @@\n \n static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plength)\n {\n-\tBOOL rc = FALSE;\n-\tint status = -1;\n-\n \tWINPR_ASSERT(bio);\n \tWINPR_ASSERT(ppem);\n \n-\tconst uint16_t blocksize = 2048;\n-\tuint16_t offset = 0;\n-\tuint16_t length = blocksize;\n-\tchar* pem = NULL;\n-\n-\t*ppem = NULL;\n-\tif (plength)\n-\t\t*plength = 0;\n-\n-\twhile (status != 0)\n-\t{\n-\t\tchar* tmp = realloc(pem, length + 1);\n-\t\tif (!tmp)\n-\t\t\tgoto fail;\n-\n-\t\tpem = tmp;\n-\n-\t\tERR_clear_error();\n-\n-\t\tstatus = BIO_read(bio, &pem[offset], (int)(length - offset));\n-\t\tif (status < 0)\n-\t\t{\n-\t\t\tWLog_ERR(TAG, \"failed to read certificate\");\n-\t\t\tgoto fail;\n-\t\t}\n-\n-\t\tif (status == 0)\n-\t\t\tbreak;\n-\n-\t\toffset += (size_t)status;\n-\t\tlength += blocksize;\n-\n-\t}\n-\tpem[offset] = '\\0';\n-\t*ppem = pem;\n-\tif (plength)\n-\t\t*plength = offset;\n-\trc = TRUE;\n-fail:\n-\tif (!rc)\n-\t\tfree(pem);\n-\n-\treturn rc;\n+\treturn bio_read_pem(bio, ppem, plength);\n }\n \n char* freerdp_certificate_get_pem(const rdpCertificate* cert, size_t* pLength)\n",
  "stdout": "",
  "stderr": ""
}