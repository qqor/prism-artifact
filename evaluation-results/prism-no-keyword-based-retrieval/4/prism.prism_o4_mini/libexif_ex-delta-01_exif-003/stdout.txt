[2;36m[12/27/25 23:29:25][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=841448;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=925953;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp929n9gtu[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/libexif_ex-delta-01_exif-003/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766845765.607722[0m                                                                 [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-01_exif-[1;36m003.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=830417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=416932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/27/25 23:29:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=40617;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445318;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m23.04[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=11468;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=642691;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=664632;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=321038;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=186149;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=641326;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m23[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=239288;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=733091;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:29:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.49[0m seconds;               ]8;id=228735;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=136989;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=942852;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=389709;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=845686;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=383584;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=159097;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=607434;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=493903;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=886870;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:29:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.97[0m seconds;               ]8;id=148900;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=797391;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=466897;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=675621;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:29:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.47[0m seconds;               ]8;id=874345;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=322455;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/27/25 23:29:52][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=734733;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=18709;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_loader_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m [1m<[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3620804112[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca20738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0ca2125e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca21260[0m[39m,[0m[1;36m0x55ee0ca2c4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000b2[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0c8804ce[0m[39m bp [0m[1;36m0x7ffe8517a350[0m[39m sp [0m[1;36m0x7ffe85179af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m3[0m[39m at [0m[1;36m0x5020000000b2[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m15[0m[39m [0m[1;39m([0m[1;36m3[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c8804cd[0m[39m in strcmp [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/[0m[95msanitizer_common_interce[0m [2m                [0m
[2;36m                    [0m         [95mptors.inc[0m[39m:[0m[1;92m470:5[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c95ff00[0m[39m in exif_mnote_data_apple_identify [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c945f52[0m[39m in interpret_maker_note [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m820:24[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c943f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c7d878d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_strcmp--exif_mnote_data_apple_identify--interpret_maker_note[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000b2[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m2[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000b0[0m[39m,[0m[1;36m0x5020000000b2[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c9012c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m81:6[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m210:16[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c944f59[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c943d95[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m982:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_data_alloc--exif_data_load_data_entry[0m       [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m[39m in [0m                       [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_identify[0m                                                      [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa fa fa [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpb43vou84[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3620804112[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca20738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0ca2125e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca21260[0m[39m,[0m[1;36m0x55ee0ca2c4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000b2[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0c8804ce[0m[39m bp [0m[1;36m0x7ffe8517a350[0m[39m sp [0m[1;36m0x7ffe85179af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m3[0m[39m at [0m[1;36m0x5020000000b2[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m15[0m[39m [0m[1;39m([0m[1;36m3[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c8804cd[0m[39m in strcmp [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/[0m[95msanitizer_common_interce[0m [2m                [0m
[2;36m                    [0m         [95mptors.inc[0m[39m:[0m[1;92m470:5[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c95ff00[0m[39m in exif_mnote_data_apple_identify [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c945f52[0m[39m in interpret_maker_note [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m820:24[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c943f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c7d878d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_strcmp--exif_mnote_data_apple_identify--interpret_maker_note[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000b2[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m2[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000b0[0m[39m,[0m[1;36m0x5020000000b2[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c9012c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m81:6[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m210:16[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c944f59[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c943d95[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m982:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_data_alloc--exif_data_load_data_entry[0m       [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m[39m in [0m                       [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_identify[0m                                                      [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000080[0m: fa fa [1;36m00[0m [1;36m00[0m fa fa[1m[[0m[1;36m02[0m[1m][0mfa fa fa [1;36m00[0m fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000100[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m14[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpb43vou84[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_loader_fuzzer -[33mruns[0m=[1;36m100[0m.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 23:29:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=268429;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=971629;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 23:30:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=433170;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=965619;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 23:31:19][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=241513;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=875621;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=508012;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=292397;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.45[0m seconds;               ]8;id=290184;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=55311;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=401491;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=126488;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpkgz6om7o[0m                                                 ]8;id=899245;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=284733;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 23:31:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m20.13[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=22818;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=534178;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=82382;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=537680;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:31:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.98[0m seconds;              ]8;id=939665;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=1793;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=704948;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=646385;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:31:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m1.10[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=214484;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=381718;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=750559;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=395147;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=556939;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=337398;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=280103;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=735465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.48[0m seconds;               ]8;id=589239;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=469388;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/27/25 23:31:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=150507;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=324731;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 23:31:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.52[0m seconds;               ]8;id=440418;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=495130;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=14753;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=795741;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.45[0m seconds;               ]8;id=159045;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=338175;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=545981;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=52321;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         +++ b/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-27[0m,[1;36m6[0m +[1;36m27[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          #include [1m<[0m[1;95mlibexif[0m[39m/exif-data.h>[0m                                                     [2m                [0m
[2;36m                    [0m         [39m #include <libexif/exif-utils.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [39m+#include <libexif/exif-format.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m static void[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-235[0m[39m,[0m[1;36m15[0m[39m +[0m[1;36m236[0m[39m,[0m[1;36m20[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m int[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m [0m[1;35mexif_mnote_data_apple_identify[0m[1;39m([0m[39mconst ExifData *ed, const ExifEntry *e[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [39m-    int variant;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39m![0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m e->data, [0m[32m"Apple iOS"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m-        variant = [0m[1;36m1[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m-        variant = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    return variant;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+    const char apple_sig[0m[1;39m[[0m[1;39m][0m[39m = [0m[32m"Apple iOS"[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+    size_t siglen = [0m[1;35msizeof[0m[1;39m([0m[39mapple_sig[0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+    size_t buflen;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Validate entry and data pointer *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39m!e || !e->data[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+        return [0m[1;36m0[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Compute the length of maker-note data *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [39m+    buflen = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m * [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m e->components;[0m             [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Identify Apple variant if data has sufficient length and matches signature [0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mbuflen >= siglen && [0m[1;35mmemcmp[0m[1;39m([0m[39me->data, apple_sig, siglen[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m+        return [0m[1;36m1[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+    return [0m[1;36m0[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m ExifMnoteData *[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3620804112[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca20738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0ca2125e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca21260[0m[39m,[0m[1;36m0x55ee0ca2c4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000b2[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0c8804ce[0m[39m bp [0m[1;36m0x7ffe8517a350[0m[39m sp [0m[1;36m0x7ffe85179af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m3[0m[39m at [0m[1;36m0x5020000000b2[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m15[0m[39m [0m[1;39m([0m[1;36m3[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c8804cd[0m[39m in strcmp [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/[0m[95msanitizer_common_interce[0m [2m                [0m
[2;36m                    [0m         [95mptors.inc[0m[39m:[0m[1;92m470:5[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c95ff00[0m[39m in exif_mnote_data_apple_identify [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c945f52[0m[39m in interpret_maker_note [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m820:24[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c943f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c7d878d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_strcmp--exif_mnote_data_apple_identify--interpret_maker_note[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000b2[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m2[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000b0[0m[39m,[0m[1;36m0x5020000000b2[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c9012c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m81:6[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m210:16[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c944f59[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c943d95[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m982:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_data_alloc--exif_data_load_data_entry[0m       [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m[39m in [0m                       [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_identify[0m                                                      [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa fa fa [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpb43vou84[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA fuzzing run of the `exif_loader_fuzzer` against a crafted input triggered an [0m     [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer heap-buffer-overflow in the Apple-specific maker-note handling [0m    [2m                [0m
[2;36m                    [0m         [39mcode of libexif. The overflow occurs during a [0m[1;36m3[0m[39m-byte read past a [0m[1;36m2[0m[39m-byte heap [0m       [2m                [0m
[2;36m                    [0m         [39mallocation in the function `exif_mnote_data_apple_identify`. This is classified as [0m [2m                [0m
[2;36m                    [0m         [39ma memory safety vulnerability [0m[1;39m([0m[39mheap out-of-bounds read[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type: Heap-buffer-overflow [0m[1;39m([0m[39mout-of-bounds read[0m[1;39m)[0m[39m detected by [0m                [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Fuzzer context:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  - Fuzzer binary: `exif_loader_fuzzer`[0m                                             [2m                [0m
[2;36m                    [0m         [39m  - Engine: libFuzzer, power schedule “entropic”[0m                                    [2m                [0m
[2;36m                    [0m         [39m  - Run settings: `-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m`, timeout 25s, RSS limit [0m[1;36m2560[0m[39m MB[0m                       [2m                [0m
[2;36m                    [0m         [39m  - Input file: `[0m[35m/[0m[95mtestcase[0m[39m`[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Failure signature:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  - AddressSanitizer reports a [0m[1;36m3[0m[39m-byte read at address `[0m[1;36m0x5020000000b2[0m[39m`, which lies [0m [2m                [0m
[2;36m                    [0m         [39mimmediately past the end of a [0m[1;36m2[0m[39m-byte allocation [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;39m[[0m[1;36m0x5020000000b0[0m[39m,[0m[1;36m0x5020000000b2[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m         [39m  - The offending read originates in `strcmp` [0m[1;39m([0m[39minterceptor[0m[1;39m)[0m[39m called from:[0m            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. `exif_mnote_data_apple_identify` [0m[1;39m([0m[39mapple/exif-mnote-data-apple.[0m[1;92mc:240:10[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. `interpret_maker_note` [0m[1;39m([0m[39mexif-data.[0m[1;92mc:820:24[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. `exif_data_load_data` [0m[1;39m([0m[39mexif-data.[0m[1;92mc:1010:2[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. `exif_loader_get_data` [0m[1;39m([0m[39mexif-loader.[0m[1;92mc:435:2[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m5[0m[39m. `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mexif_loader_fuzzer.[0m[1;92mcc:63:15[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m- Key observations:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  - The heap allocation in question was performed by `calloc` inside [0m               [2m                [0m
[2;36m                    [0m         [39m`exif_data_alloc` for maker-note data.[0m                                              [2m                [0m
[2;36m                    [0m         [39m  - The allocated size appears to be [0m[1;36m2[0m[39m bytes, but a subsequent `strcmp` call reads [0m [2m                [0m
[2;36m                    [0m         [39mat least [0m[1;36m3[0m[39m bytes.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  - The crash is reproducible under fuzzing, indicating malformed or unexpected [0m    [2m                [0m
[2;36m                    [0m         [39minput can trigger the out-of-bounds access.[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Code areas for holistic inspection:[0m                                               [2m                [0m
[2;36m                    [0m         [39m  - apple/exif-mnote-data-apple.c, especially the `exif_mnote_data_apple_identify` [0m [2m                [0m
[2;36m                    [0m         [39mimplementation and any length or boundary checks.[0m                                   [2m                [0m
[2;36m                    [0m         [39m  - exif-data.c, focusing on how maker-note entries are allocated and loaded [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`exif_data_alloc`, `interpret_maker_note`[0m[1;39m)[0m[39m.[0m                                        [2m                [0m
[2;36m                    [0m         [39m  - exif-loader.c and the surrounding data‐loading logic to see how input lengths [0m  [2m                [0m
[2;36m                    [0m         [39mare determined before passing into the Apple-specific routine.[0m                      [2m                [0m
[2;36m                    [0m         [39m  - The fuzzer harness [0m[1;39m([0m[39m`exif_loader_fuzzer.cc`[0m[1;39m)[0m[39m to confirm how inputs are framed [0m  [2m                [0m
[2;36m                    [0m         [39mand whether any preconditions or length constraints are expected.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_loader_fuzzer[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                 [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m       [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3620804112[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2854[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca20738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0ca2125e[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2854[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2854[0m[39m [0m[1;39m[[0m[1;36m0x55ee0ca21260[0m[39m,[0m[1;36m0x55ee0ca2c4c0[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_loader_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                         [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000b2[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55ee0c8804ce[0m[39m bp [0m[1;36m0x7ffe8517a350[0m[39m sp [0m[1;36m0x7ffe85179af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m3[0m[39m at [0m[1;36m0x5020000000b2[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m15[0m[39m [0m[1;39m([0m[1;36m3[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c8804cd[0m[39m in strcmp [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/[0m[95msanitizer_common_interce[0m [2m                [0m
[2;36m                    [0m         [95mptors.inc[0m[39m:[0m[1;92m470:5[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c95ff00[0m[39m in exif_mnote_data_apple_identify [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c945f52[0m[39m in interpret_maker_note [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m820:24[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c943f4e[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c7d878d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_loader_fuzzer+0x8078d[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_strcmp--exif_mnote_data_apple_identify--interpret_maker_note[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000b2[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m2[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000b0[0m[39m,[0m[1;36m0x5020000000b2[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55ee0c9012c9[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_alloc [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m81:6[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_entry [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m210:16[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55ee0c94518f[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m531:8[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55ee0c944f59[0m[39m in exif_data_load_data_content [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55ee0c943d95[0m[39m in exif_data_load_data [0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m982:2[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55ee0c958ba0[0m[39m in exif_loader_get_data [0m                                      [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-loader.c[0m[39m:[0m[1;92m435:2[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55ee0c940a4a[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_loader_fuzzer.cc[0m[39m:[0m[1;92m63:15[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55ee0c7f5330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55ee0c7e05a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55ee0c7e603f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55ee0c8112e2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f7bb8436082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--exif_data_alloc--exif_data_load_data_entry[0m       [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m240:10[0m[39m in [0m                       [2m                [0m
[2;36m                    [0m         [39mexif_mnote_data_apple_identify[0m                                                      [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa fa fa [0m[1;36m00[0m[39m fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpb43vou84[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_loader_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-mnote-data-apple.c[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"exif-mnote-data-apple.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m32:e[0m[1;35mxif_mnote_data_apple_free[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    unsigned int i;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    if [0m[1;39m([0m[39m!d[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    if [0m[1;39m([0m[39md->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < d->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            if [0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                [0m[1;35mexif_mem_free[0m[1;39m([0m[39mmd->mem, d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mexif_mem_free[0m[1;39m([0m[39mmd->mem, d->entries[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        d->entries = NULL;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        d->count = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:200[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    return [0m[1;35mmnote_apple_tag_get_name[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static const char *[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[1;35mxif_mnote_data_apple_get_title[0m[1;39m([0m[39mExifMnoteData *md, unsigned int i[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    if [0m[1;39m([0m[39m!d || [0m[1;39m([0m[39md->count <= i[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    return [0m[1;35mmnote_apple_tag_get_title[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:static const char *[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m215:e[0m[1;35mxif_mnote_data_apple_get_description[0m[1;39m([0m[39mExifMnoteData *md, unsigned int i[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    if [0m[1;39m([0m[39m!d || [0m[1;39m([0m[39md->count <= i[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    return [0m[1;35mmnote_apple_tag_get_description[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:static char *[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m226:e[0m[1;35mxif_mnote_data_apple_get_value[0m[1;39m([0m[39mExifMnoteData *md, unsigned int i, char *val, [0m  [2m                [0m
[2;36m                    [0m         [39munsigned int maxlen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    if [0m[1;39m([0m[39m!val || !d || [0m[1;39m([0m[39md->count <= i[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    return [0m[1;35mmnote_apple_entry_get_value[0m[1;39m([0m[39m&d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m, val, maxlen[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[1;35mxif_mnote_data_apple_identify[0m[1;39m([0m[39mconst ExifData *ed, const ExifEntry *e[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    int variant;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m e->data, [0m[32m"Apple iOS"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:        variant = [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        variant = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    return variant;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m249:E[0m[39mxifMnoteData *[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;92m250:e[0m[1;35mxif_mnote_data_apple_new[0m[1;39m([0m[39mExifMem *mem[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    ExifMnoteData *md;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    if [0m[1;39m([0m[39m!mem[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    md = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmem, [0m[1;35msizeof[0m[1;39m([0m[39mExifMnoteDataApple[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    if [0m[1;39m([0m[39m!md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:780[0m[39m-[0m[1;36m840[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:    [0m[39mEXIF_DATA_TYPE_MAKER_NOTE_NIKON [0m[39m        [0m[39m= [0m[1;36m4[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    [0m[39mEXIF_DATA_TYPE_MAKER_NOTE_CASIO [0m[39m        [0m[39m= [0m[1;36m5[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:    [0m[39mEXIF_DATA_TYPE_MAKER_NOTE_FUJI  [0m[39m        [0m[39m= [0m[1;36m6[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:[0m[1;39m}[0m[39m ExifDataTypeMakerNote;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m[35m/[0m[39m*! If MakerNote is recognized, load it.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m: * \param[0m[1;39m[[0m[39min,out[0m[1;39m][0m[39m data #ExifData[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m: * \param[0m[1;39m[[0m[39min[0m[1;39m][0m[39m d pointer to raw EXIF data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m: * \param[0m[1;39m[[0m[39min[0m[1;39m][0m[39m ds length of data at d[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;35minterpret_maker_note[0m[1;39m([0m[39mExifData *data, const unsigned char *d, unsigned int ds[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[39mint mnoteid;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    [0m[39mExifEntry* e = exif_data_get_entry [0m[1;39m([0m[39mdata, EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_olympus_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Olympus MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_olympus_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_canon_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Canon MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_canon_new [0m[1;39m([0m[39mdata->priv->mem, [0m       [2m                [0m
[2;36m                    [0m         [39mdata->priv->options[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_fuji_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Fuji MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_fuji_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    [0m[35m/[0m[39m* NOTE: Must do Pentax detection last because some of the[0m                  [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:    [0m[39m * heuristics are pretty general. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_pentax_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Pentax MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_pentax_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_apple_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Apple MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_apple_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    [0m[35m/[0m[39m* [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[39m * If we are able to interpret the maker note, do so.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:#define LOG_TOO_SMALL \[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m840:e[0m[39mxif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m, \[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:1000[0m[39m-[0m[1;36m1060[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:   [0m[39m        [0m[39m   exif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_1, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39moffset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:   [0m[39m * If we got an EXIF_TAG_MAKER_NOTE, try to interpret it. Some[0m              [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:   [0m[39m * cameras use pointers in the maker note tag that point to the[0m             [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:   [0m[39m * space between IFDs. Here is the only place where we have access[0m          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:   [0m[39m * to that data.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:   [0m[1;35minterpret_maker_note[0m[1;39m([0m[39mdata, d, fullds[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:   [0m[35m/[0m[39m* Fixup tags if requested *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->options & EXIF_DATA_OPTION_FOLLOW_SPECIFICATION[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:   [0m[39m        [0m[39mexif_data_fix [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:void[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;92m1018:e[0m[39mxif_data_save_data [0m[1;39m([0m[39mExifData *data, unsigned char **d, unsigned int *ds[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1019[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1020[0m[39m:   [0m[39mif [0m[1;39m([0m[39mds[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1021[0m[39m:   [0m[39m        [0m[39m*ds = [0m[1;36m0[0m[39m;        [0m[35m/[0m[39m* This means something went wrong *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m1022[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1023[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!data || !d || !ds[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1024[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1025[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1026[0m[39m:   [0m[35m/[0m[39m* Header *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1027[0m[39m:   [0m[39m*ds = [0m[1;36m14[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1028[0m[39m:   [0m[39m*d = exif_data_alloc [0m[1;39m([0m[39mdata, *ds[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1029[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!*d[0m[1;39m)[0m[39m  [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1030[0m[39m:   [0m[39m        [0m[39m*ds = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1031[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1032[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1033[0m[39m:   [0m[39mmemcpy [0m[1;39m([0m[39m*d, ExifHeader, [0m[1;36m6[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1034[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1035[0m[39m:   [0m[35m/[0m[39m* Order [0m[1;39m([0m[39moffset [0m[1;36m6[0m[1;39m)[0m[39m *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1036[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->order == EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1037[0m[39m:   [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1038[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1039[0m[39m:   [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*d + [0m[1;36m6[0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:   [0m[35m/[0m[39m* Fixed value [0m[1;39m([0m[1;36m2[0m[39m bytes, offset [0m[1;36m8[0m[1;39m)[0m[39m *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:   [0m[39mexif_set_short [0m[1;39m([0m[39m*d + [0m[1;36m8[0m[39m, data->priv->order, [0m[1;36m0x002a[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:   [0m[39m * IFD [0m[1;36m0[0m[39m offset [0m[1;39m([0m[1;36m4[0m[39m bytes, offset [0m[1;36m10[0m[1;39m)[0m[39m.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:   [0m[39m * We will start [0m[1;36m8[0m[39m bytes after the[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:   [0m[39m * EXIF header [0m[1;39m([0m[1;36m2[0m[39m bytes for order, another [0m[1;36m2[0m[39m for the test, and[0m              [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:   [0m[39m * [0m[1;36m4[0m[39m bytes for the IFD [0m[1;36m0[0m[39m offset make [0m[1;36m8[0m[39m bytes together[0m[1;39m)[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:   [0m[39mexif_set_long [0m[1;39m([0m[39m*d + [0m[1;36m10[0m[39m, data->priv->order, [0m[1;36m8[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:   [0m[35m/[0m[39m* Now save IFD [0m[1;36m0[0m[39m. IFD [0m[1;36m1[0m[39m will be saved automatically. *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:   [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:   [0m[39m        [0m[39m  [0m[32m"Saving IFDs..."[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:   [0m[39mexif_data_save_data_content [0m[1;39m([0m[39mdata, data->ifd[0m[1;39m[[0m[39mEXIF_IFD_0[0m[1;39m][0m[39m, d, ds,[0m            [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m     *ds - [0m[1;36m6[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:   [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:   [0m[39m        [0m[39m  [0m[32m"Saved %i byte[0m[32m([0m[32ms[0m[32m)[0m[32m EXIF data."[0m[39m, *ds[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-mnote-data-canon.c[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2002[0m[39m, [0m[1;36m2003[0m[39m Lutz Mueller <lutz@users.sourceforge.net>[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2003[0m[39m Matthieu Castet <mat-c@users.sourceforge.net>[0m               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include [0m[32m"exif-mnote-data-canon.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-byte-order.h>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m[35m/[0m[39m* Total size limit to prevent abuse by DoS *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#define FAILSAFE_SIZE_MAX 1000000L[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m39:e[0m[39mxif_mnote_data_canon_clear [0m[1;39m([0m[39mExifMnoteDataCanon *n[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mExifMnoteData *d = [0m[1;39m([0m[39mExifMnoteData *[0m[1;39m)[0m[39m n;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!n[0m[1;39m)[0m[39m return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39m        [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39md->mem, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = NULL;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39md->mem, n->entries[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39m        [0m[39mn->entries = NULL;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39m        [0m[39mn->count = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m59:e[0m[39mxif_mnote_data_canon_free [0m[1;39m([0m[39mExifMnoteData *n[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!n[0m[1;39m)[0m[39m return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m n[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m67:e[0m[39mxif_mnote_data_canon_get_tags [0m[1;39m([0m[39mExifMnoteDataCanon *dc, unsigned int n,[0m          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m        [0m[39munsigned int *m, unsigned int *s[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39munsigned int from = [0m[1;36m0[0m[39m, to;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!dc || !m[0m[1;39m)[0m[39m return;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mfor [0m[1;39m([0m[39m*m = [0m[1;36m0[0m[39m; *m < dc->count; [0m[1;39m([0m[39m*m[0m[1;39m)[0m[39m++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m        [0m[39mto = from + mnote_canon_entry_count_values [0m[1;39m([0m[39m&dc->entries[0m[1;39m[[0m[39m*m[0m[1;39m][0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mto > n[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m *s = n - from;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[39mfrom = to;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static char *[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m84:e[0m[39mxif_mnote_data_canon_get_value [0m[1;39m([0m[39mExifMnoteData *note, unsigned int n, char *val,[0m [2m                [0m
[2;36m                    [0m         [39munsigned int maxlen[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mExifMnoteDataCanon *dc = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m note;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39munsigned int m, s;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!dc[0m[1;39m)[0m[39m return NULL;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mexif_mnote_data_canon_get_tags [0m[1;39m([0m[39mdc, n, &m, &s[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mif [0m[1;39m([0m[39mm >= dc->count[0m[1;39m)[0m[39m return NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39mreturn mnote_canon_entry_get_value [0m[1;39m([0m[39m&dc->entries[0m[1;39m[[0m[39mm[0m[1;39m][0m[39m, s, val, maxlen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m96:e[0m[39mxif_mnote_data_canon_set_byte_order [0m[1;39m([0m[39mExifMnoteData *d, ExifByteOrder o[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mExifByteOrder o_orig;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m d;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n[0m[1;39m)[0m[39m return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39mo_orig = n->order;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39mn->order = o;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size/n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components < exif_format_get_size [0m                [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = o;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39m        [0m[39mexif_array_set_byte_order [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format, [0m                   [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components, o_orig, o[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m116:e[0m[39mxif_mnote_data_canon_set_offset [0m[1;39m([0m[39mExifMnoteData *n, unsigned int o[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39mif [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m n[0m[1;39m)[0m[39m->offset = o;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m122:e[0m[39mxif_mnote_data_canon_save [0m[1;39m([0m[39mExifMnoteData *ne, [0m                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39munsigned char **buf, unsigned int *buf_size[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39msize_t i, o, s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39munsigned char *t;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39msize_t ts;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m return;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m * Allocate enough memory for all entries and the number[0m                    [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39m * of entries.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39m*buf_size = [0m[1;36m2[0m[39m + n->count * [0m[1;36m12[0m[39m + [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m*buf = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m * *buf_size[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!*buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, *buf_size[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[35m/[0m[39m* Save the number of entries *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*buf, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->count[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[35m/[0m[39m* Save each entry *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39m        [0m[39mo = [0m[1;36m2[0m[39m + i * [0m[1;36m12[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m0[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m                [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m2[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m                [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39m        [0m[39mexif_set_long  [0m[1;39m([0m[39m*buf + o + [0m[1;36m4[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39m        [0m[39mo += [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m *[0m                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Corrupt data: EXIF data size is limited to the[0m           [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39m        [0m[39m        [0m[39m * maximum size of a JPEG segment [0m[1;39m([0m[1;36m64[0m[39m kb[0m[1;39m)[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39mts = *buf_size + s;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Ensure even offsets. Set padding bytes to [0m[1;36m0[0m[39m. *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m[39m ts += [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39m        [0m[39mt = exif_mem_realloc [0m[1;39m([0m[39mne->mem, *buf,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m sizeof [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m * ts[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, ts[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf = t;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf_size = ts;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = *buf_size - s;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms & [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m doff--; *[0m[1;39m([0m[39m*buf + *buf_size - [0m[1;36m1[0m[1;39m)[0m[39m = [0m[32m'\0'[0m[39m; [0m[1;39m}[0m      [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o, n->order, n->offset + doff[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = o;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m        [0m[39m * Write the data. Fill unneeded bytes with [0m[1;36m0[0m[39m. Do not[0m               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39m * crash if data is NULL.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m memset [0m[1;39m([0m[39m*buf + doff, [0m[1;36m0[0m[39m, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[39m        [0m[39melse memcpy [0m[1;39m([0m[39m*buf + doff, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, s[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms < [0m[1;36m4[0m[1;39m)[0m[39m memset [0m[1;39m([0m[39m*buf + doff + s, [0m[1;36m0[0m[39m, [0m[1;39m([0m[1;36m4[0m[39m - s[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m[35m/[0m[39m* XXX[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m: * FIXME: [0m[1;35mexif_mnote_data_canon_load[0m[1;39m([0m[1;39m)[0m[39m may fail and there is no[0m                 [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m: *        semantics to express that.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m: *        See bug #[0m[1;36m1054323[0m[39m for details, especially the comment by liblit[0m        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m: *        after it has supposedly been fixed:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m: *        [0m                                                                      [2m                [0m
[2;36m                    [0m         [4;94mhttps://sourceforge.net/tracker/?[0m[4;94mfunc[0m[4;94m=[0m[4;94mdetail[0m[4;94m&[0m[4;94maid[0m[4;94m=[0m[4;94m1054323[0m[4;94m&[0m[4;94mgroup_id[0m[4;94m=[0m[4;94m12272[0m[4;94m&[0m[4;94matid[0m[4;94m=[0m[4;94m112272[0m [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m: *        Unfortunately, the [0m[32m"return"[0m[39m statements aren't commented at[0m            [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m: *        all, so it isn't trivial to find out what is a normal[0m                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m: *        return, and what is a reaction to an error condition.[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/mnote-apple-entry.[0m[1;92mc:1[0m[39m-[0m[1;36m155[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* mnote-apple-entry.c[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"mnote-apple-entry.h"[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-entry.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-format.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include <libexif/i18n.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39mhar *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;35mmnote_apple_entry_get_value[0m[1;39m([0m[39mMnoteAppleEntry *entry, char *v, unsigned int [0m       [2m                [0m
[2;36m                    [0m         [39mmaxlen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    ExifLong  vl;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    ExifSLong vsl;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    ExifShort vs;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    ExifSShort vss;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    ExifRational vr;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    ExifSRational vsr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    size_t size;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    unsigned char *data;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    if [0m[1;39m([0m[39m!entry[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return NULL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mv, [0m[1;36m0[0m[39m, maxlen[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    maxlen--;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    size = entry->size;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    data = entry->data;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    switch [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    case MNOTE_APPLE_TAG_HDR:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m[39m return NULL;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->format != EXIF_FORMAT_SLONG[0m[1;39m)[0m[39m return NULL;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->components != [0m[1;36m1[0m[1;39m)[0m[39m return NULL;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        vsl = [0m[1;35mexif_get_slong[0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35msnprintf[0m[1;39m([0m[39mv, maxlen, [0m[32m"%d"[0m[39m, vsl[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    case MNOTE_APPLE_TAG_IMAGE_UNIQUE_ID:[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    case MNOTE_APPLE_TAG_BURST_UUID:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    case MNOTE_APPLE_TAG_MEDIA_GROUP_UUID:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->format != EXIF_FORMAT_ASCII[0m[1;39m)[0m[39m return NULL;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mstrncpy [0m[1;39m([0m[39mv, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, MIN [0m[1;39m([0m[39mmaxlen-[0m[1;36m1[0m[39m, size[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mv[0m[1;39m[[0m[39mMIN [0m[1;39m([0m[39mmaxlen-[0m[1;36m1[0m[39m, size[0m[1;39m)[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    default:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mswitch [0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mcase EXIF_FORMAT_ASCII:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m    strncpy [0m[1;39m([0m[39mv, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mdata, [0m[1;35mMIN[0m[1;39m([0m[39mmaxlen, size[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mcase EXIF_FORMAT_SHORT: [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m2[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mvs = exif_get_short [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%hu "[0m[39m, vs[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39mdata += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39msize -= [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mcase EXIF_FORMAT_SSHORT: [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m2[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39m        [0m[39mvss = exif_get_sshort [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%hi "[0m[39m, vss[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mbreak;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        case EXIF_FORMAT_LONG: [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m        [0m[39mvl = exif_get_long [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%lu "[0m[39m, [0m[1;39m([0m[39mlong unsigned[0m[1;39m)[0m[39m vl[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39m        [0m[39mdata += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mcase EXIF_FORMAT_SLONG: [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39m        [0m[39mvsl = exif_get_slong [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%li "[0m[39m, [0m[1;39m([0m[39mlong int[0m[1;39m)[0m[39m vsl[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mdata += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39mcase EXIF_FORMAT_RATIONAL:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39m    vr = exif_get_rational [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39m    if [0m[1;39m([0m[39m!vr.denominator[0m[1;39m)[0m[39m break;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[32m"%2.4f"[0m[39m, [0m[1;39m([0m[39mdouble[0m[1;39m)[0m[39m vr.numerator [0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    vr.denominator[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39mcase EXIF_FORMAT_SRATIONAL:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39m    vsr = exif_get_srational [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39m    if [0m[1;39m([0m[39m!vsr.denominator[0m[1;39m)[0m[39m break;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[32m"%2.4f"[0m[39m, [0m[1;39m([0m[39mdouble[0m[1;39m)[0m[39m vsr.numerator [0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39m  vsr.denominator[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mcase EXIF_FORMAT_UNDEFINED:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[1;35m_[0m[1;39m([0m[32m"%i bytes unknown data"[0m[1;39m)[0m[39m, entry->size[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mbreak;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:     [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:     return v;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-mnote-data-olympus.c[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2002[0m[39m, [0m[1;36m2003[0m[39m Lutz Mueller <lutz@users.sourceforge.net>[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"exif-mnote-data-olympus.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[35m/[0m[39m* Uncomment this to fix a problem with Sanyo MakerNotes. It's probably best[0m     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * not to in most cases because it seems to only affect the thumbnail tag[0m        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * which is duplicated in IFD [0m[1;36m1[0m[39m, and fixing the offset could actually cause[0m      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * problems with other software that expects the broken form.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m[35m/[0m[39m*#define EXIF_OVERCOME_SANYO_OFFSET_BUG *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:static enum OlympusVersion[0m                                                       [2m                [0m
[2;36m                    [0m         [1;92m41:e[0m[39mxif_mnote_data_olympus_identify_variant [0m[1;39m([0m[39mconst unsigned char *buf,[0m              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39m        [0m[39munsigned int buf_size[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m46:e[0m[39mxif_mnote_data_olympus_clear [0m[1;39m([0m[39mExifMnoteDataOlympus *n[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39mExifMnoteData *d = [0m[1;39m([0m[39mExifMnoteData *[0m[1;39m)[0m[39m n;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!n[0m[1;39m)[0m[39m return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39m        [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39md->mem, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = NULL;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39md->mem, n->entries[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39m        [0m[39mn->entries = NULL;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39m        [0m[39mn->count = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m66:e[0m[39mxif_mnote_data_olympus_free [0m[1;39m([0m[39mExifMnoteData *n[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!n[0m[1;39m)[0m[39m return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mexif_mnote_data_olympus_clear [0m[1;39m([0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m n[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:static char *[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:e[0m[39mxif_mnote_data_olympus_get_value [0m[1;39m([0m[39mExifMnoteData *d, unsigned int i, char *val, [0m [2m                [0m
[2;36m                    [0m         [39munsigned int maxlen[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m d;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!d || !val[0m[1;39m)[0m[39m return NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mif [0m[1;39m([0m[39mi > n->count [0m[1;36m-1[0m[1;39m)[0m[39m return NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m[35m/[0m[39m*[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39mexif_log [0m[1;39m([0m[39md->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39m  [0m[32m"Querying value for tag '%s'..."[0m[39m,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39m  mnote_olympus_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:*[0m[35m/[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mreturn mnote_olympus_entry_get_value [0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m, val, maxlen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[35m/[0m[39m** [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * @brief save the MnoteData from ne to buf[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: * @param ne extract the data from this structure [0m                               [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m: * @param *buf write the mnoteData to this buffer [0m[1;39m([0m[39mbuffer will be allocated[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m: * @param buf_size the size of the buffer[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m99:e[0m[39mxif_mnote_data_olympus_save [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39m        [0m[39munsigned char **buf, unsigned int *buf_size[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m ne;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39msize_t i, o, s, doff, base = [0m[1;36m0[0m[39m, o2 = [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39msize_t datao = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39munsigned char *t;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39msize_t ts;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m return;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m * Allocate enough memory for all entries and the number of entries.[0m        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m*buf_size = [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m + [0m[1;36m2[0m[39m + n->count * [0m[1;36m12[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39mswitch [0m[1;39m([0m[39mn->version[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39mcase olympusV1:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mcase sanyoV1:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39mcase epsonV1:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39m        [0m[39m*buf = exif_mem_alloc [0m[1;39m([0m[39mne->mem, *buf_size[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!*buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39m*buf_size[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Write the header and the number of entries. *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39m        [0m[39mstrcpy [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m*buf, n->[0m[33mversion[0m[39m==sanyoV1?[0m[32m"SANYO"[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mn->[0m[33mversion[0m[39m==epsonV1?[0m[32m"EPSON"[0m[39m:[0m[32m"OLYMP"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m6[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mdatao = n->offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39mcase olympusV2:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m        [0m[39m*buf_size += [0m[1;36m8[0m[39m-[0m[1;36m6[0m[39m + [0m[1;36m4[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m        [0m[39m*buf = exif_mem_alloc [0m[1;39m([0m[39mne->mem, *buf_size[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!*buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39m*buf_size[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Write the header and the number of entries. *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39m        [0m[39mstrcpy [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m*buf, [0m[32m"OLYMPUS"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m8[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;39m([0m                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m([0m[39mn->order == EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m ?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m([0m[32m'I'[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[32m'I'[0m[39m :[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m([0m[32m'M'[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m10[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;36m3[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m4[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39mcase nikonV1: [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39mbase = MNOTE_NIKON1_TAG_BASE;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[35m/[0m[39m* v1 has offsets based to main IFD, not makernote IFD *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39m        [0m[39mdatao += n->offset + [0m[1;36m10[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39m        [0m[35m/[0m[39m* subtract the size here, so the increment in the next case will [0m  [2m                [0m
[2;36m                    [0m         [39mnot harm us *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39m        [0m[39m*buf_size -= [0m[1;36m8[0m[39m + [0m[1;36m2[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[35m/[0m[39m* Fall through to nikonV2 handler *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mcase nikonV2: [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[35m/[0m[39m* Write out V0 files in V2 format *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39mcase nikonV0: [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39m        [0m[39m*buf_size += [0m[1;36m8[0m[39m + [0m[1;36m2[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39m        [0m[39m*buf_size += [0m[1;36m4[0m[39m; [0m[35m/[0m[39m* Next IFD pointer *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39m*buf = exif_mem_alloc [0m[1;39m([0m[39mne->mem, *buf_size[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!*buf[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39m*buf_size[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Write the header and the number of entries. *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mstrcpy [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m*buf, [0m[32m"Nikon"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39m        [0m[1;39m([0m[39m*buf[0m[1;39m)[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m = n->version;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->version != nikonV1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m10[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;39m([0m          [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mn->order == EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m ?[0m               [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[32m'I'[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[32m'I'[0m[39m :[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[32m'M'[0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m12[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;36m0x2A[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + [0m[1;36m14[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;36m8[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m + [0m[1;36m8[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[39mdatao -= [0m[1;36m10[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Reset next IFD pointer *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o2 + [0m[1;36m2[0m[39m + n->count * [0m[1;36m12[0m[39m, n->order, [0m[1;36m0[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o2, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->count[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[35m/[0m[39m* Save each entry *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mo = o2 + i * [0m[1;36m12[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m0[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag - base[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m2[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mexif_set_long  [0m[1;39m([0m[39m*buf + o + [0m[1;36m4[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-data.c[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2001[0m[39m Lutz Mueller <lutz@users.sourceforge.net>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include <libexif/exif-mnote-data.h>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <libexif/exif-ifd.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <libexif/exif-mnote-data-priv.h>[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-loader.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-log.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <libexif/i18n.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include <libexif/exif-system.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include <libexif/apple/exif-mnote-data-apple.h>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include <libexif/canon/exif-mnote-data-canon.h>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include <libexif/fuji/exif-mnote-data-fuji.h>[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include <libexif/olympus/exif-mnote-data-olympus.h>[0m                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include <libexif/pentax/exif-mnote-data-pentax.h>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include <math.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#undef JPEG_MARKER_SOI[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#define JPEG_MARKER_SOI  [0m[1;36m0xd8[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:#undef JPEG_MARKER_APP0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#define JPEG_MARKER_APP0 [0m[1;36m0xe0[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#undef JPEG_MARKER_APP1[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define JPEG_MARKER_APP1 [0m[1;36m0xe1[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:static const unsigned char ExifHeader[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x45[0m[39m, [0m[1;36m0x78[0m[39m, [0m[1;36m0x69[0m[39m, [0m[1;36m0x66[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[1;39m}[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:struct _ExifDataPrivate[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[39mExifByteOrder order;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39mExifMnoteData *md;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39mExifLog *log;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mExifMem *mem;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39munsigned int ref_count;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[35m/[0m[39m* Temporarily used while loading data *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39munsigned int offset_mnote;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mExifDataOption options;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mExifDataType data_type;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:static void *[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:e[0m[39mxif_data_alloc [0m[1;39m([0m[39mExifData *data, unsigned int i[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mvoid *d;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data || !i[0m[1;39m)[0m[39m [0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39md = exif_mem_alloc [0m[1;39m([0m[39mdata->priv->mem, i[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39mif [0m[1;39m([0m[39md[0m[1;39m)[0m[39m [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39mreturn d;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mEXIF_LOG_NO_MEMORY [0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, i[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m89:E[0m[39mxifMnoteData *[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m90:e[0m[39mxif_data_get_mnote_data [0m[1;39m([0m[39mExifData *d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39mreturn [0m[1;39m([0m[39md && d->priv[0m[1;39m)[0m[39m ? d->priv->md : NULL;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m95:E[0m[39mxifData *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m96:e[0m[39mxif_data_new [0m[1;39m([0m[39mvoid[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mExifMem *mem = exif_mem_new_default [0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39mExifData *d = exif_data_new_mem [0m[1;39m([0m[39mmem[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mexif_mem_unref [0m[1;39m([0m[39mmem[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mreturn d;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m106:E[0m[39mxifData *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m107:e[0m[39mxif_data_new_mem [0m[1;39m([0m[39mExifMem *mem[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mExifData *data;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!mem[0m[1;39m)[0m[39m [0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39mdata = exif_mem_alloc [0m[1;39m([0m[39mmem, sizeof [0m[1;39m([0m[39mExifData[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m[39m [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39mdata->priv = exif_mem_alloc [0m[1;39m([0m[39mmem, sizeof [0m[1;39m([0m[39mExifDataPrivate[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data->priv[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39mmem, data[0m[1;39m)[0m[39m; [0m                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m; [0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mdata->priv->ref_count = [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mdata->priv->mem = mem;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mexif_mem_ref [0m[1;39m([0m[39mmem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < EXIF_IFD_COUNT; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mdata->ifd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = exif_content_new_mem [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!data->ifd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_data_free [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn [0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39m        [0m[39mdata->ifd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m->parent = data;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[35m/[0m[39m* Default options *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:#ifndef NO_VERBOSE_TAG_STRINGS[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39m * When the tag list is compiled away, setting this option prevents[0m         [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39m * any tags from being loaded[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mexif_data_set_option [0m[1;39m([0m[39mdata, EXIF_DATA_OPTION_IGNORE_UNKNOWN_TAGS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mexif_data_set_option [0m[1;39m([0m[39mdata, EXIF_DATA_OPTION_FOLLOW_SPECIFICATION[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[35m/[0m[39m* Default data type: none *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mexif_data_set_data_type [0m[1;39m([0m[39mdata, EXIF_DATA_TYPE_COUNT[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m153:E[0m[39mxifData *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_data_new_from_data [0m[1;39m([0m[39mconst unsigned char *data, unsigned int size[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mExifData *edata;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39medata = exif_data_new [0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39mexif_data_load_data [0m[1;39m([0m[39medata, data, size[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39medata[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:static int[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m164:e[0m[39mxif_data_load_data_entry [0m[1;39m([0m[39mExifData *data, ExifEntry *entry,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[39m        [0m[39m        [0m[39m   const unsigned char *d,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39m        [0m[39m        [0m[39m   unsigned int size, unsigned int offset[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39munsigned int s, doff;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39mentry->tag        = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m0[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mentry->format     = exif_get_short [0m[1;39m([0m[39md + offset + [0m[1;36m2[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39mentry->components = exif_get_long  [0m[1;39m([0m[39md + offset + [0m[1;36m4[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[35m/[0m[39m* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent [0m       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39m * has not been set yet[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, entry->tag,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39m  exif_tag_get_name [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[35m/[0m[39m* [0m[1;39m{[0m[1;36m0[0m[39m,[0m[1;36m1[0m[39m,[0m[1;36m2[0m[39m,[0m[1;36m4[0m[39m,[0m[1;36m8[0m[1;39m}[0m[39m x [0m[1;39m{[0m[39m [0m[1;36m0x00000000[0m[39m .. [0m[1;36m0xffffffff[0m[39m [0m[1;39m}[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[39m *   -> [0m[1;39m{[0m[39m [0m[1;36m0x000000000[0m[39m .. [0m[1;36m0x7fffffff8[0m[39m [0m[1;39m}[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39ms = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m * entry->components;[0m                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39ms < entry->components[0m[1;39m)[0m[39m || [0m[1;39m([0m[39ms == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39m        [0m[39mdoff = exif_get_long [0m[1;39m([0m[39md + offset + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdoff >= size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:237[0m[39m-[0m[1;36m247[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[1;35mxif_mnote_data_apple_identify[0m[1;39m([0m[39mconst ExifData *ed, const ExifEntry *e[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    int variant;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m e->data, [0m[32m"Apple iOS"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:        variant = [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        variant = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    return variant;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:200[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m: *        return, and what is a reaction to an error condition.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:200[0m[39m-[0m[1;36m260[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mexif_set_long  [0m[1;39m([0m[39m*buf + o + [0m[1;36m4[0m[39m, n->order,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[39m        [0m[39mo += [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m *[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m           [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Corrupt data: EXIF data size is limited to the[0m           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39m        [0m[39m * maximum size of a JPEG segment [0m[1;39m([0m[1;36m64[0m[39m kb[0m[1;39m)[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = *buf_size;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39m        [0m[39mts = *buf_size + s;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39mt = exif_mem_realloc [0m[1;39m([0m[39mne->mem, *buf,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m sizeof [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m * ts[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mts[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf = t;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39m        [0m[39m*buf_size = ts;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + o, n->order, datao + doff[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[39m        [0m[39mdoff = o;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Write the data. *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39m*buf + doff, n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, s[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Most certainly damaged input file *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemset [0m[1;39m([0m[39m*buf + doff, [0m[1;36m0[0m[39m, s[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[39mxif_mnote_data_olympus_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39m        [0m[39m      const unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m en;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39msize_t i, tcount, o, o2, datao = [0m[1;36m6[0m[39m, base = [0m[1;36m0[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m * Olympus headers start with [0m[32m"OLYMP"[0m[39m and need to have at least[0m             [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m * a size of [0m[1;36m22[0m[39m bytes [0m[1;39m([0m[1;36m6[0m[39m for [0m[32m'OLYMP'[0m[39m, [0m[1;36m2[0m[39m other bytes, [0m[1;36m2[0m[39m for the[0m              [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m * number of entries, and [0m[1;36m12[0m[39m for one entry.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The function `exif_mnote_data_apple_identify` unconditionally invokes [0m         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39me->data, [0m[32m"Apple iOS"[0m[1;39m)[0m[39m`.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Maker-note data [0m[1;39m([0m[39m`e->data`[0m[1;39m)[0m[39m is a raw memory buffer of length `s = [0m             [2m                [0m
[2;36m                    [0m         [1;35mexif_format_get_size[0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m * e->components`. It is neither NUL-terminated nor [0m [2m                [0m
[2;36m                    [0m         [39mguaranteed to be at least as long as the constant string `[0m[32m"Apple iOS"[0m[39m`.  [0m           [2m                [0m
[2;36m                    [0m         [39m   - When `s < [0m[1;35mstrlen[0m[1;39m([0m[32m"Apple iOS"[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m`, `strcmp` overruns the [0m[1;36m2[0m[39m-byte allocation on[0m [2m                [0m
[2;36m                    [0m         [39mmalformed inputs, causing the observed heap-buffer-overflow.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Fix Outline[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Replace the unbounded `strcmp` with a length-guarded comparison using `memcmp`[0m [2m                [0m
[2;36m                    [0m         [39mor `strncmp`.  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Compute the actual maker-note data size [0m[1;39m([0m[39m`buflen = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mexif_format_get_size[0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m * e->components`[0m[1;39m)[0m[39m and ensure it is at least as [0m     [2m                [0m
[2;36m                    [0m         [39mlarge as the signature prefix.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Only compare the first `N = [0m[1;35mstrlen[0m[1;39m([0m[32m"Apple iOS"[0m[1;39m)[0m[39m` bytes when `buflen >= N`.  [0m   [2m                [0m
[2;36m                    [0m         [39m   - Return variant [0m[1;36m1[0m[39m if and only if the prefix matches; otherwise return [0m[1;36m0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mexactly as before.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps to Implement[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   a. In `apple/exif-mnote-data-apple.c`, modify `exif_mnote_data_apple_identify`:[0m  [2m                [0m
[2;36m                    [0m         [39m      - Add a preliminary null-check on `e` and `e->data`.[0m                          [2m                [0m
[2;36m                    [0m         [39m      - Include `<libexif/exif-format.h>` if not already present, to call [0m          [2m                [0m
[2;36m                    [0m         [39m`exif_format_get_size`.[0m                                                             [2m                [0m
[2;36m                    [0m         [39m      - Define a local constant `static const char apple_sig[0m[1;39m[[0m[1;39m][0m[39m = [0m[32m"Apple iOS"[0m[39m;` and [0m [2m                [0m
[2;36m                    [0m         [39mcalculate its length `siglen = [0m[1;35msizeof[0m[1;39m([0m[39mapple_sig[0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;`.[0m                             [2m                [0m
[2;36m                    [0m         [39m      - Compute the buffer length:  [0m                                                [2m                [0m
[2;36m                    [0m         [39m          `size_t buflen = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39me->format[0m[1;39m)[0m[39m * [0m                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msize_t[0m[1;39m)[0m[39me->components;`[0m                                                             [2m                [0m
[2;36m                    [0m         [39m      - If `buflen >= siglen` and `[0m[1;35mmemcmp[0m[1;39m([0m[39me->data, apple_sig, siglen[0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m`, return[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m; otherwise return [0m[1;36m0[0m[39m.[0m                                                              [2m                [0m
[2;36m                    [0m         [39m      - Remove or comment out the existing `strcmp` invocation.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Preserve existing API and logic:[0m                                              [2m                [0m
[2;36m                    [0m         [39m      - Keep the function signature unchanged.[0m                                      [2m                [0m
[2;36m                    [0m         [39m      - Continue returning [0m[1;36m1[0m[39m for Apple variant, [0m[1;36m0[0m[39m otherwise [0m[1;39m([0m[39mso that other [0m         [2m                [0m
[2;36m                    [0m         [39mmaker-note handlers remain invoked only when identify returns nonzero[0m[1;39m)[0m[39m.[0m             [2m                [0m
[2;36m                    [0m         [39m      - Do not touch harness, tests, or any other utility code.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Rationale & Impact[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Using `memcmp` with an explicit length check prevents any out-of-bounds read, [0m [2m                [0m
[2;36m                    [0m         [39meliminating the heap-buffer-overflow.  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - This approach exactly emulates the intent of the original `strcmp` [0m[1;39m([0m[39mdetecting [0m [2m                [0m
[2;36m                    [0m         [39mthe `[0m[32m"Apple iOS"[0m[39m` prefix[0m[1;39m)[0m[39m but with explicit bounds safety.  [0m                        [2m                [0m
[2;36m                    [0m         [39m   - Other identify routines [0m[1;39m([0m[39mOlympus, Canon, etc.[0m[1;39m)[0m[39m follow the same pattern of [0m     [2m                [0m
[2;36m                    [0m         [39mlength checks plus fixed-length compares—this patch aligns Apple’s code with that [0m  [2m                [0m
[2;36m                    [0m         [39mproven, safe pattern.  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - No existing functionality is removed; Apple maker-note data of sufficient [0m     [2m                [0m
[2;36m                    [0m         [39mlength and matching prefix will still be detected.  [0m                                [2m                [0m
[2;36m                    [0m         [39m   - Since malformed or truncated buffers now simply lead to `identify` returning [0m  [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m, there is no risk of false positives or breaking downstream code paths for valid [0m [2m                [0m
[2;36m                    [0m         [39minputs.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - No other parts of the codebase or fuzz harness need modification.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side-Effects & Mitigations[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - If someone passed a non-Apple maker-note that coincidentally starts with [0m      [2m                [0m
[2;36m                    [0m         [39m`[0m[32m"Apple iOS"[0m[39m` but has no terminator, our fix still correctly identifies it. That [0m   [2m                [0m
[2;36m                    [0m         [39mmatches the original behavior.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - There is no risk of overflow in the length calculation for realistic component[0m [2m                [0m
[2;36m                    [0m         [39mcounts, and we avoid multiplying extremely large values because fuzzers will not [0m   [2m                [0m
[2;36m                    [0m         [39mordinarily produce absurd `components` values—they are first bounded by EXIF format[0m [2m                [0m
[2;36m                    [0m         [39msize checks in `exif_data_load_data_entry`.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Ensure that the include of `<libexif/exif-format.h>` does not conflict; if [0m    [2m                [0m
[2;36m                    [0m         [39mneeded, guard the include with existing config macros.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Verification[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Rebuild libexif and re-run `exif_loader_fuzzer` under AddressSanitizer to [0m     [2m                [0m
[2;36m                    [0m         [39mconfirm the overflow is eliminated.  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Execute the existing test suite to validate that Apple maker-note parsing [0m     [2m                [0m
[2;36m                    [0m         [39mstill works for valid sample files.  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Optionally add a unit test in `apple/exif-mnote-data-apple.c` to feed a [0m[1;36m2[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mbuffer and assert `identify` returns [0m[1;36m0[0m[39m without crash.  [0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 23:31:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=164377;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=530976;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=358716;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=574800;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp929n9gtu[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/libexif_ex-delta-01_exif-003/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766845908.2131217[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/libexif_ex-delta-01_exif-[1;36m003.[0mtoml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=420296;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=814298;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=322236;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=916232;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=341167;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=296657;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
