{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_7",
  "source_directory": "/home/user/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.15420129999999999,
    "prompt_tokens": 89843,
    "completion_tokens": 12585
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -44,6 +44,8 @@\n public class PDPageTree implements COSObjectable, Iterable<PDPage>\n {\n     private static final Logger LOG = LogManager.getLogger(PDPageTree.class);\n+    // Maximum depth for PageTree traversal to avoid performance issues\n+    private static final int MAX_PAGE_TREE_DEPTH = 100;\n     private final COSDictionary root;\n     private final PDDocument document; // optional\n \n@@ -183,16 +185,21 @@\n \n         private PageIterator(COSDictionary node)\n         {\n+            int level = 0;\n             List<COSDictionary> kids = enqueueKids(node);\n-            while (!kids.isEmpty())\n+            while (!kids.isEmpty() && level < MAX_PAGE_TREE_DEPTH)\n             {\n                 List<COSDictionary> newKids = new ArrayList<>();\n-\n                 for (COSDictionary kid : kids)\n                 {\n                     newKids.addAll(enqueueKids(kid));\n                 }\n                 kids = newKids;\n+                level++;\n+            }\n+            if (level >= MAX_PAGE_TREE_DEPTH)\n+            {\n+                LOG.warn(\"Page tree traversal exceeded max depth {}\", MAX_PAGE_TREE_DEPTH);\n             }\n         }\n \n",
  "stdout": "",
  "stderr": ""
}