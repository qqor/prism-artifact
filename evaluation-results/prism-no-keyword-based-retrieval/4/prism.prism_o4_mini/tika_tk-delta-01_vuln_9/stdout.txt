[2;36m[12/28/25 04:09:47][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=840722;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=946587;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpuotu2kst[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-01_vuln_9/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66862587.4316173[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-01_vuln_9.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=964529;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=268526;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:11:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m101.55[0m ]8;id=582642;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=475015;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=356457;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=158795;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=100615;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=690687;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=80247;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=690369;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m101[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m[12/28/25 04:11:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=696812;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=880996;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.61[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=173026;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=575912;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/28/25 04:11:31][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=427459;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=401929;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=656369;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=742287;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=327717;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=839424;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=874044;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=565016;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:11:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m3.89[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=566039;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=901640;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=745376;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=576771;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:11:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.55[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=277499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=515058;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/28/25 04:11:48][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=664156;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=731000;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/28/25 04:11:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=298688;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=578545;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 04:12:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=457097;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=514915;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 04:13:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=466332;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=979753;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=191537;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=852429;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:13:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.53[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=785290;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=880267;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=849737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpfbb3h63b[0m                                                 ]8;id=334641;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=173095;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/28/25 04:15:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m78.09[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=209838;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516402;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=71914;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=421444;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:15:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m30.55[0m seconds;                ]8;id=488817;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=770011;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=798191;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=922605;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:15:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m15.36[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=971578;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=716003;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=206200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=509488;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=648668;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=914932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=810408;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=298443;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:15:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.56[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=520696;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674828;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/28/25 04:15:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=742132;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=672659;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:15:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.67[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=942603;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=153386;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=197303;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 04:16:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.59[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=251677;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=966629;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=427054;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=585923;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         @@ [1;36m-35[0m,[1;36m6[0m +[1;36m35[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.util.concurrent.TimeoutException;                                      [2m                [0m
[2;36m                    [0m          import java.util.regex.Matcher;                                                    [2m                [0m
[2;36m                    [0m          import java.util.regex.Pattern;                                                    [2m                [0m
[2;36m                    [0m         +import java.util.Arrays;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.commons.io.IOUtils;                                              [2m                [0m
[2;36m                    [0m          import org.apache.commons.io.output.NullOutputStream;                              [2m                [0m
[2;36m                    [0m         @@ [1;36m-91[0m,[1;36m6[0m +[1;36m92[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m               * @see Runtime#[1;35mexec[0m[1m([0mString[1m[[0m[1m][0m[1m)[0m                                                 [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              private String[1m[[0m[1m][0m command = new String[1m[[0m[1m][0m[1m{[0m[32m"cat"[0m[1m}[0m;                                [2m                [0m
[2;36m                    [0m         +    [35m/[0m[35m/[0m Pattern to allow only safe command elements: alphanumeric, underscore, dot, [2m                [0m
[2;36m                    [0m         slash, dash                                                                         [2m                [0m
[2;36m                    [0m         +    private static final Pattern SAFE_CMD =                                        [2m                [0m
[2;36m                    [0m         [1;35mPattern.compile[0m[1m([0m[32m"^[0m[32m[[0m[32mA-Za-z0-9_./\\\\-[0m[32m][0m[32m+$"[0m[1m)[0m;                                          [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m               * A consumer for ignored Lines                                                [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         @@ [1;36m-224[0m,[1;36m7[0m +[1;36m227[0m,[1;36m12[0m @@                                                                [2m                [0m
[2;36m                    [0m               * @see Runtime#[1;35mexec[0m[1m([0mString[1m[[0m[1m][0m[1m)[0m                                                 [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              public void [1;35msetCommand[0m[1m([0mString[33m...[0m command[1m)[0m [1m{[0m                                    [2m                [0m
[2;36m                    [0m         -        this.command = command;                                                    [2m                [0m
[2;36m                    [0m         +        for [1m([0mString c : command[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         +            if [1m([0m![1;35mSAFE_CMD.matcher[0m[1m([0mc[1m)[0m[1;35m.matches[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m         +                throw new [1;35mIllegalArgumentException[0m[1m([0m[32m"Invalid command element: "[0m +   [2m                [0m
[2;36m                    [0m         c[1m)[0m;                                                                                 [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        this.command = [1;35mArrays.copyOf[0m[1m([0mcommand, command.length[1m)[0m;                     [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         @@ [1;36m-306[0m,[1;36m15[0m +[1;36m314[0m,[1;36m12[0m @@                                                               [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  [35m/[0m[35m/[0m Execute                                                                 [2m                [0m
[2;36m                    [0m         -        Process process = null;                                                    [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            if [1m([0mcmd.length == [1;36m1[0m[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         -                process = [1;35mRuntime.getRuntime[0m[1m([0m[1m)[0m[1;35m.exec[0m[1m([0mcmd[1m[[0m[1;36m0[0m[1m][0m[1m)[0m;                       [2m                [0m
[2;36m                    [0m         -            [1m}[0m else [1m{[0m                                                               [2m                [0m
[2;36m                    [0m         -                process = [1;35mRuntime.getRuntime[0m[1m([0m[1m)[0m[1;35m.exec[0m[1m([0mcmd[1m)[0m;                          [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mException e[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m         -            [1;35mLOG.warn[0m[1m([0m[32m"problem with process exec"[0m, e[1m)[0m;                              [2m                [0m
[2;36m                    [0m         +        Process process;                                                           [2m                [0m
[2;36m                    [0m         +        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         +            process = new [1;35mProcessBuilder[0m[1m([0mcmd[1m)[0m[1;35m.start[0m[1m([0m[1m)[0m;                             [2m                [0m
[2;36m                    [0m         +        [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m         +            [1;35mLOG.warn[0m[1m([0m[32m"problem starting external process"[0m, e[1m)[0m;                      [2m                [0m
[2;36m                    [0m         +            return;                                                                [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-360[0m,[1;36m9[0m +[1;36m360[0m,[1;36m9[0m @@                                                                 [2m                [0m
[2;36m                    [0m                      return;                                                                [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  int added = [1;36m0[0m;                                                             [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mmetadata.get[0m[1m([0m[32m"html_meta:exiftool_path"[0m[1m)[0m != null[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -            added = [1;35mconfigureExifTool[0m[1m([0m[1;35mmetadata.get[0m[1m([0m[32m"html_meta:exiftool_path"[0m[1m)[0m[1m)[0m;    [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Metadata-based exiftool configuration removed for security              [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m untrusted HTML metadata cannot override external parser                 [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m added remains [1;36m0[0m                                                         [2m                [0m
[2;36m                    [0m                  [35m/[0m[35m/[0m[95mdo[0m anything with attrs?                                                  [2m                [0m
[2;36m                    [0m                  Metadata m = new [1;35mMetadata[0m[1m([0m[1m)[0m;                                               [2m                [0m
[2;36m                    [0m                  [1;35mm.set[0m[1m([0mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A Jazzer fuzzing run reported a critical security issue: an OS command injection    [2m                [0m
[2;36m                    [0m         vulnerability. The exception trace shows that attacker-controlled input reaches a   [2m                [0m
[2;36m                    [0m         call to Runtime.exec/ProcessBuilder within Apache Tika’s `ExternalParser`,          [2m                [0m
[2;36m                    [0m         triggering a `FuzzerSecurityIssueCritical`.                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue Type: OS Command Injection                                                  [2m                [0m
[2;36m                    [0m           Jazzer’s `OsCommandInjection` sanitizer detected attacker-controlled data being   [2m                [0m
[2;36m                    [0m         passed into an operating‐system command execution API, which can lead to arbitrary  [2m                [0m
[2;36m                    [0m         command execution.                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - What Happened                                                                     [2m                [0m
[2;36m                    [0m           The fuzzer harness [1m([0m`HtmlParserFuzzer.fuzzerTestOneInput` → `parseOne`[1m)[0m feeds     [2m                [0m
[2;36m                    [0m         crafted input into Apache Tika’s parsing pipeline. During parsing, Tika’s           [2m                [0m
[2;36m                    [0m         `ExternalParser.parse` invokes `Runtime.exec` [1m([0mvia `ProcessBuilder.start`[1m)[0m with     [2m                [0m
[2;36m                    [0m         arguments that include data derived from the input. Jazzer intercepts this          [2m                [0m
[2;36m                    [0m         execution and raises a `FuzzerSecurityIssueCritical: OS Command Injection`          [2m                [0m
[2;36m                    [0m         exception.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Key Observations                                                                  [2m                [0m
[2;36m                    [0m           • The stack trace pinpoints `OsCommandInjection.processImplStartHook` as the      [2m                [0m
[2;36m                    [0m         sanitizer entry point, followed by standard Java process‐launch methods             [2m                [0m
[2;36m                    [0m         [1m([0m`ProcessBuilder.start`, `Runtime.exec`[1m)[0m.                                           [2m                [0m
[2;36m                    [0m           • The vulnerable call chain originates in                                         [2m                [0m
[2;36m                    [0m         `org.apache.tika.parser.external.ExternalParser` [1m([0mlines [1;36m274[0m and [1;36m314[0m in the trace[1m)[0m.  [2m                [0m
[2;36m                    [0m           • The parsing pipeline includes multiple layers—`ParserDecorator`,                [2m                [0m
[2;36m                    [0m         `CompositeParser`, `AutoDetectParser`, `DelegatingParser`,                          [2m                [0m
[2;36m                    [0m         `ParsingEmbeddedDocumentExtractor`, and HTML‐specific handling [1m([0m`HtmlHandler`,      [2m                [0m
[2;36m                    [0m         `XHTMLDowngradeHandler`, `JSoupParser`[1m)[0m.                                            [2m                [0m
[2;36m                    [0m           • The fuzzer harness code in `HtmlParserFuzzer` is merely the entry point and not [2m                [0m
[2;36m                    [0m         the root cause; it demonstrates how external input flows into Tika’s external       [2m                [0m
[2;36m                    [0m         command invocation.                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Areas for Investigation                                                           [2m                [0m
[2;36m                    [0m           [1;36m1[0m. **ExternalParser Logic**: Review how command arguments are constructed in      [2m                [0m
[2;36m                    [0m         `ExternalParser.parse`. Pay special attention to any concatenation or interpolation [2m                [0m
[2;36m                    [0m         of input-derived strings into command‐line parameters.                              [2m                [0m
[2;36m                    [0m           [1;36m2[0m. **HTML Parser Hooks**: Examine `HtmlHandler.handleDataURIScheme` and related   [2m                [0m
[2;36m                    [0m         HTML parsing steps to see how embedded payloads might reach the external parser.    [2m                [0m
[2;36m                    [0m           [1;36m3[0m. **Fuzzer Harness Input Flow**: Trace how `HtmlParserFuzzer.parseOne` passes    [2m                [0m
[2;36m                    [0m         raw data into Tika components, ensuring no sanitization or validation occurs before [2m                [0m
[2;36m                    [0m         external command invocation.                                                        [2m                [0m
[2;36m                    [0m           [1;36m4[0m. **Command Execution APIs**: Audit all uses of `Runtime.exec` and               [2m                [0m
[2;36m                    [0m         `ProcessBuilder` across the codebase, not just in `ExternalParser`, to identify     [2m                [0m
[2;36m                    [0m         other potential injection points.                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:250[0m[39m-[0m[1;36m30[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    public void [0m[1;35msetReturnStdout[0m[1;39m([0m[39mboolean returnStdout[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        this.returnStdout = returnStdout;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:     * If set to true, this will return the stderr in the metadata[0m              [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:     * via [0m[1;39m{[0m[39m@link org.apache.tika.metadata.ExternalProcess#STD_ERR[0m[1;39m}[0m[39m.[0m            [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * Default is <code>true<[0m[35m/[0m[95mcode[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     * @param returnStderr[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    public void [0m[1;35msetReturnStderr[0m[1;39m([0m[39mboolean returnStderr[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        this.returnStderr = returnStderr;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:     * This parser is called on the output of the process.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:     * If the process writes to an output file, specified by[0m                    [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:     * [0m[1;39m{[0m[39m@link ExternalParser#OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m, this parser will parse that [0m   [2m                [0m
[2;36m                    [0m         [39mfile,[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:     * otherwise it will parse the UTF-[0m[1;36m8[0m[39m encoded bytes from the process' [0m       [2m                [0m
[2;36m                    [0m         [39mSTD_OUT.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:     * @param parser[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    public void [0m[1;35msetOutputParser[0m[1;39m([0m[39mParser parser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        this.outputParser = parser;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    public Parser [0m[1;35mgetOutputParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        return outputParser;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    public void [0m[1;35minitialize[0m[1;39m([0m[39mMap<String, Param> params[0m[1;39m)[0m[39m throws [0m                   [2m                [0m
[2;36m                    [0m         [39mTikaConfigException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[35m/[0m[35m/[0m[95mno-op[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    public void [0m[1;35mcheckInitialization[0m[1;39m([0m[39mInitializableProblemHandler problemHandler[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            throws TikaConfigException [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[1;35msupportedTypes.size[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            throw new [0m[1;35mTikaConfigException[0m[1;39m([0m[32m"supportedTypes size must be > 0"[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        if [0m[1;39m([0m[1;35mcommandLine.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            throw new [0m[1;35mTikaConfigException[0m[1;39m([0m[32m"commandLine is empty?!"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        if [0m[1;39m([0m[39moutputParser == EmptyParser.INSTANCE[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"no parser selected for the output; contents will be "[0m[39m +[0m  [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                    [0m[32m"written to the content handler"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:350[0m[39m-[0m[1;36m420[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m120[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * A consumer for ignored Lines[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private LineConsumer ignoredLineConsumer = LineConsumer.NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Starts a thread that reads and discards the contents of the[0m              [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * standard stream of the given process. Potential exceptions[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * are ignored, and the stream is closed once fully processed.[0m              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * Note: calling this starts a new thread and blocks the [0m[1;35mcurrent[0m[1;39m([0m[39mcaller[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * thread until the new thread dies[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     * @param stream stream to be ignored[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    private static void [0m[1;35mignoreStream[0m[1;39m([0m[39mfinal InputStream stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;35mignoreStream[0m[1;39m([0m[39mstream, true[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     * Starts a thread that reads and discards the contents of the[0m              [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     * standard stream of the given process. Potential exceptions[0m               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * are ignored, and the stream is closed once fully processed.[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * @param stream       stream to sent to black hole [0m[1;39m([0m[39ma k a null[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * @param waitForDeath when [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m the caller thread will be[0m          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *                     blocked till the death of new thread.[0m                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * @return The thread that is created and started[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:300[0m[39m-[0m[1;36m380[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            if [0m[1;39m([0m[39minputToStdIn[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                [0m[1;35msendInput[0m[1;39m([0m[39mprocess, stream[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:            InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            if [0m[1;39m([0m[39mhasPatterns[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                [0m[1;35mextractMetadata[0m[1;39m([0m[39merr, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                    [0m[1;35mextractMetadata[0m[1;39m([0m[39mout, metadata[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                [0m[1;35mignoreStream[0m[1;39m([0m[39merr[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:                    [0m[1;35mignoreStream[0m[1;39m([0m[39mout[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException ignore[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:        [0m[35m/[0m[35m/[0m[39m Grab the output if we haven't already[0m                                [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        if [0m[1;39m([0m[39m!outputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:            try [0m[1;39m([0m[39mFileInputStream fileInputStream = new [0m[1;35mFileInputStream[0m[1;39m([0m[39moutput[0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                [0m[1;35mextractOutput[0m[1;39m([0m[39mfileInputStream, xhtml[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:     * Starts a thread that extracts the contents of the standard output[0m        [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:     * stream of the given process to the given XHTML content handler.[0m          [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:     * The standard output stream is closed once fully processed.[0m               [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:     * @param stream[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:     * @param xhtml  XHTML content handler[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:     * @throws SAXException if the XHTML SAX events could not be handled[0m        [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:     * @throws IOException  if an input error occurred[0m                          [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:    private void [0m[1;35mextractOutput[0m[1;39m([0m[39mInputStream stream, XHTMLContentHandler xhtml[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:        try [0m[1;39m([0m[39mReader reader = new [0m[1;35mInputStreamReader[0m[1;39m([0m[39mstream, UTF_8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:            [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m buffer = new char[0m[1;39m[[0m[1;36m1024[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            for [0m[1;39m([0m[39mint n = [0m[1;35mreader.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m; n != [0m[1;36m-1[0m[39m; n = [0m[1;35mreader.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mxhtml.characters[0m[1;39m([0m[39mbuffer, [0m[1;36m0[0m[39m, n[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:362[0m[39m-[0m[1;36m383[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:120[0m[39m-[0m[1;36m160[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * @return The thread that is created and started[0m                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    private static Thread [0m[1;35mignoreStream[0m[1;39m([0m[39mfinal InputStream stream, boolean [0m       [2m                [0m
[2;36m                    [0m         [39mwaitForDeath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        Thread t = new [0m[1;35mThread[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mstream, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                [0m[1;35mIOUtils.closeQuietly[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mt.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mwaitForDeath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mt.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException ignore[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        return t;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * Checks to see if the command can be run. Typically used with[0m             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * something like [0m[32m"myapp --version"[0m[39m to check to see if [0m[32m"myapp"[0m              [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * is installed and on the path.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * @param checkCmd   The check command to run[0m                               [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * @param errorValue What is considered an error value?[0m                     [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:160[0m[39m-[0m[1;36m230[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        return [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        return supportedTypes;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    public void [0m[1;35msetSupportedTypes[0m[1;39m([0m[39mSet<MediaType> supportedTypes[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        this.supportedTypes = [0m[1;35mCollections.unmodifiableSet[0m[1;39m([0m[39mnew [0m                  [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[39msupportedTypes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root-Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The OS command injection arises because untrusted, attacker-controlled data [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mthe `html_met[0m[1;92ma:e[0m[39mxiftool_path` metadata value[0m[1;39m)[0m[39m is passed directly into [0m             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mExternalParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m`. Internally, `[0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mthen invokes `[0m[1;35mRuntime.exec[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mand in single-element cases delegates to the [0m     [2m                [0m
[2;36m                    [0m         [39mshell[0m[1;39m)[0m[39m, allowing arbitrary binaries or shell sequences to run.[0m                      [2m                [0m
[2;36m                    [0m         [39m   - The feature in `HtmlHandler.handleDataURIScheme` that reads [0m                   [2m                [0m
[2;36m                    [0m         [39m`html_met[0m[1;92ma:e[0m[39mxiftool_path` from the HTML payload and dynamically reconfigures an [0m    [2m                [0m
[2;36m                    [0m         [39m`ExternalParser` instance at parse-time is the direct injection vector.[0m             [2m                [0m
[2;36m                    [0m         [39m   - No sanitization or validation is applied to the `path` string, and the parser [0m [2m                [0m
[2;36m                    [0m         [39mcode uses `[0m[1;35mRuntime.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m` when the command array has length [0m[1;36m1[0m[39m—thus routing [0m  [2m                [0m
[2;36m                    [0m         [39mthrough the shell.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Strategy Overview[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - Eliminate the “configure from HTML metadata” shortcut, since it permits [0m       [2m                [0m
[2;36m                    [0m         [39muntrusted documents to control which program is run.[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Require all external-command configuration [0m[1;39m([0m[39me.g. exiftool path, flags[0m[1;39m)[0m[39m to come[0m [2m                [0m
[2;36m                    [0m         [39mfrom the static TikaConfig [0m[1;39m([0m[39mXML or programmatic[0m[1;39m)[0m[39m or environment/system [0m             [2m                [0m
[2;36m                    [0m         [39mproperties—never from embedded HTML metadata.[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Harden `ExternalParser` itself:[0m                                                [2m                [0m
[2;36m                    [0m         [39m     a[0m[1;39m)[0m[39m Always invoke external processes via `ProcessBuilder` with a String[0m[1;39m[[0m[1;39m][0m[39m to [0m   [2m                [0m
[2;36m                    [0m         [39mavoid shell interpretation, removing the single-argument `[0m[1;35mRuntime.exec[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mbranch.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m     b[0m[1;39m)[0m[39m Introduce basic validation in `[0m[1;35mExternalParser.setCommand[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` to reject [0m   [2m                [0m
[2;36m                    [0m         [39mobviously invalid or dangerous inputs [0m[1;39m([0m[39me.g. any element containing whitespace or [0m   [2m                [0m
[2;36m                    [0m         [39mshell metacharacters `; & | > < \`[0m[1;39m)[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Preserve the existing public API so users who correctly configured external [0m   [2m                [0m
[2;36m                    [0m         [39mparsers in TikaConfig are unaffected.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mStep [0m[1;36m1[0m[39m – Disable metadata-based configuration in HtmlHandler[0m                        [2m                [0m
[2;36m                    [0m         [39m  - In `HtmlHandler.handleDataURIScheme` [0m[1;39m([0m[39mtika-parser-html-module[0m[1;39m)[0m[39m, remove or [0m      [2m                [0m
[2;36m                    [0m         [39mneutralize the block:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m      if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m          added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    so that user-supplied HTML cannot change which external tool is invoked. Retain[0m [2m                [0m
[2;36m                    [0m         [39membedded-extraction via configured parsers only.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mStep [0m[1;36m2[0m[39m – Strengthen [0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m invocation path[0m                          [2m                [0m
[2;36m                    [0m         [39m  - In `[0m[1;35mExternalParser.parse[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mtika-core[0m[1;39m)[0m[39m, refactor the process-start logic:[0m   [2m                [0m
[2;36m                    [0m         [39m      old:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      new:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        try [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m            [0m[35m/[0m[35m/[0m[39m Always use ProcessBuilder to avoid shell interpretation[0m              [2m                [0m
[2;36m                    [0m         [39m            process = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[1;35m.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem starting external process"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m            return; [0m[35m/[0m[35m/[0m[39m or wrap/propagate as TikaException[0m                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mStep [0m[1;36m3[0m[39m – Add basic command-element validation in setCommand[0m                         [2m                [0m
[2;36m                    [0m         [39m  - In `[0m[1;35mExternalParser.setCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m`, before assigning to [0m         [2m                [0m
[2;36m                    [0m         [39m`this.command`, iterate over each element:[0m                                          [2m                [0m
[2;36m                    [0m         [39m      private static final Pattern SAFE_CMD = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mPattern.compile[0m[1;39m([0m[32m"^[0m[32m[[0m[32mA-Za-z0-9_./\\-[0m[32m][0m[32m+$"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m      public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m          for [0m[1;39m([0m[39mString c : command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m              if [0m[1;39m([0m[39m![0m[1;35mSAFE_CMD.matcher[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [39m                  throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                               [2m                [0m
[2;36m                    [0m         [39m                      [0m[32m"Invalid command element: "[0m[39m + c[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m              [0m[1;39m}[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m          [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m          this.command = [0m[1;35mArrays.copyOf[0m[1;39m([0m[39mcommand, command.length[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    This rejects any attempt to inject shell metacharacters or spaces.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mStep [0m[1;36m4[0m[39m – [0m[1;39m([0m[39mOptional[0m[1;39m)[0m[39m Deprecate configureExifTool override[0m                            [2m                [0m
[2;36m                    [0m         [39m  - Mark `[0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m` and `[0m[1;35mresetExifTool[0m[1;39m([0m[39mint[0m[1;39m)[0m[39m` in `HtmlHandler` as [0m  [2m                [0m
[2;36m                    [0m         [39mdeprecated in favor of static TikaConfig-based setup. This ensures future [0m          [2m                [0m
[2;36m                    [0m         [39mmaintainers don’t reintroduce dynamic metadata-driven configuration.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Removing the metadata override in `HtmlHandler` ensures untrusted documents [0m   [2m                [0m
[2;36m                    [0m         [39mcannot swap in arbitrary binaries.[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Always using `[0m[1;35mProcessBuilder[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m` avoids the single-string exec path [0m    [2m                [0m
[2;36m                    [0m         [39mthat invokes a shell and is universally recognized as a security risk.[0m              [2m                [0m
[2;36m                    [0m         [39m   - Whitelisting valid characters in `setCommand` provides defense-in-depth—any [0m   [2m                [0m
[2;36m                    [0m         [39mlegitimate executable path [0m[1;39m([0m[39me.g. `[0m[35m/usr/bin/[0m[95mexiftool[0m[39m`[0m[1;39m)[0m[39m passes, while injection [0m      [2m                [0m
[2;36m                    [0m         [39mpayloads [0m[1;39m([0m[39m`rm -rf`, `;`, `|`[0m[1;39m)[0m[39m are rejected.[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Tests and harness aren’t modified; existing valid, static configurations of [0m   [2m                [0m
[2;36m                    [0m         [39mexternal parsers continue working unchanged. No fuzz harness or external libraries [0m [2m                [0m
[2;36m                    [0m         [39mare touched.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side-Effects & Mitigation[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Users that relied on the ability to configure exiftool path via HTML `<meta>` [0m [2m                [0m
[2;36m                    [0m         [39mtags will see that feature disabled. Document the change in the release notes: [0m     [2m                [0m
[2;36m                    [0m         [39m“Metadata-based external parser overrides removed—use TikaConfig instead.”[0m          [2m                [0m
[2;36m                    [0m         [39m   - The stricter `SAFE_CMD` pattern may reject executable names with spaces or [0m    [2m                [0m
[2;36m                    [0m         [39mexotic Unicode characters. If needed, relax the regex to allow additional safe [0m     [2m                [0m
[2;36m                    [0m         [39mcharacters, but avoid whitespace or shell operators.[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Always catching `IOException` from `[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m` ensures we log a [0m  [2m                [0m
[2;36m                    [0m         [39mwarning rather than proceed with a null `process`. Confirm downstream code handles [0m [2m                [0m
[2;36m                    [0m         [39ma null or thrown exception cleanly.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References in Codebase[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Similar hardening in other languages or frameworks often replaces [0m             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mRuntime.exec[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m` with `ProcessBuilder` and applies whitelisting—this aligns [0m  [2m                [0m
[2;36m                    [0m         [39mwith best practices documented in the JDK security guides.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/28/25 04:16:01][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=489314;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=41190;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=132200;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=85938;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpuotu2kst[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-01_vuln_9/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66862961.0109727[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-01_vuln_9.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=80354;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=331883;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=705194;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=170744;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m[12/28/25 04:16:02][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=670781;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=456690;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
