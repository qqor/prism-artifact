{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-full-01_vuln_3",
  "source_directory": "/home/user/crete/.cache/official-afc-poi",
  "llm_usage": {
    "total_cost": 1.1956846000000003,
    "prompt_tokens": 693430,
    "completion_tokens": 98389
  },
  "variant": "sound",
  "diff": "--- a/poi/src/main/java/org/apache/poi/hssf/record/RecordInputStream.java\n+++ b/poi/src/main/java/org/apache/poi/hssf/record/RecordInputStream.java\n@@ -138,6 +138,11 @@\n             _bhi = bds;\n         }\n         _nextSid = readNextSid();\n+        // PRIME FIRST RECORD\n+        _currentDataLength = DATA_LEN_NEEDS_TO_BE_READ;\n+        if (_nextSid != INVALID_SID_VALUE) {\n+            nextRecord();\n+        }\n     }\n \n     /**\n@@ -146,6 +151,9 @@\n      */\n     @Override\n     public int available() {\n+        if (_currentDataLength == DATA_LEN_NEEDS_TO_BE_READ) {\n+            return 0;\n+        }\n         return remaining();\n     }\n \n@@ -172,11 +180,8 @@\n      * current record.\n      */\n     public boolean hasNextRecord() throws LeftoverDataException {\n-        if (_currentDataLength != -1 && _currentDataLength != _currentDataOffset) {\n+        if (_currentDataLength != DATA_LEN_NEEDS_TO_BE_READ && _currentDataLength != _currentDataOffset) {\n             throw new LeftoverDataException(_currentSid, remaining());\n-        }\n-        if (_currentDataLength != DATA_LEN_NEEDS_TO_BE_READ) {\n-            _nextSid = readNextSid();\n         }\n         return _nextSid != INVALID_SID_VALUE;\n     }\n",
  "stdout": "",
  "stderr": ""
}