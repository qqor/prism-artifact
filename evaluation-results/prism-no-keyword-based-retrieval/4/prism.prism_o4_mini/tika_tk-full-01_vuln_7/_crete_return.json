{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.3129588000000001,
    "prompt_tokens": 142844,
    "completion_tokens": 35416
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n@@ -19,6 +19,7 @@\n import java.io.Serializable;\n import java.util.HashMap;\n import java.util.Map;\n+import org.apache.tika.config.Field;\n \n public class TextAndCSVConfig implements Serializable {\n \n@@ -55,4 +56,20 @@\n         nameToDelimiterMap.entrySet()\n                           .forEach(e -> delimiterToNameMap.put(e.getValue(), e.getKey()));\n     }\n+\n+    /**\n+     * Whether to fetch and parse remote resources referenced by =HYPERLINK formulas.\n+     * Default is false to prevent SSRF.\n+     */\n+    @Field\n+    private boolean fetchRemoteResources = false;\n+\n+    public boolean isFetchRemoteResources() {\n+        return fetchRemoteResources;\n+    }\n+\n+    @Field\n+    public void setFetchRemoteResources(boolean fetchRemoteResources) {\n+        this.fetchRemoteResources = fetchRemoteResources;\n+    }\n }\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -258,7 +258,10 @@\n             xhtml.startElement(\"a\", \"href\", url);\n             xhtml.characters(name);\n             xhtml.endElement(\"a\");\n-            processURL(url, name, xhtml, metadata, context);\n+            TextAndCSVConfig config = context.get(TextAndCSVConfig.class, defaultTextAndCSVConfig);\n+            if (config.isFetchRemoteResources()) {\n+                processURL(url, name, xhtml, metadata, context);\n+            }\n         } else {\n             xhtml.characters(cellContent);\n         }\n",
  "stdout": "",
  "stderr": ""
}