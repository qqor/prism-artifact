{
  "project_name": "libxml2",
  "vulnerability_identifier": "libxml2_lx-full-01_vuln_003",
  "source_directory": "/home/qqor/crete/.cache/official-afc-libxml2",
  "llm_usage": {
    "total_cost": 0.16179020000000002,
    "prompt_tokens": 77262,
    "completion_tokens": 17455
  },
  "variant": "sound",
  "diff": "--- a/parser.c\n+++ b/parser.c\n@@ -760,6 +760,17 @@\n \n static void\n xmlSBufAddEntitySecure(xmlSBuf *buf, const xmlChar *str, unsigned len) {\n+    if (str == NULL) {\n+        return;\n+    }\n+    /* Clamp len to the actual string length to prevent overflow */\n+    {\n+        unsigned actual = 0;\n+        while (actual < len && str[actual] != 0) {\n+            actual++;\n+        }\n+        len = actual;\n+    }\n     if (buf->max - buf->size < len) {\n         if (buf->code == XML_ERR_OK)\n             buf->code = XML_ERR_RESOURCE_LIMIT;\n",
  "stdout": "",
  "stderr": ""
}