--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1850,17 +1850,21 @@
 	WINPR_ASSERT(s);
 	WINPR_ASSERT(mcs);
 
-	const size_t blockLength = Stream_GetRemainingLength(s);
-	if (blockLength < 4)
-		return FALSE;
-
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
-
-	if (mcs->channelCount > CHANNEL_MAX_COUNT)
-		return FALSE;
+    const size_t blockLength = Stream_GetRemainingLength(s);
+    if (blockLength < 4)
+        return FALSE;
+
+    /* Read channelCount and validate its range */
+    UINT8 channelCount = 0;
+    Stream_Read_UINT8(s, channelCount); /* channelCount */
+    if (channelCount > CHANNEL_MAX_COUNT)
+        return FALSE;
+
+    /* Ensure the block has enough data for all entries (4-byte header + 12 bytes per channel) */
+    if (blockLength < 4 + (size_t)channelCount * 12)
+        return FALSE;
+
+    mcs->channelCount = channelCount;
 
 	/* channelDefArray */
 	for (UINT32 i = 0; i < mcs->channelCount; i++)
