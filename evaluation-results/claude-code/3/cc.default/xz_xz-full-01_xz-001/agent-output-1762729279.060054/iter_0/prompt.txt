Create a patch to fix a AddressSanitizer: heap-use-after-free bug given below and apply it to the code.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
==ERROR: AddressSanitizer: heap-use-after-free on address 0x5060000000a0 at pc 0x55de17fd2306 bp 0x7fff1f2b1200 sp 0x7fff1f2b11f8
READ of size 8 at 0x5060000000a0 thread T0
SCARINESS: 51 (8-byte-read-heap-use-after-free)
    #0 0x55de17fd2305 in compute_tree_checksum /src/xz/src/liblzma/check/treeck.c:79:34
    #1 0x55de17fd160e in lzma_tree /src/xz/src/liblzma/check/treeck.c:100:15
    #2 0x55de17fd1241 in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #3 0x55de17fca53f in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #4 0x55de17fba77b in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #5 0x55de17fb6b81 in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #6 0x55de17fb42a4 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #7 0x55de17fb3c8a in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #8 0x55de17e682e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #9 0x55de17e53555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #10 0x55de17e58fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #11 0x55de17e84292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #12 0x7f89d5e52082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)
    #13 0x55de17e4b73d in _start (/out/fuzz_encode_stream+0x4a73d)

DEDUP_TOKEN: compute_tree_checksum--lzma_tree--lzma_check_update
0x5060000000a0 is located 32 bytes inside of 56-byte region [0x506000000080,0x5060000000b8)
freed by thread T0 here:
    #0 0x55de17f73e16 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x55de17fd24c0 in compute_tree_checksum /src/xz/src/liblzma/check/treeck.c:90:3
    #2 0x55de17fd23ec in compute_tree_checksum /src/xz/src/liblzma/check/treeck.c:82:16
    #3 0x55de17fd23ec in compute_tree_checksum /src/xz/src/liblzma/check/treeck.c:82:16
    #4 0x55de17fd160e in lzma_tree /src/xz/src/liblzma/check/treeck.c:100:15
    #5 0x55de17fd1241 in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #6 0x55de17fca53f in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #7 0x55de17fba77b in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #8 0x55de17fb6b81 in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #9 0x55de17fb42a4 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #10 0x55de17fb3c8a in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #11 0x55de17e682e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #12 0x55de17e53555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #13 0x55de17e58fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #14 0x55de17e84292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #15 0x7f89d5e52082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_free--compute_tree_checksum--compute_tree_checksum
previously allocated by thread T0 here:
    #0 0x55de17f740af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x55de17fd1830 in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x55de17fd15ff in lzma_tree /src/xz/src/liblzma/check/treeck.c:99:20
    #3 0x55de17fd1241 in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #4 0x55de17fca53f in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #5 0x55de17fba77b in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #6 0x55de17fb6b81 in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #7 0x55de17fb42a4 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #8 0x55de17fb3c8a in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #9 0x55de17e682e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #10 0x55de17e53555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #11 0x55de17e58fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #12 0x55de17e84292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7f89d5e52082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--lzma_tree
SUMMARY: AddressSanitizer: heap-use-after-free /src/xz/src/liblzma/check/treeck.c:79:34 in compute_tree_checksum
Shadow bytes around the buggy address:
  0x505ffffffe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x505ffffffe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x505fffffff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x505fffffff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x506000000000: fa fa fa fa 00 00 00 00 00 00 00 01 fa fa fa fa
=>0x506000000080: fd fd fd fd[fd]fd fd fa fa fa fa fa fd fd fd fd
  0x506000000100: fd fd fd fa fa fa fa fa 00 00 00 00 00 00 00 fa
  0x506000000180: fa fa fa fa 00 00 00 00 00 00 00 fa fa fa fa fa
  0x506000000200: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa
  0x506000000280: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x506000000300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==18==ABORTING
MS: 0 ; base unit: 0000000000000000000000000000000000000000
subprocess command returned a non-zero exit status: 1
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/xz:/out -v /tmp/tmp8opl0iqo:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce fuzz_encode_stream -runs=100.

</crash_log>