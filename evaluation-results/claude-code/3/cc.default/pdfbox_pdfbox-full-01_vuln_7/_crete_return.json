{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_7",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\nindex 558ca8737..e564563a7 100644\n--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -180,6 +180,7 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>\n     private final class PageIterator implements Iterator<PDPage>\n     {\n         private final Queue<COSDictionary> queue = new ArrayDeque<>();\n+        private final Set<COSDictionary> visited = new HashSet<>();\n \n         private PageIterator(COSDictionary node)\n         {\n@@ -205,6 +206,13 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>\n          */\n         private List<COSDictionary> enqueueKids(COSDictionary node)\n         {\n+            // Check for circular references to prevent infinite loops\n+            if (node != null && !visited.add(node))\n+            {\n+                LOG.warn(\"Circular reference detected in page tree, skipping node\");\n+                return Collections.EMPTY_LIST;\n+            }\n+\n             if (isPageTreeNode(node))\n             {\n                 return getKids(node);\n",
  "stdout": "",
  "stderr": ""
}