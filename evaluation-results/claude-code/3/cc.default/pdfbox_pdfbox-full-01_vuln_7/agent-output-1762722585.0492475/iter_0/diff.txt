diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
index 558ca8737..e564563a7 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
@@ -180,6 +180,7 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>
     private final class PageIterator implements Iterator<PDPage>
     {
         private final Queue<COSDictionary> queue = new ArrayDeque<>();
+        private final Set<COSDictionary> visited = new HashSet<>();
 
         private PageIterator(COSDictionary node)
         {
@@ -205,6 +206,13 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>
          */
         private List<COSDictionary> enqueueKids(COSDictionary node)
         {
+            // Check for circular references to prevent infinite loops
+            if (node != null && !visited.add(node))
+            {
+                LOG.warn("Circular reference detected in page tree, skipping node");
+                return Collections.EMPTY_LIST;
+            }
+
             if (isPageTreeNode(node))
             {
                 return getKids(node);
