{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-004",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "vulnerable",
  "diff": "diff --git a/src/shared/condition.c b/src/shared/condition.c\nindex 67894f9319..47ca6fddfc 100644\n--- a/src/shared/condition.c\n+++ b/src/shared/condition.c\n@@ -97,12 +97,13 @@ Condition* condition_free(Condition *c) {\n }\n \n Condition* condition_free_list_type(Condition *head, ConditionType type) {\n-        LIST_FOREACH(conditions, c, head)\n-                if (type < 0 || c->type == type) {\n-                        condition_free(c);\n-                }\n+        LIST_FOREACH_WITH_NEXT(conditions, c, n, head)\n+                if (type < 0 || c->type == type)\n+                        LIST_REMOVE(conditions, head, condition_free(c));\n+\n+        if (type < 0)\n+                assert(!head);\n \n-        assert(type >= 0 || !head);\n         return head;\n }\n \n",
  "stdout": "+ FUZZER=fuzz-link-parser\r\n+ shift\r\n+ '[' '!' -v TESTCASE ']'\r\n+ TESTCASE=/testcase\r\n+ '[' '!' -f /testcase ']'\r\n+ export RUN_FUZZER_MODE=interactive\r\n+ RUN_FUZZER_MODE=interactive\r\n+ export FUZZING_ENGINE=libfuzzer\r\n+ FUZZING_ENGINE=libfuzzer\r\n+ export SKIP_SEED_CORPUS=1\r\n+ SKIP_SEED_CORPUS=1\r\n+ run_fuzzer fuzz-link-parser -runs=100 /testcase\r\nvm.mmap_rnd_bits = 28\r\n/out/fuzz-link-parser -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -timeout_exitcode=0 < /dev/null\r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 1979415693\r\nINFO: Loaded 2 modules   (96980 inline 8-bit counters): 94610 [0x7f139c24f920, 0x7f139c266ab2), 2370 [0x557c75944078, 0x557c759449ba), \r\nINFO: Loaded 2 PC tables (96980 PCs): 94610 [0x7f139c266ab8,0x7f139c3d83d8), 2370 [0x557c759449c0,0x557c7594dde0), \r\n/out/fuzz-link-parser: Running 1 inputs 100 time(s) each.\r\nRunning: /testcase\r\nAssertion '_item' failed at src/shared/condition.c:102, function condition_free_list_type(). Aborting.\r\r\nAddressSanitizer:DEADLYSIGNAL\r\n=================================================================\r\n==18==ERROR: AddressSanitizer: ABRT on unknown address 0x000000000012 (pc 0x7f139b30400b bp 0x7ffdd55695f0 sp 0x7ffdd55693a0 T0)\r\nSCARINESS: 10 (signal)\r\n    #0 0x7f139b30400b in raise (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n    #1 0x7f139b2e3858 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x22858) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n    #2 0x7f139bd6f629 in log_assert_failed /work/build/../../src/systemd/src/basic/log.c:996:9\r\n    #3 0x7f139bb3e21e in condition_free_list_type /work/build/../../src/systemd/src/shared/condition.c:102:25\r\n    #4 0x7f139bc56686 in config_parse_net_condition /work/build/../../src/systemd/src/shared/net-condition.c:205:25\r\n    #5 0x7f139bb4b1a9 in next_assignment /work/build/../../src/systemd/src/shared/conf-parser.c:159:24\r\n    #6 0x7f139bb4b1a9 in parse_line /work/build/../../src/systemd/src/shared/conf-parser.c:269:16\r\n    #7 0x7f139bb4a404 in config_parse /work/build/../../src/systemd/src/shared/conf-parser.c:412:21\r\n    #8 0x7f139bb4c73a in config_parse_many_files /work/build/../../src/systemd/src/shared/conf-parser.c:564:21\r\n    #9 0x7f139bb4c73a in config_parse_many /work/build/../../src/systemd/src/shared/conf-parser.c:627:13\r\n    #10 0x557c757e0a5d in link_load_one /work/build/../../src/systemd/src/udev/net/link-config.c:273:13\r\n    #11 0x557c757dfb15 in LLVMFuzzerTestOneInput /work/build/../../src/systemd/src/udev/net/fuzz-link-parser.c:25:16\r\n    #12 0x557c758273f0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13\r\n    #13 0x557c75812665 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6\r\n    #14 0x557c758180ff in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9\r\n    #15 0x557c758433a2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\r\n    #16 0x7f139b2e5082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n    #17 0x557c7570721d in _start (/out/fuzz-link-parser+0x7b21d)\r\n\r\nDEDUP_TOKEN: raise--abort--log_assert_failed\r\nAddressSanitizer can not provide additional info.\r\nSUMMARY: AddressSanitizer: ABRT (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d) in raise\r\n==18==ABORTING\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/systemd:/out -v /tmp/tmprj86dq2m:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce fuzz-link-parser -runs=100.\n"
}