diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..df2a4ae05 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -206,10 +206,16 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
     if(user_end) {
       size_t resp_count = 0;
       ssize_t bytes_recv;
+      char *slash_pos;
       resp_buf = malloc(1024);
       memset(resp_buf, 0, 1024);
       /* Username comes immediately after path */
-      user_start = strchr(path, '/') + 1;
+      slash_pos = strchr(path, '/');
+      if(!slash_pos) {
+        result = CURLE_URL_MALFORMAT;
+        goto error;
+      }
+      user_start = slash_pos + 1;
       *user_end = (char)0;
       auth_start = user_end + 1;
       auth_end = strchr(path, '@');
@@ -222,13 +228,15 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
       if(result)
         goto error;
 
-      if(strcmp(auth_start, "debug")) {
+      if(auth_start && strcmp(auth_start, "debug")) {
         do {
         result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
-        do {
-        result = sendf(data, user_start);
-        } while(result == CURLE_AGAIN);
+        if(user_start && *user_start) {
+          do {
+          result = sendf(data, user_start);
+          } while(result == CURLE_AGAIN);
+        }
       }
 
 
