diff --git a/epan/dissectors/packet-netbios.c b/epan/dissectors/packet-netbios.c
index 9d55d615db..a94199bcee 100644
--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -691,6 +691,7 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
 	uint8_t byte;
 	int i = 0;
 	int index = 0;
+	int max_sig_bytes;
 
     if (!tree)
         return 0;
@@ -705,8 +706,10 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
 	/* Allocate buffer for signature field */
 	if (flag & 0x80) {
 		signature = g_malloc( NB_SIZE_HMAC + 1);
+		max_sig_bytes = NB_SIZE_HMAC / 2;
 	} else {
 		signature = g_malloc( NB_SIZE_TMAC + 1);
+		max_sig_bytes = NB_SIZE_TMAC / 2;
 	}
 
 	if (signature == NULL)
@@ -719,7 +722,7 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
     proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);
 
 	/* Convert signature field to a string */
-	while ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) ) {
+	while ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) && i < max_sig_bytes ) {
 		byte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);
 
 		signature[index++] = hex_digits[byte >> 4];
