diff --git a/poi/src/main/java/org/apache/poi/hssf/record/EscherAggregate.java b/poi/src/main/java/org/apache/poi/hssf/record/EscherAggregate.java
index 67beb2120..67e82d413 100644
--- a/poi/src/main/java/org/apache/poi/hssf/record/EscherAggregate.java
+++ b/poi/src/main/java/org/apache/poi/hssf/record/EscherAggregate.java
@@ -1116,7 +1116,9 @@ public final class EscherAggregate extends AbstractEscherHolderRecord {
 
             // Write the matching OBJ record
             Record obj = shapeToObj.get(shapes.get(i));
-            pos += obj.serialize(pos, data);
+            if (obj != null) {
+                pos += obj.serialize(pos, data);
+            }
 
             isFirst = false;
         }
