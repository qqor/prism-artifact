Create a patch to fix a AddressSanitizer: heap-use-after-free bug given below and apply it to the code.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
==ERROR: AddressSanitizer: heap-use-after-free on address 0x51c000000880 at pc 0x0000050713e4 bp 0x7fff4e7854c0 sp 0x7fff4e784c80
WRITE of size 4 at 0x51c000000880 thread T0
SCARINESS: 46 (4-byte-write-heap-use-after-free)
    #0 0x50713e3 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:63:3
    #1 0x79837ca in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10
    #2 0x79837ca in tvb_memcpy /src/wireshark/epan/tvbuff.c:945:10
    #3 0x79930ae in _tvb_get_raw_bytes_as_stringz /src/wireshark/epan/tvbuff.c:4047:3
    #4 0x79930ae in tvb_get_raw_bytes_as_stringz /src/wireshark/epan/tvbuff.c:4073:8
    #5 0x76374d5 in telnet_add_text /src/wireshark/epan/dissectors/packet-telnet.c:2211:5
    #6 0x7636e20 in dissect_telnet /src/wireshark/epan/dissectors/packet-telnet.c:2337:9
    #7 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #8 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #9 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #10 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3
    #11 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5
    #12 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #13 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #14 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #15 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8
    #16 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3
    #17 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2
    #18 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2
    #19 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #20 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #21 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #22 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #23 0x7fe51e2fa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)
    #24 0x4f49cad in _start (/out/handler_telnet+0x4f49cad)

DEDUP_TOKEN: __asan_memcpy--memcpy--tvb_memcpy
0x51c000000880 is located 0 bytes inside of 1920-byte region [0x51c000000880,0x51c000001000)
freed by thread T0 here:
    #0 0x50731c6 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x7a1cb28 in wmem_simple_free /src/wireshark/wsutil/wmem/wmem_allocator_simple.c:54:5
    #2 0x7636bf2 in telnet_sub_option /src/wireshark/epan/dissectors/packet-telnet.c:2099:9
    #3 0x7636bf2 in telnet_command /src/wireshark/epan/dissectors/packet-telnet.c:2182:14
    #4 0x7636bf2 in dissect_telnet /src/wireshark/epan/dissectors/packet-telnet.c:2322:16
    #5 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #6 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #7 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #8 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3
    #9 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5
    #10 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #11 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #12 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #13 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8
    #14 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3
    #15 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2
    #16 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2
    #17 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #18 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #19 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #20 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #21 0x7fe51e2fa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_free--wmem_simple_free--telnet_sub_option
previously allocated by thread T0 here:
    #0 0x507345f in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x7b083d8 in g_malloc (/out/handler_telnet+0x7b083d8)
    #2 0x763824e in dissect_naws_subopt /src/wireshark/epan/dissectors/packet-telnet.c:652:29
    #3 0x7636bf2 in telnet_sub_option /src/wireshark/epan/dissectors/packet-telnet.c:2099:9
    #4 0x7636bf2 in telnet_command /src/wireshark/epan/dissectors/packet-telnet.c:2182:14
    #5 0x7636bf2 in dissect_telnet /src/wireshark/epan/dissectors/packet-telnet.c:2322:16
    #6 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #7 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #8 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #9 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3
    #10 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5
    #11 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9
    #12 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9
    #13 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8
    #14 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8
    #15 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3
    #16 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2
    #17 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2
    #18 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #19 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #20 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #21 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #22 0x7fe51e2fa082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--g_malloc--dissect_naws_subopt
SUMMARY: AddressSanitizer: heap-use-after-free /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10 in memcpy
Shadow bytes around the buggy address:
  0x51c000000600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x51c000000680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x51c000000700: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x51c000000780: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa fa
  0x51c000000800: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x51c000000880:[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x51c000000900: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x51c000000980: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x51c000000a00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x51c000000a80: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x51c000000b00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==18==ABORTING
MS: 0 ; base unit: 0000000000000000000000000000000000000000
0xff,0xfa,0x1f,0x0,0x50,0x0,0x18,0xff,0xf0,0xff,0xfa,0x22,0x1,0x1,0xff,0xf0,0x61,0x61,0x61,0x61,
\377\372\037\000P\000\030\377\360\377\372\"\001\001\377\360aaaa
subprocess command returned a non-zero exit status: 1
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/wireshark:/out -v /tmp/tmp6em6y_ls:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce handler_telnet -runs=100.

</crash_log>