I tried to fix a com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: Server Side Request Forgery (SSRF) vulnerability causing the crash log in the <crash_log> below.
I failed to fix the vulnerability with the following patches:

```diff
diff --git a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java
index 96f49d4e0..bf52ffe4a 100644
--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java
+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java
@@ -268,16 +268,18 @@ public class TextAndCSVParser extends AbstractEncodingDetectorParser {
     private void processURL(String urlString, String name, XHTMLContentHandler xhtml,
                             Metadata parentMetadata,
                             ParseContext context) throws IOException, SAXException {
-        EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);
+        // SSRF vulnerability fix: Do not fetch URLs from untrusted CSV content
+        // URLs in CSV cells are stored as metadata/links only, not fetched
+        // This prevents Server Side Request Forgery attacks
         Metadata metadata = new Metadata();
         metadata.set(TikaCoreProperties.RESOURCE_NAME_KEY, name);
+        metadata.set(TikaCoreProperties.EMBEDDED_RESOURCE_TYPE,
+                TikaCoreProperties.EmbeddedResourceType.HYPERLINK.toString());
         try {
-            URL url = new URL(urlString);
-            URLConnection connection = url.openConnection();
-            connection.setConnectTimeout(5000);
-            try (TikaInputStream tis = TikaInputStream.get(connection.getInputStream())) {
-                ex.parseEmbedded(tis, xhtml, metadata, false);
-            }
+            // Validate URL format but do not open connection
+            new URL(urlString);
+            // Store URL reference in metadata without fetching
+            parentMetadata.add("hyperlink", urlString);
         } catch (Exception e) {
             parentMetadata.set(TikaCoreProperties.EMBEDDED_EXCEPTION,
                     ExceptionUtils.getStackTrace(e));

```

Explain why the patches failed and provide a new patch to fix the vulnerability.
Do not repeat the same mistakes in the new patch.
Try a completely different approach to fix the vulnerability.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: Server Side Request Forgery (SSRF)
Attempted connection to: jazzer.com:443
Requests to destinations based on untrusted data could lead to exfiltration of sensitive data or exposure of internal services.

If the fuzz test is expected to perform network connections, call com.code_intelligence.jazzer.api.BugDetectors#allowNetworkConnections at the beginning of your fuzz test and optionally provide a predicate matching the expected hosts.
	at com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf(ServerSideRequestForgery.java:127)
	at com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket(ServerSideRequestForgery.java:71)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.security.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:299)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:498)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:603)
	at java.base/sun.net.www.protocol.https.HttpsClient.<init>(HttpsClient.java:266)
	at java.base/sun.net.www.protocol.https.HttpsClient.New(HttpsClient.java:380)
	at java.base/sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpClient(AbstractDelegateHttpsURLConnection.java:189)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:175)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1665)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1589)
	at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:224)
	at org.apache.tika.parser.csv.TextAndCSVParser.processURL(TextAndCSVParser.java:278)
	at org.apache.tika.parser.csv.TextAndCSVParser.processCell(TextAndCSVParser.java:261)
	at org.apache.tika.parser.csv.TextAndCSVParser.parse(TextAndCSVParser.java:211)
	at com.example.TextAndCSVParserFuzzer.parseOne(TextAndCSVParserFuzzer.java:57)
	at com.example.TextAndCSVParserFuzzer.fuzzerTestOneInput(TextAndCSVParserFuzzer.java:41)
DEDUP_TOKEN: 092377579d0e2656
== libFuzzer crashing input ==
reproducer_path='.'; Java reproducer written to ./Crash_5a2d0da60ed027df931f1dd06277742e61acdeb9.java

subprocess command returned a non-zero exit status: 77
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika:/out -v /tmp/tmpcg8p6q7d:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce TextAndCSVParserFuzzer -runs=100.

</crash_log>