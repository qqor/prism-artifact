{
  "project_name": "libavif",
  "vulnerability_identifier": "libavif_av-delta-02_avif-002",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-libavif",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/src/reformat.c b/src/reformat.c\nindex f261e073..1e80f915 100644\n--- a/src/reformat.c\n+++ b/src/reformat.c\n@@ -809,12 +809,19 @@ static avifResult avifImageYUVAnyToRGBAnySlow(const avifImage * image,\n                         }\n                         uspill_image[i][j] -= pSpillCb;\n                         vspill_image[i][j] -= pSpillCb;\n-                        uspill_image[i+a][j] -= pSpillCb;\n-                        vspill_image[i+a][j] -= pSpillCr;\n-                        uspill_image[i][j+b] -= pSpillCb;\n-                        vspill_image[i][j+b] -= pSpillCr;\n-                        uspill_image[i+a][j+b] -= pSpillCb;\n-                        vspill_image[i+a][j+b] -= pSpillCr;\n+                        // Bounds check before accessing array elements\n+                        if (i+a >= 0 && i+a < image->width) {\n+                            uspill_image[i+a][j] -= pSpillCb;\n+                            vspill_image[i+a][j] -= pSpillCr;\n+                        }\n+                        if (j+b >= 0 && j+b < image->height) {\n+                            uspill_image[i][j+b] -= pSpillCb;\n+                            vspill_image[i][j+b] -= pSpillCr;\n+                        }\n+                        if (i+a >= 0 && i+a < image->width && j+b >= 0 && j+b < image->height) {\n+                            uspill_image[i+a][j+b] -= pSpillCb;\n+                            vspill_image[i+a][j+b] -= pSpillCr;\n+                        }\n                     }   \n                 }\n             }\n",
  "stdout": "",
  "stderr": ""
}