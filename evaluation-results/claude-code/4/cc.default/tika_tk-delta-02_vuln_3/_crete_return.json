{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-02_vuln_3",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\nindex aef1d333d..b685a1997 100644\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n@@ -20,7 +20,6 @@ import java.io.BufferedReader;\n import java.io.IOException;\n import java.io.InputStream;\n import java.io.InputStreamReader;\n-import java.net.URL;\n import java.nio.charset.StandardCharsets;\n import java.text.DecimalFormat;\n import java.text.NumberFormat;\n@@ -31,9 +30,6 @@ import org.xml.sax.ContentHandler;\n import org.xml.sax.SAXException;\n \n import org.apache.tika.exception.TikaException;\n-import org.apache.tika.extractor.EmbeddedDocumentExtractor;\n-import org.apache.tika.extractor.EmbeddedDocumentUtil;\n-import org.apache.tika.io.TikaInputStream;\n import org.apache.tika.metadata.Metadata;\n import org.apache.tika.metadata.Property;\n import org.apache.tika.metadata.TikaCoreProperties;\n@@ -41,8 +37,6 @@ import org.apache.tika.metadata.XMPDM;\n import org.apache.tika.mime.MediaType;\n import org.apache.tika.parser.ParseContext;\n import org.apache.tika.parser.Parser;\n-import org.apache.tika.sax.BodyContentHandler;\n-import org.apache.tika.sax.EmbeddedContentHandler;\n import org.apache.tika.sax.XHTMLContentHandler;\n import org.apache.tika.utils.StringUtils;\n \n@@ -161,17 +155,8 @@ public class M3U8Parser implements Parser {\n         // split on , then the first value is the length (can be -1),\n         // the last value is the title; intermediate values are key=value format\n         metadata.add(PLAY_LIST_LINK, nextLine);\n-        if (! nextLine.startsWith(\"http\")) {\n-            return;\n-        }\n-        EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n-        Metadata m = new Metadata();\n-        if (ex.shouldParseEmbedded(m)) {\n-            try (TikaInputStream tis = TikaInputStream.get(new URL(nextLine))) {\n-                ex.parseEmbedded(tis, new BodyContentHandler(new EmbeddedContentHandler(xhtml)), m,\n-                        true);\n-            }\n-        }\n+        // Do not fetch remote URLs to prevent SSRF attacks.\n+        // Only record the link in metadata without making network connections.\n     }\n \n     private String getNextContentLine(BufferedReader reader) throws IOException {\n",
  "stdout": "",
  "stderr": ""
}