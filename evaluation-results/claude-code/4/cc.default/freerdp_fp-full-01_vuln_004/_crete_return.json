{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_004",
  "source_directory": "/home/user/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/libfreerdp/core/gcc.c b/libfreerdp/core/gcc.c\nindex d135d8353..ecf51f7ae 100644\n--- a/libfreerdp/core/gcc.c\n+++ b/libfreerdp/core/gcc.c\n@@ -1859,7 +1859,7 @@ BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)\n \tif (blockLength < 4 + (UINT8)mcs->channelCount * 12)\n \t\treturn FALSE;\n \n-\tif (mcs->channelCount > CHANNEL_MAX_COUNT)\n+\tif ((mcs->channelCount < 0) || (mcs->channelCount > CHANNEL_MAX_COUNT))\n \t\treturn FALSE;\n \n \t/* channelDefArray */\n@@ -1950,7 +1950,7 @@ BOOL gcc_read_server_network_data(wStream* s, rdpMcs* mcs)\n \tif (!Stream_CheckAndLogRequiredLengthOfSize(TAG, s, channelCount, 2ull))\n \t\treturn FALSE;\n \n-\tif (CHANNEL_MAX_COUNT < parsedChannelCount)\n+\tif ((parsedChannelCount < 0) || (CHANNEL_MAX_COUNT < parsedChannelCount))\n \t{\n \t\tWLog_ERR(TAG, \"requested %\" PRIu32 \" channels > CHANNEL_MAX_COUNT(31) %\" PRIu16,\n \t\t         mcs->channelCount, CHANNEL_MAX_COUNT);\n",
  "stdout": "",
  "stderr": ""
}