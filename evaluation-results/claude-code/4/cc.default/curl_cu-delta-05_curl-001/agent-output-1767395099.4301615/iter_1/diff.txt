diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..121a461b6 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -206,10 +206,20 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
     if(user_end) {
       size_t resp_count = 0;
       ssize_t bytes_recv;
+      /* Username comes immediately after path - validate structure first */
+      user_start = strchr(path, '/');
+      if(!user_start || user_start >= user_end) {
+        /* Invalid path structure for authentication */
+        result = CURLE_URL_MALFORMAT;
+        goto error;
+      }
+      user_start++;
       resp_buf = malloc(1024);
+      if(!resp_buf) {
+        result = CURLE_OUT_OF_MEMORY;
+        goto error;
+      }
       memset(resp_buf, 0, 1024);
-      /* Username comes immediately after path */
-      user_start = strchr(path, '/') + 1;
       *user_end = (char)0;
       auth_start = user_end + 1;
       auth_end = strchr(path, '@');
