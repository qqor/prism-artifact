{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-delta-05_curl-001",
  "source_directory": "/home/qqor/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/lib/dict.c b/lib/dict.c\nindex c940308b0..6d80cd61e 100644\n--- a/lib/dict.c\n+++ b/lib/dict.c\n@@ -206,10 +206,19 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)\n     if(user_end) {\n       size_t resp_count = 0;\n       ssize_t bytes_recv;\n+      /* Username comes immediately after path - find the slash first */\n+      char *slash = strchr(path, '/');\n+      if(!slash || slash >= user_end) {\n+        result = CURLE_URL_MALFORMAT;\n+        goto error;\n+      }\n+      user_start = slash + 1;\n       resp_buf = malloc(1024);\n+      if(!resp_buf) {\n+        result = CURLE_OUT_OF_MEMORY;\n+        goto error;\n+      }\n       memset(resp_buf, 0, 1024);\n-      /* Username comes immediately after path */\n-      user_start = strchr(path, '/') + 1;\n       *user_end = (char)0;\n       auth_start = user_end + 1;\n       auth_end = strchr(path, '@');\n@@ -227,7 +236,7 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)\n         result = sendf(data, \"Sending extra debug info...\");\n         } while(result == CURLE_AGAIN);\n         do {\n-        result = sendf(data, user_start);\n+        result = sendf(data, \"%s\", user_start);\n         } while(result == CURLE_AGAIN);\n       }\n \n",
  "stdout": "",
  "stderr": ""
}