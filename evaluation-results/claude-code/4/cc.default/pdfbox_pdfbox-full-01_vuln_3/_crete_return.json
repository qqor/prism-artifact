{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_3",
  "source_directory": "/home/user/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\nindex 4f30741d2..12aed038a 100644\n--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n@@ -214,13 +214,17 @@ final class Type1Parser\n             // 0 1 255 {1 index exch /.notdef put } for\n             // we have to check \"readonly\" and \"def\" too\n             // as some fonts don't provide any dup-values, see PDFBOX-2134\n-            while (!(lexer.peekKind(Token.NAME)\n+            while (lexer.peekToken() != null && !(lexer.peekKind(Token.NAME)\n                     && (lexer.peekToken().getText().equals(\"dup\")\n                             || lexer.peekToken().getText().equals(\"readonly\")\n                             || lexer.peekToken().getText().equals(\"def\"))))\n             {\n                 lexer.nextToken();\n             }\n+            if (lexer.peekToken() == null)\n+            {\n+                throw new IOException(\"Unexpected end of input while reading encoding\");\n+            }\n             \n             Map<Integer, String> codeToName = new HashMap<>();\n             while (lexer.peekKind(Token.NAME) &&\n",
  "stdout": "",
  "stderr": ""
}