
================================================================================
Response 1
================================================================================
Now I understand the issue. The crash log shows an SSRF (Server Side Request Forgery) vulnerability related to XML parsing. The XML parser is processing external entities and attempting to connect to `jazze.com:80`. This is a classic XXE (XML External Entity) vulnerability where the `DocumentBuilder` is not configured to prevent external entity references.

Looking at the code in the `DomXmpParser` constructor (lines 77-90), the `DocumentBuilderFactory` is created but doesn't have secure features enabled to prevent external entities from being loaded.

Let me create a patch to fix this vulnerability:

================================================================================
Response 2
================================================================================
The patch has been applied successfully. Here's a summary of the fix:

## Summary of the SSRF/XXE Fix

The vulnerability was in the `DomXmpParser` class where the `DocumentBuilderFactory` was not configured with secure XML parsing features. This allowed malicious XML input to include external entity references that would cause the parser to make outbound network connections (SSRF) or potentially leak sensitive data (XXE).

### Changes Made

Added the following security configurations to the `DocumentBuilderFactory` in the constructor:

1. **`disallow-doctype-decl`** - Completely disallows DOCTYPE declarations, which is the most secure option as it prevents all XXE attacks at the root
2. **`external-general-entities`** - Disables external general entities
3. **`external-parameter-entities`** - Disables external parameter entities  
4. **`load-external-dtd`** - Prevents loading of external DTDs
5. **`setXIncludeAware(false)`** - Disables XInclude processing
6. **`setExpandEntityReferences(false)`** - Prevents expansion of entity references

These settings follow [OWASP's recommendations](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html) for preventing XXE vulnerabilities in Java applications.
