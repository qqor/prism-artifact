{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-full-01_vuln_0",
  "source_directory": "/home/qqor/crete/.cache/official-afc-poi",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\nindex 651fee520..efc4173d5 100644\n--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\n+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\n@@ -119,6 +119,9 @@ public class MAPIAttribute {\n       try(UnsynchronizedByteArrayInputStream inp = UnsynchronizedByteArrayInputStream.builder().setByteArray(parent.getData()).get()) {\n          // First up, get the number of attributes\n          int count = LittleEndian.readInt(inp);\n+         if (count < 0 || count > MAX_RECORD_COUNT) {\n+            throw new IOException(\"Invalid attribute count: \" + count + \", max allowed: \" + MAX_RECORD_COUNT);\n+         }\n          List<MAPIAttribute> attrs = new ArrayList<>();\n \n          // Now, read each one in in turn\n@@ -187,6 +190,9 @@ public class MAPIAttribute {\n             int values = 1;\n             if(isMV || isVL) {\n                values = LittleEndian.readInt(inp);\n+               if (values < 0 || values > MAX_RECORD_COUNT) {\n+                  throw new IOException(\"Invalid values count: \" + values + \", max allowed: \" + MAX_RECORD_COUNT);\n+               }\n             }\n \n             if (type == Types.NULL && values > 1) {\n",
  "stdout": "",
  "stderr": ""
}