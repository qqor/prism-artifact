diff --git a/src/net_builtin.c b/src/net_builtin.c
index 793874f4..6eeec5ec 100644
--- a/src/net_builtin.c
+++ b/src/net_builtin.c
@@ -381,6 +381,10 @@ static void rx_arp(struct mg_tcpip_if *ifp, struct pkt *pkt) {
 
 static void rx_icmp(struct mg_tcpip_if *ifp, struct pkt *pkt) {
   // MG_DEBUG(("ICMP %d", (int) len));
+  // Validate that pkt->icmp is within bounds before accessing
+  if (pkt->icmp == NULL) return;
+  if ((char *) pkt->icmp < pkt->raw.buf ||
+      (char *) (pkt->icmp + 1) > pkt->raw.buf + pkt->raw.len) return;
   if (pkt->icmp->type == 8 && pkt->ip != NULL && pkt->ip->dst == ifp->ip) {
     size_t hlen = sizeof(struct eth) + sizeof(struct ip) + sizeof(struct icmp);
     size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;
