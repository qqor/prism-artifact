
================================================================================
Response 1
================================================================================
I can see the path traversal vulnerability. The issue is on line 43 where `tae.getName()` from the tar archive entry is used directly without validating that it doesn't escape the `extractDir` boundary. A malicious tar file could contain entries with names like `../../../etc/passwd` that would write files outside the intended extraction directory.

The fix needs to validate that the resolved target path is still within the `extractDir` after normalization.

Let me create a patch to fix this:

================================================================================
Response 2
================================================================================
The patch has been applied successfully. Here's a summary of the fix:

## Path Traversal Vulnerability Fix

**File:** `tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java`

**Problem:** The code was extracting tar archive entries without validating that the extracted file paths stay within the intended extraction directory. A malicious tar file containing entries like `../../../etc/passwd` could write files anywhere on the filesystem.

**Fix:** Added a path traversal check on line 45-47 that:
1. Normalizes both the target path and the extraction directory to absolute paths
2. Verifies the target path starts with the extraction directory path
3. Throws an `IOException` if a path traversal attempt is detected

This prevents attackers from using relative path components (like `..`) in tar entry names to escape the intended extraction directory and write files to arbitrary locations.
