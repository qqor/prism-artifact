{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/user/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/libexif/exif-data.c b/libexif/exif-data.c\nindex f3f6dbc..46093f5 100644\n--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -167,6 +167,11 @@ exif_data_load_data_entry (ExifData *data, ExifEntry *entry,\n {\n \tunsigned int s, doff;\n \n+\t/* Validate that the 12-byte IFD entry fits within the buffer before any reads */\n+\tif (CHECKOVERFLOW(offset, size, 12)) {\n+\t\treturn 0;\n+\t}\n+\n \tentry->tag        = exif_get_short (d + offset + 0, data->priv->order);\n \tentry->format     = exif_get_short (d + offset + 2, data->priv->order);\n \tentry->components = exif_get_long  (d + offset + 4, data->priv->order);\n@@ -925,7 +930,11 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n \t\t\t  len);\n \t\td += 2;\n-\t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n+\t\t/* Ensure the claimed length doesn't exceed the actual buffer */\n+\t\tif (len > ds)\n+\t\t\tds -= 2;\n+\t\telse\n+\t\t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n \t}\n \n \t/*\n",
  "stdout": "",
  "stderr": ""
}