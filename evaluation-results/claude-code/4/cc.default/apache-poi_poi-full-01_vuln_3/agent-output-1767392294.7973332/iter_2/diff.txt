diff --git a/poi/src/main/java/org/apache/poi/poifs/filesystem/POIFSMiniStore.java b/poi/src/main/java/org/apache/poi/poifs/filesystem/POIFSMiniStore.java
index 527436164..2e68d0fe4 100644
--- a/poi/src/main/java/org/apache/poi/poifs/filesystem/POIFSMiniStore.java
+++ b/poi/src/main/java/org/apache/poi/poifs/filesystem/POIFSMiniStore.java
@@ -86,6 +86,15 @@ public class POIFSMiniStore extends BlockStore {
      * Load the block, extending the underlying stream if needed
      */
     protected ByteBuffer createBlockIfNeeded(final int offset) throws IOException {
+        // Validate offset to prevent resource exhaustion from corrupted files
+        // Small block stream is only used for streams smaller than BIG_BLOCK_MINIMUM_DOCUMENT_SIZE (4096 bytes)
+        // Maximum valid small blocks = 4096 / 64 = 64, use a generous safety margin
+        int maxSmallBlocks = POIFSConstants.BIG_BLOCK_MINIMUM_DOCUMENT_SIZE / POIFSConstants.SMALL_BLOCK_SIZE;
+        if (offset < 0 || offset > maxSmallBlocks) {
+            throw new IOException("Invalid small block offset: " + offset +
+                " (must be between 0 and " + maxSmallBlocks + ")");
+        }
+
         boolean firstInStore = false;
         if (_mini_stream.getStartBlock() == POIFSConstants.END_OF_CHAIN) {
             firstInStore = true;
