{
  "project_name": "xz",
  "vulnerability_identifier": "xz_xz-full-01_xz-001",
  "source_directory": "/home/user/crete/.cache/official-afc-xz",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/src/liblzma/check/treeck.c b/src/liblzma/check/treeck.c\nindex f54d244e..f1ed4a1c 100644\n--- a/src/liblzma/check/treeck.c\n+++ b/src/liblzma/check/treeck.c\n@@ -78,16 +78,16 @@ static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)\n     node->state = STATE_VISITED;\n     for (size_t i = 0; i < node->edge_count; ++i) {\n       TreeNode *child = node->edges[i];\n-      if (child) {\n+      if (child && child->state != STATE_HASHED) {\n         sum += compute_tree_checksum(child, depth + 1);\n       }\n     }\n     node->state = STATE_HASHED;\n-  }\n \n-  // Free the node and edges\n-  free(node->edges);\n-  free(node);\n+    // Free the node and edges only after fully processing\n+    free(node->edges);\n+    free(node);\n+  }\n \n   return sum;\n }\n",
  "stdout": "",
  "stderr": ""
}