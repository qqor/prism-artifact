diff --git a/poi/src/main/java/org/apache/poi/ss/usermodel/DateUtil.java b/poi/src/main/java/org/apache/poi/ss/usermodel/DateUtil.java
index 401b1c47a..f10ca3916 100644
--- a/poi/src/main/java/org/apache/poi/ss/usermodel/DateUtil.java
+++ b/poi/src/main/java/org/apache/poi/ss/usermodel/DateUtil.java
@@ -70,7 +70,10 @@ public class DateUtil {
     private static final Pattern date_ptrn2 = Pattern.compile("^\\[[a-zA-Z]+]");
     private static final Pattern date_ptrn3a = Pattern.compile("[yYmMdDhHsS]");
     // add "\u5e74 \u6708 \u65e5" for Chinese/Japanese date format:2017 \u5e74 2 \u6708 7 \u65e5
-    private static final Pattern date_ptrn3b = Pattern.compile("^[\\[\\]yYmMdDhHsS\\-T/\u5e74\u6708\u65e5,. :\"\\\\]+0* ?[ampAMP/]*$");
+    // Use possessive quantifier (++) to prevent catastrophic backtracking on long inputs
+    private static final Pattern date_ptrn3b = Pattern.compile("^[\\[\\]yYmMdDhHsS\\-T/\u5e74\u6708\u65e5,. :\"\\\\]++0*+ ?[ampAMP/]*+$");
+    // Maximum length of format string to prevent ReDoS attacks
+    private static final int MAX_FORMAT_LENGTH = 255;
     //  elapsed time patterns: [h],[m] and [s]
     private static final Pattern date_ptrn4 = Pattern.compile("^\\[([hH]+|[mM]+|[sS]+)]");
 
@@ -715,6 +718,11 @@ public class DateUtil {
         //  y m d h s - \ / , . : [ ] T
         // optionally followed by AM/PM
 
+        // Limit format string length to prevent ReDoS attacks (see CVE for stack overflow)
+        if (fs.length() > MAX_FORMAT_LENGTH) {
+            return false;
+        }
+
         boolean result = date_ptrn3b.matcher(fs).matches();
         cache(formatString, formatIndex, result);
         return result;
