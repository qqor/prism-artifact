I tried to fix a deadly signal
 vulnerability causing the crash log in the <crash_log> below.
I failed to fix the vulnerability with the following patches:

```diff
diff --git a/poi/src/main/java/org/apache/poi/hssf/record/aggregates/FormulaRecordAggregate.java b/poi/src/main/java/org/apache/poi/hssf/record/aggregates/FormulaRecordAggregate.java
index 5ce1f62f6..0fdddf5c3 100644
--- a/poi/src/main/java/org/apache/poi/hssf/record/aggregates/FormulaRecordAggregate.java
+++ b/poi/src/main/java/org/apache/poi/hssf/record/aggregates/FormulaRecordAggregate.java
@@ -91,7 +91,12 @@ public final class FormulaRecordAggregate extends RecordAggregate implements Cel
      */
     private static void handleMissingSharedFormulaRecord(FormulaRecord formula) {
         // make sure 'unshared' formula is actually available
-        Ptg firstToken = formula.getParsedExpression()[0];
+        Ptg[] parsedExpression = formula.getParsedExpression();
+        if (parsedExpression == null || parsedExpression.length == 0) {
+            throw new RecordFormatException(
+                    "SharedFormulaRecord not found for FormulaRecord with (isSharedFormula=true) and empty parsed expression");
+        }
+        Ptg firstToken = parsedExpression[0];
         if (firstToken instanceof ExpPtg) {
             throw new RecordFormatException(
                     "SharedFormulaRecord not found for FormulaRecord with (isSharedFormula=true)");

```

Explain why the patches failed and provide a new patch to fix the vulnerability.
Do not repeat the same mistakes in the new patch.
Try a completely different approach to fix the vulnerability.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
== ERROR: libFuzzer: deadly signal

Stack traces of all JVM threads:
Thread[Common-Cleaner,8,InnocuousThreadGroup]

[error occurred during error reporting (), id 0xb, SIGSEGV (0xb) at pc=0x00007f2ec1248fab]

==20== ERROR: libFuzzer: deadly signal
NOTE: libFuzzer has rudimentary signal handlers.
      Combine libFuzzer with AddressSanitizer or similar for better crash reports.
SUMMARY: libFuzzer: deadly signal
subprocess command returned a non-zero exit status: 77user
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/apache-poi:/out -v /tmp/tmpak_owu0y:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce POIHSSFFuzzer -runs=100.

</crash_log>