I tried to fix a com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: File path traversal vulnerability causing the crash log in the <crash_log> below.
I failed to fix the vulnerability with the following patches:

```diff
diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
index 0922124e6..008c48f61 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -41,6 +41,10 @@ public class TikaUntar {
             while (tae != null) {
                 if (tae.isFile()) {
                     Path target = extractDir.resolve(tae.getName()).normalize();
+                    // Prevent path traversal attacks
+                    if (!target.startsWith(extractDir.normalize())) {
+                        throw new IOException("Path traversal attempt detected: " + tae.getName());
+                    }
                     if (!Files.isDirectory(target.getParent())) {
                         Files.createDirectories(target.getParent());
                     }

``````diff
diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
index 0922124e6..c7d36b722 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -40,7 +40,17 @@ public class TikaUntar {
 
             while (tae != null) {
                 if (tae.isFile()) {
-                    Path target = extractDir.resolve(tae.getName()).normalize();
+                    String entryName = tae.getName();
+                    // Validate entry name before any path operations to prevent path traversal
+                    if (entryName.contains("..") || entryName.startsWith("/") ||
+                        entryName.contains("\\..") || entryName.startsWith("\\")) {
+                        throw new IOException("Invalid tar entry name: " + entryName);
+                    }
+                    Path target = extractDir.resolve(entryName).normalize();
+                    // Double-check the resolved path stays within extract directory
+                    if (!target.normalize().startsWith(extractDir.normalize())) {
+                        throw new IOException("Path traversal attempt detected: " + entryName);
+                    }
                     if (!Files.isDirectory(target.getParent())) {
                         Files.createDirectories(target.getParent());
                     }

```

Explain why the patches failed and provide a new patch to fix the vulnerability.
Do not repeat the same mistakes in the new patch.
Try a completely different approach to fix the vulnerability.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: File path traversal: /tmp/expander-tmp17290040960515240899/output/q/r/jazzer-traversal
	at com.code_intelligence.jazzer.sanitizers.FilePathTraversal.check(FilePathTraversal.java:346)
	at com.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath(FilePathTraversal.java:293)
	at com.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook(FilePathTraversal.java:177)
	at org.apache.tika.cli.TikaUntar.main(TikaUntar.java:47)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at com.example.TikaAppUntarringFuzzer.parseOne(TikaAppUntarringFuzzer.java:84)
	at com.example.TikaAppUntarringFuzzer.fuzzerTestOneInput(TikaAppUntarringFuzzer.java:58)
DEDUP_TOKEN: 0e51155e1f0e30d4
== libFuzzer crashing input ==
reproducer_path='.'; Java reproducer written to ./Crash_9689beed6cdf68af6291a23a8a117186272d1e5b.java

subprocess command returned a non-zero exit status: 77
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika:/out -v /tmp/tmpqwgekvhq:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce TikaAppUntarringFuzzer -runs=100.

</crash_log>