{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/qqor/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/libexif/exif-data.c b/libexif/exif-data.c\nindex f3f6dbc..99abdff 100644\n--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -924,6 +924,11 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n \t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n \t\t\t  len);\n+\t\tif (len > ds) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n+\t\t\t\t  \"APP1 length (%u) exceeds remaining data (%u).\", len, ds);\n+\t\t\treturn;\n+\t\t}\n \t\td += 2;\n \t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n \t}\n",
  "stdout": "",
  "stderr": ""
}