diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..df4c6f9 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -85,7 +85,7 @@ exif_mnote_data_apple_load(ExifMnoteData *md, const unsigned char *buf, unsigned
     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);
 
     /* Sanity check the offset */
-    if (buf_size < 6 + 16 + tcount * 6 + 4) {
+    if (buf_size < ofs + tcount * 12) {
         exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
                  "ExifMnoteDataApple", "Short MakerNote");
         /*printf("%s(%d)\n", __FUNCTION__, __LINE__);*/
@@ -117,7 +117,7 @@ exif_mnote_data_apple_load(ExifMnoteData *md, const unsigned char *buf, unsigned
         } else {
             dofs = ofs + 8;
         }
-	if (dofs > buf_size) {
+	if (dofs + dsize > buf_size) {
 		exif_log (md->log, EXIF_LOG_CODE_CORRUPT_DATA,
                                   "ExifMnoteApplet", "Tag size overflow detected (%u vs size %u)", dofs, buf_size);
 		continue;
