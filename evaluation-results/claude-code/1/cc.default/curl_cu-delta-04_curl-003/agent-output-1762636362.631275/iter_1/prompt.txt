I tried to fix a AddressSanitizer: SEGV vulnerability causing the crash log in the <crash_log> below.
I failed to fix the vulnerability with the following patches:

```diff
diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..e69eb72c7 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -1436,6 +1436,7 @@ void Curl_doh_cleanup(struct Curl_easy *data)
     curl_slist_free_all(doh->req_hds);
     data->req.doh->req_hds = NULL;
     Curl_safefree(data->req.doh);
+    data->req.doh = NULL;
   }
 }
 

```

Explain why the patches failed and provide a new patch to fix the vulnerability.
Do not repeat the same mistakes in the new patch.
Try a completely different approach to fix the vulnerability.
NEVER fix files outside the source directory.
NEVER do any git operations in or outside the source directory.

Below is the crash log:

<crash_log>
==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x564cb23696fe bp 0x7fff366b0c40 sp 0x7fff366b0ae0 T0)
==18==The signal is caused by a READ memory access.
==18==Hint: this fault was caused by a dereference of a high value address (see register values below).  Disassemble the provided pc to learn which register was used.
SCARINESS: 20 (wild-addr-read)
    #0 0x564cb23696fe in Curl_doh_close /src/curl/lib/doh.c:1410:30
    #1 0x564cb222c91a in Curl_req_done /src/curl/lib/request.c:108:3
    #2 0x564cb21fedf4 in multi_done /src/curl/lib/multi.c:754:14
    #3 0x564cb2206a81 in multi_runsingle /src/curl/lib/multi.c:2856:15
    #4 0x564cb2204035 in curl_multi_perform /src/curl/lib/multi.c:3016:16
    #5 0x564cb21b2ace in fuzz_handle_transfer(fuzz_data*) /src/curl_fuzzer/curl_fuzzer.cc:419:5
    #6 0x564cb21b00ed in LLVMFuzzerTestOneInput /src/curl_fuzzer/curl_fuzzer.cc:97:3
    #7 0x564cb20646a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x564cb204f915 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #9 0x564cb20553af in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #10 0x564cb2080652 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x7f14a09ae082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)
    #12 0x564cb2047afd in _start (/out/curl_fuzzer_http+0x136afd)

DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done
AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/curl/lib/doh.c:1410:30 in Curl_doh_close
==18==ABORTING
subprocess command returned a non-zero exit status: 1
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/curl:/out -v /tmp/tmpjr6lojaa:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce curl_fuzzer_http -runs=100.

</crash_log>