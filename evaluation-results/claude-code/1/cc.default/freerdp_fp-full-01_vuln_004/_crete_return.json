{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_004",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/libfreerdp/core/gcc.c b/libfreerdp/core/gcc.c\nindex d135d8353..7f34975d9 100644\n--- a/libfreerdp/core/gcc.c\n+++ b/libfreerdp/core/gcc.c\n@@ -1856,7 +1856,11 @@ BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)\n \n \tStream_Read_UINT8(s, mcs->channelCount); /* channelCount */\n \n-\tif (blockLength < 4 + (UINT8)mcs->channelCount * 12)\n+\t/* Need to check remaining length after reading channelCount (1 byte consumed)\n+\t * Each channel requires 12 bytes (8 for name + 4 for options)\n+\t * Plus 3 more bytes for the rest of the header (total 4 bytes including channelCount)\n+\t */\n+\tif (Stream_GetRemainingLength(s) < 3 + (size_t)mcs->channelCount * 12)\n \t\treturn FALSE;\n \n \tif (mcs->channelCount > CHANNEL_MAX_COUNT)\n",
  "stdout": "",
  "stderr": ""
}