diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
index df50a55b1..2e2fba7e7 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
@@ -170,6 +170,11 @@ public class CMap
      */
     public int readCode(InputStream in) throws IOException
     {
+        // PDFBOX-xxxx: malformed CMap with no codespace ranges, consume one byte to avoid infinite loop
+        if (maxCodeLength == 0)
+        {
+            return in.read();
+        }
         byte[] bytes = new byte[maxCodeLength];
         in.read(bytes,0,minCodeLength);
         in.mark(maxCodeLength);
