diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..8822aa0 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,12 +235,21 @@ exif_mnote_data_apple_get_value(ExifMnoteData *md, unsigned int i, char *val, un
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
-    int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
-        variant = 1;
-    } else {
-        variant = 0;
+    int variant = 0;
+    const char *apple_ios = "Apple iOS";
+    size_t apple_ios_len = strlen(apple_ios);
+
+    /* Check if e->data has enough size and is null-terminated */
+    if (e && e->data && e->size >= apple_ios_len + 1) {
+        /* Ensure the buffer is null-terminated within the allocated size */
+        if (e->data[e->size - 1] == '\0' ||
+            memchr(e->data, '\0', e->size) != NULL) {
+            /* Use strncmp to safely compare up to the available size */
+            if (strncmp((const char *) e->data, apple_ios, apple_ios_len) == 0 &&
+                (e->data[apple_ios_len] == '\0' || e->size == apple_ios_len)) {
+                variant = 1;
+            }
+        }
     }
 
     return variant;
