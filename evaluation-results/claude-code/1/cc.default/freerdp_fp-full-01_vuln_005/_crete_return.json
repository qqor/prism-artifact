{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_005",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "vulnerable",
  "diff": "diff --git a/libfreerdp/core/freerdp.c b/libfreerdp/core/freerdp.c\nindex 594a1a2b8..b56698259 100644\n--- a/libfreerdp/core/freerdp.c\n+++ b/libfreerdp/core/freerdp.c\n@@ -1436,7 +1436,8 @@ BOOL freerdp_is_valid_mcs_create_request(const BYTE* data, size_t size)\n \tWINPR_ASSERT(s);\n \n \trdpMcs* mcs = test_mcs_new();\n-\tWINPR_ASSERT(mcs);\n+\tif (!mcs)\n+\t\treturn FALSE;\n \n \tBOOL result = mcs_recv_connect_initial(mcs, s);\n \ttest_mcs_free(mcs);\n@@ -1453,7 +1454,8 @@ BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n \tWINPR_ASSERT(s);\n \n \trdpMcs* mcs = test_mcs_new();\n-\tWINPR_ASSERT(mcs);\n+\tif (!mcs)\n+\t\treturn FALSE;\n \n \tBOOL result = mcs_recv_connect_response(mcs, s);\n \ttest_mcs_free(mcs);\n",
  "stdout": "+ FUZZER=TestFuzzCoreServer\r\n+ shift\r\n+ '[' '!' -v TESTCASE ']'\r\n+ TESTCASE=/testcase\r\n+ '[' '!' -f /testcase ']'\r\n+ export RUN_FUZZER_MODE=interactive\r\n+ RUN_FUZZER_MODE=interactive\r\n+ export FUZZING_ENGINE=libfuzzer\r\n+ FUZZING_ENGINE=libfuzzer\r\n+ export SKIP_SEED_CORPUS=1\r\n+ SKIP_SEED_CORPUS=1\r\n+ run_fuzzer TestFuzzCoreServer -runs=100 /testcase\r\nvm.mmap_rnd_bits = 28\r\n/out/TestFuzzCoreServer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -timeout_exitcode=0 < /dev/null\r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 2048381744\r\nINFO: Loaded 1 modules   (70193 inline 8-bit counters): 70193 [0x559092fda594, 0x559092feb7c5), \r\nINFO: Loaded 1 PC tables (70193 PCs): 70193 [0x559092feb7c8,0x5590930fdad8), \r\n/out/TestFuzzCoreServer: Running 1 inputs 100 time(s) each.\r\nRunning: /testcase\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: *************************************************\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: This build is using [runtime-check] build options:\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: * 'WITH_VERBOSE_WINPR_ASSERT=ON'\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: \r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: [runtime-check] build options might slow down the application\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: *************************************************\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_SOCKET, SO_KEEPALIVE\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() IPPROTO_TCP, TCP_KEEPIDLE\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_KEEPCNT\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_KEEPINTVL\r\n[22:04:06:246] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_USER_TIMEOUT\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_send_update_pdu]: fast path update size (2) exceeds the client's maximum request size (0)\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_update]: Fastpath update Synchronize [3] failed, status 0\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_update_data]: fastpath_recv_update() - -1\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_updates]: fastpath_recv_update_data() fail\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_input_event]: Unknown eventCode 7\r\n[22:04:06:247] [18:00000012] [WARN][com.freerdp.core.rdp] - [rdp_read_security_header][0x519000000080]: invalid security header length, have 0, must be >= 4\r\n[22:04:06:247] [18:00000012] [ERROR][com.freerdp.core] - [tpdu_read_header]: tpdu length 210 > tpkt header length 0\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [Stream_CheckAndLogRequiredLengthWLogExVa][0x519000000080]: [rdp_read_share_control_header(/src/FreeRDP/libfreerdp/core/rdp.c:252)] invalid length, got 1, require at least 2 [element size=1]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 12: unresolvable, address=(nil)\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [Stream_CheckAndLogRequiredLengthWLogExVa][0x519000000080]: [rdp_read_share_data_header(/src/FreeRDP/libfreerdp/core/rdp.c:343)] invalid length, got 1, require at least 12 [element size=1]\r\n[22:04:06:248] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 12: unresolvable, address=(nil)\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.update] - [check_alt_order_supported]: [0x12] UNKNOWN - Alternate Secondary Drawing Order UNKNOWN\r\n[22:04:06:249] [18:00000012] [ERROR][com.freerdp.core.update] - [check_order_activated]: [0x12] UNKNOWN - SERVER BUG: The support for this feature was not announced! Use /relax-order-checks to ignore\r\n[22:04:06:249] [18:00000012] [ERROR][com.freerdp.core.update] - [update_recv_order]: order flags 48 failed\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_recv_altsec_window_order(/src/FreeRDP/libfreerdp/core/window.c:1132)] invalid length, got 0, require at least 6 [element size=1]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:249] [18:00000012] [WARN][com.freerdp.core.update] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_read_play_sound(/src/FreeRDP/libfreerdp/core/update.c:341)] invalid length, got 0, require at least 8 [element size=1]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_recv_pointer(/src/FreeRDP/libfreerdp/core/update.c:752)] invalid length, got 0, require at least 4 [element size=1]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:250] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [tpkt_read_header(/src/FreeRDP/libfreerdp/core/tpkt.c:98)] invalid length, got 0, require at least 1 [element size=1]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 10: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 12: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 13: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 14: unresolvable, address=(nil)\r\n[22:04:06:251] [18:00000012] [WARN][com.freerdp.core.capabilities] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_demand_active(/src/FreeRDP/libfreerdp/core/capabilities.c:4521)] invalid length, got 0, require at least 8 [element size=1]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_confirm_active(/src/FreeRDP/libfreerdp/core/capabilities.c:4652)] invalid length, got 0, require at least 10 [element size=1]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:252] [18:00000012] [WARN][com.freerdp.core.autodetect] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_heartbeat_packet(/src/FreeRDP/libfreerdp/core/heartbeat.c:35)] invalid length, got 0, require at least 4 [element size=1]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [tpkt_read_header(/src/FreeRDP/libfreerdp/core/tpkt.c:98)] invalid length, got 0, require at least 1 [element size=1]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:253] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 10: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 12: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fd59f324000], dli_sname=__libc_start_main [0x7fd59f347f90]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 13: dli_fname=/out/TestFuzzCoreServer [0x559092102000], dli_sname=(null) [(nil)]\r\n[22:04:06:254] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 14: unresolvable, address=(nil)\r\n[22:04:06:260] [18:00000012] [WARN][com.freerdp.crypto] - [ber_read_application_tag]: invalid tag, got 0x42, expected 0x65\r\nAddressSanitizer:DEADLYSIGNAL\r\n=================================================================\r\n==18==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x52100001a600 bp 0x7ffd5df0bb30 sp 0x7ffd5df0ba78 T0)\r\n==18==The signal is caused by a WRITE memory access.\r\n==18==Hint: address points to the zero page.\r\nSCARINESS: 10 (null-deref)\r\n    #0 0x52100001a600  (<unknown module>)\r\n    #1 0x5590926b72a2 in freerdp_is_valid_mcs_create_response /src/FreeRDP/libfreerdp/core/freerdp.c:1460:16\r\n    #2 0x55909263e790 in test_server /src/FreeRDP/libfreerdp/core/test/TestFuzzCoreServer.c:83:3\r\n    #3 0x55909263e790 in LLVMFuzzerTestOneInput /src/FreeRDP/libfreerdp/core/test/TestFuzzCoreServer.c:106:2\r\n    #4 0x5590924f5100 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13\r\n    #5 0x5590924e0375 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6\r\n    #6 0x5590924e5e0f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9\r\n    #7 0x5590925110b2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\r\n    #8 0x7fd59f348082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n\r\nDEDUP_TOKEN: freerdp_is_valid_mcs_create_response--test_server\r\nAddressSanitizer can not provide additional info.\r\nSUMMARY: AddressSanitizer: SEGV (<unknown module>) \r\n==18==ABORTING\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/qqor/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/freerdp:/out -v /tmp/tmpjvqw_0_l:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce TestFuzzCoreServer -runs=100.\n"
}