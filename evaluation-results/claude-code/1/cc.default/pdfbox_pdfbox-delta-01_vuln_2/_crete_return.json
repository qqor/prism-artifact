{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-delta-01_vuln_2",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\nindex eb0a9f79a..b4f02cfa4 100644\n--- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n@@ -155,11 +155,10 @@ public class OCRStreamEngine {\n     }\n \n     private String runTesseract(Path image) throws IOException {\n-        String actualTessPath = pdDocument.getDocumentInformation()\n-                .getCustomMetadataValue(TESSERACT_PATH_KEY);\n-        if (actualTessPath == null || actualTessPath.isEmpty()) {\n-            actualTessPath = tesseractPath;\n-        }\n+        // SECURITY: Never use document metadata for executable path to prevent OS command injection\n+        // Only use the configured tesseractPath from setTesseractPath() method\n+        // Document metadata is attacker-controlled and must not be used for executable paths\n+        String actualTessPath = tesseractPath;\n \n         Path txt = Paths.get(image.toAbsolutePath().toString());\n         doOCR(actualTessPath, image, txt);\n",
  "stdout": "",
  "stderr": ""
}