{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_1",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java\nindex b80c8727b..5613e0932 100644\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java\n@@ -18,13 +18,10 @@ package org.apache.tika.parser.microsoft.rtf;\n \n import java.io.IOException;\n import java.io.InputStream;\n-import java.io.ObjectInputStream;\n-import java.nio.charset.StandardCharsets;\n import java.util.concurrent.atomic.AtomicInteger;\n \n import org.apache.commons.io.FilenameUtils;\n import org.apache.commons.io.IOUtils;\n-import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;\n import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;\n import org.xml.sax.ContentHandler;\n import org.xml.sax.SAXException;\n@@ -36,7 +33,6 @@ import org.apache.tika.io.TikaInputStream;\n import org.apache.tika.metadata.Metadata;\n import org.apache.tika.metadata.RTFMetadata;\n import org.apache.tika.metadata.TikaCoreProperties;\n-import org.apache.tika.mime.MediaType;\n import org.apache.tika.parser.ParseContext;\n import org.apache.tika.sax.EmbeddedContentHandler;\n \n@@ -211,17 +207,9 @@ class RTFEmbObjHandler {\n             extractObj(bytes, handler, metadata);\n \n         } else if (state == EMB_STATE.JAVA_OBJDATA) {\n-            try {\n-                Object obj = new ObjectInputStream(\n-                        UnsynchronizedByteArrayInputStream.builder().setByteArray(bytes)\n-                                .get()).readObject();\n-                metadata.set(RTFMetadata.EMB_CLASS, obj.getClass().getName());\n-                metadata.set(TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,\n-                        MediaType.text(\"plain\").toString());\n-                extractObj(obj.toString().getBytes(StandardCharsets.UTF_8), handler, metadata);\n-            } catch (ClassNotFoundException e) {\n-                throw new TikaException(\"Not found\", e);\n-            }\n+            // Java object deserialization is disabled for security reasons.\n+            // Deserializing arbitrary Java objects from untrusted input can lead to\n+            // Remote Code Execution vulnerabilities.\n         } else if (state == EMB_STATE.NADA) {\n             //swallow...no start for pict or embed?!\n         }\n",
  "stdout": "",
  "stderr": ""
}