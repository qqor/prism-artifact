{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/qqor/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/libexif/exif-data.c b/libexif/exif-data.c\nindex f3f6dbc..c9e6ad8 100644\n--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -925,6 +925,12 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n \t\t\t  len);\n \t\td += 2;\n+\t\t/* Validate that claimed length does not exceed actual remaining data */\n+\t\tif (len < 2 || len > ds) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,\n+\t\t\t\t  \"ExifData\", \"EXIF data length (%u) exceeds remaining buffer (%u)\", len, ds);\n+\t\t\treturn;\n+\t\t}\n \t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n \t}\n \n",
  "stdout": "",
  "stderr": ""
}