diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
index d8dc8042a..5ece87919 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
@@ -530,6 +530,15 @@ public abstract class PDFStreamEngine
      */
     private void processStreamOperators(PDContentStream contentStream) throws IOException
     {
+        increaseLevel();
+        if (level > 50)
+        {
+            LOG.error("recursion is too deep, skipping content stream processing");
+            decreaseLevel();
+            return;
+        }
+        try
+        {
         List<COSBase> arguments = new ArrayList<>();
         PDFStreamParser parser = new PDFStreamParser(contentStream);
         Object token = parser.parseNextToken();
@@ -568,6 +577,11 @@ public abstract class PDFStreamEngine
         {
             shouldProcessColorOperators = oldShouldProcessColorOperators;
         }
+        }
+        finally
+        {
+            decreaseLevel();
+        }
     }
 
     /**
