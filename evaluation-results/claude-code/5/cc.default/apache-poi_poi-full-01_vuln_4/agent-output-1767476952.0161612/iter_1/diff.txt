diff --git a/poi-ooxml/src/main/java/org/apache/poi/xssf/usermodel/XSSFCell.java b/poi-ooxml/src/main/java/org/apache/poi/xssf/usermodel/XSSFCell.java
index 29088a5b4..78f4c87c1 100644
--- a/poi-ooxml/src/main/java/org/apache/poi/xssf/usermodel/XSSFCell.java
+++ b/poi-ooxml/src/main/java/org/apache/poi/xssf/usermodel/XSSFCell.java
@@ -697,7 +697,12 @@ public final class XSSFCell extends CellBase {
             case STCellType.INT_STR:
                 return CellType.STRING;
             default:
-                throw new IllegalStateException("Illegal cell type: " + this._cell.getT());
+                // Handle unknown/invalid cell types gracefully by treating them as blank or string cells
+                // This can occur when parsing malformed OOXML files
+                if (!_cell.isSetV() && blankCells) {
+                    return CellType.BLANK;
+                }
+                return CellType.STRING;
         }
     }
 
