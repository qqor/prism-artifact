{
  "project_name": "lcms",
  "vulnerability_identifier": "lcms_cm-full-01_lcms-002",
  "source_directory": "/home/qqor/crete/.cache/official-afc-little-cms",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/src/cmsvirt.c b/src/cmsvirt.c\nindex 4439ff7..ba4ea22 100644\n--- a/src/cmsvirt.c\n+++ b/src/cmsvirt.c\n@@ -1094,9 +1094,9 @@ cmsHPROFILE CreateNamedColorDevicelink(cmsHTRANSFORM xform)\n     nc2 ->ColorantCount = cmsPipelineOutputChannels(v ->Lut);\n \n     // Make sure we have proper formatters\n-    cmsChangeBuffersFormat(xform, TYPE_NAMED_COLOR_INDEX,\n+    if (!cmsChangeBuffersFormat(xform, TYPE_NAMED_COLOR_INDEX,\n         FLOAT_SH(0) | COLORSPACE_SH(_cmsLCMScolorSpace(v ->ExitColorSpace))\n-        | BYTES_SH(2) | CHANNELS_SH(cmsChannelsOfColorSpace(v ->ExitColorSpace)));\n+        | BYTES_SH(2) | CHANNELS_SH(cmsChannelsOfColorSpace(v ->ExitColorSpace)))) goto Error;\n \n     // Apply the transfor to colorants.\n     for (i=0; i < nColors; i++) {\n@@ -1109,6 +1109,7 @@ cmsHPROFILE CreateNamedColorDevicelink(cmsHTRANSFORM xform)\n     return hICC;\n \n Error:\n+    if (nc2 != NULL) cmsFreeNamedColorList(nc2);\n     if (hICC != NULL) cmsCloseProfile(hICC);\n     return NULL;\n }\n",
  "stdout": "",
  "stderr": ""
}