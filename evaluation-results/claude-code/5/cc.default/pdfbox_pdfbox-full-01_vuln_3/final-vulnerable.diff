diff --git a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
index df50a55b1..cfd7e2ee5 100644
--- a/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
+++ b/fontbox/src/main/java/org/apache/fontbox/cmap/CMap.java
@@ -170,6 +170,18 @@ public class CMap
      */
     public int readCode(InputStream in) throws IOException
     {
+        // Ensure we have valid code lengths to prevent infinite loops
+        // If maxCodeLength is 0 or less than minCodeLength, CMap is invalid/empty
+        if (maxCodeLength <= 0 || maxCodeLength < minCodeLength)
+        {
+            // Consume one byte to ensure progress and prevent infinite loops
+            int b = in.read();
+            if (b == -1)
+            {
+                return -1; // EOF
+            }
+            return b & 0xFF;
+        }
         byte[] bytes = new byte[maxCodeLength];
         in.read(bytes,0,minCodeLength);
         in.mark(maxCodeLength);
