diff --git a/libfreerdp/core/gcc.c b/libfreerdp/core/gcc.c
index d135d8353..19b42a726 100644
--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1847,6 +1847,7 @@ BOOL gcc_write_server_security_data(wStream* s, rdpMcs* mcs)
 
 BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)
 {
+	UINT32 channelCount = 0;
 	WINPR_ASSERT(s);
 	WINPR_ASSERT(mcs);
 
@@ -1854,12 +1855,14 @@ BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)
 	if (blockLength < 4)
 		return FALSE;
 
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
+	Stream_Read_UINT32(s, channelCount); /* channelCount */
 
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
+	if (channelCount > CHANNEL_MAX_COUNT)
 		return FALSE;
 
-	if (mcs->channelCount > CHANNEL_MAX_COUNT)
+	mcs->channelCount = (INT8)channelCount;
+
+	if (blockLength < 4 + channelCount * 12)
 		return FALSE;
 
 	/* channelDefArray */
