diff --git a/parser.c b/parser.c
index 46ddc9ab..a459d2fb 100644
--- a/parser.c
+++ b/parser.c
@@ -9000,6 +9000,7 @@ xmlParseAttribute2(xmlParserCtxtPtr ctxt,
                 xmlWarningMsg(ctxt, XML_WAR_SPACE_VALUE,
                               "Invalid value \"%s\" for xml:space : \"default\" or \"preserve\" expected\n",
                               internal_val, NULL);
+                xmlFree(internal_val);
             }
         }
         /*
@@ -9021,12 +9022,9 @@ xmlParseAttribute2(xmlParserCtxtPtr ctxt,
                 xmlWarningMsg(ctxt, XML_WAR_TAB_VALUE,
                               "Invalid value \"%s\" for xml:tab : \"default\", \"preserve\", \"expand\", or \"skip\" expected\n",
                               internal_val, NULL);
-                xmlFree(internal_val);
             }
         }
-        if (internal_val) {
-            xmlFree(internal_val);
-        }
+        xmlFree(internal_val);
     }
 
     *value = val;
