diff --git a/tools/src/main/java/org/apache/pdfbox/tools/ExtractText.java b/tools/src/main/java/org/apache/pdfbox/tools/ExtractText.java
index 753f23c53..09834fb79 100644
--- a/tools/src/main/java/org/apache/pdfbox/tools/ExtractText.java
+++ b/tools/src/main/java/org/apache/pdfbox/tools/ExtractText.java
@@ -65,6 +65,9 @@ public final class ExtractText  implements Callable<Integer>
 
     private static final String STD_ENCODING = "UTF-8";
 
+    // Maximum number of rotation angles to process per page to prevent timeout
+    private static final int MAX_ROTATION_ANGLES = 10;
+
     // Expected for CLI app to write to System.out/System.err
     @SuppressWarnings("squid:S106")
     private final PrintStream SYSOUT;
@@ -343,7 +346,17 @@ public final class ExtractText  implements Callable<Integer>
                     angleCollector.setEndPage(p);
                     angleCollector.writeText(document, new NullWriter());
                     // rotation magic
-                    for (int angle : angleCollector.getAngles())
+                    Set<Integer> angles = angleCollector.getAngles();
+
+                    // Limit the number of angles to prevent timeout with malformed PDFs
+                    if (angles.size() > MAX_ROTATION_ANGLES)
+                    {
+                        LOG.warn("Too many rotation angles detected (" + angles.size() +
+                                "), limiting to " + MAX_ROTATION_ANGLES + " to prevent timeout");
+                        angles = new TreeSet<>(angles).stream().limit(MAX_ROTATION_ANGLES)
+                                .collect(java.util.stream.Collectors.toCollection(TreeSet::new));
+                    }
+                    for (int angle : angles)
                     {
                         // prepend a transformation
                         // (we could skip these parts for angle 0, but it doesn't matter much)
