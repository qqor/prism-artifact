{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/epan/dissectors/packet-gvcp.c b/epan/dissectors/packet-gvcp.c\nindex d49324a429..2381d3267b 100644\n--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -979,10 +979,12 @@ Attempts to dissect a bootstrap register\n static int dissect_register(uint32_t addr, proto_tree *branch, tvbuff_t *tvb, int offset, int length)\n {\n \tuint32_t value = 0;\n-\t\n+\n \tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+\tif (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+\t\tgvcp_register_number[gvcp_register_count] = addr;\n+\t\tgvcp_register_value[gvcp_register_count++] = value;\n+\t}\n \n \tswitch (addr)\n \t{\n@@ -1494,10 +1496,12 @@ static int dissect_register(uint32_t addr, proto_tree *branch, tvbuff_t *tvb, in\n static int dissect_extended_bootstrap_register(uint32_t addr, proto_tree *branch, tvbuff_t *tvb, int offset, int length _U_)\n {\n \tuint32_t value = 0;\n-\t\n+\n \tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+\tif (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+\t\tgvcp_register_number[gvcp_register_count] = addr;\n+\t\tgvcp_register_value[gvcp_register_count++] = value;\n+\t}\n \n \tswitch (addr)\n \t{\n@@ -2533,6 +2537,9 @@ static int dissect_gvcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, voi\n \tgvcp_conv_info_t *gvcp_info = 0;\n \tgvcp_transaction_t *gvcp_trans = 0;\n \n+\t/* Reset register count for each packet */\n+\tgvcp_register_count = 0;\n+\n \tif (tvb_captured_length(tvb) <  GVCP_MIN_PACKET_SIZE)\n \t{\n \t\treturn 0;\n",
  "stdout": "",
  "stderr": ""
}