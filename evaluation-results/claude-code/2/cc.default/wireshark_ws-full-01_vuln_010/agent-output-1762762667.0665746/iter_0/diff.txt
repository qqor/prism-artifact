diff --git a/epan/dissectors/packet-netbios.c b/epan/dissectors/packet-netbios.c
index 9d55d615db..24c3a9a6a1 100644
--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -704,9 +704,9 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
 
 	/* Allocate buffer for signature field */
 	if (flag & 0x80) {
-		signature = g_malloc( NB_SIZE_HMAC + 1);
+		signature = g_malloc( NB_SIZE_HMAC * 2 + 1);
 	} else {
-		signature = g_malloc( NB_SIZE_TMAC + 1);
+		signature = g_malloc( NB_SIZE_TMAC * 2 + 1);
 	}
 
 	if (signature == NULL)
