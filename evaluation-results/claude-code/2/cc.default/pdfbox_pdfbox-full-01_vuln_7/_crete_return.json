{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_7",
  "source_directory": "/home/qqor/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\nindex 558ca8737..c874b4684 100644\n--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -180,9 +180,11 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>\n     private final class PageIterator implements Iterator<PDPage>\n     {\n         private final Queue<COSDictionary> queue = new ArrayDeque<>();\n+        private final Set<COSDictionary> visited = new HashSet<>();\n \n         private PageIterator(COSDictionary node)\n         {\n+            visited.add(node);\n             List<COSDictionary> kids = enqueueKids(node);\n             while (!kids.isEmpty())\n             {\n@@ -190,7 +192,12 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>\n \n                 for (COSDictionary kid : kids)\n                 {\n-                    newKids.addAll(enqueueKids(kid));\n+                    if (!visited.contains(kid))\n+                    {\n+                        visited.add(kid);\n+                        newKids.addAll(enqueueKids(kid));\n+                    }\n+                    // Skip already visited nodes to prevent infinite loops in circular references\n                 }\n                 kids = newKids;\n             }\n",
  "stdout": "",
  "stderr": ""
}