{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-full-01_vuln_1",
  "source_directory": "/home/qqor/crete/.cache/official-afc-poi",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\nindex 651fee520..d1f99edb7 100644\n--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\n+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java\n@@ -165,8 +165,12 @@ public class MAPIAttribute {\n                } else {\n                   // Custom name was stored\n                   int mplen = LittleEndian.readInt(inp);\n-                  if (mplen < 0) {\n-                     throw new IOException(\"Did not expect negative value: \" + mplen);\n+                  // Validate length to prevent OOM - property names should be reasonably sized\n+                  // Even very long property names shouldn't exceed 64KB\n+                  if (mplen < 0 || mplen > 65536) {\n+                     throw new IOException(\"Invalid property name length: \" + mplen +\n+                        \" (expected between 0 and 65536 bytes). \" +\n+                        \"This may indicate a corrupted or malicious file.\");\n                   }\n                   byte[] mpdata = new byte[mplen];\n                   if (IOUtils.readFully(inp, mpdata) < 0) {\n",
  "stdout": "",
  "stderr": ""
}