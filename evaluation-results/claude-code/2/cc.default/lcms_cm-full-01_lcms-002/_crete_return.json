{
  "project_name": "lcms",
  "vulnerability_identifier": "lcms_cm-full-01_lcms-002",
  "source_directory": "/home/user/crete/.cache/official-afc-little-cms",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "wrong",
  "diff": "diff --git a/src/cmsvirt.c b/src/cmsvirt.c\nindex 4439ff7..1be3ada 100644\n--- a/src/cmsvirt.c\n+++ b/src/cmsvirt.c\n@@ -1100,7 +1100,10 @@ cmsHPROFILE CreateNamedColorDevicelink(cmsHTRANSFORM xform)\n \n     // Apply the transfor to colorants.\n     for (i=0; i < nColors; i++) {\n-        cmsDoTransform(xform, &i, nc2 ->List[i].DeviceColorant, 1);\n+        cmsUInt16Number index[cmsMAXCHANNELS];\n+        memset(index, 0, sizeof(index));\n+        index[0] = (cmsUInt16Number)i;\n+        cmsDoTransform(xform, index, nc2 ->List[i].DeviceColorant, 1);\n     }\n \n     if (!cmsWriteTag(hICC, cmsSigNamedColor2Tag, (void*) nc2)) goto Error;\n",
  "stdout": "",
  "stderr": "error: patch failed: src/cmsvirt.c:1100\nerror: src/cmsvirt.c: patch does not apply\n"
}