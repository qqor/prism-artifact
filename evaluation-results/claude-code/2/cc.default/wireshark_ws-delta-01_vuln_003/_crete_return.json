{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-01_vuln_003",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.0,
    "prompt_tokens": 0,
    "completion_tokens": 0
  },
  "variant": "sound",
  "diff": "diff --git a/epan/dissectors/packet-ber.c b/epan/dissectors/packet-ber.c\nindex ce979681ee..634afb4f2e 100644\n--- a/epan/dissectors/packet-ber.c\n+++ b/epan/dissectors/packet-ber.c\n@@ -3188,10 +3188,11 @@ dissect_ber_GeneralString(asn1_ctx_t *actx, proto_tree *tree, tvbuff_t *tvb, int\n             tvb_len = tvb_get_uint8(tvb, offset);\n             if ((unsigned)tvb_len >= name_len) {\n                 tvb_memcpy(out_tvb, (uint8_t*)name_string, 0, name_len-1);\n+                name_string[name_len-1] = '\\0';\n             } else {\n                 tvb_memcpy(out_tvb, (uint8_t*)name_string, 0, tvb_len);\n+                name_string[tvb_len] = '\\0';\n             }\n-            name_string[tvb_len] = '\\0';\n         }\n     }\n \n",
  "stdout": "",
  "stderr": ""
}