diff --git a/epan/dissectors/packet-netbios.c b/epan/dissectors/packet-netbios.c
index 9d55d615db..fea25dc2b3 100644
--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -704,9 +704,11 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
 
 	/* Allocate buffer for signature field */
 	if (flag & 0x80) {
-		signature = g_malloc( NB_SIZE_HMAC + 1);
+		/* Rationale: allocate sufficient space for 2 hex digits per byte plus null */
+		signature = g_malloc(2 * NB_SIZE_HMAC + 1);
 	} else {
-		signature = g_malloc( NB_SIZE_TMAC + 1);
+		/* Rationale: allocate sufficient space for 2 hex digits per byte plus null */
+		signature = g_malloc(2 * NB_SIZE_TMAC + 1);
 	}
 
 	if (signature == NULL)
@@ -716,10 +718,10 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
     proto_tree_add_item(ttree, hf_netb_trace_timestamp, tvb, offset + NB_XMIT_CORL, 4, ENC_BIG_ENDIAN);
     proto_tree_add_item(ttree, hf_netb_trace_reason, tvb, offset + NB_RMT_SES, 1, ENC_NA);
     proto_tree_add_item(ttree, hf_netb_trace_initiator, tvb, offset + NB_INIT_NAME, 16, ENC_ASCII | ENC_NA);
-    proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);
+     proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);
 
 	/* Convert signature field to a string */
-	while ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) ) {
+	while (tvb_offset_exists(tvb, offset + NB_SIGNATURE + i)) {
 		byte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);
 
 		signature[index++] = hex_digits[byte >> 4];
@@ -728,6 +730,7 @@ dissect_netb_terminate_trace( tvbuff_t *tvb, packet_info *pinfo _U_, int offset,
 		i++;
 	}
 
+	/* Null-terminate */
 	signature[index] = '\0';
 	
 	proto_tree_add_string(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, i - 1, signature);
