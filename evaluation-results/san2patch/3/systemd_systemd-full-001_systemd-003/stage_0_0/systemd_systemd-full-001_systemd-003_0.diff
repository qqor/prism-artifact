diff --git a/src/libsystemd/sd-journal/catalog.c b/src/libsystemd/sd-journal/catalog.c
index a8d65ea4bf..224f341ee4 100644
--- a/src/libsystemd/sd-journal/catalog.c
+++ b/src/libsystemd/sd-journal/catalog.c
@@ -360,15 +360,17 @@ int catalog_import_file(OrderedHashmap *h, const char *path) {
                 payload_size += line_len;
                 payload[payload_size++] = '\n';
                 payload[payload_size] = '\0';
-
+                /* Defer freeing 'line' until after its last use to avoid use-after-free */
                 empty_line = false;
+                freep(&line);
         }
 
         if (got_id) {
                 if (payload_size == 0)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                "[%s:%u] No payload text.",
-                                               path, n);
+                                               path,
+                                               n);                                               path, n);
 
                 r = finish_item(h, id, lang ?: deflang, payload, payload_size);
                 if (r < 0)
