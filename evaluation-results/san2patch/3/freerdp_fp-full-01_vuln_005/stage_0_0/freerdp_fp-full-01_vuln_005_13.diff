diff --git a/libfreerdp/core/freerdp.c b/libfreerdp/core/freerdp.c
index 594a1a2b8..8ea6c93e3 100644
--- a/libfreerdp/core/freerdp.c
+++ b/libfreerdp/core/freerdp.c
@@ -497,7 +497,16 @@ wMessageQueue* freerdp_get_message_queue(freerdp* instance, DWORD id)
 		case FREERDP_INPUT_MESSAGE_QUEUE:
 		{
 			rdp_input_internal* input = input_cast(context->input);
-			queue = input->queue;
+			// Rationale: assert in debug and handle error in release
+			WINPR_ASSERT(input);
+			if (!input)
+			{
+				WLog_ERR(TAG, "freerdp_get_message_queue: input context is NULL");
+			}
+			else
+			{
+				queue = input->queue;
+			}
 		}
 		break;
 		default:
