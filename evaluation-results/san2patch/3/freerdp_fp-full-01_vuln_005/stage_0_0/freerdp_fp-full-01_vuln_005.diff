diff --git a/libfreerdp/core/freerdp.c b/libfreerdp/core/freerdp.c
index 594a1a2b8..95f437023 100644
--- a/libfreerdp/core/freerdp.c
+++ b/libfreerdp/core/freerdp.c
@@ -497,6 +497,12 @@ wMessageQueue* freerdp_get_message_queue(freerdp* instance, DWORD id)
 		case FREERDP_INPUT_MESSAGE_QUEUE:
 		{
 			rdp_input_internal* input = input_cast(context->input);
+			// Rationale: check both input and its queue pointer for NULL
+			if (!input || !input->queue)
+			{
+				WLog_ERR(TAG, "freerdp_get_message_queue: input or queue is NULL");
+				break;
+			}
 			queue = input->queue;
 		}
 		break;
