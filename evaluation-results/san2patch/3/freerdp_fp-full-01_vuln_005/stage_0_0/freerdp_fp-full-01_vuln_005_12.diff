diff --git a/libfreerdp/core/freerdp.c b/libfreerdp/core/freerdp.c
index 594a1a2b8..896417cd2 100644
--- a/libfreerdp/core/freerdp.c
+++ b/libfreerdp/core/freerdp.c
@@ -497,7 +497,8 @@ wMessageQueue* freerdp_get_message_queue(freerdp* instance, DWORD id)
 		case FREERDP_INPUT_MESSAGE_QUEUE:
 		{
 			rdp_input_internal* input = input_cast(context->input);
-			queue = input->queue;
+			// Rationale: use safe conditional assignment to avoid NULL dereference
+			queue = (input != NULL) ? input->queue : NULL;
 		}
 		break;
 		default:
