diff --git a/src/cmspack.c b/src/cmspack.c
index 3e9d23f..9128ba0 100644
--- a/src/cmspack.c
+++ b/src/cmspack.c
@@ -124,7 +124,6 @@ cmsUInt8Number* UnrollChunkyBytes(CMSREGISTER _cmsTRANSFORM* info,
     }
 
     for (i=0; i < nChan; i++) {
-
         cmsUInt32Number index = DoSwap ? (nChan - i - 1) : i;
 
         v = FROM_8_TO_16(*accum);
@@ -136,7 +135,9 @@ cmsUInt8Number* UnrollChunkyBytes(CMSREGISTER _cmsTRANSFORM* info,
             if (v > 0xffff) v = 0xffff;
         }
 
-        wIn[index] = (cmsUInt16Number) v;
+        /* Rationale: check bounds before writing to avoid overflow */
+        if (index < nChan)
+            wIn[index] = (cmsUInt16Number) v;
         accum++;
     }
 
@@ -155,10 +156,10 @@ cmsUInt8Number* UnrollChunkyBytes(CMSREGISTER _cmsTRANSFORM* info,
 
     cmsUNUSED_PARAMETER(info);
     cmsUNUSED_PARAMETER(Stride);
-
 }
 
 
+
 // Extra channels are just ignored because come in the next planes
 static
 cmsUInt8Number* UnrollPlanarBytes(CMSREGISTER _cmsTRANSFORM* info,
