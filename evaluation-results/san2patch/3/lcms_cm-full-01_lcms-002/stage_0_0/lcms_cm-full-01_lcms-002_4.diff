diff --git a/src/cmspack.c b/src/cmspack.c
index 3e9d23f..7fa8474 100644
--- a/src/cmspack.c
+++ b/src/cmspack.c
@@ -105,7 +105,18 @@ cmsUInt8Number* UnrollChunkyBytes(CMSREGISTER _cmsTRANSFORM* info,
     cmsUInt32Number Extra      = T_EXTRA(info -> InputFormat);
     cmsUInt32Number Premul     = T_PREMUL(info->InputFormat);
 
-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;
+    /* Clamp nChan to avoid overflow of fixed 36-byte buffer */
+    {
+        cmsUInt32Number maxItems = 36;
+        cmsUInt32Number needed  = nChan + 2 * Extra;
+        if (needed > maxItems) {
+            /* reduce channel count to safe limit */
+            nChan = maxItems > 2 * Extra ? maxItems - 2 * Extra : 0;
+        }
+    }
+
+    /* FIXME: Crash CWE-125: Out-of-bounds Read */
+     cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;
     cmsUInt32Number v;
     cmsUInt32Number i;  
     cmsUInt32Number alpha_factor = 1;
