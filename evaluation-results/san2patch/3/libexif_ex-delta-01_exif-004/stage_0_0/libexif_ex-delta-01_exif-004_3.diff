diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..084b2a1 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -182,7 +182,8 @@ static unsigned int
 exif_mnote_data_apple_get_id(ExifMnoteData *md, unsigned int i) {
     ExifMnoteDataApple *d = (ExifMnoteDataApple *) md;
 
-    if (!d || (d->count <= i)) {
+    /* Compare using wider type to avoid overflow */
+    if ((unsigned long)i >= (unsigned long)(d ? d->count : 0)) {
         return 0;
     }
 
