diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..3f72110 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -182,7 +182,8 @@ static unsigned int
 exif_mnote_data_apple_get_id(ExifMnoteData *md, unsigned int i) {
     ExifMnoteDataApple *d = (ExifMnoteDataApple *) md;
 
-    if (!d || (d->count <= i)) {
+    /* Added entries NULL check and correct boundary check to prevent out-of-bounds access */
+    if (!d || !d->entries || i >= d->count) {
         return 0;
     }
 
