diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..42d5aa1 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -180,11 +180,17 @@ exif_mnote_data_apple_count(ExifMnoteData *md){
 
 static unsigned int
 exif_mnote_data_apple_get_id(ExifMnoteData *md, unsigned int i) {
+    /* Validate md pointer first */
+    if (!md) {
+        return 0;
+    }
     ExifMnoteDataApple *d = (ExifMnoteDataApple *) md;
 
-    if (!d || (d->count <= i)) {
+    /* Ensure index is within valid range */
+    if (i >= d->count) {
         return 0;
     }
+    /* entries is guaranteed to be initialized in load function */
 
     return d->entries[i].tag;
 }
