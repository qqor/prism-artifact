diff --git a/epan/dissectors/packet-telnet.c b/epan/dissectors/packet-telnet.c
index 9f003e3e61..d51a2ef2cc 100644
--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -2094,6 +2094,7 @@ telnet_sub_option(packet_info *pinfo, proto_tree *option_tree, proto_item *optio
       if (iac_data > 0) {
         /* Data is escaped, we have to unescape it. */
         unescaped_tvb = unescape_and_tvbuffify_telnet_option(pinfo, tvb, start_offset, subneg_len);
+        /* Rationale: copy text into the proto_tree so later free does not affect stored string */
         (*opt->dissect)(pinfo, opt->name, unescaped_tvb, 0, subneg_len - iac_data, option_tree, option_item);
       } else {
         (*opt->dissect)(pinfo, opt->name, tvb, start_offset, subneg_len, option_tree, option_item);
@@ -2103,7 +2104,12 @@ telnet_sub_option(packet_info *pinfo, proto_tree *option_tree, proto_item *optio
       if (iac_data > 0) {
         /* Data is escaped, we have to unescape it. */
         unescaped_tvb = unescape_and_tvbuffify_telnet_option(pinfo, tvb, start_offset, subneg_len);
-        proto_tree_add_item(option_tree, hf_telnet_option_data, unescaped_tvb, 0, subneg_len - iac_data, ENC_NA);
+        {
+          /* immediate string copy to avoid later use-after-free */
+          gchar *str = tvb_get_stringz(unescaped_tvb, 0, subneg_len - iac_data);
+          proto_tree_add_string(option_tree, hf_telnet_option_data, unescaped_tvb, 0, subneg_len - iac_data, str);
+          g_free(str);
+        }
       } else {
         proto_tree_add_item(option_tree, hf_telnet_option_data, tvb, start_offset, subneg_len, ENC_NA);
       }
@@ -2206,10 +2212,17 @@ telnet_add_text(proto_tree *tree, tvbuff_t *tvb, int offset, int len)
        If this subopt is set then a method for storing the data in a given window
        is necessary.
     */
-   if ( hf_telnet_naws_subopt_set ) {
-    int start_offset = hf_telnet_width * hf_telnet_line;
-    tvb_get_raw_bytes_as_stringz(tvb, offset, (linelen < hf_telnet_width) ? linelen : hf_telnet_width, hf_naws_data + start_offset);
-    hf_telnet_line = (hf_telnet_line + 1) % hf_telnet_height;
+   if (hf_telnet_naws_subopt_set) {
+     int start_offset = hf_telnet_width * hf_telnet_line;
+     if (hf_naws_data == NULL) {
+         /* reallocate if it was freed prematurely */
+         hf_naws_data = g_malloc0(hf_telnet_width * hf_telnet_height);
+         hf_naws_data_refcount = 1;
+     }
+     tvb_get_raw_bytes_as_stringz(tvb, offset,
+         (linelen < hf_telnet_width) ? linelen : hf_telnet_width,
+         hf_naws_data + start_offset);
+     hf_telnet_line = (hf_telnet_line + 1) % hf_telnet_height;
   }
 
     /*
