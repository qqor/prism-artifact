diff --git a/parser.c b/parser.c
index 46ddc9ab..03d24511 100644
--- a/parser.c
+++ b/parser.c
@@ -9030,19 +9030,19 @@ xmlParseAttribute2(xmlParserCtxtPtr ctxt,
     }
 
     *value = val;
-    return (hname);
+// FIXME: Crash CWE-415: Double Free
+     return (hname);
 
 mem_error:
     xmlErrMemory(ctxt);
+    goto error;
 error:
-    if ((val != NULL) && (*alloc != 0))
+    if ((val != NULL) && (*alloc != 0)) {
         xmlFree(val);
+        val = NULL; /* Prevent double free by nulling after free */
+    }
     return(hname);
 }
-
-/**
- * xmlAttrHashInsert:
- * @ctxt: parser context
  * @size: size of the hash table
  * @name: attribute name
  * @uri: namespace uri
