diff --git a/parser.c b/parser.c
index 46ddc9ab..b82b69d7 100644
--- a/parser.c
+++ b/parser.c
@@ -9026,23 +9026,23 @@ xmlParseAttribute2(xmlParserCtxtPtr ctxt,
         }
         if (internal_val) {
             xmlFree(internal_val);
+            internal_val = NULL; /* Prevent repeated free of internal_val */
         }
     }
 
     *value = val;
-    return (hname);
+// FIXME: Crash CWE-415: Double Free
+     return (hname);
 
 mem_error:
     xmlErrMemory(ctxt);
 error:
-    if ((val != NULL) && (*alloc != 0))
+    if ((val != NULL) && (*alloc != 0)) {
         xmlFree(val);
+        val = NULL; /* Prevent double free by nulling after free */
+    }
     return(hname);
 }
-
-/**
- * xmlAttrHashInsert:
- * @ctxt: parser context
  * @size: size of the hash table
  * @name: attribute name
  * @uri: namespace uri
