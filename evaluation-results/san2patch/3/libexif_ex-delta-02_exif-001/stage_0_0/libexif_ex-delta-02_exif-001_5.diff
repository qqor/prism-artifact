diff --git a/libexif/fuji/exif-mnote-data-fuji.c b/libexif/fuji/exif-mnote-data-fuji.c
index b055c45..cc8c1f1 100644
--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -165,25 +165,29 @@ exif_mnote_data_fuji_load (ExifMnoteData *en,
 	}
 	if (CHECKOVERFLOW(n->offset, buf_size, 6+8+4)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
-			  "ExifMnoteDataFuji", "Short MakerNote");
+		      "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
 	datao = 6 + n->offset;
 
+	/* Prevent out-of-bounds read: ensure at least 4 bytes are available */
+	if (datao + 8 + 4 > buf_size) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+		      "ExifMnoteDataFuji", "Short MakerNote");
+		return;
+	}
 	n->order = EXIF_BYTE_ORDER_INTEL;
 
 	datao += exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
 	if (CHECKOVERFLOW(datao, buf_size, 2)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
-			  "ExifMnoteDataFuji", "Short MakerNote");
+		      "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
 
 	/* Read the number of tags */
 	c = exif_get_short (buf + datao, EXIF_BYTE_ORDER_INTEL);
-	datao += 2;
-
-	/* Just use an arbitrary max tag limit here to avoid needing to much memory or time. There are 50 named tags currently.
+	datao += 2;	/* Just use an arbitrary max tag limit here to avoid needing to much memory or time. There are 50 named tags currently.
 	 * Fuji XT2 had 56 entries or so, GFX500 has 68. 150 seems a safe upper bound currently.
 	 * The format allows specifying the same range of memory as often as it can, so this multiplies quickly. */
 	if (c > 150) {
