diff --git a/parser.c b/parser.c
index 836b4a4f..efb4eb30 100644
--- a/parser.c
+++ b/parser.c
@@ -766,12 +766,10 @@ xmlSBufAddEntitySecure(xmlSBuf *buf, const xmlChar *str, unsigned len) {
         return;
     }
 
-    if (buf->cap == 0) {
-        // Ensure that the buffer is double the necessary size
-        // This ensures no buffer overflow is possible
-        if (xmlSBufGrow(buf, len * 2) < 0)
-            return;
-    }
+    // Preemptively ensure buffer capacity for entire new content
+    unsigned required = buf->size + len;
+    if (xmlSBufGrow(buf, required) < 0)
+        return;
 
     if (len > 0)
         memcpy(buf->mem + buf->size, str, len);
