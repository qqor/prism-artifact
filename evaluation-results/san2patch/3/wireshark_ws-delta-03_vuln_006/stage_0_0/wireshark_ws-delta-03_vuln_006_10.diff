diff --git a/epan/dissectors/packet-irc.c b/epan/dissectors/packet-irc.c
index 481a619eca..e69de29bb2 100644
--- a/epan/dissectors/packet-irc.c
+++ b/epan/dissectors/packet-irc.c
@@ -1,1390 +0,0 @@
-/* packet-irc.c
- *
- * Wireshark - Network traffic analyzer
- * By Gerald Combs <gerald@wireshark.org>
- * Copyright 1998 Gerald Combs
- *
- * Copied from packet-tftp.c
- *
- * SPDX-License-Identifier: GPL-2.0-or-later
- */
-
-/*
- * Routines for IRC packet dissection
- *
- * See
- *
- *  http://www.irchelp.org/irchelp/rfc/
- *
- * and the RFCs and other documents it mentions, such as RFC 1459, RFCs
- * 2810, 2811, 2812, and 2813,
- *
- * For CTCP, see :
- *  http://www.irchelp.org/irchelp/rfc/ctcpspec.html
- *  http://web.archive.org/web/20031203073050/http://www.invlogic.com/irc/ctcp.html
- *  https://www.ietf.org/archive/id/draft-oakley-irc-ctcp-02.txt
- */
-
- #include "config.h"
-
- #include <epan/packet.h>
- #include <epan/expert.h>
- #include <wsutil/array.h>
- 
- void proto_register_irc(void);
- void proto_reg_handoff_irc(void);
- 
- static int proto_irc;
- static int proto_irc_ctcp;
- static int hf_irc_request;
- static int hf_irc_request_prefix;
- static int hf_irc_request_command;
- static int hf_irc_request_command_pass;
- static int hf_irc_request_command_pass_password;
- static int hf_irc_request_command_nick;
- static int hf_irc_request_command_nick_nick;
- static int hf_irc_request_command_user;
- static int hf_irc_request_command_user_user;
- static int hf_irc_request_command_user_host;
- static int hf_irc_request_command_user_server;
- static int hf_irc_request_command_user_real;
- static int hf_irc_request_command_ping;
- static int hf_irc_request_command_ping_server;
- static int hf_irc_request_command_pong;
- static int hf_irc_request_command_pong_server;
- static int hf_irc_request_command_quit;
- static int hf_irc_request_command_quit_message;
- static int hf_irc_request_command_join;
- static int hf_irc_request_command_join_channel;
- static int hf_irc_request_command_part;
- static int hf_irc_request_command_part_channel;
- static int hf_irc_request_command_part_message;
- static int hf_irc_request_command_privmsg;
- static int hf_irc_request_command_privmsg_target;
- static int hf_irc_request_command_privmsg_message;
- static int hf_irc_request_command_notice;
- static int hf_irc_request_command_notice_target;
- static int hf_irc_request_command_notice_message;
- static int hf_irc_request_command_mode;
- static int hf_irc_request_command_topic;
- static int hf_irc_request_command_topic_target;
- static int hf_irc_request_command_topic_topic;
- static int hf_irc_request_command_names;
- static int hf_irc_request_command_names_channel;
- static int hf_irc_request_command_list;
- static int hf_irc_request_command_list_channel;
- static int hf_irc_request_command_who;
- static int hf_irc_request_command_whois;
- static int hf_irc_request_command_whois_name;
- static int hf_irc_request_command_whowas;
- static int hf_irc_request_command_invite;
- static int hf_irc_request_command_kick;
- static int hf_irc_request_command_away;
- static int hf_irc_request_command_ison;
- static int hf_irc_request_command_time;
- static int hf_irc_request_command_motd;
- static int hf_irc_request_command_version;
- static int hf_irc_request_command_stats;
- static int hf_irc_request_command_links;
- static int hf_irc_request_command_param;
- static int hf_irc_request_command_trace;
- static int hf_irc_request_command_admin;
- static int hf_irc_request_command_info;
- static int hf_irc_request_trailer;
- static int hf_irc_response;
- static int hf_irc_response_prefix;
- static int hf_irc_response_command;
- static int hf_irc_response_num_command;
- static int hf_irc_response_command_param;
- static int hf_irc_response_trailer;
- //static int hf_irc_ctcp;
- static int hf_irc_ctcp_command;
- static int hf_irc_ctcp_params;
- 
- static int ett_irc;
- static int ett_irc_request;
- static int ett_irc_request_command;
- static int ett_irc_request_command_pass;
- static int ett_irc_request_command_nick;
- static int ett_irc_request_command_user;
- static int ett_irc_request_command_ping;
- static int ett_irc_request_command_pong;
- static int ett_irc_request_command_quit;
- static int ett_irc_request_command_join;
- static int ett_irc_request_command_part;
- static int ett_irc_request_command_privmsg;
- static int ett_irc_request_command_notice;
- static int ett_irc_request_command_topic;
- static int ett_irc_request_command_names;
- static int ett_irc_request_command_list;
- static int ett_irc_request_command_whois;
- static int ett_irc_response;
- static int ett_irc_response_command;
- 
- static expert_field ei_irc_missing_end_delimiter;
- static expert_field ei_irc_numeric_request_command;
- static expert_field ei_irc_response_command;
- static expert_field ei_irc_prefix_missing_ending_space;
- static expert_field ei_irc_request_command;
- static expert_field ei_irc_tag_data_invalid;
- 
- /* This must be a null-terminated string */
- static const uint8_t TAG_DELIMITER[] = {0x01, 0x00};
- /* patterns used for tvb_ws_mempbrk_pattern_uint8 */
- static ws_mempbrk_pattern pbrk_tag_delimiter;
- 
- static dissector_handle_t ctcp_handle;
- 
- #define TCP_PORT_RANGE          "6667,57000" /* Not IANA registered */
- #define CHANNELLEN              50
- 
- static int
- dissect_irc_ctcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)
- {
-     proto_tree   *ctcp_tree;
-     proto_item   *ti;
-     const uint8_t *str_command, *str_params;
-     int          space_offset = -1;
- 
-     ti = proto_tree_add_item(tree, proto_irc, tvb, 0, -1, ENC_ASCII|ENC_NA);
-     ctcp_tree = proto_item_add_subtree(ti, ett_irc);
- 
-     space_offset = tvb_find_uint8(tvb, 1, -1, ' ');
-     if (space_offset == -1) {
-         proto_tree_add_item_ret_string(ctcp_tree, hf_irc_ctcp_command, tvb, 0, tvb_reported_length(tvb), ENC_ASCII|ENC_NA, pinfo->pool, &str_command);
-     }
-     else {
-         proto_tree_add_item_ret_string(ctcp_tree, hf_irc_ctcp_command, tvb, 0, space_offset, ENC_ASCII|ENC_NA, pinfo->pool, &str_command);
-         proto_tree_add_item_ret_string(ctcp_tree, hf_irc_ctcp_params, tvb, space_offset+1, tvb_reported_length(tvb)-space_offset-1, ENC_ASCII|ENC_NA, pinfo->pool, &str_params);
-     }
- 
-     return tvb_captured_length(tvb);
- }
- 
- static void
- dissect_irc_tag_data(proto_tree *tree, proto_item *item, tvbuff_t *tvb, int offset, int datalen, packet_info *pinfo, const uint8_t* command)
- {
-     unsigned char found_start_needle = 0,
-            found_end_needle   = 0;
-     int    tag_start_offset, tag_end_offset;
-     tvbuff_t *next_tvb;
- 
-     tag_start_offset = tvb_ws_mempbrk_pattern_uint8(tvb, offset, datalen, &pbrk_tag_delimiter, &found_start_needle);
-     if (tag_start_offset == -1)
-     {
-         /* no tag data */
-         return;
-     }
- 
-     tag_end_offset = tvb_ws_mempbrk_pattern_uint8(tvb, tag_start_offset+1, datalen, &pbrk_tag_delimiter, &found_end_needle);
-     if (tag_end_offset == -1)
-     {
-         expert_add_info(pinfo, item, &ei_irc_missing_end_delimiter);
-         return;
-     }
- 
-     if ((strcmp(command, "NOTICE") != 0) &&
-        (strcmp(command, "PRIVMSG") != 0))
-     {
-         expert_add_info(pinfo, item, &ei_irc_tag_data_invalid);
-     }
- 
-     /* Placeholder to call CTCP dissector, strip out delimiter */
-     if(tree) {
-         next_tvb = tvb_new_subset_length(tvb, tag_start_offset+1, datalen-2 );
-         dissect_irc_ctcp(next_tvb, pinfo, tree, NULL);
-     }
- }
- 
- static void
- dissect_irc_pass(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     int end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
- 
-     end = offset + end;
-     
-     proto_tree *tree = proto_item_add_subtree(item, ett_irc_request_command_pass);
-     proto_tree_add_item(tree, hf_irc_request_command_pass_password, tvb, offset, end-offset, ENC_ASCII);
- 
-     return;
- }
- 
- static void
- dissect_irc_nick(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     /* The password */
-     int end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
- 
-     end = offset + end;
-     
-     proto_tree *tree = proto_item_add_subtree(item, ett_irc_request_command_nick);
-     proto_tree_add_item(tree, hf_irc_request_command_pass, tvb, offset, end-offset, ENC_ASCII);
- 
-     return;
- }
- 
- static void
- dissect_irc_user(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int param_end;
-     int end_offset;
-     int end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
- 
-     end_offset = offset + end;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_user);
- 
-     int current_offset = offset;
-     param_end = tvb_find_uint8(tvb, current_offset, end, ' ');
-     if (param_end == -1)
-         return;
- 
-     proto_tree_add_item(tree, hf_irc_request_command_user_user, tvb, current_offset, param_end-current_offset, ENC_ASCII);
-     current_offset = param_end + 1;
- 
-     param_end = tvb_find_uint8(tvb, current_offset, end_offset-current_offset, ' ');
-     if (param_end == -1)
-         return;
- 
-     proto_tree_add_item(tree, hf_irc_request_command_user_host, tvb, current_offset, param_end-current_offset, ENC_ASCII);
-     current_offset = param_end + 1;
- 
-     param_end = tvb_find_uint8(tvb, current_offset, end_offset-current_offset, ' ');
-     if (param_end == -1)
-         return;
- 
-     proto_tree_add_item(tree, hf_irc_request_command_user_server, tvb, current_offset, param_end-current_offset, ENC_ASCII);
-     current_offset = param_end + 1;
- 
-     if (tvb_get_uint8(tvb, current_offset) == ':') {
-         current_offset++;
-         end = tvb_captured_length_remaining(tvb, current_offset);
-         proto_tree_add_item(tree, hf_irc_request_command_user_real, tvb, current_offset, end, ENC_ASCII);
-     }
- }
- 
- static void
- dissect_irc_ping(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int end;
- 
-     if (tvb_get_uint8(tvb, offset) != ':')
-         return;
-     
-     offset++;
-     end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
-     
-     tree = proto_item_add_subtree(item, ett_irc_request_command_ping);
- 
-     proto_tree_add_item(tree, hf_irc_request_command_ping_server, tvb, offset, end, ENC_ASCII);
- }
- 
- static void
- dissect_irc_pong(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int end;
- 
-     if (tvb_get_uint8(tvb, offset) != ':')
-         return;
-     
-     offset++;
-     end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
-     
-     tree = proto_item_add_subtree(item, ett_irc_request_command_pong);
- 
-     proto_tree_add_item(tree, hf_irc_request_command_pong_server, tvb, offset, end, ENC_ASCII);
- }
- 
- static void
- dissect_irc_quit(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int end;
- 
-     if (tvb_get_uint8(tvb, offset) != ':')
-         return;
-     
-     offset++;
-     end = tvb_captured_length_remaining(tvb, offset);
-     if (end <= 0)
-         return;
-     
-     tree = proto_item_add_subtree(item, ett_irc_request_command_quit);
- 
-     proto_tree_add_item(tree, hf_irc_request_command_quit_message, tvb, offset, end, ENC_ASCII);
- }
- 
- static void
- dissect_irc_join(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_offset;
-     int end_offset;
-     int length;
-     uint8_t *channel_name;
- 
-     if (tvb_get_uint8(tvb, offset) != '#')
-         return;
-     
-     start_offset = offset;
- 
-     channel_name = malloc(CHANNELLEN+1);
- 
-     if (channel_name == NULL ) {
-         return;
-     }
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_join);
-     
-     /* Parse the channels to join*/
-     while(tvb_offset_exists(tvb, start_offset) ) {
-         // Find the comma
-         length = tvb_captured_length_remaining(tvb, start_offset);
-         end_offset = tvb_find_uint8(tvb, start_offset, length, ',');
- 
-         if ( end_offset == -1 ) {
-             proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, length, ENC_ASCII);
-             
-             memset(channel_name, 0, CHANNELLEN+1);
-             tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-             proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-             free(channel_name);
-             return;
-         }
- 
-         memset(channel_name, 0, CHANNELLEN+1);
-         tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-         proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-         proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, length, ENC_ASCII);
-         start_offset = end_offset + 1;
-     }
- 
-     free(channel_name);
-     return;
- }
- 
- static void
- dissect_irc_part(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_offset;
-     int end_offset;
-     int length;
-     uint8_t *channel_name;
- 
-     if (tvb_get_uint8(tvb, offset) != '#')
-         return;
-     
-     channel_name = malloc(CHANNELLEN+1);
- 
-     if (channel_name == NULL ) {
-         return;
-     }
- 
-     start_offset = offset;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_part);
- 
-     while(tvb_offset_exists(tvb, start_offset) ) {
-         length = tvb_captured_length_remaining(tvb, start_offset);
-         end_offset = tvb_find_uint8(tvb, start_offset, length, ',');
- 
-         if ( end_offset == -1 ) {
-             int start_message = tvb_find_uint8(tvb, start_offset, length, ':');
- 
-             if ( start_message == -1 ) {
-                 proto_tree_add_item(tree, hf_irc_request_command_part_channel, tvb, start_offset, length, ENC_ASCII);
-                 
-                 memset(channel_name, 0, CHANNELLEN+1);
-                 tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-                 proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-                 free(channel_name);
-                 return;
-             }
- 
-             length = start_message-start_offset;
- 
-             proto_tree_add_item(tree, hf_irc_request_command_part_channel, tvb, start_offset, length, ENC_ASCII);
-             
-             memset(channel_name, 0, CHANNELLEN+1);
-             tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-             proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-             start_message++;
-             length = tvb_captured_length_remaining(tvb, start_message);
-             proto_tree_add_item(tree, hf_irc_request_command_part_message, tvb, start_message, length, ENC_ASCII);
- 
-             free(channel_name);
-             return;
-         }
- 
-         memset(channel_name, 0, CHANNELLEN+1);
-         tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-         proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-         proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, length, ENC_ASCII);
-         start_offset = end_offset + 1;
-     }
- 
-     free(channel_name);
-     return;
- }
- 
- static void
- dissect_irc_privmsg(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_message;
-     int length;
- 
-     length = tvb_captured_length_remaining(tvb, offset);
- 
-     start_message = tvb_find_uint8(tvb, offset, length, ':');
- 
-     if ( start_message == -1)
-         return;
-     
-     tree = proto_item_add_subtree(item, ett_irc_request_command_privmsg);
- 
-     proto_tree_add_item(tree, hf_irc_request_command_privmsg_target, tvb, offset, start_message-offset, ENC_ASCII);
-     start_message++;
- 
-     length = tvb_captured_length_remaining(tvb, start_message);
-     proto_tree_add_item(tree, hf_irc_request_command_privmsg_message, tvb, start_message, length, ENC_ASCII);
- 
-     return;
- }
- 
- static void
- dissect_irc_notice(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_message;
-     int length;
- 
-     length = tvb_captured_length_remaining(tvb, offset);
- 
-     start_message = tvb_find_uint8(tvb, offset, length, ':');
- 
-     if ( start_message == -1)
-         return;
-     
-     tree = proto_item_add_subtree(item, ett_irc_request_command_notice);
- 
-     proto_tree_add_item(tree, hf_irc_request_command_notice_target, tvb, offset, start_message-offset, ENC_ASCII);
-     start_message++;
- 
-     length = tvb_captured_length_remaining(tvb, start_message);
-     proto_tree_add_item(tree, hf_irc_request_command_notice_message, tvb, start_message, length, ENC_ASCII);
- 
-     return;
- }
- 
- static void
- dissect_irc_topic(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_topic;
-     int length;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_topic);
- 
-     length = tvb_captured_length_remaining(tvb, offset);
-     start_topic = tvb_find_uint8(tvb, offset, length, ':');
- 
-     if ( start_topic == -1) {
-         proto_tree_add_item(tree, hf_irc_request_command_topic_target, tvb, offset, length, ENC_ASCII);
-         return;
-     }
-     
-     proto_tree_add_item(tree, hf_irc_request_command_topic_target, tvb, offset, start_topic-offset-1, ENC_ASCII);
-     start_topic++;
- 
-     length = tvb_captured_length_remaining(tvb, start_topic);
-     proto_tree_add_item(tree, hf_irc_request_command_topic_topic, tvb, start_topic, length, ENC_ASCII);
- 
-     return;
- }
- 
- static void
- dissect_irc_names(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_offset;
-     int end_offset;
-     int length;
-     uint8_t *channel_name;
- 
-     if (tvb_get_uint8(tvb, offset) != '#')
-         return;
-     
-     channel_name = malloc(CHANNELLEN+1);
- 
-     if (channel_name == NULL ) {
-         return;
-     }
- 
-     start_offset = offset;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_names);
- 
-     while(tvb_offset_exists(tvb, start_offset) ) {
-         length = tvb_captured_length_remaining(tvb, start_offset);
-         end_offset = tvb_find_uint8(tvb, start_offset, length, ',');
- 
-         if ( end_offset == -1 ) {
-             proto_tree_add_item(tree, hf_irc_request_command_names_channel, tvb, start_offset, length, ENC_ASCII);
-             
-             memset(channel_name, 0, CHANNELLEN+1);
-             tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-             proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-             free(channel_name);
-             return;
-         }
- 
-         memset(channel_name, 0, CHANNELLEN+1);
-         tvb_memcpy(tvb, channel_name, start_offset, length);
-         proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-         proto_tree_add_item(tree, hf_irc_request_command_names_channel, tvb, start_offset, end_offset-start_offset, ENC_ASCII);
-         start_offset = end_offset + 1;
-     }
- 
-     free(channel_name);
-     return;
- }
- 
- static void
- dissect_irc_list(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_offset;
-     int end_offset;
-     int length;
-     uint8_t *channel_name;
- 
-     if (tvb_get_uint8(tvb, offset) != '#')
-         return;
-     
-     channel_name = malloc(CHANNELLEN+1);
- 
-     if (channel_name == NULL ) {
-         return;
-     }
- 
-     start_offset = offset;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_list);
- 
-     while(tvb_offset_exists(tvb, start_offset) ) {
-         length = tvb_captured_length_remaining(tvb, start_offset);
-         end_offset = tvb_find_uint8(tvb, start_offset, length, ',');
- 
-         if ( end_offset == -1 ) {
-             proto_tree_add_item(tree, hf_irc_request_command_list_channel, tvb, start_offset, length, ENC_ASCII);
-             
-             memset(channel_name, 0, CHANNELLEN+1);
-             tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);
-             proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-             free(channel_name);
- 
-             return;
-         }
- 
-         memset(channel_name, 0, CHANNELLEN+1);
-         tvb_memcpy(tvb, channel_name, start_offset, (end_offset-start_offset < CHANNELLEN) ? end_offset-start_offset : CHANNELLEN);
-         proto_item_append_text(tree, "Channel: %s", channel_name);
- 
-         proto_tree_add_item(tree, hf_irc_request_command_list_channel, tvb, start_offset, end_offset-start_offset, ENC_ASCII);
-         start_offset = end_offset + 1;
-     }
- 
-     free(channel_name);
-     return;
- }
- 
- static void
- dissect_irc_whois(tvbuff_t *tvb, proto_item *item, int offset)
- {
-     proto_tree *tree;
-     int start_offset;
-     int end_offset;
-     int length;
- 
-     tree = proto_item_add_subtree(item, ett_irc_request_command_whois);
-     start_offset = offset;
- 
-     while(tvb_offset_exists(tvb, start_offset) ) {
-         length = tvb_captured_length_remaining(tvb, start_offset);
-         end_offset = tvb_find_uint8(tvb, start_offset, length, ',');
- 
-         if ( end_offset == -1 ) {
-             proto_tree_add_item(tree, hf_irc_request_command_whois_name, tvb, start_offset, length, ENC_ASCII);
-             return;
-         }
- 
-         proto_tree_add_item(tree, hf_irc_request_command_whois_name, tvb, start_offset, end_offset-start_offset, ENC_ASCII);
-         start_offset = end_offset + 1;
-     }
- 
-     return;
- }
- 
- static void
- dissect_irc_request_command(proto_tree *request_tree, tvbuff_t *tvb, int offset, const uint8_t *str_command)
- {
-     int end_offset;
-     proto_item *ti;
- 
-     if (!str_command)
-         return;
- 
-     end_offset = tvb_find_uint8(tvb, offset, tvb_captured_length_remaining(tvb, offset), ' ');
- 
-     if(end_offset == -1)
-         return;
- 
-     if (strcmp(str_command, "PASS") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_pass, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_pass(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "NICK") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_nick, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_nick(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "USER") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_user, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_user(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "PING") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_ping, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_ping(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "PONG") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_pong, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_pong(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "QUIT") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_quit, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_quit(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "JOIN") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_join, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_join(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "PART") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_part, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_part(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "PRIVMSG") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_privmsg, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_privmsg(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "NOTICE") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_notice, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_notice(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "MODE") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_mode, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "TOPIC") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_topic, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_topic(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "NAMES") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_names, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_names(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "LIST") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_list, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_list(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "WHO") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_who, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "WHOIS") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_whois, tvb, offset, end_offset-offset, ENC_ASCII);
-         dissect_irc_whois(tvb, ti, end_offset+1);
-     } else if (strcmp(str_command, "WHOWAS") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_whowas, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "INVITE") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_invite, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "KICK") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_kick, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "AWAY") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_away, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "ISON") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_who, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "TIME") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_time, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "MOTD") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_motd, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "VERSION") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_version, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "STATS") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_stats, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "LINKS") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_links, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "TRACE") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_trace, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "ADMIN") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_admin, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else if (strcmp(str_command, "INFO") == 0) {
-         ti = proto_tree_add_item(request_tree, hf_irc_request_command_info, tvb, offset, end_offset-offset, ENC_ASCII);
-     } else {
-         proto_tree_add_string_format_value(request_tree, hf_irc_request_command, tvb, offset, end_offset-offset, str_command,
-                                            "Unknown or unhandled command: %s", str_command);
-     }
- }
- 
- static void
- dissect_irc_request(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, int offset, int linelen)
- {
-     proto_tree   *request_tree, *command_tree = NULL;
-     proto_item   *request_item;
-     int           start_offset                = offset;
-     int           end_offset                  = start_offset+linelen;
-     int           eop_offset                  = -1,
-                   eoc_offset                  = -1,
-                   eocp_offset,
-                   tag_start_offset, tag_end_offset;
-     const uint8_t *str_command;
-     unsigned char found_tag_needle            = 0;
-     bool          first_command_param         = true;
- 
-     request_item = proto_tree_add_item(tree, hf_irc_request, tvb, offset, linelen, ENC_ASCII);
-     if (linelen <= 0)
-         return;
- 
-     request_tree = proto_item_add_subtree(request_item, ett_irc_request );
- 
-     /* Check if message has a prefix */
-     if (tvb_get_uint8(tvb, offset) == ':')
-     {
-         /* find the end of the prefix */
-         eop_offset = tvb_find_uint8(tvb, offset+1, linelen-1, ' ');
-         if (eop_offset == -1)
-         {
-             expert_add_info(pinfo, request_item, &ei_irc_prefix_missing_ending_space);
-             return;
-         }
- 
-         proto_tree_add_item(request_tree, hf_irc_request_prefix, tvb, offset+1, eop_offset-offset-1, ENC_ASCII);
-         offset = eop_offset+1;
-     }
- 
-     /* clear out any whitespace before command */
-     while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-     {
-         offset++;
-     }
-     if (offset == end_offset)
-     {
-         expert_add_info(pinfo, request_item, &ei_irc_request_command);
-         return;
-     }
- 
-     eoc_offset = tvb_find_uint8(tvb, offset, end_offset-offset, ' ');
-     if (eoc_offset == -1)
-     {
-         const uint8_t* col_str;
- 
-         proto_tree_add_item_ret_string(request_tree, hf_irc_request_command, tvb, offset, end_offset-offset, ENC_ASCII|ENC_NA, pinfo->pool, &col_str);
-         col_append_fstr( pinfo->cinfo, COL_INFO, " (%s)", col_str);
- 
-         /* Warn if there is a "numeric" command */
-         if ((end_offset-offset == 3) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset))) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset+1))) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset+2))))
-         {
-             expert_add_info(pinfo, request_item, &ei_irc_numeric_request_command);
-         }
-         return;
-     }
- 
-     proto_tree_add_item_ret_string(request_tree, hf_irc_request_command, tvb, offset, eoc_offset-offset, ENC_ASCII|ENC_NA, pinfo->pool, &str_command);
-     col_append_fstr( pinfo->cinfo, COL_INFO, " (%s)", str_command);
-     dissect_irc_request_command(request_tree, tvb, offset, str_command);
- 
-     /* Warn if there is a "numeric" command */
-     if ((eoc_offset-offset == 3) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset))) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset+1))) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset+2))))
-     {
-         expert_add_info(pinfo, request_item, &ei_irc_numeric_request_command);
-     }
- 
-     offset = eoc_offset+1;
- 
-     /* clear out any whitespace before command parameter */
-     while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-     {
-         offset++;
-     }
-     if (offset == end_offset)
-     {
-         /* No command parameters */
-         return;
-     }
- 
-     /* Check if message has a trailer */
-     if (tvb_get_uint8(tvb, offset) == ':')
-     {
-         proto_tree_add_item(request_tree, hf_irc_request_trailer, tvb, offset+1, end_offset-offset-1, ENC_ASCII);
-         dissect_irc_tag_data(request_tree, request_item, tvb, offset+1, end_offset-offset-1, pinfo, str_command);
-         return;
-     }
- 
-     while(offset < end_offset)
-     {
-         eocp_offset = tvb_find_uint8(tvb, offset, end_offset-offset, ' ');
-         tag_start_offset = tvb_ws_mempbrk_pattern_uint8(tvb, offset, end_offset-offset, &pbrk_tag_delimiter, &found_tag_needle);
- 
-         /* Create subtree when the first parameter is found */
-         if (first_command_param)
-         {
-             command_tree = proto_tree_add_subtree(request_tree, tvb, offset, end_offset-offset,
-                                              ett_irc_request_command, NULL, "Command parameters");
-             first_command_param = false;
-         }
- 
-         if (((eocp_offset == -1) && (tag_start_offset == -1)) ||
-             ((eocp_offset != -1) && (tag_start_offset == -1)) ||
-             (eocp_offset < tag_start_offset))
-         {
-             /* regular message should be dissected */
- 
-             if (eocp_offset == -1)
-             {
-                 proto_tree_add_item(command_tree, hf_irc_request_command_param, tvb, offset, end_offset-offset, ENC_ASCII);
-                 return;
-             }
- 
-             proto_tree_add_item(command_tree, hf_irc_request_command_param, tvb, offset, eocp_offset-offset, ENC_ASCII);
-             offset = eocp_offset+1;
- 
-             /* clear out any whitespace before next command parameter */
-             while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-             {
-                 offset++;
-             }
-             if (offset == end_offset)
-             {
-                 break;
-             }
- 
-             /* Check if message has a trailer */
-             if (tvb_get_uint8(tvb, offset) == ':')
-             {
-                 proto_tree_add_item(request_tree, hf_irc_request_trailer, tvb, offset+1, end_offset-offset-1, ENC_ASCII);
-                 dissect_irc_tag_data(request_tree, request_item, tvb, offset+1, end_offset-offset-1, pinfo, str_command);
-                 return;
-             }
-         }
-         else if (((eocp_offset == -1) && (tag_start_offset != -1)) ||
-                (eocp_offset > tag_start_offset))
-         {
-             /* tag data dissected */
- 
-             found_tag_needle = 0;
-             tag_end_offset = tvb_ws_mempbrk_pattern_uint8(tvb, tag_start_offset+1, end_offset-tag_start_offset-1, &pbrk_tag_delimiter, &found_tag_needle);
-             if (tag_end_offset == -1)
-             {
-                 expert_add_info(pinfo, request_item, &ei_irc_missing_end_delimiter);
-                 return;
-             }
- 
-             dissect_irc_tag_data(request_tree, request_item, tvb, tag_start_offset, tag_end_offset-tag_start_offset, pinfo, str_command);
-             offset = tag_end_offset+1;
-         }
-     }
- }
- 
- static void
- dissect_irc_response(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, int offset, int linelen)
- {
-     proto_tree   *response_tree, *command_tree = NULL;
-     proto_item   *response_item, *hidden_item;
-     int           start_offset                 = offset;
-     int           end_offset                   = start_offset+linelen;
-     int           eop_offset                   = -1,
-                   eoc_offset                   = -1,
-                   eocp_offset,
-                   tag_start_offset, tag_end_offset;
-     const uint8_t* str_command;
-     uint16_t      num_command;
-     unsigned char found_tag_needle             = 0;
-     bool          first_command_param          = true;
- 
-     response_item = proto_tree_add_item(tree, hf_irc_response, tvb, offset, linelen, ENC_ASCII);
-     if (linelen <= 0)
-         return;
- 
-     response_tree = proto_item_add_subtree(response_item, ett_irc_response );
- 
-     /* Check if message has a prefix */
-     if (tvb_get_uint8(tvb, offset) == ':')
-     {
-         /* find the end of the prefix */
-         eop_offset = tvb_find_uint8(tvb, offset+1, linelen-1, ' ');
-         if (eop_offset == -1)
-         {
-             expert_add_info(pinfo, response_item, &ei_irc_prefix_missing_ending_space);
-             return;
-         }
- 
-         proto_tree_add_item(response_tree, hf_irc_response_prefix, tvb, offset+1, eop_offset-offset-1, ENC_ASCII);
-         offset = eop_offset+1;
-     }
- 
-     /* clear out any whitespace before command */
-     while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-     {
-         offset++;
-     }
-     if (offset == end_offset)
-     {
-         expert_add_info(pinfo, response_item, &ei_irc_response_command);
-         return;
-     }
- 
-     eoc_offset = tvb_find_uint8(tvb, offset, end_offset-offset, ' ');
-     if (eoc_offset == -1)
-     {
-         const uint8_t* col_str;
-         proto_tree_add_item_ret_string(response_tree, hf_irc_response_command, tvb, offset, end_offset-offset, ENC_ASCII|ENC_NA, pinfo->pool, &col_str);
-         col_append_fstr( pinfo->cinfo, COL_INFO, " (%s)", col_str);
- 
-         /* if response command is numeric, allow it to be filtered as an integer */
-         if ((end_offset-offset == 3) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset))) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset+1))) &&
-             (g_ascii_isdigit(tvb_get_uint8(tvb, offset+2))))
-         {
-             num_command = ((tvb_get_uint8(tvb, offset)-0x30)*100) + ((tvb_get_uint8(tvb, offset+1)-0x30)*10) + (tvb_get_uint8(tvb, offset+2)-0x30);
-             hidden_item = proto_tree_add_uint(response_tree, hf_irc_response_num_command, tvb, offset, end_offset-offset, num_command);
-             proto_item_set_hidden(hidden_item);
-         }
-         return;
-     }
- 
-     proto_tree_add_item_ret_string(response_tree, hf_irc_response_command, tvb, offset, eoc_offset-offset, ENC_ASCII|ENC_NA, pinfo->pool, &str_command);
-     col_append_fstr( pinfo->cinfo, COL_INFO, " (%s)", str_command);
- 
-     /* if response command is numeric, allow it to be filtered as an integer */
-     if ((eoc_offset-offset == 3) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset))) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset+1))) &&
-        (g_ascii_isdigit(tvb_get_uint8(tvb, offset+2))))
-     {
-         num_command = ((tvb_get_uint8(tvb, offset)-0x30)*100) + ((tvb_get_uint8(tvb, offset+1)-0x30)*10) + (tvb_get_uint8(tvb, offset+2)-0x30);
-         hidden_item = proto_tree_add_uint(response_tree, hf_irc_response_num_command, tvb, offset, eoc_offset-offset, num_command);
-         proto_item_set_hidden(hidden_item);
-     }
- 
-     offset = eoc_offset+1;
- 
-     /* clear out any whitespace before command parameter */
-     while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-     {
-         offset++;
-     }
-     if (offset == end_offset)
-     {
-         /* No command parameters */
-         return;
-     }
- 
-     /* Check if message has a trailer */
-     if (tvb_get_uint8(tvb, offset) == ':')
-     {
-         proto_tree_add_item(response_tree, hf_irc_response_trailer, tvb, offset+1, end_offset-offset-1, ENC_ASCII);
-         dissect_irc_tag_data(response_tree, response_item, tvb, offset+1, end_offset-offset-1, pinfo, str_command);
-         return;
-     }
- 
-     while(offset < end_offset)
-     {
-         eocp_offset = tvb_find_uint8(tvb, offset, end_offset-offset, ' ');
-         tag_start_offset = tvb_ws_mempbrk_pattern_uint8(tvb, offset, end_offset-offset, &pbrk_tag_delimiter, &found_tag_needle);
- 
-         /* Create subtree when the first parameter is found */
-         if (first_command_param)
-         {
-             command_tree = proto_tree_add_subtree(response_tree, tvb, offset, end_offset-offset,
-                                         ett_irc_response_command , NULL, "Command parameters");
-             first_command_param = false;
-         }
- 
-         if ((tag_start_offset == -1) || (eocp_offset < tag_start_offset))
-         {
-             /* regular message should be dissected */
- 
-             if (eocp_offset == -1)
-             {
-                 proto_tree_add_item(command_tree, hf_irc_response_command_param, tvb, offset, end_offset-offset, ENC_ASCII);
-                 return;
-             }
- 
-             proto_tree_add_item(command_tree, hf_irc_response_command_param, tvb, offset, eocp_offset-offset, ENC_ASCII);
-             offset = eocp_offset+1;
- 
-             /* clear out any whitespace before next command parameter */
-             while(offset < end_offset && tvb_get_uint8(tvb, offset) == ' ')
-             {
-                 offset++;
-             }
-             if (offset == end_offset)
-             {
-                 break;
-             }
- 
-             /* Check if message has a trailer */
-             if (tvb_get_uint8(tvb, offset) == ':')
-             {
-                 proto_tree_add_item(response_tree, hf_irc_response_trailer, tvb, offset+1, end_offset-offset-1, ENC_ASCII);
-                 dissect_irc_tag_data(response_tree, response_item, tvb, offset+1, end_offset-offset-1, pinfo, str_command);
-                 return;
-             }
-         }
-         else if ((eocp_offset == -1) || (eocp_offset > tag_start_offset))
-         {
-             /* tag data dissected */
- 
-             found_tag_needle = 0;
-             tag_end_offset = tvb_ws_mempbrk_pattern_uint8(tvb, tag_start_offset+1, end_offset-tag_start_offset-1, &pbrk_tag_delimiter, &found_tag_needle);
-             if (tag_end_offset == -1)
-             {
-                 expert_add_info(pinfo, response_item, &ei_irc_missing_end_delimiter);
-                 return;
-             }
- 
-             dissect_irc_tag_data(response_tree, response_item, tvb, tag_start_offset, tag_end_offset-tag_start_offset, pinfo, str_command);
-             offset = tag_end_offset+1;
-         }
-     }
- }
- 
- static int
- dissect_irc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)
- {
-     proto_tree *irc_tree, *ti;
-     int         offset = 0;
-     int         next_offset;
-     int         linelen;
- 
-     col_set_str(pinfo->cinfo, COL_PROTOCOL, "IRC");
- 
-     col_set_str(pinfo->cinfo, COL_INFO,
-         (pinfo->match_uint == pinfo->destport) ? "Request" : "Response");
- 
-     ti = proto_tree_add_item(tree, proto_irc, tvb, 0, -1, ENC_NA);
-     irc_tree = proto_item_add_subtree(ti, ett_irc);
- 
-     /*
-      * Process the packet data, a line at a time.
-      */
-     while (tvb_offset_exists(tvb, offset))
-     {
-         /*
-          * Find the end of the line.
-          */
-         linelen = tvb_find_line_end(tvb, offset, -1, &next_offset, false);
-         if (next_offset == offset) {
-             /*
-              * XXX - we really want the "show data a
-              * line at a time" loops in various
-              * dissectors to do reassembly and to
-              * throw an exception if there's no
-              * line ending in the current packet
-              * and we're not doing reassembly.
-              */
-             break;
-         }
- 
-         if (linelen != 0)
-         {
-             if (pinfo->match_uint == pinfo->destport)
-             {
-                 dissect_irc_request(irc_tree, tvb, pinfo, offset, linelen);
-             }
-             else
-             {
-                 dissect_irc_response(irc_tree, tvb, pinfo, offset, linelen);
-             }
-         }
-         offset = next_offset;
-     }
-     return tvb_captured_length(tvb);
- }
- 
- void
- proto_register_irc(void)
- {
-     static hf_register_info hf[] = {
-         { &hf_irc_response, { "Response", "irc.response", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Line of response message", HFILL }},
- 
-         { &hf_irc_request, { "Request", "irc.request", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Line of request message", HFILL }},
- 
-         { &hf_irc_request_prefix, { "Prefix", "irc.request.prefix", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request prefix", HFILL }},
- 
-         { &hf_irc_request_command, { "Command", "irc.request.command", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command", HFILL }},
-         
-         { &hf_irc_request_command_pass, { "PASS Command", "irc.request.command.pass", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_pass_password, { "Password", "irc.request.command.pass.password", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_nick, { "NICK Command", "irc.request.command.nick", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_nick_nick, { "Nickname", "irc.request.command.nick.nick", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_user, { "USER Command", "irc.request.command.user", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_user_user, { "User", "irc.request.command.user.user", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_user_host, { "Host", "irc.request.command.user.host", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-                 
-         { &hf_irc_request_command_user_server, { "Server", "irc.request.command.user.server", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-                     
-         { &hf_irc_request_command_user_real, { "Real", "irc.request.command.user.real", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_ping, { "PING Command", "irc.request.command.ping", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_ping_server, { "Server", "irc.request.command.ping.server", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_pong, { "PONG Command", "irc.request.command.pong", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_pong_server, { "Server", "irc.request.command.pong.server", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_quit, { "QUIT Command", "irc.request.command.quit", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_quit_message, { "Message", "irc.request.command.quit.message", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-           
-         { &hf_irc_request_command_join, { "JOIN Command", "irc.request.command.join", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-   
-         { &hf_irc_request_command_join_channel, { "Join", "irc.request.command.join.channel", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_part, { "PART Command", "irc.request.command.part", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_part_channel, { "Channel", "irc.request.command.part.channel", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_part_message, { "Message", "irc.request.command.part.message", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-           
-         { &hf_irc_request_command_privmsg, { "PRIVMSG Command", "irc.request.command.privmsg", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_privmsg_target, { "Target", "irc.request.command.privmsg.target", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-             
-         { &hf_irc_request_command_privmsg_message, { "Message", "irc.request.command.privmsg.message", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-   
-         { &hf_irc_request_command_notice, { "NOTICE Command", "irc.request.command.notice", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_notice_target, { "Target", "irc.request.command.notice.target", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_notice_message, { "Message", "irc.request.command.notice.message", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_mode, { "MODE Command", "irc.request.command.mode", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: MODE", HFILL }},
-           
-         { &hf_irc_request_command_topic, { "TOPIC Command", "irc.request.command.topic", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_topic_target, { "Target", "irc.request.command.topic.target", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_topic_topic, { "Topic", "irc.request.command.topic.topic", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-   
-         { &hf_irc_request_command_names, { "NAMES Command", "irc.request.command.names", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_names_channel, { "Channel", "irc.request.command.names.channel", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-           
-         { &hf_irc_request_command_list, { "LIST Command", "irc.request.command.list", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_list_channel, { "Channel", "irc.request.command.list.channel", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-   
-         { &hf_irc_request_command_who, { "WHO Command", "irc.request.command.who", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: WHO", HFILL }},
-           
-         { &hf_irc_request_command_whois, { "WHOIS Command", "irc.request.command.whois", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
-         
-         { &hf_irc_request_command_whois_name, { "Name", "irc.request.command.whois.name", FT_STRING, BASE_NONE,
-           NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_request_command_whowas, { "WHOWAS Command", "irc.request.command.whowas", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: WHOWAS", HFILL }},
-     
-         { &hf_irc_request_command_invite, { "INVITE Command", "irc.request.command.invite", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: INVITE", HFILL }},
-             
-         { &hf_irc_request_command_kick, { "KICK Command", "irc.request.command.kick", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: KICK", HFILL }},
-     
-         { &hf_irc_request_command_away, { "AWAY Command", "irc.request.command.away", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: AWAY", HFILL }},
- 
-         { &hf_irc_request_command_ison, { "ISON Command", "irc.request.command.ison", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: ISON", HFILL }},
-             
-         { &hf_irc_request_command_time, { "TIME Command", "irc.request.command.time", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: TIME", HFILL }},
-     
-         { &hf_irc_request_command_motd, { "MOTD Command", "irc.request.command.motd", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: MOTD", HFILL }},
-             
-         { &hf_irc_request_command_version, { "VERSION Command", "irc.request.command.version", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: VERSION", HFILL }},
-     
-         { &hf_irc_request_command_stats, { "STATS Command", "irc.request.command.stats", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: STATS", HFILL }},
-             
-         { &hf_irc_request_command_links, { "LINKS Command", "irc.request.command.links", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: LINKS", HFILL }},
-       
-         { &hf_irc_request_command_trace, { "TRACE Command", "irc.request.command.trace", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: TRACE", HFILL }},
-               
-         { &hf_irc_request_command_admin, { "ADMIN Command", "irc.request.command.admin", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: ADMIN", HFILL }},
-       
-         { &hf_irc_request_command_info, { "INFO Command", "irc.request.command.info", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command: INFO", HFILL }},
- 
-         { &hf_irc_request_command_param, { "Parameter", "irc.request.command_parameter", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request command parameter", HFILL }},
- 
-         { &hf_irc_request_trailer, { "Trailer", "irc.request.trailer", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Request trailer", HFILL }},
- 
-         { &hf_irc_response_prefix, { "Prefix", "irc.response.prefix", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Response prefix", HFILL }},
- 
-         { &hf_irc_response_command, { "Command", "irc.response.command", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Response command", HFILL }},
- 
-         { &hf_irc_response_num_command, { "Command", "irc.response.num_command", FT_UINT16, BASE_DEC,
-           NULL, 0x0, "Response (numeric) command", HFILL }},
- 
-         { &hf_irc_response_command_param, { "Parameter", "irc.response.command_parameter", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Response command parameter", HFILL }},
- 
-         { &hf_irc_response_trailer, { "Trailer", "irc.response.trailer", FT_STRING, BASE_NONE,
-           NULL, 0x0, "Response trailer", HFILL }},
- 
-         //{ &hf_irc_ctcp, { "CTCP", "irc.ctcp", FT_STRING, BASE_NONE,
-         //  NULL, 0x0, NULL, HFILL }},
- 
-         { &hf_irc_ctcp_command, { "Command", "irc.ctcp.command", FT_STRING, BASE_NONE,
-           NULL, 0x0, "CTCP command", HFILL }},
- 
-         { &hf_irc_ctcp_params, { "Parameters", "irc.ctcp.parameters", FT_STRING, BASE_NONE,
-           NULL, 0x0, "CTCP parameters", HFILL }},
-     };
- 
-     static int *ett[] = {
-         &ett_irc,
-         &ett_irc_request,
-         &ett_irc_request_command,
-         &ett_irc_request_command_pass,
-         &ett_irc_request_command_nick,
-         &ett_irc_request_command_user,
-         &ett_irc_request_command_ping,
-         &ett_irc_request_command_pong,
-         &ett_irc_request_command_quit,
-         &ett_irc_request_command_join,
-         &ett_irc_request_command_part,
-         &ett_irc_request_command_privmsg,
-         &ett_irc_request_command_notice,
-         &ett_irc_request_command_topic,
-         &ett_irc_request_command_names,
-         &ett_irc_request_command_list,
-         &ett_irc_request_command_whois,
-         &ett_irc_response,
-         &ett_irc_response_command
-     };
- 
-     static ei_register_info ei[] = {
-         { &ei_irc_missing_end_delimiter, { "irc.missing_end_delimiter", PI_MALFORMED, PI_ERROR, "Missing ending tag delimiter (0x01)", EXPFILL }},
-         { &ei_irc_tag_data_invalid, { "irc.tag_data_invalid", PI_PROTOCOL, PI_WARN, "Tag data outside of NOTICE or PRIVMSG command", EXPFILL }},
-         { &ei_irc_prefix_missing_ending_space, { "irc.prefix_missing_ending_space", PI_MALFORMED, PI_ERROR, "Prefix missing ending <space>", EXPFILL }},
-         { &ei_irc_request_command, { "irc.request.command.missing", PI_MALFORMED, PI_ERROR, "Request has no command", EXPFILL }},
-         { &ei_irc_numeric_request_command, { "irc.request.command.numeric", PI_PROTOCOL, PI_WARN, "Numeric command not allowed in request", EXPFILL }},
-         { &ei_irc_response_command, { "irc.response.command.missing", PI_MALFORMED, PI_ERROR, "Response has no command", EXPFILL }},
-     };
- 
-     expert_module_t* expert_irc;
- 
-     proto_irc = proto_register_protocol("Internet Relay Chat", "IRC", "irc");
-     register_dissector("irc", dissect_irc, proto_irc);
-     proto_register_field_array(proto_irc, hf, array_length(hf));
-     proto_register_subtree_array(ett, array_length(ett));
-     expert_irc = expert_register_protocol(proto_irc);
-     expert_register_field_array(expert_irc, ei, array_length(ei));
- 
-     /* subdissector code */
-     proto_irc_ctcp = proto_register_protocol_in_name_only("Client To Client Protocol", "CTCP", "irc.ctcp", proto_irc, FT_PROTOCOL);
- 
-     /* compile patterns */
-     ws_mempbrk_compile(&pbrk_tag_delimiter, TAG_DELIMITER);
- }
- 
- void
- proto_reg_handoff_irc(void)
- {
-     dissector_add_uint_range_with_preference("tcp.port", TCP_PORT_RANGE, find_dissector("irc"));
- 
-     ctcp_handle = create_dissector_handle(dissect_irc_ctcp, proto_irc_ctcp);
- }
- 
- /*
-  * Editor modelines  -  https://www.wireshark.org/tools/modelines.html
-  *
-  * Local variables:
-  * c-basic-offset: 4
-  * tab-width: 8
-  * indent-tabs-mode: nil
-  * End:
-  *
-  * vi: set shiftwidth=4 tabstop=8 expandtab:
-  * :indentSize=4:tabSize=8:noTabs=true:
-  */
- 
\ No newline at end of file
