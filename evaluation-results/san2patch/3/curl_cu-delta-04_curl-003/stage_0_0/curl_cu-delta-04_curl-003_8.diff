diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..b84bd1b2e 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -334,9 +334,15 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
     ERROR_CHECK_SETOPT(CURLOPT_CAINFO_BLOB,
                        data->set.blobs[BLOB_CAINFO]);
   }
-  if(data->set.str[STRING_SSL_CAPATH]) {
-    ERROR_CHECK_SETOPT(CURLOPT_CAPATH,
-                       data->set.str[STRING_SSL_CAPATH]);
+// Rationale: duplicate the CAPATH string, use the duplicate for the setopt call and then free it, then clear original pointer
+   if(data->set.str[STRING_SSL_CAPATH]) {
+    char *capath_dup = strdup(data->set.str[STRING_SSL_CAPATH]);
+    if(capath_dup) {
+      ERROR_CHECK_SETOPT(CURLOPT_CAPATH,
+                         capath_dup);
+      free(capath_dup);
+    }
+    data->set.str[STRING_SSL_CAPATH] = NULL;
   }
   if(data->set.str[STRING_SSL_CRLFILE]) {
     ERROR_CHECK_SETOPT(CURLOPT_CRLFILE,
@@ -346,8 +352,7 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
     ERROR_CHECK_SETOPT(CURLOPT_CERTINFO, 1L);
   if(data->set.ssl.fsslctx)
     ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_FUNCTION, data->set.ssl.fsslctx);
-  if(data->set.ssl.fsslctxp)
-    ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_DATA, data->set.ssl.fsslctxp);
+  if(data->set.ssl.fsslctxp)    ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_DATA, data->set.ssl.fsslctxp);
   if(data->set.fdebug)
     ERROR_CHECK_SETOPT(CURLOPT_DEBUGFUNCTION, data->set.fdebug);
   if(data->set.debugdata)
