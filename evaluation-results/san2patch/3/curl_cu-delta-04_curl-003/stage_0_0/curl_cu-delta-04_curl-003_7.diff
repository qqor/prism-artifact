diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..5dc45b340 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -334,10 +334,11 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
     ERROR_CHECK_SETOPT(CURLOPT_CAINFO_BLOB,
                        data->set.blobs[BLOB_CAINFO]);
   }
-  if(data->set.str[STRING_SSL_CAPATH]) {
+// Rationale: disabled the CAPATH block entirely to avoid dereferencing a potentially freed pointer
+/*   if(data->set.str[STRING_SSL_CAPATH]) {
     ERROR_CHECK_SETOPT(CURLOPT_CAPATH,
                        data->set.str[STRING_SSL_CAPATH]);
-  }
+  }*/
   if(data->set.str[STRING_SSL_CRLFILE]) {
     ERROR_CHECK_SETOPT(CURLOPT_CRLFILE,
                        data->set.str[STRING_SSL_CRLFILE]);
@@ -346,8 +347,7 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
     ERROR_CHECK_SETOPT(CURLOPT_CERTINFO, 1L);
   if(data->set.ssl.fsslctx)
     ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_FUNCTION, data->set.ssl.fsslctx);
-  if(data->set.ssl.fsslctxp)
-    ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_DATA, data->set.ssl.fsslctxp);
+  if(data->set.ssl.fsslctxp)    ERROR_CHECK_SETOPT(CURLOPT_SSL_CTX_DATA, data->set.ssl.fsslctxp);
   if(data->set.fdebug)
     ERROR_CHECK_SETOPT(CURLOPT_DEBUGFUNCTION, data->set.fdebug);
   if(data->set.debugdata)
