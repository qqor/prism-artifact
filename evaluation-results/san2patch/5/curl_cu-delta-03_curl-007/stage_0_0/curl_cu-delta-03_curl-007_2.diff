diff --git a/lib/alliswellprotocoll.c b/lib/alliswellprotocoll.c
index 5be67405e..3c986ad4d 100644
--- a/lib/alliswellprotocoll.c
+++ b/lib/alliswellprotocoll.c
@@ -274,13 +274,19 @@ static CURLcode alliswellprotocoll_sm
 
 static CURLcode alliswellprotocoll_doing(struct Curl_easy *data, bool *done)
 {
-  struct connectdata *conn = data->conn;
-  struct alliswellprotocoll_conn *vnormal = &conn->proto.vnormal;
+  struct connectdata *conn = data ? data->conn : NULL;
+  /* Rationale: Unified error path using goto to handle NULL-pointer scenarios. */
+  if(!data || !conn) {
+    goto error;
+  }
+   struct alliswellprotocoll_conn *vnormal = &conn->proto.vnormal;
 
   CURLcode result = Curl_pp_statemach(data, &vnormal->pp, FALSE, FALSE);
 
   *done = (vnormal->state == ALLISWELLPROTOCOLL_STOP);
-
   return result;
 
+error:
+  *done = FALSE;
+  return CURLE_BAD_FUNCTION_ARGUMENT;
 }
\ No newline at end of file
