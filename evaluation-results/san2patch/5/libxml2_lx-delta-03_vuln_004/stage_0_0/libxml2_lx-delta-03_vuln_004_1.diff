diff --git a/encoding.c b/encoding.c
index adecdcc6..becea2f6 100644
--- a/encoding.c
+++ b/encoding.c
@@ -1632,7 +1632,9 @@ xmlCharEncInput(xmlParserInputBufferPtr input, size_t *sizeOut)
             break;
 
         if (ret == XML_ENC_ERR_SPACE) {
-            if (xmlBufGrow(out, 4096) < 0) {
+            /* grow by 4Ã— to accommodate worst-case UTF-8 expansion plus null */
+            size_t grow_amount = 4096 * 4 + 1;
+            if (xmlBufGrow(out, (int)grow_amount) < 0) {
                 input->error = XML_ERR_NO_MEMORY;
                 return(XML_ENC_ERR_MEMORY);
             }
