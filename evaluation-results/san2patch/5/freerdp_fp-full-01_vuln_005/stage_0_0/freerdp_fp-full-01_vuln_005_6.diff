diff --git a/libfreerdp/core/connection.c b/libfreerdp/core/connection.c
index 71c1060fb..2913b2f95 100644
--- a/libfreerdp/core/connection.c
+++ b/libfreerdp/core/connection.c
@@ -288,15 +288,13 @@ static BOOL rdp_client_wait_for_activation(rdpRdp* rdp)
 	}
 
 	WLog_ERR(TAG, "Timeout waiting for activation");
-	freerdp_set_last_error_if_not(rdp->context, FREERDP_ERROR_CONNECT_ACTIVATION_TIMEOUT);
+	if (rdp && rdp->context) {
+		freerdp_set_last_error_if_not(rdp->context, FREERDP_ERROR_CONNECT_ACTIVATION_TIMEOUT);
+	} else {
+		WLog_ERR(TAG, "Cannot set last error: missing RDP context");
+	}
 	return FALSE;
-}
-/**
- * Establish RDP Connection based on the settings given in the 'rdp' parameter.
- * msdn{cc240452}
- * @param rdp RDP module
- * @return true if the connection succeeded. FALSE otherwise.
- */
+} */
 
 BOOL rdp_client_connect(rdpRdp* rdp)
 {
