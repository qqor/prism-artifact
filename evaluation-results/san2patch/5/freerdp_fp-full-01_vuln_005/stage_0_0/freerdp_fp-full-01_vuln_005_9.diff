diff --git a/libfreerdp/core/connection.c b/libfreerdp/core/connection.c
index 71c1060fb..808dd22d1 100644
--- a/libfreerdp/core/connection.c
+++ b/libfreerdp/core/connection.c
@@ -287,16 +287,14 @@ static BOOL rdp_client_wait_for_activation(rdpRdp* rdp)
 			return TRUE;
 	}
 
+	if (!rdp || !rdp->context) {
+		WLog_ERR(TAG, "rdp_client_wait_for_activation: context is invalid");
+		return FALSE;
+	}
 	WLog_ERR(TAG, "Timeout waiting for activation");
 	freerdp_set_last_error_if_not(rdp->context, FREERDP_ERROR_CONNECT_ACTIVATION_TIMEOUT);
 	return FALSE;
-}
-/**
- * Establish RDP Connection based on the settings given in the 'rdp' parameter.
- * msdn{cc240452}
- * @param rdp RDP module
- * @return true if the connection succeeded. FALSE otherwise.
- */
+} */
 
 BOOL rdp_client_connect(rdpRdp* rdp)
 {
