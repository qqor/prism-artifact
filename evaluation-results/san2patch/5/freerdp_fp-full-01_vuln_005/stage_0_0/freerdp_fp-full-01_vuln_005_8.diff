diff --git a/libfreerdp/core/connection.c b/libfreerdp/core/connection.c
index 71c1060fb..4381db263 100644
--- a/libfreerdp/core/connection.c
+++ b/libfreerdp/core/connection.c
@@ -288,15 +288,13 @@ static BOOL rdp_client_wait_for_activation(rdpRdp* rdp)
 	}
 
 	WLog_ERR(TAG, "Timeout waiting for activation");
+	if (!rdp || !rdp->context)
+		goto failure;
 	freerdp_set_last_error_if_not(rdp->context, FREERDP_ERROR_CONNECT_ACTIVATION_TIMEOUT);
+
+failure:
 	return FALSE;
-}
-/**
- * Establish RDP Connection based on the settings given in the 'rdp' parameter.
- * msdn{cc240452}
- * @param rdp RDP module
- * @return true if the connection succeeded. FALSE otherwise.
- */
+} */
 
 BOOL rdp_client_connect(rdpRdp* rdp)
 {
