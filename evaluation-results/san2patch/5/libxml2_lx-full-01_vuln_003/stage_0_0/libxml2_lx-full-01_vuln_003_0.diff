diff --git a/xmlstring.c b/xmlstring.c
index 5f03e07a..262ebbb8 100644
--- a/xmlstring.c
+++ b/xmlstring.c
@@ -77,37 +77,35 @@ xmlChar *
 xmlStrdup(const xmlChar *cur) {
     const xmlChar *p = cur;
 
+    /* Rationale: compute exact length, allocate correct buffer sized to prevent overflow */
     if (cur == NULL) return(NULL);
-    while (*p != 0) p++; /* non input consuming */
-    return(xmlStrndup(cur, p - cur));
+    size_t len = 0;
+    while (*p != 0) { p++; len++; }
+    xmlChar *ret = (xmlChar *)xmlMalloc(len + 1);
+    if (ret == NULL) return(NULL);
+    memcpy(ret, cur, len);
+    ret[len] = 0;
+    return(ret);
 }
-
-/**
- * xmlCharStrndup:
- * @cur:  the input char *
- * @len:  the len of @cur
- *
- * a strndup for char's to xmlChar's
- *
- * Returns a new xmlChar * or NULL
  */
 
 xmlChar *
 xmlCharStrndup(const char *cur, int len) {
     int i;
     xmlChar *ret;
+    int n;
 
     if ((cur == NULL) || (len < 0)) return(NULL);
-    ret = xmlMalloc((size_t) len + 1);
+    /* clamp length to actual string length */
+    n = (int)strnlen(cur, len);
+    ret = xmlMalloc((size_t) n + 1);
     if (ret == NULL) {
-        return(NULL);
+         return(NULL);
     }
-    for (i = 0;i < len;i++) {
-        /* Explicit sign change */
+    for (i = 0;i < n;i++) {
         ret[i] = (xmlChar) cur[i];
-        if (ret[i] == 0) return(ret);
     }
-    ret[len] = 0;
+    ret[n] = 0;
     return(ret);
 }
 
