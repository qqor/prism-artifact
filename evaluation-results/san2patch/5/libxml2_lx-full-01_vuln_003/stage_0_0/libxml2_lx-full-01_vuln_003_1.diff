diff --git a/xmlstring.c b/xmlstring.c
index 5f03e07a..417d3773 100644
--- a/xmlstring.c
+++ b/xmlstring.c
@@ -75,39 +75,39 @@ xmlStrndup(const xmlChar *cur, int len) {
  */
 xmlChar *
 xmlStrdup(const xmlChar *cur) {
-    const xmlChar *p = cur;
-
+    /* Rationale: use xmlStrlen and manual copy loop to avoid overflow */
     if (cur == NULL) return(NULL);
-    while (*p != 0) p++; /* non input consuming */
-    return(xmlStrndup(cur, p - cur));
+    size_t len = xmlStrlen(cur);
+    xmlChar *ret = (xmlChar *)xmlMalloc(len + 1);
+    if (ret == NULL) return(NULL);
+    xmlChar *dst = ret;
+    const xmlChar *src = cur;
+    while (*src != 0) {
+        *dst++ = *src++;
+    }
+    *dst = 0;
+    return(ret);
 }
-
-/**
- * xmlCharStrndup:
- * @cur:  the input char *
- * @len:  the len of @cur
- *
- * a strndup for char's to xmlChar's
- *
- * Returns a new xmlChar * or NULL
  */
 
 xmlChar *
 xmlCharStrndup(const char *cur, int len) {
     int i;
     xmlChar *ret;
+    int actual = 0;
 
     if ((cur == NULL) || (len < 0)) return(NULL);
-    ret = xmlMalloc((size_t) len + 1);
+    /* calculate number of characters up to len or terminating NUL */
+    while ((actual < len) && (cur[actual] != 0)) actual++;
+    ret = xmlMalloc((size_t) actual + 1);
     if (ret == NULL) {
-        return(NULL);
+         return(NULL);
     }
-    for (i = 0;i < len;i++) {
+    for (i = 0;i < actual;i++) {
         /* Explicit sign change */
         ret[i] = (xmlChar) cur[i];
-        if (ret[i] == 0) return(ret);
     }
-    ret[len] = 0;
+    ret[actual] = 0;
     return(ret);
 }
 
