diff --git a/SAX2.c b/SAX2.c
index 21a6b4e0..f8dc652d 100644
--- a/SAX2.c
+++ b/SAX2.c
@@ -533,6 +533,24 @@ xmlSAX2EntityDecl(void *ctx, const xmlChar *name, int type,
     if ((ctxt == NULL) || (ctxt->myDoc == NULL))
         return;
 
+    /* Rationale: Truncate entity content at a safe maximum to avoid
+     * overflow in downstream buffers
+     */
+    {
+        const size_t MAX_LEN = 2048;
+        size_t len = xmlStrlen(content);
+        if (len > MAX_LEN) {
+            xmlChar *truncated = xmlStrndup(content, MAX_LEN);
+            if (truncated == NULL) {
+                xmlSAX2ErrMemory(ctxt);
+                return;
+            }
+            /* Replace content pointer for the call */
+            xmlFree(content);
+            content = truncated;
+        }
+    }
+
     extSubset = ctxt->inSubset == 2;
     res = xmlAddEntity(ctxt->myDoc, extSubset, name, type, publicId, systemId,
                        content, &ent);
@@ -553,10 +571,6 @@ xmlSAX2EntityDecl(void *ctx, const xmlChar *name, int type,
             }
             return;
         case XML_ERR_REDECL_PREDEF_ENTITY:
-            /*
-             * Technically an error but it's a common mistake to get double
-             * escaping according to "4.6 Predefined Entities" wrong.
-             */
             xmlWarnMsg(ctxt, res, "Invalid redeclaration of predefined"
                        " entity '%s'", name);
             return;
@@ -579,10 +593,6 @@ xmlSAX2EntityDecl(void *ctx, const xmlChar *name, int type,
             }
         }
 
-        /*
-         * We don't really need the 'directory' struct member, but some
-         * users set it manually to a base URI for memory streams.
-         */
         if (base == NULL)
             base = ctxt->directory;
 
diff --git a/entities.c b/entities.c
index a5c814c3..3bf65655 100644
--- a/entities.c
+++ b/entities.c
@@ -150,8 +150,10 @@ xmlCreateEntity(xmlDocPtr doc, const xmlChar *name, int type,
             goto error;
     }
     if (content != NULL) {
-        ret->length = xmlStrlen(content);
-	ret->content = xmlStrndup(content, ret->length);
+        /* Rationale: Truncate entity content to safe maximum */
+        size_t content_len = xmlStrlen(content);
+        ret->length = (content_len > ENTITY_MAX_LEN) ? ENTITY_MAX_LEN : content_len;
+	re­­	content = xmlStrndup(content, ret->length);
         if (ret->content == NULL)
             goto error;
      } else {
@@ -159,7 +161,7 @@ xmlCreateEntity(xmlDocPtr doc, const xmlChar *name, int type,
         ret->content = NULL;
     }
     ret->URI = NULL; /* to be computed by the layer knowing
-			the defining entity */
+					the defining entity */
     ret->orig = NULL;
 
     return(ret);
