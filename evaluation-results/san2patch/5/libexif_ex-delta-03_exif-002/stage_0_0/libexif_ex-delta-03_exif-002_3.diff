diff --git a/libexif/exif-data.c b/libexif/exif-data.c
index f3f6dbc..8cbdbd4 100644
--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -976,6 +976,9 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,
 	exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData", 
 		  "IFD 0 at %i.", (int) offset);
 
+	/* Quick reject if data too small */
+	if (ds < 6)
+		return;
 	/* ds is restricted to 16 bit above, so offset is restricted too, and offset+8 should not overflow. */
 	if (offset > ds || offset + 6 + 2 > ds)
 		return;
@@ -991,8 +994,7 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,
 
 	offset = exif_get_long (d + 6 + offset + 2 + 12 * n, data->priv->order);
 	if (offset) {
-		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-			  "IFD 1 at %i.", (int) offset);
+		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",			  "IFD 1 at %i.", (int) offset);
 
 		/* Sanity check. ds is ensured to be above 6 above, offset is 16bit */
 		if (offset > ds - 6) {
