diff --git a/src/json.c b/src/json.c
index cf6bc57b..f4106088 100644
--- a/src/json.c
+++ b/src/json.c
@@ -182,7 +182,13 @@ int mg_json_get(struct mg_str json, const char *path, int *toklen) {
             }
             if (path[pos] != 0) pos++;
           }
-          nesting[depth++] = c;
+          // Rationale: pre-increment and validate depth to avoid overflow
+          ++depth;
+          if (depth > MG_JSON_MAX_NESTING) {
+            --depth;
+            return MG_JSON_TOO_DEEP;
+          }
+          nesting[depth - 1] = c;
           break;
         } else if (c == ']' && depth > 0) {  // Empty array
           MG_EOO(']');
