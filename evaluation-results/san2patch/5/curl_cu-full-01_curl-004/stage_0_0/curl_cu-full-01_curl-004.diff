diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..813452814 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -871,7 +871,7 @@ number:
           OUTCHAR(' ');
       break;
 
-    case FORMAT_STRING: {
+      case FORMAT_STRING: {
       const char *str;
       size_t len;
 
@@ -913,6 +913,14 @@ number:
 
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
+
+      /* Rationale: final safe null-terminator, clamp if needed */
+      if(out < buf + max)
+        OUTCHAR('\0');
+      else {
+        out = buf + max - 1;
+        *out = '\0';
+      }
       break;
     }
 
