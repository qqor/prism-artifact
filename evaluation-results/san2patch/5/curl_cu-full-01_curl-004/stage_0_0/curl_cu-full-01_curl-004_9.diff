diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..1ee5ee4ce 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1072,11 +1072,20 @@ int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
   info.length = 0;
   info.max = maxlength;
 
-  retcode = formatf(&info, addbyter, format, ap_save);
+  /* Rationale: Nested callback checks remaining space before writing each byte */
+  int safe_addbyter(struct nsprintf *i, int c)
+  {
+    if(i->length < i->max - 1) {
+      return addbyter(i, c);
+    }
+    return 0;
+  }
+
+  retcode = formatf(&info, safe_addbyter, format, ap_save);
   if(info.max) {
     /* we terminate this with a zero byte */
-    if(info.max == info.length) {
-      /* we are at maximum, scrap the last letter */
+    if(info.length == info.max) {
+      /* scrap the last letter when exactly full */
       info.buffer[-1] = 0;
       DEBUGASSERT(retcode);
       retcode--; /* do not count the nul byte */
@@ -1087,6 +1096,7 @@ int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
   return retcode;
 }
 
+
 int curl_msnprintf(char *buffer, size_t maxlength, const char *format, ...)
 {
   int retcode;
