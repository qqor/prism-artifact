diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..867fcadc5 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1066,27 +1066,19 @@ int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
                     va_list ap_save)
 {
   int retcode;
-  struct nsprintf info;
-
-  info.buffer = buffer;
-  info.length = 0;
-  info.max = maxlength;
-
-  retcode = formatf(&info, addbyter, format, ap_save);
-  if(info.max) {
-    /* we terminate this with a zero byte */
-    if(info.max == info.length) {
-      /* we are at maximum, scrap the last letter */
-      info.buffer[-1] = 0;
-      DEBUGASSERT(retcode);
-      retcode--; /* do not count the nul byte */
-    }
-    else
-      info.buffer[0] = 0;
-  }
+  /* Rationale: Use a memory-backed FILE stream to leverage vfprintf's safe writes */
+  FILE *mem = fmemopen(buffer, maxlength, "w");
+  if(!mem)
+    return -1;
+
+  retcode = vfprintf(mem, format, ap_save);
+  fflush(mem);
+  fclose(mem);
+
   return retcode;
 }
 
+
 int curl_msnprintf(char *buffer, size_t maxlength, const char *format, ...)
 {
   int retcode;
