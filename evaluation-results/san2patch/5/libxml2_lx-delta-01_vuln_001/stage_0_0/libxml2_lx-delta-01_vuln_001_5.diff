diff --git a/HTMLparser.c b/HTMLparser.c
index 9c34e9e8..6c1a710b 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -3697,7 +3697,18 @@ htmlTopParseComment(htmlParserCtxtPtr ctxt, int bogus) {
         } else if ((CUR == '-') && (NXT(1) == '>')) {
             SKIP(2);
         } else {
+            /* Pre-scan comment length and clamp to maxLength */
+            const unsigned char *p = ctxt->input->cur;
+            int length = 0;
+            while (*p && !(p[0] == '-' && p[1] == '-' && p[2] == '>') && length < maxLength) {
+                p++;
+                length++;
+            }
             buf = htmlSecureComment(ctxt, MASK_DASH, 0, maxLength);
+            if (buf != NULL) {
+                /* Ensure null-termination and truncate if needed */
+                buf[length] = '\0';
+            }
             comment = buf;
         }
     }
