diff --git a/HTMLparser.c b/HTMLparser.c
index 9c34e9e8..3628c668 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2837,28 +2837,24 @@ next_chunk:
             size_t newSize = (used + extraSize) * 2;
             xmlChar *tmp = (xmlChar *) xmlRealloc(buffer, newSize + 1);
 
-            if (tmp == NULL) {
-                htmlErrMemory(ctxt);
-                goto error;
-            }
-            buffer = tmp;
-            buffer_size = newSize;
-        }
-
-        if (chunkSize > 0) {
+// FIXME: Crash CWE-787: Out-of-bounds Write
+         if (chunkSize > 0) {
+            /* compute actual bytes to copy */
+            size_t toCopy = (buffer_size - used) < (size_t)chunkSize ? (buffer_size - used) : (size_t)chunkSize;
             input->cur += chunkSize;
-            memcpy(buffer + used, chunk, chunkSize);
-            used += chunkSize;
+            memcpy(buffer + used, chunk, toCopy);
+            used += toCopy;
         }
 
         input->cur += skip;
         if (replSize > 0) {
-            memcpy(buffer + used, repl, replSize);
-            used += replSize;
+            /* compute actual bytes to copy for replacement */
+            size_t repCopy = (buffer_size - used) < (size_t)replSize ? (buffer_size - used) : (size_t)replSize;
+            memcpy(buffer + used, repl, repCopy);
+            used += repCopy;
         }
 
         SHRINK;
-
         if (termSkip >= 0)
             break;
 
@@ -3578,28 +3574,24 @@ next_chunk:
             size_t newSize = (used + extraSize) * 2;
             xmlChar *tmp = (xmlChar *) xmlRealloc(buffer, newSize + 1);
 
-            if (tmp == NULL) {
-                htmlErrMemory(ctxt);
-                goto error;
-            }
-            buffer = tmp;
-            buffer_size = newSize;
-        }
-
-        if (chunkSize > 0) {
+// FIXME: Crash CWE-787: Out-of-bounds Write
+         if (chunkSize > 0) {
+            /* compute actual bytes to copy */
+            size_t toCopy = (buffer_size - used) < (size_t)chunkSize ? (buffer_size - used) : (size_t)chunkSize;
             input->cur += chunkSize;
-            memcpy(buffer + used, chunk, chunkSize);
-            used += chunkSize;
+            memcpy(buffer + used, chunk, toCopy);
+            used += toCopy;
         }
 
         input->cur += skip;
         if (replSize > 0) {
-            memcpy(buffer + used, repl, replSize);
-            used += replSize;
+            /* compute actual bytes to copy for replacement */
+            size_t repCopy = (buffer_size - used) < (size_t)replSize ? (buffer_size - used) : (size_t)replSize;
+            memcpy(buffer + used, repl, repCopy);
+            used += repCopy;
         }
 
         SHRINK;
-
         if (termSkip >= 0)
             break;
 
