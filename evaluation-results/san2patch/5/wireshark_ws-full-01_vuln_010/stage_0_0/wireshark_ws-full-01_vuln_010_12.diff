diff --git a/epan/dissectors/packet-netbios.c b/epan/dissectors/packet-netbios.c
index 9d55d615db..44bb8639b8 100644
--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -399,15 +399,6 @@ netbios_data_first_middle_flags( tvbuff_t *tvb, proto_tree *tree, int offset)
 		/* decode the flag field for Data First Middle packet*/
 
 	tf = proto_tree_add_item(tree, hf_netb_flags, tvb, offset, 1, ENC_LITTLE_ENDIAN);
-	field_tree = proto_item_add_subtree(tf, ett_netb_flags);
-
-	proto_tree_add_item( field_tree, hf_netb_flags_ack, tvb, offset, 1, ENC_LITTLE_ENDIAN);
-
-	proto_tree_add_item( field_tree, hf_netb_flags_ack_expected, tvb, offset, 1, ENC_LITTLE_ENDIAN);
-
-	proto_tree_add_item( field_tree, hf_netb_flags_recv_cont_req, tvb, offset, 1, ENC_LITTLE_ENDIAN);
-}
-
 static void
 netbios_data_only_flags( tvbuff_t *tvb, proto_tree *tree, int offset)
 
@@ -415,12 +406,20 @@ netbios_data_only_flags( tvbuff_t *tvb, proto_tree *tree, int offset)
 	proto_tree *field_tree;
 	proto_item *tf;
 
+	/* Rationale: Use tvb_ensure_bytes_exist to abort if requested data is out-of-bounds */
+	if (!tvb_ensure_bytes_exist(tvb, offset, 1)) {
+		/* insufficient data, skip parsing */
+		return;
+	}
+
 	/* decode the flag field for Data Only Last packet*/
 	tf = proto_tree_add_item(tree, hf_netb_flags, tvb, offset, 1, ENC_LITTLE_ENDIAN);
 	field_tree = proto_item_add_subtree(tf, ett_netb_flags);
 
 	proto_tree_add_item( field_tree, hf_netb_flags_ack, tvb, offset, 1, ENC_LITTLE_ENDIAN);
-
+	proto_tree_add_item( field_tree, hf_netb_flags_ack_expected, tvb, offset, 1, ENC_LITTLE_ENDIAN);
+	proto_tree_add_item( field_tree, hf_netb_flags_recv_cont_req, tvb, offset, 1, ENC_LITTLE_ENDIAN);
+}
 	proto_tree_add_item( field_tree, hf_netb_flags_ack_with_data, tvb, offset, 1, ENC_LITTLE_ENDIAN);
 
 	proto_tree_add_item( field_tree, hf_netb_flags_ack_expected, tvb, offset, 1, ENC_LITTLE_ENDIAN);
