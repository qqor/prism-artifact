diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..aabf2b3c8 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -874,6 +874,8 @@ number:
     case FORMAT_STRING: {
       const char *str;
       size_t len;
+      /* Rationale: cap precision before assigning to len */
+      static const size_t MAX_FMT_LEN = 1024;
 
       str = (char *)iptr->val.str;
       if(!str) {
@@ -889,8 +891,10 @@ number:
           len = 0;
         }
       }
-      else if(prec != -1)
-        len = (size_t)prec;
+      else if(prec != -1) {
+        size_t p = (size_t)prec;
+        len = (p > MAX_FMT_LEN) ? MAX_FMT_LEN : p;
+      }
       else if(*str == '\0')
         len = 0;
       else
