diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..5f62223ec 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -874,6 +874,8 @@ number:
     case FORMAT_STRING: {
       const char *str;
       size_t len;
+      /* Rationale: use strnlen to bound length by precision or max */
+      static const size_t MAX_FMT_LEN = 1024;
 
       str = (char *)iptr->val.str;
       if(!str) {
@@ -889,12 +891,12 @@ number:
           len = 0;
         }
       }
-      else if(prec != -1)
-        len = (size_t)prec;
-      else if(*str == '\0')
-        len = 0;
-      else
-        len = strlen(str);
+      else {
+        if(prec != -1)
+          len = strnlen(str, (size_t)prec);
+        else
+          len = strnlen(str, MAX_FMT_LEN);
+      }
 
       width -= (len > INT_MAX) ? INT_MAX : (int)len;
 
