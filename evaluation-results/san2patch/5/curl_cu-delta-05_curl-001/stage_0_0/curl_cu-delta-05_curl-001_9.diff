diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..2def7c049 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1126,20 +1126,14 @@ int Curl_dyn_vprintf(struct dynbuf *dyn, const char *format, va_list ap_save)
 
 char *curl_mvaprintf(const char *format, va_list ap_save)
 {
-  struct asprintf info;
-  struct dynbuf dyn;
-  info.b = &dyn;
-  Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+  char temp[MAX_DICT_CMD_LEN + 1];
+  int len;
 
-  (void)formatf(&info, alloc_addbyter, format, ap_save);
-  if(info.merr) {
-    Curl_dyn_free(info.b);
+  /* Rationale: format into stack buffer with a hard limit */
+  len = vsnprintf(temp, sizeof(temp), format, ap_save);
+  if(len < 0 || (size_t)len > MAX_DICT_CMD_LEN)
     return NULL;
-  }
-  if(Curl_dyn_len(info.b))
-    return Curl_dyn_ptr(info.b);
-  return strdup("");
+  return strdup(temp);
 }
 
 char *curl_maprintf(const char *format, ...)
