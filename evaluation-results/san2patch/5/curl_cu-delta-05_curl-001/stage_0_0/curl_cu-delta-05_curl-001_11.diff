diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..f43d33bab 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -131,10 +131,12 @@ static CURLcode sendf(struct Curl_easy *data, const char *fmt, ...)
 {
   size_t bytes_written;
   size_t write_len;
+  const size_t max_len = 8192;
   CURLcode result = CURLE_OK;
   char *s;
   char *sptr;
-  va_list ap;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+   va_list ap;
   va_start(ap, fmt);
   s = vaprintf(fmt, ap); /* returns an allocated string */
   va_end(ap);
@@ -142,7 +144,11 @@ static CURLcode sendf(struct Curl_easy *data, const char *fmt, ...)
     return CURLE_OUT_OF_MEMORY; /* failure */
 
   bytes_written = 0;
-  write_len = strlen(s);
+  write_len = strnlen(s, max_len + 1);
+  if(write_len > max_len) {
+    free(s);
+    return CURLE_OUT_OF_MEMORY;
+  }
   sptr = s;
 
   for(;;) {
diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..6dbf57a4e 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1130,13 +1130,19 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
   struct dynbuf dyn;
   info.b = &dyn;
   Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+   info.merr = MERR_OK;
 
   (void)formatf(&info, alloc_addbyter, format, ap_save);
   if(info.merr) {
     Curl_dyn_free(info.b);
     return NULL;
   }
+  /* Fail on or equal to maximum to avoid overflow */
+  if(Curl_dyn_len(info.b) >= CURL_MAX_MVAPRINTF_LEN) {
+    Curl_dyn_free(info.b);
+    return NULL;
+  }
   if(Curl_dyn_len(info.b))
     return Curl_dyn_ptr(info.b);
   return strdup("");
