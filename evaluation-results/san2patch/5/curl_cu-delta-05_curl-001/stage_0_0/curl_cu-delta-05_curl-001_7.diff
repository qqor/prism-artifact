diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..5bb4c6908 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1128,15 +1128,21 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
 {
   struct asprintf info;
   struct dynbuf dyn;
+
   info.b = &dyn;
   Curl_dyn_init(info.b, DYN_APRINTF);
   info.merr = MERR_OK;
 
+  /* Rationale: after formatting, ensure dynamic buffer did not grow too large */
   (void)formatf(&info, alloc_addbyter, format, ap_save);
   if(info.merr) {
     Curl_dyn_free(info.b);
     return NULL;
   }
+  if(Curl_dyn_len(info.b) > MAX_DICT_CMD_LEN) {
+    Curl_dyn_free(info.b);
+    return NULL;
+  }
   if(Curl_dyn_len(info.b))
     return Curl_dyn_ptr(info.b);
   return strdup("");
