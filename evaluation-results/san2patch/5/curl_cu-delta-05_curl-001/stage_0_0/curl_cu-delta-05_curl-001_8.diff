diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..c51a07cce 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1128,12 +1128,14 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
 {
   struct asprintf info;
   struct dynbuf dyn;
+
   info.b = &dyn;
-  Curl_dyn_init(info.b, DYN_APRINTF);
+  /* Rationale: reserve at most MAX_DICT_CMD_LEN+1 bytes to prevent over-allocation */
+  Curl_dyn_init(info.b, MAX_DICT_CMD_LEN + 1);
   info.merr = MERR_OK;
 
   (void)formatf(&info, alloc_addbyter, format, ap_save);
-  if(info.merr) {
+  if(info.merr || Curl_dyn_len(info.b) > MAX_DICT_CMD_LEN) {
     Curl_dyn_free(info.b);
     return NULL;
   }
