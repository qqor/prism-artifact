diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..7200ab7ee 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1126,20 +1126,23 @@ int Curl_dyn_vprintf(struct dynbuf *dyn, const char *format, va_list ap_save)
 
 char *curl_mvaprintf(const char *format, va_list ap_save)
 {
-  struct asprintf info;
-  struct dynbuf dyn;
-  info.b = &dyn;
-  Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+  int len;
+  char *buffer;
+  va_list ap_copy;
 
-  (void)formatf(&info, alloc_addbyter, format, ap_save);
-  if(info.merr) {
-    Curl_dyn_free(info.b);
+  /* Rationale: use vsnprintf directly into allocated buffer */
+  va_copy(ap_copy, ap_save);
+  len = vsnprintf(NULL, 0, format, ap_copy);
+  va_end(ap_copy);
+  if(len < 0 || (size_t)len > MAX_DICT_CMD_LEN)
     return NULL;
-  }
-  if(Curl_dyn_len(info.b))
-    return Curl_dyn_ptr(info.b);
-  return strdup("");
+
+  buffer = malloc((size_t)len + 1);
+  if(!buffer)
+    return NULL;
+
+  vsnprintf(buffer, (size_t)len + 1, format, ap_save);
+  return buffer;
 }
 
 char *curl_maprintf(const char *format, ...)
