diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..ced9117b7 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -134,9 +134,27 @@ static CURLcode sendf(struct Curl_easy *data, const char *fmt, ...)
   CURLcode result = CURLE_OK;
   char *s;
   char *sptr;
-  va_list ap;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+   va_list ap;
   va_start(ap, fmt);
-  s = vaprintf(fmt, ap); /* returns an allocated string */
+  {
+    va_list ap2;
+    va_copy(ap2, ap);
+    int needed = vsnprintf(NULL, 0, fmt, ap);
+    if(needed < 0 || (size_t)needed > 8192) {
+      va_end(ap2);
+      va_end(ap);
+      return CURLE_OUT_OF_MEMORY;
+    }
+    s = malloc((size_t)needed + 1);
+    if(!s) {
+      va_end(ap2);
+      va_end(ap);
+      return CURLE_OUT_OF_MEMORY;
+    }
+    vsnprintf(s, (size_t)needed + 1, fmt, ap2);
+    va_end(ap2);
+  }
   va_end(ap);
   if(!s)
     return CURLE_OUT_OF_MEMORY; /* failure */
diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..20ad093f4 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1130,15 +1130,22 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
   struct dynbuf dyn;
   info.b = &dyn;
   Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+   info.merr = MERR_OK;
 
   (void)formatf(&info, alloc_addbyter, format, ap_save);
   if(info.merr) {
     Curl_dyn_free(info.b);
     return NULL;
   }
-  if(Curl_dyn_len(info.b))
+  if(Curl_dyn_len(info.b)) {
+    /* Block if the output is too large */
+    if(Curl_dyn_len(info.b) > CURL_MAX_MVAPRINTF_LEN) {
+      Curl_dyn_free(info.b);
+      return NULL;
+    }
     return Curl_dyn_ptr(info.b);
+  }
   return strdup("");
 }
 
