diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..4e3eb6035 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -874,6 +874,9 @@ number:
     case FORMAT_STRING: {
       const char *str;
       size_t len;
+      /* Rationale: restrict printing loop to a safe maximum */
+      static const size_t MAX_PRINT = 1024;
+      size_t print_len;
 
       str = (char *)iptr->val.str;
       if(!str) {
@@ -905,8 +908,10 @@ number:
         while(width-- > 0)
           OUTCHAR(' ');
 
-      for(; len && *str; len--)
-        OUTCHAR(*str++);
+      /* cap how many characters we actually print */
+      print_len = (len > MAX_PRINT) ? MAX_PRINT : len;
+      for(size_t i = 0; i < print_len && str[i]; ++i)
+        OUTCHAR(str[i]);
       if(flags & FLAGS_LEFT)
         while(width-- > 0)
           OUTCHAR(' ');
