diff --git a/epan/dissectors/packet-telnet.c b/epan/dissectors/packet-telnet.c
index 9f003e3e61..dfd5166a5d 100644
--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -2206,11 +2206,19 @@ telnet_add_text(proto_tree *tree, tvbuff_t *tvb, int offset, int len)
        If this subopt is set then a method for storing the data in a given window
        is necessary.
     */
-   if ( hf_telnet_naws_subopt_set ) {
-    int start_offset = hf_telnet_width * hf_telnet_line;
-    tvb_get_raw_bytes_as_stringz(tvb, offset, (linelen < hf_telnet_width) ? linelen : hf_telnet_width, hf_naws_data + start_offset);
-    hf_telnet_line = (hf_telnet_line + 1) % hf_telnet_height;
-  }
+// FIXED: Ensure hf_naws_data is reallocated if it has been freed prematurely
+    if (hf_telnet_naws_subopt_set) {
+        if (!hf_naws_data) {
+            /* Recreate the NAWS buffer to avoid use-after-free */
+            hf_naws_data = g_malloc(hf_telnet_width * hf_telnet_height);
+            memset(hf_naws_data, 0, hf_telnet_width * hf_telnet_height);
+        }
+        int start_offset = hf_telnet_width * hf_telnet_line;
+        int copy_len = (linelen < hf_telnet_width) ? linelen : hf_telnet_width;
+        /* Safely copy directly into the (re)allocated buffer */
+        tvb_get_raw_bytes_as_stringz(tvb, offset, copy_len, hf_naws_data + start_offset);
+        hf_telnet_line = (hf_telnet_line + 1) % hf_telnet_height;
+    }
 
     /*
      * In Telnet, CR NUL is the way you send a CR by itself in the
