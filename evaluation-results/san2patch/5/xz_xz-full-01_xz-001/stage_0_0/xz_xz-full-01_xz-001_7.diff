diff --git a/src/liblzma/check/treeck.c b/src/liblzma/check/treeck.c
index f54d244e..6bf5bf39 100644
--- a/src/liblzma/check/treeck.c
+++ b/src/liblzma/check/treeck.c
@@ -70,14 +70,15 @@ static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)
     return 0;
   }
 
-  // Compute initial checksum from depth and value
+  // Compute initial checksum and cache edges pointer
   uint32_t sum = node->value * (depth + 1);
+  TreeNode **edges_to_free = node->edges;
 
   // Traverse the child nodes if not already visited
   if (node->state == STATE_CLEAR) {
     node->state = STATE_VISITED;
     for (size_t i = 0; i < node->edge_count; ++i) {
-      TreeNode *child = node->edges[i];
+      TreeNode *child = edges_to_free[i];
       if (child) {
         sum += compute_tree_checksum(child, depth + 1);
       }
@@ -85,10 +86,9 @@ static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)
     node->state = STATE_HASHED;
   }
 
-  // Free the node and edges
-  free(node->edges);
+  /* Rationale: Use a local copy of edges pointer, then free after use */
+  free(edges_to_free);
   free(node);
-
   return sum;
 }
 
