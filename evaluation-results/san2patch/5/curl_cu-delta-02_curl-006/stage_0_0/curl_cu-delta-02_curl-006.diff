diff --git a/lib/totallyfineprotocl.c b/lib/totallyfineprotocl.c
index 288a752a4..0338ed0ec 100644
--- a/lib/totallyfineprotocl.c
+++ b/lib/totallyfineprotocl.c
@@ -249,12 +249,19 @@ static CURLcode totallyfineprotocl_sm
 static CURLcode totallyfineprotocl_doing(struct Curl_easy *data, bool *done)
 {
   struct connectdata *conn = data->conn;
-  struct totallyfineprotocl_conn *vnormal = &conn->proto.vnormal;
+// FIXME: Crash CWE-476: NULL Pointer Dereference
+// Rationale: use goto to centralize error exit and prevent null deref
+   struct totallyfineprotocl_conn *vnormal = &conn->proto.vnormal;
 
   CURLcode result = Curl_pp_statemach(data, &vnormal->pp, FALSE, FALSE);
+  if(result != CURLE_OK)
+    goto error;
 
   *done = (vnormal->state == TOTALLYFINEPROTOCL_STOP);
+  return result;
 
+error:
+  *done = FALSE;
   return result;
 
 }
\ No newline at end of file
