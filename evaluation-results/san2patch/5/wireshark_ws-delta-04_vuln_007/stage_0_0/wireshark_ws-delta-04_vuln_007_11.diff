diff --git a/wsutil/wmem/wmem_strbuf.c b/wsutil/wmem/wmem_strbuf.c
index ff49f6b8ba..dfcc12f28d 100644
--- a/wsutil/wmem/wmem_strbuf.c
+++ b/wsutil/wmem/wmem_strbuf.c
@@ -383,9 +383,14 @@ char *
 wmem_strbuf_finalize(wmem_strbuf_t *strbuf)
 {
     if (strbuf == NULL)
-        return NULL;
+         return NULL;
 
     char *ret = (char *)wmem_realloc(strbuf->allocator, strbuf->str, strbuf->len+1);
+    /* check allocation before termination */
+    if (ret == NULL)
+         return NULL;
+    /* ensure proper C-string termination */
+    ret[strbuf->len] = 0;
 
     wmem_free(strbuf->allocator, strbuf);
 
