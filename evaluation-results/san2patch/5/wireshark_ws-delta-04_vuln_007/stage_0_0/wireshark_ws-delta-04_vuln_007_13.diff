diff --git a/wsutil/wmem/wmem_strbuf.c b/wsutil/wmem/wmem_strbuf.c
index ff49f6b8ba..bda0c5317d 100644
--- a/wsutil/wmem/wmem_strbuf.c
+++ b/wsutil/wmem/wmem_strbuf.c
@@ -383,11 +383,14 @@ char *
 wmem_strbuf_finalize(wmem_strbuf_t *strbuf)
 {
     if (strbuf == NULL)
-        return NULL;
+         return NULL;
 
     char *ret = (char *)wmem_realloc(strbuf->allocator, strbuf->str, strbuf->len+1);
 
     wmem_free(strbuf->allocator, strbuf);
+    /* only terminate if reallocation succeeded */
+    if (ret)
+        ret[strbuf->len] = 0;
 
     return ret;
 }
