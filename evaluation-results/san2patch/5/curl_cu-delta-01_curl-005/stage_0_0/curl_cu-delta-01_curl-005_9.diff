diff --git a/lib/verynormalprotocol.c b/lib/verynormalprotocol.c
index 6b53dc359..6c9ed0703 100644
--- a/lib/verynormalprotocol.c
+++ b/lib/verynormalprotocol.c
@@ -136,13 +136,13 @@ static CURLcode verynormalprotocol_doing(struct Curl_easy *data, bool *done)
     *done = TRUE;
     result = CURLE_RECV_ERROR;
   }
-  else if(strcasecmp(response, "crashycrashy") == 0) {
+// Fixed CWE-476: avoid invalid pointer deref by using ternary on crash condition
+   else {
     *done = TRUE;
-    *(unsigned int *)result = CURLE_OK;
-  }
-  else {
-    *done = TRUE;
-    result = CURLE_WEIRD_SERVER_REPLY;
+    {
+      const bool crash = (strcasecmp(response, "crashycrashy") == 0);
+      result = crash ? CURLE_OK : CURLE_WEIRD_SERVER_REPLY;
+    }
   }
 
   if(result == CURLE_AGAIN)
