+ FUZZER=fuzz_encode_stream
+ shift
+ '[' '!' -v TESTCASE ']'
+ TESTCASE=/testcase
+ '[' '!' -f /testcase ']'
+ export RUN_FUZZER_MODE=interactive
+ RUN_FUZZER_MODE=interactive
+ export FUZZING_ENGINE=libfuzzer
+ FUZZING_ENGINE=libfuzzer
+ export SKIP_SEED_CORPUS=1
+ SKIP_SEED_CORPUS=1
+ run_fuzzer fuzz_encode_stream -runs=100 /testcase
vm.mmap_rnd_bits = 28
/out/fuzz_encode_stream -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -max_len=4096 -timeout_exitcode=0 < /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2926243833
INFO: Loaded 1 modules   (2409 inline 8-bit counters): 2409 [0x5569d556f3e8, 0x5569d556fd51), 
INFO: Loaded 1 PC tables (2409 PCs): 2409 [0x5569d556fd58,0x5569d55793e8), 
/out/fuzz_encode_stream: Running 1 inputs 100 time(s) each.
Running: /testcase

=================================================================
[1m[31m==18==ERROR: LeakSanitizer: detected memory leaks
[1m[0m
[1m[34mDirect leak of 224 byte(s) in 4 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5d4a in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #4 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #5 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #6 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #7 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #8 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #9 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #10 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #11 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #12 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #13 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 448 byte(s) in 8 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5d4a in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #5 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #6 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #7 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #8 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #9 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #10 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #11 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #12 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #13 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #14 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #15 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #16 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #17 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 257 byte(s) in 8 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5ea2 in create_tree /src/xz/src/liblzma/check/treeck.c:46:17
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #5 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #6 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #7 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #8 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #9 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #10 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #11 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #12 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #13 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #14 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #15 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #16 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #17 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 121 byte(s) in 5 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5ea2 in create_tree /src/xz/src/liblzma/check/treeck.c:46:17
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #4 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #5 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #6 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #7 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #8 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #9 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #10 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #11 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #12 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #13 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 112 byte(s) in 2 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5d4a in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #5 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #6 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #7 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #8 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #9 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #10 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #11 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #12 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #13 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #14 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #15 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 112 byte(s) in 2 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5d4a in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #5 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #6 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #7 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #8 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #9 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #10 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #11 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #12 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #13 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #14 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #15 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 72 byte(s) in 2 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5ea2 in create_tree /src/xz/src/liblzma/check/treeck.c:46:17
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #5 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #6 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #7 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #8 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #9 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #10 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #11 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #12 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #13 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #14 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #15 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 56 byte(s) in 1 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5d4a in create_tree /src/xz/src/liblzma/check/treeck.c:33:20
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #4 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #5 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #6 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #7 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #8 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #9 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #10 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #11 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #12 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #13 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
[1m[34mIndirect leak of 56 byte(s) in 2 object(s) allocated from:
[1m[0m    #0 0x5569d54840af in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x5569d54d5ea2 in create_tree /src/xz/src/liblzma/check/treeck.c:46:17
    #2 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #3 0x5569d54d5fcc in create_tree /src/xz/src/liblzma/check/treeck.c:58:24
    #4 0x5569d54d5c9c in lzma_tree /src/xz/src/liblzma/check/treeck.c:124:20
    #5 0x5569d54d59ea in lzma_check_update /src/xz/src/liblzma/check/check.c:143:23
    #6 0x5569d54d1a9e in block_encode /src/xz/src/liblzma/common/block_encoder.c:82:4
    #7 0x5569d54c7094 in stream_encode /src/xz/src/liblzma/common/stream_encoder.c:158:24
    #8 0x5569d54c539c in lzma_code /src/xz/src/liblzma/common/common.c:293:17
    #9 0x5569d54c3b32 in fuzz_code /src/xz/tests/ossfuzz/./fuzz_common.h:63:18
    #10 0x5569d54c3b32 in LLVMFuzzerTestOneInput /src/xz/tests/ossfuzz/fuzz_encode_stream.c:81:2
    #11 0x5569d53782e0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #12 0x5569d5363555 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #13 0x5569d5368fef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #14 0x5569d5394292 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #15 0x7f788637c082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)

DEDUP_TOKEN: __interceptor_malloc--create_tree--create_tree
SUMMARY: AddressSanitizer: 1458 byte(s) leaked in 34 allocation(s).

INFO: a leak has been found in the initial corpus.

INFO: to ignore leaks on libFuzzer side use -detect_leaks=0.

MS: 0 ; base unit: 0000000000000000000000000000000000000000
subprocess command returned a non-zero exit status: 77
