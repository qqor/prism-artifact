diff --git a/libfreerdp/codec/rfx.c b/libfreerdp/codec/rfx.c
index 3b9168ab6..29a94aa7e 100644
--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -707,9 +707,9 @@ static INLINE BOOL rfx_process_message_frame_end(RFX_CONTEXT* WINPR_RESTRICT con
 }
 
 static INLINE BOOL rfx_process_message_metadata(RFX_CONTEXT* WINPR_RESTRICT context,
-												RFX_MESSAGE* WINPR_RESTRICT message,
-												wStream* WINPR_RESTRICT s,
-												UINT16* WINPR_RESTRICT pExpectedBlockType)
+                                                RFX_MESSAGE* WINPR_RESTRICT message,
+                                                wStream* WINPR_RESTRICT s,
+                                                UINT16* WINPR_RESTRICT pExpectedBlockType)
 {
 	UINT32 magic = 0;
 
@@ -731,7 +731,21 @@ static INLINE BOOL rfx_process_message_metadata(RFX_CONTEXT* WINPR_RESTRICT cont
 		WLog_Print(context->priv->log, WLOG_ERROR, "invalid magic number 0x%08" PRIX32 "", magic);
 		return FALSE;
 	}
-	*(UINT64*)metadataBlock = metadataData;
+
+	/* Patch 5: manually split copy to avoid any overflow */
+	{
+		UINT8* dest = metadataBlock;
+		const UINT8* src = (const UINT8*)&metadataData;
+		for (size_t i = 0; i < sizeof(metadataData); i++)
+		{
+			if (i >= sizeof(metadataBlock))
+			{
+				WLog_Print(context->priv->log, WLOG_ERROR, "metadata copy out-of-bounds at %zu", i);
+				return FALSE;
+			}
+			dest[i] = src[i];
+		}
+	}
 	return TRUE;
 }
 
