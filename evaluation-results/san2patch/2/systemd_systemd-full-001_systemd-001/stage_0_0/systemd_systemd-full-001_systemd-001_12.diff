diff --git a/src/udev/udev-rules.c b/src/udev/udev-rules.c
index 9f9a970a6c..2877133021 100644
--- a/src/udev/udev-rules.c
+++ b/src/udev/udev-rules.c
@@ -503,7 +503,8 @@ static int rule_line_add_token(UdevRuleLine *rule_line, UdevRuleTokenType type,
         assert(type >= 0 && type < _TK_TYPE_MAX);
         assert(op >= 0 && op < _OP_TYPE_MAX);
 
-        if (type < _TK_M_MAX) {
+        /* Rationale: Retain original buffer but guard the second write with a bounds check using known string length. */
+if (type < _TK_M_MAX) {
                 assert(value);
                 assert(IN_SET(op, OP_MATCH, OP_NOMATCH));
 
@@ -514,7 +515,7 @@ static int rule_line_add_token(UdevRuleLine *rule_line, UdevRuleTokenType type,
                 else if (streq(value, "?*")) {
                         /* Convert KEY=="?*" -> KEY!="" */
                         match_type = MATCH_TYPE_EMPTY;
-                        op = op == OP_MATCH ? OP_NOMATCH : OP_MATCH;
+                         op = op == OP_MATCH ? OP_NOMATCH : OP_MATCH;
                 } else if (string_is_glob(value))
                         match_type = MATCH_TYPE_GLOB;
                 else
@@ -522,6 +523,7 @@ static int rule_line_add_token(UdevRuleLine *rule_line, UdevRuleTokenType type,
 
                 if (type_has_nulstr_value(type)) {
                         /* Convert value string to nulstr. */
+                        size_t orig_len = strlen(value);
                         bool bar = true, empty = false;
                         char *a, *b;
 
@@ -539,8 +541,8 @@ static int rule_line_add_token(UdevRuleLine *rule_line, UdevRuleTokenType type,
                         }
                         *b = '\0';
 
-                        /* Make sure the value is end, so NULSTR_FOREACH can read correct match */
-                        if (b < a)
+                        /* Guard second byte write with a bounds check */
+                        if (b < a && (size_t)(b - value) + 1 < orig_len + 1)
                                 b[1] = '\0';
 
                         if (bar)
