diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..3ac150f 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -759,6 +759,8 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
     cmsStage* mpe;
         
     mpe = Pipeline->Elements;
+    /* Guard against NULL stage list */
+    if (mpe == NULL) return 0;
 
     switch (cmsStageInputChannels(mpe)) {
     case 3:
@@ -790,7 +792,9 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
         _cmsIOPrintf(m, "]\n");
 
         mpe = mpe ->Next;
-    }
+    /* Ensure we didnâ€™t advance to NULL */
+        if (mpe == NULL) return 0;
+     }
 
     if (cmsStageType(mpe) == cmsSigCLutElemType) {
 
