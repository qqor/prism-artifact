diff --git a/src/json.c b/src/json.c
index 2a91900..697154a 100644
--- a/src/json.c
+++ b/src/json.c
@@ -264,11 +264,15 @@ json_value * json_parse_ex (json_settings * settings,
    state.uint_max -= 8; /* limit of how much can be added before next check */
    state.ulong_max -= 8;
 
+   /* boundary-check each advance when parsing Unicode escapes */
    for (state.first_pass = 1; state.first_pass >= 0; -- state.first_pass)
    {
+      /* check next 4 increments one by one */
+      for (int i = 1; i <= 4; ++i) {
+         if (state.ptr + i >= end) goto error;
+      }
       json_uchar uchar;
-      unsigned char uc_b1, uc_b2, uc_b3, uc_b4;
-      json_char * string = 0;
+      unsigned char uc_b1, uc_b2, uc_b3, uc_b4;      json_char * string = 0;
       unsigned int string_length = 0;
 
       top = root = 0;
