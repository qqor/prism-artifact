diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..86638fe2a 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1065,24 +1065,25 @@ static int addbyter(unsigned char outc, void *f)
 int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
                     va_list ap_save)
 {
+  /* Rationale: Calculate a safe termination index and clamp return code when overflow occurred */
   int retcode;
   struct nsprintf info;
 
   info.buffer = buffer;
   info.length = 0;
-  info.max = maxlength;
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   info.max = maxlength;
 
   retcode = formatf(&info, addbyter, format, ap_save);
   if(info.max) {
     /* we terminate this with a zero byte */
-    if(info.max == info.length) {
-      /* we are at maximum, scrap the last letter */
-      info.buffer[-1] = 0;
+    size_t term = info.length < info.max ? info.length : info.max - 1;
+    info.buffer[term] = 0;
+    if(info.length >= info.max) {
       DEBUGASSERT(retcode);
-      retcode--; /* do not count the nul byte */
+      /* do not count the nul byte and clamp to max-1 */
+      retcode = (int)(info.max - 1);
     }
-    else
-      info.buffer[0] = 0;
   }
   return retcode;
 }
