diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..94248af56 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1053,13 +1053,17 @@ number:
 static int addbyter(unsigned char outc, void *f)
 {
   struct nsprintf *infop = f;
-  if(infop->length < infop->max) {
-    /* only do this if we have not reached max length yet */
-    *infop->buffer++ = (char)outc; /* store */
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   /* write by index, keep buffer pointer constant */
+   if(infop->length < infop->max - 1) {
+    infop->buffer[infop->length] = (char)outc; /* store */
     infop->length++; /* we are now one byte larger */
     return 0;     /* fputc() returns like this on success */
   }
-  return 1;
+   /* ensure explicit null-termination at end */
+   if(infop->max > 0)
+    infop->buffer[infop->max - 1] = '\0';
+   return 1;
 }
 
 int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
@@ -1090,10 +1094,18 @@ int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
 int curl_msnprintf(char *buffer, size_t maxlength, const char *format, ...)
 {
   int retcode;
-  va_list ap_save; /* argument pointer */
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   va_list ap_save; /* argument pointer */
   va_start(ap_save, format);
   retcode = curl_mvsnprintf(buffer, maxlength, format, ap_save);
   va_end(ap_save);
+  /* clamp termination at actual length or buffer end */
+  {
+    size_t len = retcode > 0 ? (size_t)retcode : 0;
+    if(len >= maxlength)
+      len = maxlength - 1;
+    buffer[len] = '\0';
+  }
   return retcode;
 }
 
@@ -1102,8 +1114,7 @@ static int alloc_addbyter(unsigned char outc, void *f)
 {
   struct asprintf *infop = f;
   CURLcode result = Curl_dyn_addn(infop->b, &outc, 1);
-  if(result) {
-    infop->merr = result == CURLE_TOO_LARGE ? MERR_TOO_LARGE : MERR_MEM;
+  if(result) {    infop->merr = result == CURLE_TOO_LARGE ? MERR_TOO_LARGE : MERR_MEM;
     return 1 ; /* fail */
   }
   return 0;
