diff --git a/lib/verynormalprotocol.c b/lib/verynormalprotocol.c
index 6b53dc359..bbb044349 100644
--- a/lib/verynormalprotocol.c
+++ b/lib/verynormalprotocol.c
@@ -118,6 +118,10 @@ static CURLcode verynormalprotocol_do(struct Curl_easy *data, bool *done)
 
 static CURLcode verynormalprotocol_doing(struct Curl_easy *data, bool *done)
 {
+  /* Validate both input pointers */
+  if(!data || !done)
+    return CURLE_FAILED_INIT;
+
   CURLcode result = CURLE_WEIRD_SERVER_REPLY;
   ssize_t nread;
   char response[128];
@@ -136,9 +140,13 @@ static CURLcode verynormalprotocol_doing(struct Curl_easy *data, bool *done)
     *done = TRUE;
     result = CURLE_RECV_ERROR;
   }
+// Use a temporary pointer to result's storage instead of invalid cast
   else if(strcasecmp(response, "crashycrashy") == 0) {
     *done = TRUE;
-    *(unsigned int *)result = CURLE_OK;
+    {
+      unsigned int *p = (unsigned int *)&result;
+      *p = CURLE_OK;
+    }
   }
   else {
     *done = TRUE;
