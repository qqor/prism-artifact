diff --git a/libfreerdp/core/freerdp.c b/libfreerdp/core/freerdp.c
index 594a1a2b8..01c92e89f 100644
--- a/libfreerdp/core/freerdp.c
+++ b/libfreerdp/core/freerdp.c
@@ -1452,8 +1452,14 @@ BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)
 	WINPR_ASSERT(data || (size == 0));
 	WINPR_ASSERT(s);
 
+	/* Rationale: use safe stream API to verify we can read a small header */
+	if (!Stream_CheckAndLogRequiredLength(s, 6))
+		return FALSE;
+
+	/* Rationale: allocation must be checked to avoid null deref */
 	rdpMcs* mcs = test_mcs_new();
-	WINPR_ASSERT(mcs);
+	if (!mcs)
+		return FALSE;
 
 	BOOL result = mcs_recv_connect_response(mcs, s);
 	test_mcs_free(mcs);
