diff --git a/libfreerdp/core/mcs.c b/libfreerdp/core/mcs.c
index 6f3dbe199..488faece4 100644
--- a/libfreerdp/core/mcs.c
+++ b/libfreerdp/core/mcs.c
@@ -195,96 +195,56 @@ const char* mcs_domain_pdu_string(DomainMCSPDU pdu)
 {
 	switch (pdu)
 	{
-		case DomainMCSPDU_PlumbDomainIndication:
-			return "DomainMCSPDU_PlumbDomainIndication";
-		case DomainMCSPDU_ErectDomainRequest:
-			return "DomainMCSPDU_ErectDomainRequest";
-		case DomainMCSPDU_MergeChannelsRequest:
-			return "DomainMCSPDU_MergeChannelsRequest";
-		case DomainMCSPDU_MergeChannelsConfirm:
-			return "DomainMCSPDU_MergeChannelsConfirm";
-		case DomainMCSPDU_PurgeChannelsIndication:
-			return "DomainMCSPDU_PurgeChannelsIndication";
-		case DomainMCSPDU_MergeTokensRequest:
-			return "DomainMCSPDU_MergeTokensRequest";
-		case DomainMCSPDU_MergeTokensConfirm:
-			return "DomainMCSPDU_MergeTokensConfirm";
-		case DomainMCSPDU_PurgeTokensIndication:
-			return "DomainMCSPDU_PurgeTokensIndication";
-		case DomainMCSPDU_DisconnectProviderUltimatum:
-			return "DomainMCSPDU_DisconnectProviderUltimatum";
-		case DomainMCSPDU_RejectMCSPDUUltimatum:
-			return "DomainMCSPDU_RejectMCSPDUUltimatum";
-		case DomainMCSPDU_AttachUserRequest:
-			return "DomainMCSPDU_AttachUserRequest";
-		case DomainMCSPDU_AttachUserConfirm:
-			return "DomainMCSPDU_AttachUserConfirm";
-		case DomainMCSPDU_DetachUserRequest:
-			return "DomainMCSPDU_DetachUserRequest";
-		case DomainMCSPDU_DetachUserIndication:
-			return "DomainMCSPDU_DetachUserIndication";
-		case DomainMCSPDU_ChannelJoinRequest:
-			return "DomainMCSPDU_ChannelJoinRequest";
-		case DomainMCSPDU_ChannelJoinConfirm:
-			return "DomainMCSPDU_ChannelJoinConfirm";
-		case DomainMCSPDU_ChannelLeaveRequest:
-			return "DomainMCSPDU_ChannelLeaveRequest";
-		case DomainMCSPDU_ChannelConveneRequest:
-			return "DomainMCSPDU_ChannelConveneRequest";
-		case DomainMCSPDU_ChannelConveneConfirm:
-			return "DomainMCSPDU_ChannelConveneConfirm";
-		case DomainMCSPDU_ChannelDisbandRequest:
-			return "DomainMCSPDU_ChannelDisbandRequest";
-		case DomainMCSPDU_ChannelDisbandIndication:
-			return "DomainMCSPDU_ChannelDisbandIndication";
-		case DomainMCSPDU_ChannelAdmitRequest:
-			return "DomainMCSPDU_ChannelAdmitRequest";
-		case DomainMCSPDU_ChannelAdmitIndication:
-			return "DomainMCSPDU_ChannelAdmitIndication";
-		case DomainMCSPDU_ChannelExpelRequest:
-			return "DomainMCSPDU_ChannelExpelRequest";
-		case DomainMCSPDU_ChannelExpelIndication:
-			return "DomainMCSPDU_ChannelExpelIndication";
-		case DomainMCSPDU_SendDataRequest:
-			return "DomainMCSPDU_SendDataRequest";
-		case DomainMCSPDU_SendDataIndication:
-			return "DomainMCSPDU_SendDataIndication";
-		case DomainMCSPDU_UniformSendDataRequest:
-			return "DomainMCSPDU_UniformSendDataRequest";
-		case DomainMCSPDU_UniformSendDataIndication:
-			return "DomainMCSPDU_UniformSendDataIndication";
-		case DomainMCSPDU_TokenGrabRequest:
-			return "DomainMCSPDU_TokenGrabRequest";
-		case DomainMCSPDU_TokenGrabConfirm:
-			return "DomainMCSPDU_TokenGrabConfirm";
-		case DomainMCSPDU_TokenInhibitRequest:
-			return "DomainMCSPDU_TokenInhibitRequest";
-		case DomainMCSPDU_TokenInhibitConfirm:
-			return "DomainMCSPDU_TokenInhibitConfirm";
-		case DomainMCSPDU_TokenGiveRequest:
-			return "DomainMCSPDU_TokenGiveRequest";
-		case DomainMCSPDU_TokenGiveIndication:
-			return "DomainMCSPDU_TokenGiveIndication";
-		case DomainMCSPDU_TokenGiveResponse:
-			return "DomainMCSPDU_TokenGiveResponse";
-		case DomainMCSPDU_TokenGiveConfirm:
-			return "DomainMCSPDU_TokenGiveConfirm";
-		case DomainMCSPDU_TokenPleaseRequest:
-			return "DomainMCSPDU_TokenPleaseRequest";
-		case DomainMCSPDU_TokenPleaseConfirm:
-			return "DomainMCSPDU_TokenPleaseConfirm";
-		case DomainMCSPDU_TokenReleaseRequest:
-			return "DomainMCSPDU_TokenReleaseRequest";
-		case DomainMCSPDU_TokenReleaseConfirm:
-			return "DomainMCSPDU_TokenReleaseConfirm";
-		case DomainMCSPDU_TokenTestRequest:
-			return "DomainMCSPDU_TokenTestRequest";
-		case DomainMCSPDU_TokenTestConfirm:
-			return "DomainMCSPDU_TokenTestConfirm";
-		case DomainMCSPDU_enum_length:
-			return "DomainMCSPDU_enum_length";
-		default:
-			return "DomainMCSPDU_UNKNOWN";
+		/* table-based lookup for safety */
+		static const char* pduNames[] = {
+			"DomainMCSPDU_PlumbDomainIndication",
+			"DomainMCSPDU_ErectDomainRequest",
+			"DomainMCSPDU_MergeChannelsRequest",
+			"DomainMCSPDU_MergeChannelsConfirm",
+			"DomainMCSPDU_PurgeChannelsIndication",
+			"DomainMCSPDU_MergeTokensRequest",
+			"DomainMCSPDU_MergeTokensConfirm",
+			"DomainMCSPDU_PurgeTokensIndication",
+			"DomainMCSPDU_DisconnectProviderUltimatum",
+			"DomainMCSPDU_RejectMCSPDUUltimatum",
+			"DomainMCSPDU_AttachUserRequest",
+			"DomainMCSPDU_AttachUserConfirm",
+			"DomainMCSPDU_DetachUserRequest",
+			"DomainMCSPDU_DetachUserIndication",
+			"DomainMCSPDU_ChannelJoinRequest",
+			"DomainMCSPDU_ChannelJoinConfirm",
+			"DomainMCSPDU_ChannelLeaveRequest",
+			"DomainMCSPDU_ChannelConveneRequest",
+			"DomainMCSPDU_ChannelConveneConfirm",
+			"DomainMCSPDU_ChannelDisbandRequest",
+			"DomainMCSPDU_ChannelDisbandIndication",
+			"DomainMCSPDU_ChannelAdmitRequest",
+			"DomainMCSPDU_ChannelAdmitIndication",
+			"DomainMCSPDU_ChannelExpelRequest",
+			"DomainMCSPDU_ChannelExpelIndication",
+			"DomainMCSPDU_SendDataRequest",
+			"DomainMCSPDU_SendDataIndication",
+			"DomainMCSPDU_UniformSendDataRequest",
+			"DomainMCSPDU_UniformSendDataIndication",
+			"DomainMCSPDU_TokenGrabRequest",
+			"DomainMCSPDU_TokenGrabConfirm",
+			"DomainMCSPDU_TokenInhibitRequest",
+			"DomainMCSPDU_TokenInhibitConfirm",
+			"DomainMCSPDU_TokenGiveRequest",
+			"DomainMCSPDU_TokenGiveIndication",
+			"DomainMCSPDU_TokenGiveResponse",
+			"DomainMCSPDU_TokenGiveConfirm",
+			"DomainMCSPDU_TokenPleaseRequest",
+			"DomainMCSPDU_TokenPleaseConfirm",
+			"DomainMCSPDU_TokenReleaseRequest",
+			"DomainMCSPDU_TokenReleaseConfirm",
+			"DomainMCSPDU_TokenTestRequest",
+			"DomainMCSPDU_TokenTestConfirm",
+			"DomainMCSPDU_enum_length"
+		};
+		if ((int)pdu >= 0 && (int)pdu < (int)DomainMCSPDU_enum_length)
+			return pduNames[pdu];
+		return "DomainMCSPDU_UNKNOWN";
 	}
 }
 
