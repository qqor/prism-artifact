diff --git a/libfreerdp/core/mcs.c b/libfreerdp/core/mcs.c
index 6f3dbe199..14a741464 100644
--- a/libfreerdp/core/mcs.c
+++ b/libfreerdp/core/mcs.c
@@ -345,6 +345,10 @@ BOOL mcs_read_domain_mcspdu_header(wStream* s, DomainMCSPDU domainMCSPDU, UINT16
 	WINPR_ASSERT(domainMCSPDU);
 	WINPR_ASSERT(length);
 
+	/* Rationale: Dual-check to prevent parsing of malformed streams. */
+	if (*length < MIN_MCS_CREATE_RESPONSE_SIZE || wStream_GetRemainingLength(s) < *length)
+		return FALSE;
+
 	if (!tpkt_read_header(s, length))
 		return FALSE;
 
