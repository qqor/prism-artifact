diff --git a/HTMLparser.c b/HTMLparser.c
index 9c34e9e8..42b771fd 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -2612,6 +2612,7 @@ htmlParseData(htmlParserCtxtPtr ctxt, htmlAsciiMask mask,
     used = 0;
     buffer_size = ctxt->spaceMax;
     buffer = (xmlChar *) ctxt->spaceTab;
+    // FIXME: Crash CWE-787: Out-of-bounds Write
     if (buffer == NULL) {
         buffer_size = 500;
         buffer = xmlMalloc(buffer_size + 1);
@@ -2620,12 +2621,27 @@ htmlParseData(htmlParserCtxtPtr ctxt, htmlAsciiMask mask,
             return(NULL);
         }
     }
+    // Incremental growth by fixed block size to limit realloc overhead
 
     line = input->line;
     col = input->col;
 
     while (!PARSER_STOPPED(ctxt)) {
-        const xmlChar *chunk, *in, *repl;
+        // Grow by one block if needed
+        if (used + chunkSize + 1 > buffer_size) {
+            size_t block = ctxt->spaceMax;
+            size_t new_size = buffer_size + block;
+            if (new_size < used + chunkSize + 1)
+                new_size = used + chunkSize;
+            xmlChar *tmp = (xmlChar *)xmlRealloc(buffer, new_size + 1);
+            if (tmp == NULL) {
+                htmlErrMemory(ctxt);
+                xmlFree(buffer);
+                return(NULL);
+            }
+            buffer = tmp;
+            buffer_size = new_size;
+        }        const xmlChar *chunk, *in, *repl;
         size_t avail, chunkSize, extraSize;
         int replSize;
         int skip = 0;
@@ -2837,15 +2853,15 @@ next_chunk:
             size_t newSize = (used + extraSize) * 2;
             xmlChar *tmp = (xmlChar *) xmlRealloc(buffer, newSize + 1);
 
-            if (tmp == NULL) {
-                htmlErrMemory(ctxt);
-                goto error;
-            }
-            buffer = tmp;
-            buffer_size = newSize;
         }
 
+        // FIXME: Crash CWE-787: Out-of-bounds Write
         if (chunkSize > 0) {
+            /* abort on overflow instead of allowing OOB */
+            if (chunkSize > buffer_size - used) {
+                htmlErrMemory(ctxt);
+                goto error;
+            }
             input->cur += chunkSize;
             memcpy(buffer + used, chunk, chunkSize);
             used += chunkSize;
@@ -2853,6 +2869,10 @@ next_chunk:
 
         input->cur += skip;
         if (replSize > 0) {
+            if (replSize > buffer_size - used) {
+                htmlErrMemory(ctxt);
+                goto error;
+            }
             memcpy(buffer + used, repl, replSize);
             used += replSize;
         }
@@ -3330,6 +3350,7 @@ htmlSecureComment(htmlParserCtxtPtr ctxt, htmlAsciiMask mask,
     used = 0;
     buffer_size = ctxt->spaceMax;
     buffer = (xmlChar *) ctxt->spaceTab;
+    // FIXME: Crash CWE-787: Out-of-bounds Write
     if (buffer == NULL) {
         buffer_size = 500;
         buffer = xmlMalloc(buffer_size + 1);
@@ -3338,12 +3359,27 @@ htmlSecureComment(htmlParserCtxtPtr ctxt, htmlAsciiMask mask,
             return(NULL);
         }
     }
+    // Incremental growth by fixed block size to limit realloc overhead
 
     line = input->line;
     col = input->col;
 
     while (!PARSER_STOPPED(ctxt)) {
-        const xmlChar *chunk, *in, *repl;
+        // Grow by one block if needed
+        if (used + chunkSize + 1 > buffer_size) {
+            size_t block = ctxt->spaceMax;
+            size_t new_size = buffer_size + block;
+            if (new_size < used + chunkSize + 1)
+                new_size = used + chunkSize;
+            xmlChar *tmp = (xmlChar *)xmlRealloc(buffer, new_size + 1);
+            if (tmp == NULL) {
+                htmlErrMemory(ctxt);
+                xmlFree(buffer);
+                return(NULL);
+            }
+            buffer = tmp;
+            buffer_size = new_size;
+        }        const xmlChar *chunk, *in, *repl;
         size_t avail, chunkSize, extraSize;
         int replSize;
         int skip = 0;
@@ -3578,15 +3614,15 @@ next_chunk:
             size_t newSize = (used + extraSize) * 2;
             xmlChar *tmp = (xmlChar *) xmlRealloc(buffer, newSize + 1);
 
-            if (tmp == NULL) {
-                htmlErrMemory(ctxt);
-                goto error;
-            }
-            buffer = tmp;
-            buffer_size = newSize;
         }
 
+        // FIXME: Crash CWE-787: Out-of-bounds Write
         if (chunkSize > 0) {
+            /* abort on overflow instead of allowing OOB */
+            if (chunkSize > buffer_size - used) {
+                htmlErrMemory(ctxt);
+                goto error;
+            }
             input->cur += chunkSize;
             memcpy(buffer + used, chunk, chunkSize);
             used += chunkSize;
@@ -3594,6 +3630,10 @@ next_chunk:
 
         input->cur += skip;
         if (replSize > 0) {
+            if (replSize > buffer_size - used) {
+                htmlErrMemory(ctxt);
+                goto error;
+            }
             memcpy(buffer + used, repl, replSize);
             used += replSize;
         }
