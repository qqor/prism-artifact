diff --git a/HTMLparser.c b/HTMLparser.c
index 9c34e9e8..b4be9bb6 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -3695,9 +3695,10 @@ htmlTopParseComment(htmlParserCtxtPtr ctxt, int bogus) {
         if (CUR == '>') {
             SKIP(1);
         } else if ((CUR == '-') && (NXT(1) == '>')) {
-            SKIP(2);
+             SKIP(2);
         } else {
-            buf = htmlSecureComment(ctxt, MASK_DASH, 0, maxLength);
+            /* Use htmlParseData instead of htmlSecureComment to prevent overflow */
+            buf = htmlParseData(ctxt, MASK_DASH, 0, 0, maxLength);
             comment = buf;
         }
     }
