diff --git a/libexif/exif-data.c b/libexif/exif-data.c
index f3f6dbc..e202de6 100644
--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -162,15 +162,26 @@ exif_data_new_from_data (const unsigned char *data, unsigned int size)
 
 static int
 exif_data_load_data_entry (ExifData *data, ExifEntry *entry,
-			   const unsigned char *d,
-			   unsigned int size, unsigned int offset)
+		   const unsigned char *d,
+		   unsigned int size, unsigned int offset)
 {
 	unsigned int s, doff;
+	size_t fmt_size, total;
 
 	entry->tag        = exif_get_short (d + offset + 0, data->priv->order);
 	entry->format     = exif_get_short (d + offset + 2, data->priv->order);
 	entry->components = exif_get_long  (d + offset + 4, data->priv->order);
 
+	/* Compute total size in size_t to detect overflow */
+	fmt_size = exif_format_get_size(entry->format);
+	total = fmt_size * (size_t)entry->components;
+	/* Check multiplication overflow and zero */
+	if (entry->components != 0 && total / entry->components != fmt_size)
+		return 0;
+	if (total == 0 || total > UINT_MAX)
+		return 0;
+	s = (unsigned int) total;
+
 	/* FIXME: should use exif_tag_get_name_in_ifd here but entry->parent 
 	 * has not been set yet
 	 */
@@ -180,7 +191,6 @@ exif_data_load_data_entry (ExifData *data, ExifEntry *entry,
 
 	/* {0,1,2,4,8} x { 0x00000000 .. 0xffffffff } 
 	 *   -> { 0x000000000 .. 0x7fffffff8 } */
-	s = exif_format_get_size(entry->format) * entry->components;
 	if ((s < entry->components) || (s == 0)){
 		return 0;
 	}
@@ -197,19 +207,20 @@ exif_data_load_data_entry (ExifData *data, ExifEntry *entry,
 	/* Sanity checks */
 	if (doff >= size) {
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-				  "Tag starts past end of buffer (%u > %u)", doff, size);
+			  "Tag starts past end of buffer (%u > %u)", doff, size);
 		return 0;
 	}
 
 	if (s > size - doff) {
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-				  "Tag data goes past end of buffer (%u > %u)", doff+s, size);
+			  "Tag data goes past end of buffer (%u > %u)", doff+s, size);
 		return 0;
 	}
 
 	entry->data = exif_data_alloc (data, s);
 	if (entry->data) {
 		entry->size = s;
+		/* Copy now that sizes are validated and overflow-checked */
 		memcpy (entry->data, d + doff, s);
 	} else {
 		EXIF_LOG_NO_MEMORY(data->priv->log, "ExifData", s);
@@ -220,15 +231,15 @@ exif_data_load_data_entry (ExifData *data, ExifEntry *entry,
 	if (entry->tag == EXIF_TAG_MAKER_NOTE) {
 		if (!entry->data) {
 			exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-					  "MakerNote found with empty data");	
+			  "MakerNote found with empty data");	
 		} else if (entry->size > 6) {
 			exif_log (data->priv->log,
-					       EXIF_LOG_CODE_DEBUG, "ExifData",
-					       "MakerNote found (%02x %02x %02x %02x "
-					       "%02x %02x %02x...).",
-					       entry->data[0], entry->data[1], entry->data[2],
-					       entry->data[3], entry->data[4], entry->data[5],
-					       entry->data[6]);
+			       EXIF_LOG_CODE_DEBUG, "ExifData",
+			       "MakerNote found (%02x %02x %02x %02x "
+			       "%02x %02x %02x...).",
+			       entry->data[0], entry->data[1], entry->data[2],
+			       entry->data[3], entry->data[4], entry->data[5],
+			       entry->data[6]);
 		}
 		data->priv->offset_mnote = doff;
 	}
