diff --git a/src/udev/udev-rules.c b/src/udev/udev-rules.c
index 9f9a970a6c..038c2be7e5 100644
--- a/src/udev/udev-rules.c
+++ b/src/udev/udev-rules.c
@@ -152,7 +152,6 @@ typedef enum {
         LINE_UPDATE_SOMETHING = 1 << 5, /* has other TK_A_* or TK_M_IMPORT tokens */
         LINE_IS_REFERENCED    = 1 << 6, /* is referenced by GOTO */
 } UdevRuleLineType;
-
 typedef struct UdevRuleFile UdevRuleFile;
 typedef struct UdevRuleLine UdevRuleLine;
 typedef struct UdevRuleToken UdevRuleToken;
@@ -162,10 +161,14 @@ struct UdevRuleToken {
         UdevRuleOperatorType op:8;
         UdevRuleMatchType match_type:8;
         UdevRuleSubstituteType attr_subst_type:8;
-        const char *value;
+        /* union to allow either a pointer or inline buffer for value */
+        union {
+                const char *ptr;
+                char buf[MAX_RULE_VALUE_LEN + 1];
+        } value;
+        size_t value_len;
         void *data;
-
-        UdevRuleLine *rule_line;
+};        UdevRuleLine *rule_line;
         LIST_FIELDS(UdevRuleToken, tokens);
 };
 
