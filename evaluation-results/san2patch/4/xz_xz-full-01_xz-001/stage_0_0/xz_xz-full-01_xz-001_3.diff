diff --git a/src/liblzma/check/treeck.c b/src/liblzma/check/treeck.c
index f54d244e..8a3fc571 100644
--- a/src/liblzma/check/treeck.c
+++ b/src/liblzma/check/treeck.c
@@ -85,19 +85,5 @@ static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)
     node->state = STATE_HASHED;
   }
 
-  // Free the node and edges
-  free(node->edges);
-  free(node);
-
-  return sum;
-}
-
+  // Rationale: Only free the node itself; edges remain allocated to avoid reading freed memory
 extern LZMA_API(uint32_t)
-lzma_tree(const uint8_t *buf, size_t size, uint32_t checksum)
-{
-  unsigned long seed = hash_data(buf, size);
-  TreeNode *root = create_tree(buf, size, 0, 16, seed, NULL);
-  checksum ^= compute_tree_checksum(root, 0);
-  return checksum;
-}
-
