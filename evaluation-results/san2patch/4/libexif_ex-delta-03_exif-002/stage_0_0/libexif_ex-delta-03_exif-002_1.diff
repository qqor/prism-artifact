diff --git a/libexif/exif-data.c b/libexif/exif-data.c
index f3f6dbc..055e4db 100644
--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -537,9 +537,13 @@ exif_data_load_data_content (ExifData *data, ExifIfd ifd,
 	}
 }
 
+// Rationale: Add null-pointer guard to avoid calling exif_get_short on invalid pointers
 static int
 cmp_func (const unsigned char *p1, const unsigned char *p2, ExifByteOrder o)
 {
+	if (p1 == NULL || p2 == NULL)
+		return 0;
+
 	ExifShort tag1 = exif_get_short (p1, o);
 	ExifShort tag2 = exif_get_short (p2, o);
 
@@ -558,7 +562,7 @@ cmp_func_motorola (const void *elem1, const void *elem2)
 {
 	return cmp_func ((const unsigned char *) elem1,
 			 (const unsigned char *) elem2, EXIF_BYTE_ORDER_MOTOROLA);
-}
+}}
 
 static void
 exif_data_save_data_content (ExifData *data, ExifContent *ifd,
