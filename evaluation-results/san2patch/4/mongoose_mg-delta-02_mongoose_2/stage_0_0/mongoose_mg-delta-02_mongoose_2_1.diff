diff --git a/src/net_builtin.c b/src/net_builtin.c
index 793874f4..74a92261 100644
--- a/src/net_builtin.c
+++ b/src/net_builtin.c
@@ -380,8 +380,17 @@ static void rx_arp(struct mg_tcpip_if *ifp, struct pkt *pkt) {
 }
 
 static void rx_icmp(struct mg_tcpip_if *ifp, struct pkt *pkt) {
-  // MG_DEBUG(("ICMP %d", (int) len));
-  if (pkt->icmp->type == 8 && pkt->ip != NULL && pkt->ip->dst == ifp->ip) {
+  // Compute buffer boundary for safety checks
+  uint8_t *buf_start = pkt->pay.buf;
+  uint8_t *buf_end = buf_start + pkt->pay.len;
+  struct icmp *icmp_hdr = pkt->icmp;
+  // Verify ICMP header lies within packet buffer
+  if ((uint8_t *)(icmp_hdr + 1) > buf_end) {
+    return;
+  }
+  // FIXME: Crash CWE-125: Out-of-bounds Read
+   // MG_DEBUG(("ICMP %d", (int) len));
+  if (icmp_hdr->type == 8 && pkt->ip != NULL && pkt->ip->dst == ifp->ip) {
     size_t hlen = sizeof(struct eth) + sizeof(struct ip) + sizeof(struct icmp);
     size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;
     if (plen > space) plen = space;
