diff --git a/epan/dissectors/packet-netbios.c b/epan/dissectors/packet-netbios.c
index 9d55d615db..45cedab4d5 100644
--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1205,20 +1205,35 @@ dissect_netbios(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data
 
 		proto_tree_add_uint(netb_tree, hf_netb_cmd, tvb, offset + NB_COMMAND, 1, command);
 	}
-
-					/* if command in table range */
+	// FIXME: Crash CWE-787: Out-of-bounds Write
+	
+			/* if command in table range */
 	if ( command < array_length(dissect_netb)) {
 
-					/* branch to handle commands */
+			/* branch to handle commands */
 		session_id = (dissect_netb[ command])( tvb, pinfo, offset, netb_tree);
 
-		offset += hdr_len;			/* move past header */
+		offset += hdr_len;            /* move past header */
 
 		save_fragmented = pinfo->fragmented;
 
 		/*
 		 * Process user data in frames that have it.
 		 */
+		if (command == CMD_TERMINATE_TRACE) {
+			/* read the NetBIOS name length */
+			guint8 name_len = tvb_get_guint8(tvb, offset);
+			/* guard against unreasonable length */
+			if (name_len > MAX_NETB_NAME_LEN) {
+				name_len = MAX_NETB_NAME_LEN;
+			}
+			char *buf = g_malloc(name_len + 1);
+			tvb_memcpy(tvb, offset + 1, buf, name_len);
+			buf[name_len] = '\0';
+			/* ... use buf ... */
+			g_free(buf);
+		}
+		 */
 		switch (command) {
 
 		case NB_DATAGRAM:
