diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..422d344 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -1533,7 +1533,8 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
 
 
     switch (Type) {
-
+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions
+ 
         case cmsPS_RESOURCE_CSA:
             rc = GenerateCSA(ContextID, hProfile, Intent, dwFlags, io);
             break;
@@ -1544,6 +1545,12 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
             break;
     }
 
+    /* On failure, close handler and abort */
+    if (rc == 0) {
+        if (io && io->Close) io->Close(io);
+        return 0;
+    }
+
     return rc;
 }
 
@@ -1595,9 +1602,12 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptCSA(cmsContext ContextID,
 
     dwBytesUsed =  cmsGetPostScriptColorResource(ContextID, cmsPS_RESOURCE_CSA, hProfile, Intent, dwFlags, mem);
 
-    // Get rid of memory stream
+    // Close IO handler first
     cmsCloseIOhandler(mem);
 
-    return dwBytesUsed;
+    // Check if generation succeeded
+    if (dwBytesUsed == 0)
+        return 0;
 
+    return dwBytesUsed;
 }
