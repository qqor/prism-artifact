diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..d030a0a 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -1533,7 +1533,8 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
 
 
     switch (Type) {
-
+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions
+ 
         case cmsPS_RESOURCE_CSA:
             rc = GenerateCSA(ContextID, hProfile, Intent, dwFlags, io);
             break;
@@ -1544,6 +1545,11 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
             break;
     }
 
+    /* Ensure we do not return an empty resource */
+    if (rc == 0) {
+        return 0;
+    }
+
     return rc;
 }
 
@@ -1591,13 +1597,19 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptCSA(cmsContext ContextID,
     else
         mem = cmsOpenIOhandlerFromMem(ContextID, Buffer, dwBufferLen, "w");
 
+    // Check if IO handler was created successfully
     if (!mem) return 0;
 
     dwBytesUsed =  cmsGetPostScriptColorResource(ContextID, cmsPS_RESOURCE_CSA, hProfile, Intent, dwFlags, mem);
 
+    // If no bytes were written, abort and clean up
+    if (dwBytesUsed == 0) {
+        cmsCloseIOhandler(mem);
+        return 0;
+    }
+
     // Get rid of memory stream
     cmsCloseIOhandler(mem);
 
     return dwBytesUsed;
-
 }
