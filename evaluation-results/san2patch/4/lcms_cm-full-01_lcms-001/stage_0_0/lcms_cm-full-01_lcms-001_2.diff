diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..1c0d7ff 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -1533,7 +1533,8 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
 
 
     switch (Type) {
-
+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions
+ 
         case cmsPS_RESOURCE_CSA:
             rc = GenerateCSA(ContextID, hProfile, Intent, dwFlags, io);
             break;
@@ -1544,6 +1545,12 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptColorResource(cmsContext ContextID,
             break;
     }
 
+    /* Guard against invalid or empty resource buffers */
+    if (rc == 0) {
+        io->Close(io);
+        return 0;
+    }
+
     return rc;
 }
 
@@ -1583,21 +1590,25 @@ cmsUInt32Number CMSEXPORT cmsGetPostScriptCSA(cmsContext ContextID,
                                               void* Buffer,
                                               cmsUInt32Number dwBufferLen)
 {
-    cmsIOHANDLER* mem;
-    cmsUInt32Number dwBytesUsed;
+    cmsIOHANDLER* mem = NULL;
+    cmsUInt32Number dwBytesUsed = 0;
 
     if (Buffer == NULL)
         mem = cmsOpenIOhandlerFromNULL(ContextID);
     else
         mem = cmsOpenIOhandlerFromMem(ContextID, Buffer, dwBufferLen, "w");
 
-    if (!mem) return 0;
+    if (!mem)
+        goto error;
 
-    dwBytesUsed =  cmsGetPostScriptColorResource(ContextID, cmsPS_RESOURCE_CSA, hProfile, Intent, dwFlags, mem);
+    dwBytesUsed = cmsGetPostScriptColorResource(ContextID, cmsPS_RESOURCE_CSA, hProfile, Intent, dwFlags, mem);
+    if (dwBytesUsed == 0)
+        goto error;
 
-    // Get rid of memory stream
     cmsCloseIOhandler(mem);
-
     return dwBytesUsed;
 
+error:
+    if (mem) cmsCloseIOhandler(mem);
+    return 0;
 }
