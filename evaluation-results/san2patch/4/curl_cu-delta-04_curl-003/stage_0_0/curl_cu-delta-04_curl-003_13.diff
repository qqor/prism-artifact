diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..d6bc6fb40 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -615,8 +615,9 @@ static DOHcode doh_store_cname(const unsigned char *doh, size_t dohlen,
       index++;
 
     if(length) {
-      if(Curl_dyn_len(c)) {
-        if(Curl_dyn_addn(c, STRCONST(".")))
+      size_t dlen = c ? Curl_dyn_len(c) : 0; /* safe check before use */
+      if(dlen) {
+         if(Curl_dyn_addn(c, STRCONST(".")))
           return DOH_OUT_OF_MEM;
       }
       if((index + length) > dohlen)
