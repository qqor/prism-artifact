diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..a574308 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,12 +235,17 @@ exif_mnote_data_apple_get_value(ExifMnoteData *md, unsigned int i, char *val, un
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
-    int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
-        variant = 1;
-    } else {
-        variant = 0;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+     int variant;
+
+    /* C1: length check and memcmp */
+    {
+        size_t want = sizeof("Apple iOS") - 1;
+        if (e->size >= want && memcmp((const char *) e->data, "Apple iOS", want) == 0) {
+            variant = 1;
+        } else {
+            variant = 0;
+        }
     }
 
     return variant;
