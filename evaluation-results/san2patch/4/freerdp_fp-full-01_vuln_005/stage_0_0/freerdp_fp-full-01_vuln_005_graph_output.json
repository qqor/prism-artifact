{"vuln_data": {"id": "freerdp_fp-full-01_vuln_005", "subject": "freerdp", "work_name": "freerdp", "project_name": "freerdp", "hiding_project_name": "", "project_full_name": "freerdp", "harness_name": "TestFuzzCoreServer", "branch_name": "fp-full-01", "project_repo_name": "official-afc-freerdp"}, "data_type": "oss-fuzz", "patch_success": ["build_failed", "build_failed", "build_failed", "build_failed", "build_failed"], "ret_code": false, "err_msg": "", "genpatch_candidate": [{"fix_strategy": {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "patched_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\t/* Check buffer length before parsing to prevent NULL deref */\n\t/* Minimum MCS Create Response comprises:\n\t   - result (2 bytes)\n\t   - initiator (2 bytes)\n\t   - userCount (2 bytes)\n\t   plus the 2-byte PER header = 8 bytes total */\n\tif (Stream_GetRemainingLength(s) < 8)\n\t\treturn FALSE;\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "func_def": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)", "func_ret": ["return result;"]}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, "patch_result": "build_failed"}, {"fix_strategy": {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "patched_code": "--- a/libfreerdp/core/freerdp.c\n+++ b/libfreerdp/core/freerdp.c\n@@ BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n-\t/* Compute remaining buffer via pointer arithmetic */\n-\tsize_t remain = s->end - s->p;\n-\tif (remain < MIN_MCS_CREATE_RESPONSE_SIZE)\n-\t\treturn FALSE;\n+   /* Ensure we have enough data left for a minimal MCS create response */\n+   if (Stream_GetRemainingLength(s) < MIN_MCS_CREATE_RESPONSE_SIZE)\n+       return FALSE;\n", "func_def": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)", "func_ret": ["return result;"]}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, "patch_result": "build_failed"}, {"fix_strategy": {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "patched_code": "--- a/libfreerdp/core/freerdp.c\n+++ b/libfreerdp/core/freerdp.c\n@@\n+// Provide a default minimal size for MCS create response to avoid undefined identifier\n+#ifndef MIN_MCS_CREATE_RESPONSE_SIZE\n+#define MIN_MCS_CREATE_RESPONSE_SIZE 1\n+#endif\n", "func_def": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)", "func_ret": ["return result;"]}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, "patch_result": "build_failed"}, {"fix_strategy": {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "patched_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tif (!mcs)\n\t\treturn FALSE;\n\n\t/* Ensure stream has enough data before using mcs context */\n\tconst size_t minSize = 4;  /* minimal header length */\n\tif (Stream_GetRemainingLength(s) < minSize)\n\t{\n\t\ttest_mcs_free(mcs);\n\t\treturn FALSE;\n\t}\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "func_def": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)", "func_ret": ["return result;"]}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, "patch_result": "build_failed"}, {"fix_strategy": {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "patched_code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\t/* Validate input and stream initialization */\n\tif ((!data && size != 0) || !s)\n\t\treturn FALSE;\n\n\trdpMcs* mcs = test_mcs_new();\n\tif (!mcs)\n\t\treturn FALSE;\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "func_def": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)", "func_ret": ["return result;"]}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, "patch_result": "build_failed"}], "fix_strategy": {"fix_location": {"locations": [], "rationale": "", "score": 0.0, "confidence": 0.0, "reliability_score": 0.0, "eval_rationale": ""}, "guideline": "", "description": "", "rationale": "", "score": 0.0, "confidence": 0.0, "reliability_score": 0.0, "eval_rationale": ""}, "patch_result": "", "fix_strategy_final": [{"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}], "fix_strategy_candidates": [{"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Validate all external inputs and pointer arguments before dereferencing to prevent NULL pointer dereferences (CWE-476).", "description": "At the start of freerdp_is_valid_mcs_create_response, add a check: if data is NULL while size > 0, or if size is less than the minimum required bytes for an MCS Create Response header (define a constant MIN_MCS_CREATE_RESPONSE_SIZE), immediately return FALSE. This prevents initialization of a stream over invalid or too-small buffers.", "rationale": "By validating data and size at function entry, we prevent creation of a stream over a NULL or undersized buffer, eliminating the root cause of the NULL pointer dereference.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed fix directly addresses the root cause (NULL pointer dereference) by validating the input pointers and buffer size before use. It correctly suggests returning FALSE when data is NULL with a non-zero size or when the buffer is too small, matching the CWE guidelines. The fix location at function entry is plausible, and the use of a MIN_MCS_CREATE_RESPONSE_SIZE constant is appropriately general without hallucinated specifics. This strategy is practical and applicable without being overly detailed, meriting a high score."}, {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Enforce explicit boundary and size checks on parsing routines to ensure buffer length is sufficient before reading or writing (CWE-125).", "description": "After Stream_StaticConstInit(&sbuffer, data, size), call Stream_GetRemainingLength(s) (or use s->end - s->p) to verify that the remaining buffer length is at least MIN_MCS_CREATE_RESPONSE_SIZE. If not, free the rdpMcs context and return FALSE without invoking mcs_recv_connect_response.", "rationale": "Ensuring the stream has enough bytes left before parsing guarantees that downstream calls to mcs_recv_connect_response won\u2019t read or write past the end of the buffer, avoiding both NULL dereferences and buffer overreads.", "score": 9, "confidence": 8, "reliability_score": 16.2, "eval_rationale": "The proposed strategy directly addresses the root cause by adding an explicit size check before parsing, uses the correct stream API (Stream_GetRemainingLength), and handles the error path cleanly by freeing the context and returning FALSE. The fix location is appropriate and the approach aligns with the CWE guidelines. It\u2019s specific enough to be actionable without overcommitting to code that may not exist, making it both practical and robust."}, {"fix_location": {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, "guideline": "Replace assertion-based checks with proper error-handling logic that returns failure on invalid or truncated data instead of crashing (CWE-754).", "description": "Replace WINPR_ASSERT(data || (size == 0)) and WINPR_ASSERT(s) with conditional checks that, on failure, free any allocated state (e.g., rdpMcs) and return FALSE. This ensures that in production builds (where asserts may be disabled) invalid inputs are still handled gracefully.", "rationale": "Using explicit error handling rather than assertions ensures that malformed or truncated PDUs lead to a clean failure return path rather than a crash, preserving stability in release builds.", "score": 7, "confidence": 6, "reliability_score": 11.200000000000001, "eval_rationale": "The proposed strategy correctly identifies the root cause (using assertions that can be disabled) and suggests replacing them with explicit error checks that free allocated resources and return FALSE. This aligns well with the CWE-754 guideline and is applicable at the indicated location. However, the answer remains high-level without concrete code changes, detailed conditions, or handling of all potential null pointer scenarios, which reduces its completeness and preciseness."}], "fix_location": {"locations": [], "rationale": "", "score": 0.0, "confidence": 0.0, "reliability_score": 0.0, "eval_rationale": ""}, "guideline": "", "description": "", "rationale": "", "score": 0.0, "confidence": 0.0, "reliability_score": 0.0, "eval_rationale": "", "fix_location_final": [{"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}], "fix_location_candidates": [{"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}, {"locations": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1455, "end_line": 1465, "function_name": "", "code": "BOOL freerdp_is_valid_mcs_create_response(const BYTE* data, size_t size)\n{\n\n\twStream sbuffer = { 0 };\n\twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n\n\tWINPR_ASSERT(data || (size == 0));\n\tWINPR_ASSERT(s);\n\n\trdpMcs* mcs = test_mcs_new();\n\tWINPR_ASSERT(mcs);\n\n\tBOOL result = mcs_recv_connect_response(mcs, s);\n\ttest_mcs_free(mcs);\n\treturn result;\n}", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "rationale": "The vulnerability occurs in freerdp_is_valid_mcs_create_response at line 1458, where pointers from the input stream are used without validation. By adding boundary and NULL checks around this region, we eliminate the null dereference while preserving normal packet processing.", "score": 7, "confidence": 7, "reliability_score": 11.900000000000002, "eval_rationale": "The selected location covers the exact function where the NULL-deref occurs (freerdp_is_valid_mcs_create_response) and brackets the problematic call to mcs_recv_connect_response. It aligns with the vulnerability\u2019s root cause (missing pointer/length checks before dereference). However, the patch region is somewhat broad (entire function prologue to call) and relies on asserts rather than explicit runtime checks, which may not be active in release builds. A more precise insertion point immediately around the risky accesses and implementation of real guard clauses would strengthen the fix."}], "location_candidates": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1458, "end_line": 1458, "function_name": "freerdp_is_valid_mcs_create_response", "code": "BOOL result = mcs_recv_connect_response(mcs, s);", "original_code": "", "patched_code": "", "func_def": "", "func_ret": [], "type": "crash"}], "vuln_info": {"type": "CWE-476: NULL Pointer Dereference", "root_cause": "CWE-754: Improper Check for Unusual or Exceptional Conditions", "comprehension": "In freerdp/core/freerdp.c, the function freerdp_is_valid_mcs_create_response assumes that the MCS Create Response buffer and its internal pointers are always valid and sufficiently populated. If a malformed or empty response is passed in, the code will attempt to write through a NULL pointer, leading to a crash.", "rationale": "The function fails to check for exceptional conditions (CWE-754) \u2013 namely, that the response data pointer may be NULL or the buffer may be too short \u2013 and then dereferences that NULL pointer (CWE-476), causing a segmentation fault when handling invalid MCS Create Response PDUs."}, "vuln_info_candidates": [{"type": "CWE-476: NULL Pointer Dereference", "root_cause": "CWE-754: Improper Check for Unusual or Exceptional Conditions", "comprehension": "In freerdp_is_valid_mcs_create_response, the code processes a potentially malformed MCS Create Response packet without verifying that required pointers or buffer lengths are non-NULL and sufficient. As a result, it dereferences a NULL pointer when handling unexpected or truncated input, leading to a crash.", "rationale": "AddressSanitizer identifies a write to address 0x0 at freerdp.c:1458 inside freerdp_is_valid_mcs_create_response. The function lacks proper checks for pointer validity and packet length before dereferencing, allowing malformed input to trigger a NULL pointer dereference (CWE-476) due to improper handling of exceptional conditions (CWE-754)."}, {"type": "CWE-476: NULL Pointer Dereference", "root_cause": "CWE-754: Improper Check for Unusual or Exceptional Conditions", "comprehension": "In freerdp_is_valid_mcs_create_response, the code dereferences a pointer returned from the response parsing logic without verifying that it is non-NULL or that the input stream contains the required data. A malformed or truncated MCS Create Response PDU can therefore trigger a write to address 0x0, causing a crash.", "rationale": "The parser function assumes its input buffer and associated pointers are valid and large enough, but fails to check for NULL or insufficient length before accessing fields. This improper handling of exceptional conditions (CWE-754) results in a null pointer dereference vulnerability (CWE-476) when processing unexpected or truncated data."}, {"type": "CWE-476: NULL Pointer Dereference", "root_cause": "CWE-754: Improper Check for Unusual or Exceptional Conditions", "comprehension": "In freerdp/core/freerdp.c, the function freerdp_is_valid_mcs_create_response assumes that the MCS Create Response buffer and its internal pointers are always valid and sufficiently populated. If a malformed or empty response is passed in, the code will attempt to write through a NULL pointer, leading to a crash.", "rationale": "The function fails to check for exceptional conditions (CWE-754) \u2013 namely, that the response data pointer may be NULL or the buffer may be too short \u2013 and then dereferences that NULL pointer (CWE-476), causing a segmentation fault when handling invalid MCS Create Response PDUs."}], "vuln_info_final": {"type": "CWE-476: NULL Pointer Dereference", "root_cause": "CWE-754: Improper Check for Unusual or Exceptional Conditions", "comprehension": "In freerdp/core/freerdp.c, freerdp_is_valid_mcs_create_response assumes the MCS Create Response PDU buffer and its pointers are always present and populated. A malicious or truncated packet can leave these pointers NULL or the data length insufficient. When the function attempts to write through these pointers, it dereferences address 0x0, causing a crash.", "rationale": "The function freerdp_is_valid_mcs_create_response does not verify that the input buffer, its internal pointers, or the packet length are non-NULL and sufficiently large before accessing or writing to them. This lack of validation for malformed or truncated MCS Create Response PDUs (improper handling of exceptional conditions) allows a NULL pointer dereference."}, "crash_stack_trace": [{"file_name": "libfreerdp/core/freerdp.c", "fix_line": 1458, "start_line": 1458, "end_line": 1458, "function_name": "freerdp_is_valid_mcs_create_response", "code": "BOOL result = mcs_recv_connect_response(mcs, s);", "original_code": "", "patched_code": "", "func_def": "", "func_ret": []}], "memory_allocate_stack_trace": [], "memory_free_stack_trace": [], "mode": "test", "diff_stage_dir": "/home/qqor/aixcc/san2patch-private/benchmarks/final/oss-fuzz/gen_diff_aixcc_o4-mini/freerdp_fp-full-01_vuln_005/stage_0_0", "experiment_name": "aixcc_o4-mini", "select_method": "sample", "vuln_id": "freerdp_fp-full-01_vuln_005", "sanitizer_output": "+ FUZZER=TestFuzzCoreServer\n+ shift\n+ '[' '!' -v TESTCASE ']'\n+ TESTCASE=/testcase\n+ '[' '!' -f /testcase ']'\n+ export RUN_FUZZER_MODE=interactive\n+ RUN_FUZZER_MODE=interactive\n+ export FUZZING_ENGINE=libfuzzer\n+ FUZZING_ENGINE=libfuzzer\n+ export SKIP_SEED_CORPUS=1\n+ SKIP_SEED_CORPUS=1\n+ run_fuzzer TestFuzzCoreServer -runs=100 /testcase\nvm.mmap_rnd_bits = 28\n/out/TestFuzzCoreServer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -timeout_exitcode=0 < /dev/null\nINFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 2907567065\nINFO: Loaded 1 modules   (70193 inline 8-bit counters): 70193 [0x55930db31594, 0x55930db427c5), \nINFO: Loaded 1 PC tables (70193 PCs): 70193 [0x55930db427c8,0x55930dc54ad8), \n/out/TestFuzzCoreServer: Running 1 inputs 100 time(s) each.\nRunning: /testcase\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: *************************************************\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: This build is using [runtime-check] build options:\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: * 'WITH_VERBOSE_WINPR_ASSERT=ON'\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: \n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: [runtime-check] build options might slow down the application\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core.rdp] - [log_build_warn][0x519000000080]: *************************************************\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_SOCKET, SO_KEEPALIVE\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() IPPROTO_TCP, TCP_KEEPIDLE\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_KEEPCNT\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_KEEPINTVL\n[02:02:50:961] [18:00000012] [WARN][com.freerdp.core] - [freerdp_tcp_set_keep_alive_mode]: setsockopt() SOL_TCP, TCP_USER_TIMEOUT\n[02:02:50:962] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_send_update_pdu]: fast path update size (2) exceeds the client's maximum request size (0)\n[02:02:50:963] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_update]: Fastpath update Synchronize [3] failed, status 0\n[02:02:50:963] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_update_data]: fastpath_recv_update() - -1\n[02:02:50:963] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_updates]: fastpath_recv_update_data() fail\n[02:02:50:963] [18:00000012] [ERROR][com.freerdp.core.fastpath] - [fastpath_recv_input_event]: Unknown eventCode 7\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [rdp_read_security_header][0x519000000080]: invalid security header length, have 0, must be >= 4\n[02:02:50:963] [18:00000012] [ERROR][com.freerdp.core] - [tpdu_read_header]: tpdu length 210 > tpkt header length 0\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [Stream_CheckAndLogRequiredLengthWLogExVa][0x519000000080]: [rdp_read_share_control_header(/src/FreeRDP/libfreerdp/core/rdp.c:252)] invalid length, got 1, require at least 2 [element size=1]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 12: unresolvable, address=(nil)\n[02:02:50:963] [18:00000012] [WARN][com.freerdp.core.rdp] - [Stream_CheckAndLogRequiredLengthWLogExVa][0x519000000080]: [rdp_read_share_data_header(/src/FreeRDP/libfreerdp/core/rdp.c:343)] invalid length, got 1, require at least 12 [element size=1]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.rdp] - [winpr_log_backtrace_ex][0x519000000080]: 12: unresolvable, address=(nil)\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.update] - [check_alt_order_supported]: [0x12] UNKNOWN - Alternate Secondary Drawing Order UNKNOWN\n[02:02:50:964] [18:00000012] [ERROR][com.freerdp.core.update] - [check_order_activated]: [0x12] UNKNOWN - SERVER BUG: The support for this feature was not announced! Use /relax-order-checks to ignore\n[02:02:50:964] [18:00000012] [ERROR][com.freerdp.core.update] - [update_recv_order]: order flags 48 failed\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_recv_altsec_window_order(/src/FreeRDP/libfreerdp/core/window.c:1132)] invalid length, got 0, require at least 6 [element size=1]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:964] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.window] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_read_play_sound(/src/FreeRDP/libfreerdp/core/update.c:341)] invalid length, got 0, require at least 8 [element size=1]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:965] [18:00000012] [WARN][com.freerdp.core.update] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [update_recv_pointer(/src/FreeRDP/libfreerdp/core/update.c:752)] invalid length, got 0, require at least 4 [element size=1]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.update] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [tpkt_read_header(/src/FreeRDP/libfreerdp/core/tpkt.c:98)] invalid length, got 0, require at least 1 [element size=1]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 10: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 12: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 13: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:966] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 14: unresolvable, address=(nil)\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_demand_active(/src/FreeRDP/libfreerdp/core/capabilities.c:4521)] invalid length, got 0, require at least 8 [element size=1]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_confirm_active(/src/FreeRDP/libfreerdp/core/capabilities.c:4652)] invalid length, got 0, require at least 10 [element size=1]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:967] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.capabilities] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [rdp_recv_heartbeat_packet(/src/FreeRDP/libfreerdp/core/heartbeat.c:35)] invalid length, got 0, require at least 4 [element size=1]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 10: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.autodetect] - [winpr_log_backtrace_ex]: 12: unresolvable, address=(nil)\n[02:02:50:968] [18:00000012] [WARN][com.freerdp.core.tpkt] - [Stream_CheckAndLogRequiredLengthWLogExVa]: [tpkt_read_header(/src/FreeRDP/libfreerdp/core/tpkt.c:98)] invalid length, got 0, require at least 1 [element size=1]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 0: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 1: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 2: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 3: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 4: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 5: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 6: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 7: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 8: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 9: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 10: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 11: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 12: dli_fname=/lib/x86_64-linux-gnu/libc.so.6 [0x7fada6a7d000], dli_sname=__libc_start_main [0x7fada6aa0f90]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 13: dli_fname=/out/TestFuzzCoreServer [0x55930cc59000], dli_sname=(null) [(nil)]\n[02:02:50:969] [18:00000012] [WARN][com.freerdp.core.tpkt] - [winpr_log_backtrace_ex]: 14: unresolvable, address=(nil)\n[02:02:50:975] [18:00000012] [WARN][com.freerdp.crypto] - [ber_read_application_tag]: invalid tag, got 0x42, expected 0x65\nAddressSanitizer:DEADLYSIGNAL\n=================================================================\n==18==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x52100001a600 bp 0x7ffee0e25cf0 sp 0x7ffee0e25c38 T0)\n==18==The signal is caused by a WRITE memory access.\n==18==Hint: address points to the zero page.\nSCARINESS: 10 (null-deref)\n    #0 0x52100001a600  (<unknown module>)\n    #1 0x55930d20e2bb in freerdp_is_valid_mcs_create_response /src/FreeRDP/libfreerdp/core/freerdp.c:1458:16\n    #2 0x55930d195790 in test_server /src/FreeRDP/libfreerdp/core/test/TestFuzzCoreServer.c:83:3\n    #3 0x55930d195790 in LLVMFuzzerTestOneInput /src/FreeRDP/libfreerdp/core/test/TestFuzzCoreServer.c:106:2\n    #4 0x55930d04c100 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13\n    #5 0x55930d037375 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6\n    #6 0x55930d03ce0f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9\n    #7 0x55930d0680b2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #8 0x7fada6aa1082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\n\nDEDUP_TOKEN: freerdp_is_valid_mcs_create_response--test_server\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (<unknown module>) \n==18==ABORTING\nsubprocess command returned a non-zero exit status: 1\n\nINFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/qqor/aixcc/san2patch-private/oss-fuzz-aixcc/build/out/freerdp:/out -v /home/qqor/aixcc/dataset/tarballs/freerdp_fp-full-01/pov/freerdp_fp-full-01_vuln_005:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce TestFuzzCoreServer -runs=100.\n", "package_language": "C", "package_name": "", "package_location": "/home/qqor/aixcc/san2patch-private/benchmark-projects-copy/official-afc-freerdp", "last_node": "patch_end"}