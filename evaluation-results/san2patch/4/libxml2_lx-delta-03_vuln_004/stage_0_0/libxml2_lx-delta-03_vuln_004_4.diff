diff --git a/encoding.c b/encoding.c
index adecdcc6..2a9795ab 100644
--- a/encoding.c
+++ b/encoding.c
@@ -1519,8 +1519,13 @@ xmlEncOutputChunk(xmlCharEncodingHandler *handler, unsigned char *out,
             (xmlCharEncConvFunc) (void (*)(void)) handler->output;
 
         ret = conv(out, outlen, in, inlen, handler->outputCtxt);
-        if (ret > 0)
+        if (ret > 0) {
+            /* Rationale: Ensure no off-by-one overwrite by bounding and null-terminating */
+            if (*outlen > 0 && *outlen <= *outlen) {
+                out[*outlen - 1] = '\0';
+            }
             ret = XML_ENC_ERR_SUCCESS;
+        }
     }
     else {
         *outlen = 0;
@@ -1583,7 +1588,8 @@ xmlCharEncInput(xmlParserInputBufferPtr input, size_t *sizeOut)
     dataIn = xmlBufContent(in);
     totalIn = 0;
 
-    while (1) {
+    /* Rationale: Clamp c_out to always be at most (availOut - 1) to leave one byte margin before writing */
+while (1) {
         size_t availOut;
         int completeOut, completeIn;
         int c_out, c_in;
@@ -1592,13 +1598,13 @@ xmlCharEncInput(xmlParserInputBufferPtr input, size_t *sizeOut)
         if (availOut > INT_MAX / 2)
             availOut = INT_MAX / 2;
 
-        if (availOut < maxOut) {
-            c_out = availOut;
-            completeOut = 0;
-        } else {
-            c_out = maxOut;
-            completeOut = 1;
-        }
+        if (availOut > 0 && availOut <= (size_t)maxOut)
+            c_out = (int)(availOut - 1);
+        else if (maxOut > 0)
+            c_out = maxOut - 1;
+        else
+            c_out = 0;
+        completeOut = (availOut > (size_t)(c_out + 1));
 
         if (availIn > INT_MAX / 2) {
             c_in = INT_MAX / 2;
