diff --git a/lib/multi.c b/lib/multi.c
index 1851dc731..69f0cc601 100644
--- a/lib/multi.c
+++ b/lib/multi.c
@@ -1749,10 +1749,12 @@ static CURLcode protocol_doing(struct Curl_easy *data, bool *done)
 {
   CURLcode result = CURLE_OK;
   struct connectdata *conn = data->conn;
+  struct Curl_handler *handler = conn ? conn->handler : NULL;
 
-  if(conn && conn->handler->doing) {
+// Use handler variable to check proto and doing
+  if(handler && handler->proto && handler->doing) {
     *done = FALSE;
-    result = conn->handler->doing(data, done);
+    result = handler->doing(data, done);
   }
   else
     *done = TRUE;
