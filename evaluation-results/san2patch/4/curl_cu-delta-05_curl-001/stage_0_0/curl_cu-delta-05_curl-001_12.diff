diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..b516c97c4 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -889,8 +889,14 @@ number:
           len = 0;
         }
       }
-      else if(prec != -1)
+      /* Rationale: abort when requested precision exceeds string length */
+      else if(prec != -1) {
+        size_t str_len = strlen(str);
+        if((size_t)prec > str_len) {
+          return 0;
+        }
         len = (size_t)prec;
+      }
       else if(*str == '\0')
         len = 0;
       else
@@ -1130,7 +1136,17 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
   struct dynbuf dyn;
   info.b = &dyn;
   Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+  /* Rationale: Measure required size with vsnprintf then reserve to prevent OOB reads */
+  va_list ap2;
+  va_copy(ap2, ap_save);
+  int needed = vsnprintf(NULL, 0, format, ap2);
+  va_end(ap2);
+  if(needed < 0) {
+    Curl_dyn_free(info.b);
+    return NULL;
+  }
+  Curl_dyn_reserve(info.b, (size_t)needed + 1);
+   info.merr = MERR_OK;
 
   (void)formatf(&info, alloc_addbyter, format, ap_save);
   if(info.merr) {
