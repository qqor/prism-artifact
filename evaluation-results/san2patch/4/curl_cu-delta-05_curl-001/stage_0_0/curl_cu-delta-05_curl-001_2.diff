diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..db5405d8f 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -206,6 +206,7 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
     if(user_end) {
       size_t resp_count = 0;
       ssize_t bytes_recv;
+      char cmd_buf[DICT_MAX_CMD_LEN + 1];
       resp_buf = malloc(1024);
       memset(resp_buf, 0, 1024);
       /* Username comes immediately after path */
@@ -226,12 +227,20 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
         do {
         result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
+
+        /* Rationale: Truncate user_start into fixed-size buffer to cap length */
+        {
+          size_t len = strlen(user_start);
+          if(len > DICT_MAX_CMD_LEN)
+            len = DICT_MAX_CMD_LEN;
+          memcpy(cmd_buf, user_start, len);
+          cmd_buf[len] = '\0';
+        }
         do {
-        result = sendf(data, user_start);
+        result = sendf(data, cmd_buf);
         } while(result == CURLE_AGAIN);
       }
 
-
       do {
       result = Curl_xfer_recv(data, (resp_buf + 1024 * resp_count),
         1024, &bytes_recv);
@@ -256,22 +265,9 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
       do {
       result = sendf(data,
 "AUTH %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\r\n",
-      md5_out[0],
-      md5_out[1],
-      md5_out[2],
-      md5_out[3],
-      md5_out[4],
-      md5_out[5],
-      md5_out[6],
-      md5_out[7],
-      md5_out[8],
-      md5_out[9],
-      md5_out[10],
-      md5_out[11],
-      md5_out[12],
-      md5_out[13],
-      md5_out[14],
-      md5_out[15]);
+      md5_out[0], md5_out[1], md5_out[2], md5_out[3], md5_out[4], md5_out[5],
+      md5_out[6], md5_out[7], md5_out[8], md5_out[9], md5_out[10], md5_out[11],
+      md5_out[12], md5_out[13], md5_out[14], md5_out[15]);
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
