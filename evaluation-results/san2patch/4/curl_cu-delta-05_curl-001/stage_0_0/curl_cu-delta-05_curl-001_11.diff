diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..ef98f8ca7 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -889,8 +889,10 @@ number:
           len = 0;
         }
       }
-      else if(prec != -1)
-        len = (size_t)prec;
+      /* Rationale: use strnlen to cap at precision, avoiding OOB read */
+      else if(prec != -1) {
+        len = strnlen(str, (size_t)prec);
+      }
       else if(*str == '\0')
         len = 0;
       else
@@ -1130,7 +1132,14 @@ char *curl_mvaprintf(const char *format, va_list ap_save)
   struct dynbuf dyn;
   info.b = &dyn;
   Curl_dyn_init(info.b, DYN_APRINTF);
-  info.merr = MERR_OK;
+  /* Rationale: Enforce maximum format length to avoid internal buffer overflow */
+  enum { MAX_FORMAT_LEN = 16384 };
+  size_t fmtlen = strnlen(format, MAX_FORMAT_LEN + 1);
+  if(fmtlen > MAX_FORMAT_LEN) {
+    Curl_dyn_free(info.b);
+    return NULL;
+  }
+   info.merr = MERR_OK;
 
   (void)formatf(&info, alloc_addbyter, format, ap_save);
   if(info.merr) {
