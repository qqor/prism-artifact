diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..318781c86 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -206,72 +206,83 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
     if(user_end) {
       size_t resp_count = 0;
       ssize_t bytes_recv;
-      resp_buf = malloc(1024);
-      memset(resp_buf, 0, 1024);
-      /* Username comes immediately after path */
-      user_start = strchr(path, '/') + 1;
-      *user_end = (char)0;
+      /* Allocate and check bounds on user-end calculation */
+      resp_buf = malloc(MAX_FORMAT_BUFFER_SIZE);
+      if(!resp_buf) {
+        result = CURLE_OUT_OF_MEMORY;
+        goto error;
+      }
+      memset(resp_buf, 0, MAX_FORMAT_BUFFER_SIZE);
+      /* Username starts after slash; ensure slash exists */
+      char *slash = strchr(path, '/');
+      if(!slash) {
+        result = CURLE_URL_MALFORMAT;
+        goto error;
+      }
+      user_start = slash + 1;
+      *user_end = '\0';
       auth_start = user_end + 1;
       auth_end = strchr(path, '@');
-      if(auth_end) {
-        *auth_end = (char)0;
-      }
+      if(auth_end)
+        *auth_end = '\0';
       do {
-      result = sendf(data, "CLIENT " LIBCURL_NAME " " LIBCURL_VERSION "\r\n");
+        result = sendf(data, "CLIENT " LIBCURL_NAME " " LIBCURL_VERSION "\r\n");
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
 
       if(strcmp(auth_start, "debug")) {
         do {
-        result = sendf(data, "Sending extra debug info...");
+          result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
         do {
-        result = sendf(data, user_start);
+          result = sendf(data, user_start);
         } while(result == CURLE_AGAIN);
       }
 
-
+      /* Receive safely once with full buffer size minus one for NUL */
       do {
-      result = Curl_xfer_recv(data, (resp_buf + 1024 * resp_count),
-        1024, &bytes_recv);
+        result = Curl_xfer_recv(data, resp_buf, MAX_FORMAT_BUFFER_SIZE - 1, &bytes_recv);
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
 
-      first_space = strchr(resp_buf, ' ');
+      /* Validate spaces within received length */
+      if(bytes_recv <= 0 || bytes_recv > MAX_FORMAT_BUFFER_SIZE - 1) {
+        result = CURLE_WEIRD_SERVER_REPLY;
+        goto error;
+      }
+      first_space = memchr(resp_buf, ' ', bytes_recv);
       if(!first_space)
         goto error;
-      second_space = strchr(first_space + 1, ' ');
+      second_space = memchr(first_space + 1, ' ', bytes_recv - (first_space - resp_buf) - 1);
       if(!second_space)
         goto error;
       second_space++;
       passwd = auth_start;
-      combined = malloc(strlen(second_space) + strlen(passwd));
-      strcpy(combined, second_space);
-      strcpy(combined + strlen(second_space), passwd);
+
+      /* Safe snprintf out-of-bounds protection */
+      size_t max_comb = MAX_FORMAT_BUFFER_SIZE;
+      combined = malloc(max_comb);
+      if(!combined) {
+        result = CURLE_OUT_OF_MEMORY;
+        goto error;
+      }
+      int ret = snprintf(combined, max_comb, "%s%s", second_space, passwd);
+      if(ret < 0 || (size_t)ret >= max_comb) {
+        result = CURLE_WEIRD_SERVER_REPLY;
+        goto error;
+      }
       result = Curl_md5it(md5_out, combined, strlen(combined));
       if(result)
         goto error;
       do {
-      result = sendf(data,
+        result = sendf(data,
 "AUTH %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\r\n",
-      md5_out[0],
-      md5_out[1],
-      md5_out[2],
-      md5_out[3],
-      md5_out[4],
-      md5_out[5],
-      md5_out[6],
-      md5_out[7],
-      md5_out[8],
-      md5_out[9],
-      md5_out[10],
-      md5_out[11],
-      md5_out[12],
-      md5_out[13],
-      md5_out[14],
-      md5_out[15]);
+          md5_out[0], md5_out[1], md5_out[2], md5_out[3],
+          md5_out[4], md5_out[5], md5_out[6], md5_out[7],
+          md5_out[8], md5_out[9], md5_out[10], md5_out[11],
+          md5_out[12], md5_out[13], md5_out[14], md5_out[15]);
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..1b933ed86 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -310,7 +310,8 @@ static int parsefmt(const char *format,
             }
             else
               /* get it from the next argument */
-              precision = -1;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+               precision = -1;
           }
           else {
             bool is_neg = FALSE;
@@ -320,10 +321,11 @@ static int parsefmt(const char *format,
               is_neg = TRUE;
               fmt++;
             }
-            while(ISDIGIT(*fmt)) {
+            /* Limit digit scan to prevent buffer overrun */
+            const char *seg_start = fmt;
+            while(ISDIGIT(*fmt) && (size_t)(fmt - seg_start) < MAX_FORMAT_BUFFER_SIZE) {
               int n = *fmt - '0';
-              if(precision > (INT_MAX - n) / 10)
-                return PFMT_PREC;
+              if(precision > (INT_MAX - n) / 10)                return PFMT_PREC;
               precision = precision * 10 + n;
               fmt++;
             }
