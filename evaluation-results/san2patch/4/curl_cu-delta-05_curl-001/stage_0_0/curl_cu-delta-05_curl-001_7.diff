diff --git a/lib/dict.c b/lib/dict.c
index c940308b0..fedd194ec 100644
--- a/lib/dict.c
+++ b/lib/dict.c
@@ -206,8 +206,12 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
     if(user_end) {
       size_t resp_count = 0;
       ssize_t bytes_recv;
-      resp_buf = malloc(1024);
-      memset(resp_buf, 0, 1024);
+      /* Allocate with calloc to ensure zeroing */
+      resp_buf = calloc(1, MAX_FORMAT_BUFFER_SIZE);
+      if(!resp_buf) {
+        result = CURLE_OUT_OF_MEMORY;
+        goto error;
+      }
       /* Username comes immediately after path */
       user_start = strchr(path, '/') + 1;
       *user_end = (char)0;
@@ -217,61 +221,65 @@ static CURLcode dict_do(struct Curl_easy *data, bool *done)
         *auth_end = (char)0;
       }
       do {
-      result = sendf(data, "CLIENT " LIBCURL_NAME " " LIBCURL_VERSION "\r\n");
+        result = sendf(data, "CLIENT " LIBCURL_NAME " " LIBCURL_VERSION "\r\n");
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
 
       if(strcmp(auth_start, "debug")) {
         do {
-        result = sendf(data, "Sending extra debug info...");
+          result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
         do {
-        result = sendf(data, user_start);
+          result = sendf(data, user_start);
         } while(result == CURLE_AGAIN);
       }
 
-
-      do {
-      result = Curl_xfer_recv(data, (resp_buf + 1024 * resp_count),
-        1024, &bytes_recv);
-      } while(result == CURLE_AGAIN);
+      /* Receive chunks with offset and bound check */
+      {
+        size_t offset = 0;
+        do {
+          size_t chunk = MAX_FORMAT_BUFFER_SIZE - offset - 1;
+          result = Curl_xfer_recv(data, resp_buf + offset, chunk, &bytes_recv);
+          if(result == CURLE_OK) offset += bytes_recv;
+        } while(result == CURLE_AGAIN && offset < MAX_FORMAT_BUFFER_SIZE - 1);
+      }
       if(result)
         goto error;
 
-      first_space = strchr(resp_buf, ' ');
-      if(!first_space)
+      /* Validate pointer bounds */
+      if((first_space = strchr(resp_buf, ' ')) == NULL)
         goto error;
-      second_space = strchr(first_space + 1, ' ');
-      if(!second_space)
+      if((second_space = strchr(first_space + 1, ' ')) == NULL)
         goto error;
       second_space++;
       passwd = auth_start;
-      combined = malloc(strlen(second_space) + strlen(passwd));
-      strcpy(combined, second_space);
-      strcpy(combined + strlen(second_space), passwd);
+
+      /* Use fixed-size buffer for combined */
+      {
+        char combined_fixed[MAX_FORMAT_BUFFER_SIZE];
+        int written = snprintf(combined_fixed, sizeof(combined_fixed), "%s%s", second_space, passwd);
+        if(written < 0 || (size_t)written >= sizeof(combined_fixed)) {
+          result = CURLE_WEIRD_SERVER_REPLY;
+          goto error;
+        }
+        combined = malloc(written + 1);
+        if(!combined) {
+          result = CURLE_OUT_OF_MEMORY;
+          goto error;
+        }
+        memcpy(combined, combined_fixed, written + 1);
+      }
       result = Curl_md5it(md5_out, combined, strlen(combined));
       if(result)
         goto error;
       do {
-      result = sendf(data,
+        result = sendf(data,
 "AUTH %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\r\n",
-      md5_out[0],
-      md5_out[1],
-      md5_out[2],
-      md5_out[3],
-      md5_out[4],
-      md5_out[5],
-      md5_out[6],
-      md5_out[7],
-      md5_out[8],
-      md5_out[9],
-      md5_out[10],
-      md5_out[11],
-      md5_out[12],
-      md5_out[13],
-      md5_out[14],
-      md5_out[15]);
+          md5_out[0], md5_out[1], md5_out[2], md5_out[3],
+          md5_out[4], md5_out[5], md5_out[6], md5_out[7],
+          md5_out[8], md5_out[9], md5_out[10], md5_out[11],
+          md5_out[12], md5_out[13], md5_out[14], md5_out[15]);
       } while(result == CURLE_AGAIN);
       if(result)
         goto error;
diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..20ec503b9 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -310,7 +310,8 @@ static int parsefmt(const char *format,
             }
             else
               /* get it from the next argument */
-              precision = -1;
+// FIXME: Crash CWE-125: Out-of-bounds Read
+               precision = -1;
           }
           else {
             bool is_neg = FALSE;
@@ -320,10 +321,21 @@ static int parsefmt(const char *format,
               is_neg = TRUE;
               fmt++;
             }
+            /* Safely parse numeric precision with strtol */
+            {
+              char *endptr;
+              long tmp = strtol(fmt, &endptr, 10);
+              if(tmp < 0)
+                precision = 0;
+              else if(tmp > MAX_FORMAT_BUFFER_SIZE)
+                precision = MAX_FORMAT_BUFFER_SIZE;
+              else
+                precision = (int)tmp;
+              fmt = endptr;
+            }
             while(ISDIGIT(*fmt)) {
               int n = *fmt - '0';
-              if(precision > (INT_MAX - n) / 10)
-                return PFMT_PREC;
+              if(precision > (INT_MAX - n) / 10)                return PFMT_PREC;
               precision = precision * 10 + n;
               fmt++;
             }
