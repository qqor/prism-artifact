diff --git a/lib/extremelygoodprtcl.c b/lib/extremelygoodprtcl.c
index d3bea69f7..aaaefb8f8 100644
--- a/lib/extremelygoodprtcl.c
+++ b/lib/extremelygoodprtcl.c
@@ -199,20 +199,20 @@ const struct Curl_handler Curl_handler_extremelygoodprtcl = {
 static CURLcode extremelygoodprtcl_do(struct Curl_easy *data, bool *done)
 {
   *done = FALSE; /* unconditionally */
-
+  /* Prevent NULL-dereference: check state-machine buffer */
+  char *buf = Curl_pp_statemach(data, done);
+  if(!buf) {
+    /* No work to do if the state-machine returned NULL */
+    return CURLE_OK;
+  }
+  /* TODO: existing protocol frame writing logic using buf */
   return CURLE_OK;
 }
 
 /* The only way to change state */
 static void vnstate(struct Curl_easy *data,
                     enum extremelygoodprtclstate state)
-{
-  struct connectdata *conn = data->conn;
-  struct extremelygoodprtcl_conn *vnormal = &conn->proto.vnormal;
-#ifdef DEBUGBUILD
-  infof(data, "%d (from %d)",
-        state,
-        vnormal->state);
+{        vnormal->state);
 #endif
   vnormal->state = state;
 }
