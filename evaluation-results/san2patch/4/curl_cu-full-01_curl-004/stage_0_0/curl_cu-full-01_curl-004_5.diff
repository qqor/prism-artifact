diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..27d1f7cc9 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -901,15 +901,24 @@ number:
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
 
+      /* clamp padding and length to remaining buffer space */
+      size_t avail = (size_t)(o->end - o->cur);
+      if((size_t)width > avail) width = (int)avail;
+      if(len > avail) len = avail;
+
       if(!(flags & FLAGS_LEFT))
         while(width-- > 0)
           OUTCHAR(' ');
 
       for(; len && *str; len--)
         OUTCHAR(*str++);
-      if(flags & FLAGS_LEFT)
+      if(flags & FLAGS_LEFT) {
+        /* clamp before left padding */
+        avail = (size_t)(o->end - o->cur);
+        if((size_t)width > avail) width = (int)avail;
         while(width-- > 0)
           OUTCHAR(' ');
+      }
 
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
