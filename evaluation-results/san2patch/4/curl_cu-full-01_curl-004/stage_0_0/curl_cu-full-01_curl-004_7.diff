diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..8f90687c1 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -901,15 +901,28 @@ number:
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
 
-      if(!(flags & FLAGS_LEFT))
-        while(width-- > 0)
-          OUTCHAR(' ');
+      /* use bounded for-loops for padding */
+      size_t avail = (size_t)(o->end - o->cur);
+      int pad = width > 0 ? width : 0;
+      if((size_t)pad > avail)
+        pad = (int)avail;
+      for(int i = 0; i < pad; i++)
+        OUTCHAR(' ');
 
-      for(; len && *str; len--)
+      /* bounded string output */
+      for(; len && *str; len--) {
+        if(o->cur >= o->end) break;
         OUTCHAR(*str++);
-      if(flags & FLAGS_LEFT)
-        while(width-- > 0)
+      }
+      if(flags & FLAGS_LEFT) {
+        /* clamp before left padding */
+        avail = (size_t)(o->end - o->cur);
+        pad = width > 0 ? width : 0;
+        if((size_t)pad > avail)
+          pad = (int)avail;
+        for(int i = 0; i < pad; i++)
           OUTCHAR(' ');
+      }
 
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
