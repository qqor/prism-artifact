diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..bd827beea 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -901,14 +901,16 @@ number:
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
 
+      /* guard padding loops by buffer end */
       if(!(flags & FLAGS_LEFT))
-        while(width-- > 0)
+        while(width-- > 0 && o->cur < o->end)
           OUTCHAR(' ');
 
-      for(; len && *str; len--)
+      /* guard string output by buffer end */
+      for(; len && *str && o->cur < o->end; len--)
         OUTCHAR(*str++);
       if(flags & FLAGS_LEFT)
-        while(width-- > 0)
+        while(width-- > 0 && o->cur < o->end)
           OUTCHAR(' ');
 
       if(flags & FLAGS_ALT)
