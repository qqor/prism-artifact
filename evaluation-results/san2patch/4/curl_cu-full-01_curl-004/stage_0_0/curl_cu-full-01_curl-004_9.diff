diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..419d3d3f2 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -901,15 +901,25 @@ number:
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
 
-      if(!(flags & FLAGS_LEFT))
-        while(width-- > 0)
+      /* break loops if buffer end reached */
+      if(!(flags & FLAGS_LEFT)) {
+        while(width-- > 0) {
+          if(o->cur >= o->end) break;
           OUTCHAR(' ');
+        }
+      }
 
-      for(; len && *str; len--)
+      while(len && *str) {
+        if(o->cur >= o->end) break;
         OUTCHAR(*str++);
-      if(flags & FLAGS_LEFT)
-        while(width-- > 0)
+        len--;
+      }
+      if(flags & FLAGS_LEFT) {
+        while(width-- > 0) {
+          if(o->cur >= o->end) break;
           OUTCHAR(' ');
+        }
+      }
 
       if(flags & FLAGS_ALT)
         OUTCHAR('"');
