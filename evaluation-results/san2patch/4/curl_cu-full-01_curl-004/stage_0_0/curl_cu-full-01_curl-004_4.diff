diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..80adad901 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -1053,7 +1053,9 @@ number:
 static int addbyter(unsigned char outc, void *f)
 {
   struct nsprintf *infop = f;
-  if(infop->length < infop->max) {
+// FIXME: Crash CWE-787: Out-of-bounds Write
+   size_t new_len = infop->length + 1;
+   if(new_len < infop->max) {
     /* only do this if we have not reached max length yet */
     *infop->buffer++ = (char)outc; /* store */
     infop->length++; /* we are now one byte larger */
