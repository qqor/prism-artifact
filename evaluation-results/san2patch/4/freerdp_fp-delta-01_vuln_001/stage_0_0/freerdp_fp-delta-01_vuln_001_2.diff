diff --git a/libfreerdp/crypto/certificate_data.c b/libfreerdp/crypto/certificate_data.c
index 8b8b9af7e..275c08d0e 100644
--- a/libfreerdp/crypto/certificate_data.c
+++ b/libfreerdp/crypto/certificate_data.c
@@ -148,8 +148,16 @@ rdpCertificateData* freerdp_certificate_data_new(const char* hostname, UINT16 po
 rdpCertificateData* freerdp_certificate_data_new_from_pem(const char* hostname, UINT16 port,
                                                           const char* pem, size_t length)
 {
+	/* Rationale: define a macro for size limit inside function scope */
+	#define MAX_PEM_SIZE (64 * 1024)
 	if (!pem || (length == 0))
 		return NULL;
+	if (length > MAX_PEM_SIZE) {
+		WLog_ERR(TAG, "PEM input too large (%zu bytes)", length);
+		#undef MAX_PEM_SIZE
+		return NULL;
+	}
+	#undef MAX_PEM_SIZE
 
 	rdpCertificate* cert = freerdp_certificate_new_from_pem(pem);
 	rdpCertificateData* data = freerdp_certificate_data_new_nocopy(hostname, port, cert);
