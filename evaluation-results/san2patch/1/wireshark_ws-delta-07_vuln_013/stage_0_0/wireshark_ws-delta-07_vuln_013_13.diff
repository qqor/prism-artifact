diff --git a/epan/dissectors/packet-gvcp.c b/epan/dissectors/packet-gvcp.c
index d49324a429..86f9e4e14f 100644
--- a/epan/dissectors/packet-gvcp.c
+++ b/epan/dissectors/packet-gvcp.c
@@ -245,20 +245,32 @@ GVCP statuses
 /*
 Device modes
 */
+// FIXME: Crash CWE-787: Out-of-bounds Write
 
-#define GEV_DEVICEMODE_TRANSMITTER (0x00 )
-#define GEV_DEVICEMODE_RECEIVER (0x01)
+#define GEV_DEVICEMODE_TRANSMITTER (0x00)
+#define GEV_DEVICEMODE_RECEIVER    (0x01)
 #define GEV_DEVICEMODE_TRANSCEIVER (0x02)
-#define GEV_DEVICEMODE_PERIPHERAL (0x03)
+#define GEV_DEVICEMODE_PERIPHERAL  (0x03)
+
+/* Array of allowed modes and clamp-by-index helper */
+static const guint8 gvcp_device_modes[] = {
+    GEV_DEVICEMODE_TRANSMITTER,
+    GEV_DEVICEMODE_RECEIVER,
+    GEV_DEVICEMODE_TRANSCEIVER,
+    GEV_DEVICEMODE_PERIPHERAL
+};
 
+#define GEV_DEVICEMODE_FROM_INDEX(idx)                                  \
+    (((guint)(idx) < G_N_ELEMENTS(gvcp_device_modes))                  \
+         ? gvcp_device_modes[(idx)]                                   \
+         : gvcp_device_modes[G_N_ELEMENTS(gvcp_device_modes) - 1])
 
 /*
 Event IDs
 */
 
-#define GEV_EVENT_TRIGGER (0x0002) /* deprecated */
-#define GEV_EVENT_START_OF_EXPOSURE (0x0003) /* deprecated */
-#define GEV_EVENT_END_OF_EXPOSURE (0x0004) /* deprecated */
+#define GEV_EVENT_TRIGGER           (0x0002) /* deprecated */
+#define GEV_EVENT_START_OF_EXPOSURE (0x0003) /* deprecated */#define GEV_EVENT_END_OF_EXPOSURE (0x0004) /* deprecated */
 #define GEV_EVENT_START_OF_TRANSFER (0x0005) /* deprecated */
 #define GEV_EVENT_END_OF_TRANSFER (0x0006) /* deprecated */
 #define GEV_EVENT_PRIMARY_APP_SWITCH (0x0007)
