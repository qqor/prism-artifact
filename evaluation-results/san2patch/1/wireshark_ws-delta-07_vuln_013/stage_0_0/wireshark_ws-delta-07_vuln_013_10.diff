diff --git a/epan/dissectors/packet-gvcp.c b/epan/dissectors/packet-gvcp.c
index d49324a429..84b513529b 100644
--- a/epan/dissectors/packet-gvcp.c
+++ b/epan/dissectors/packet-gvcp.c
@@ -245,20 +245,34 @@ GVCP statuses
 /*
 Device modes
 */
+// FIXME: Crash CWE-787: Out-of-bounds Write
 
-#define GEV_DEVICEMODE_TRANSMITTER (0x00 )
-#define GEV_DEVICEMODE_RECEIVER (0x01)
+#define GEV_DEVICEMODE_TRANSMITTER (0x00)
+#define GEV_DEVICEMODE_RECEIVER    (0x01)
 #define GEV_DEVICEMODE_TRANSCEIVER (0x02)
-#define GEV_DEVICEMODE_PERIPHERAL (0x03)
+#define GEV_DEVICEMODE_PERIPHERAL  (0x03)
 
+/*
+ Clamp device mode to prevent out-of-bounds writes.
+*/
+#define GEV_DEVICEMODE_MAX GEV_DEVICEMODE_PERIPHERAL
+static inline guint8
+clamp_device_mode(guint8 mode) {
+    if (mode > GEV_DEVICEMODE_MAX) {
+        expert_dissection_add_info(NULL, NULL, "GVCP",
+            "Clamped out-of-range device mode %u to %u",
+            mode, GEV_DEVICEMODE_MAX);
+        return GEV_DEVICEMODE_MAX;
+    }
+    return mode;
+}
 
 /*
 Event IDs
 */
 
-#define GEV_EVENT_TRIGGER (0x0002) /* deprecated */
-#define GEV_EVENT_START_OF_EXPOSURE (0x0003) /* deprecated */
-#define GEV_EVENT_END_OF_EXPOSURE (0x0004) /* deprecated */
+#define GEV_EVENT_TRIGGER           (0x0002) /* deprecated */
+#define GEV_EVENT_START_OF_EXPOSURE (0x0003) /* deprecated */#define GEV_EVENT_END_OF_EXPOSURE (0x0004) /* deprecated */
 #define GEV_EVENT_START_OF_TRANSFER (0x0005) /* deprecated */
 #define GEV_EVENT_END_OF_TRANSFER (0x0006) /* deprecated */
 #define GEV_EVENT_PRIMARY_APP_SWITCH (0x0007)
