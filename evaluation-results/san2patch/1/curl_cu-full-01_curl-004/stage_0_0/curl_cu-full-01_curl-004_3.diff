diff --git a/lib/mprintf.c b/lib/mprintf.c
index 35e40e302..f21a004c7 100644
--- a/lib/mprintf.c
+++ b/lib/mprintf.c
@@ -872,8 +872,10 @@ number:
       break;
 
     case FORMAT_STRING: {
+      struct msnprintf *info = (struct msnprintf *)userp;
       const char *str;
       size_t len;
+      int written = 0;
 
       str = (char *)iptr->val.str;
       if(!str) {
@@ -898,21 +900,30 @@ number:
 
       width -= (len > INT_MAX) ? INT_MAX : (int)len;
 
-      if(flags & FLAGS_ALT)
-        OUTCHAR('"');
+      if(flags & FLAGS_ALT) {
+        if(written < info->max - 1) { OUTCHAR('"'); written++; }
+      }
 
       if(!(flags & FLAGS_LEFT))
-        while(width-- > 0)
-          OUTCHAR(' ');
+        while(width-- > 0) {
+          if(written >= info->max - 1) break;
+          OUTCHAR(' '); written++;
+        }
+
+      for(; len && *str; len--) {
+        if(written >= info->max - 1) break;
+        OUTCHAR(*str++); written++;
+      }
 
-      for(; len && *str; len--)
-        OUTCHAR(*str++);
       if(flags & FLAGS_LEFT)
-        while(width-- > 0)
-          OUTCHAR(' ');
+        while(width-- > 0) {
+          if(written >= info->max - 1) break;
+          OUTCHAR(' '); written++;
+        }
 
-      if(flags & FLAGS_ALT)
-        OUTCHAR('"');
+      if(flags & FLAGS_ALT) {
+        if(written < info->max - 1) OUTCHAR('"');
+      }
       break;
     }
 
@@ -1073,17 +1084,9 @@ int curl_mvsnprintf(char *buffer, size_t maxlength, const char *format,
   info.max = maxlength;
 
   retcode = formatf(&info, addbyter, format, ap_save);
-  if(info.max) {
-    /* we terminate this with a zero byte */
-    if(info.max == info.length) {
-      /* we are at maximum, scrap the last letter */
-      info.buffer[-1] = 0;
-      DEBUGASSERT(retcode);
-      retcode--; /* do not count the nul byte */
-    }
-    else
-      info.buffer[0] = 0;
-  }
+  /* always null-terminate within bounds */
+  if(maxlength > 0)
+    buffer[(maxlength > info.length ? info.length : maxlength - 1)] = '\0';
   return retcode;
 }
 
