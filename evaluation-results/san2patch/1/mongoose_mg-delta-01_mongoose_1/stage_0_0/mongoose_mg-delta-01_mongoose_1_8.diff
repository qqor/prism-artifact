diff --git a/src/printf.c b/src/printf.c
index d9998ccf..0f666de2 100644
--- a/src/printf.c
+++ b/src/printf.c
@@ -130,13 +130,19 @@ static char mg_escape(int c) {
 
 static size_t qcpy(void (*out)(char, void *), void *ptr, char *buf,
                    size_t len) {
-  size_t i = 0, extra = 0;
+  /* Rationale: Track written bytes to enforce fixed buffer size */
+  size_t i = 0, extra = 0, written = 0;
+  const size_t MAX_BUF = 8;
   for (i = 0; i < len && buf[i] != '\0'; i++) {
+    if (written >= MAX_BUF) break;
     char c = mg_escape(buf[i]);
     if (c) {
+      if (written + 2 > MAX_BUF) break;
       out('\\', ptr), out(c, ptr), extra++;
-    } else {
+      written += 2;
+     } else {
       out(buf[i], ptr);
+      written++;
     }
   }
   return i + extra;
