diff --git a/src/printf.c b/src/printf.c
index d9998ccf..5de6f497 100644
--- a/src/printf.c
+++ b/src/printf.c
@@ -130,12 +130,16 @@ static char mg_escape(int c) {
 
 static size_t qcpy(void (*out)(char, void *), void *ptr, char *buf,
                    size_t len) {
+  /* Rationale: Use (i+extra) to prevent exceeding buffer capacity */
   size_t i = 0, extra = 0;
+  const size_t TMP_CAP = 8;
   for (i = 0; i < len && buf[i] != '\0'; i++) {
+    if (i + extra >= TMP_CAP) break;
     char c = mg_escape(buf[i]);
     if (c) {
+      if (i + extra + 2 > TMP_CAP) break;
       out('\\', ptr), out(c, ptr), extra++;
-    } else {
+     } else {
       out(buf[i], ptr);
     }
   }
