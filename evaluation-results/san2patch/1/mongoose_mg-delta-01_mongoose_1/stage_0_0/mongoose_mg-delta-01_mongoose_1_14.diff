diff --git a/src/printf.c b/src/printf.c
index d9998ccf..59fc8da6 100644
--- a/src/printf.c
+++ b/src/printf.c
@@ -34,8 +34,16 @@ static void mg_pfn_iobuf_private(char ch, void *param, bool expand) {
   }
 }
 
+/* Rationale: Centralize safe appends in helper to always enforce bounds */
+static inline void safe_append(struct mg_iobuf *io, char ch) {
+  if (io->len + 2 <= io->size) {
+    io->buf[io->len++] = (uint8_t) ch;
+    io->buf[io->len] = 0;
+  }
+}
+
 static void mg_putchar_iobuf_static(char ch, void *param) {
-  mg_pfn_iobuf_private(ch, param, false);
+  safe_append((struct mg_iobuf *) param, ch);
 }
 
 void mg_pfn_iobuf(char ch, void *param) {
@@ -47,7 +55,7 @@ size_t mg_vsnprintf(char *buf, size_t len, const char *fmt, va_list *ap) {
   size_t n = mg_vxprintf(mg_putchar_iobuf_static, &io, fmt, ap);
   if (n < len) buf[n] = '\0';
   return n;
-}
+}}
 
 size_t mg_snprintf(char *buf, size_t len, const char *fmt, ...) {
   va_list ap;
