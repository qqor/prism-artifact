diff --git a/src/libsystemd/sd-journal/catalog.c b/src/libsystemd/sd-journal/catalog.c
index a8d65ea4bf..0d2163bad5 100644
--- a/src/libsystemd/sd-journal/catalog.c
+++ b/src/libsystemd/sd-journal/catalog.c
@@ -360,7 +360,6 @@ int catalog_import_file(OrderedHashmap *h, const char *path) {
                 payload_size += line_len;
                 payload[payload_size++] = '\n';
                 payload[payload_size] = '\0';
-
                 empty_line = false;
         }
 
@@ -368,6 +367,9 @@ int catalog_import_file(OrderedHashmap *h, const char *path) {
                 if (payload_size == 0)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                "[%s:%u] No payload text.",
+        }
+        /* Free 'line' after got_id processing to avoid use-after-free */
+        freep(&line);
                                                path, n);
 
                 r = finish_item(h, id, lang ?: deflang, payload, payload_size);
