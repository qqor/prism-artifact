diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..16dac4a 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -760,6 +760,11 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
         
     mpe = Pipeline->Elements;
 
+    // Guard against NULL stage pointer to prevent NULL dereference (CWE-476)
+    if (mpe == NULL) {
+        return 0;
+    }
+
     switch (cmsStageInputChannels(mpe)) {
     case 3:
         _cmsIOPrintf(m, "[ /CIEBasedDEF\n");
@@ -790,7 +795,8 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
         _cmsIOPrintf(m, "]\n");
 
         mpe = mpe ->Next;
-    }
+    // FIXME: Crash CWE-476: NULL Pointer Dereference
+     }
 
     if (cmsStageType(mpe) == cmsSigCLutElemType) {
 
