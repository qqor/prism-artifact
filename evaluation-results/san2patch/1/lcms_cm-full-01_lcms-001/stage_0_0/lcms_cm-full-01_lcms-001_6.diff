diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..60c9ba4 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -758,6 +758,10 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
     const char* PreMin, *PostMin;
     cmsStage* mpe;
         
+    // Validate pipeline and stage pointer before use
+    if (Pipeline == NULL || Pipeline->Elements == NULL) {
+        return 0;
+    }
     mpe = Pipeline->Elements;
 
     switch (cmsStageInputChannels(mpe)) {
@@ -789,7 +793,12 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
         EmitNGamma(m, cmsStageOutputChannels(mpe), _cmsStageGetPtrToCurveSet(mpe));
         _cmsIOPrintf(m, "]\n");
 
-        mpe = mpe ->Next;
+        mpe = mpe->Next;
+    }
+
+    // Extra null check before next dereference
+    if (mpe == NULL) {
+        return 0;
     }
 
     if (cmsStageType(mpe) == cmsSigCLutElemType) {
