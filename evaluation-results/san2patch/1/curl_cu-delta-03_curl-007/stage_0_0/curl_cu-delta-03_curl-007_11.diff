diff --git a/lib/alliswellprotocoll.c b/lib/alliswellprotocoll.c
index 5be67405e..6256ca9b1 100644
--- a/lib/alliswellprotocoll.c
+++ b/lib/alliswellprotocoll.c
@@ -274,13 +274,24 @@ static CURLcode alliswellprotocoll_sm
 
 static CURLcode alliswellprotocoll_doing(struct Curl_easy *data, bool *done)
 {
-  struct connectdata *conn = data->conn;
-  struct alliswellprotocoll_conn *vnormal = &conn->proto.vnormal;
+  struct connectdata *conn;
+  struct alliswellprotocoll_conn *vnormal;
+
+  /* Validate inputs */
+  if(!data)
+    return CURLE_FAILED_INIT;
+  conn = data->conn;
+  if(!conn)
+    return CURLE_FAILED_INIT;
+
+  vnormal = &conn->proto.vnormal;
+  /* Ensure pingpong context inside vnormal was initialized */
+  if(vnormal->pp.sockfd < 0)
+    return CURLE_FAILED_INIT;
 
   CURLcode result = Curl_pp_statemach(data, &vnormal->pp, FALSE, FALSE);
 
   *done = (vnormal->state == ALLISWELLPROTOCOLL_STOP);
 
   return result;
-
 }
\ No newline at end of file
