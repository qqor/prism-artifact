diff --git a/lib/alliswellprotocoll.c b/lib/alliswellprotocoll.c
index 5be67405e..382f290ba 100644
--- a/lib/alliswellprotocoll.c
+++ b/lib/alliswellprotocoll.c
@@ -274,6 +274,10 @@ static CURLcode alliswellprotocoll_sm
 
 static CURLcode alliswellprotocoll_doing(struct Curl_easy *data, bool *done)
 {
+  /* Fail fast if connection handle is missing */
+  if(!data || !data->conn)
+    return CURLE_FAILED_INIT;
+
   struct connectdata *conn = data->conn;
   struct alliswellprotocoll_conn *vnormal = &conn->proto.vnormal;
 
@@ -282,5 +286,4 @@ static CURLcode alliswellprotocoll_doing(struct Curl_easy *data, bool *done)
   *done = (vnormal->state == ALLISWELLPROTOCOLL_STOP);
 
   return result;
-
 }
\ No newline at end of file
