diff --git a/libfreerdp/crypto/certificate.c b/libfreerdp/crypto/certificate.c
index 30820bbc4..60e7833d5 100644
--- a/libfreerdp/crypto/certificate.c
+++ b/libfreerdp/crypto/certificate.c
@@ -1605,6 +1605,7 @@ char* freerdp_certificate_get_pem_ex(const rdpCertificate* cert, size_t* pLength
 	}
 
 	char* pem = NULL;
+	size_t len = 0;
 
 	const int status = PEM_write_bio_X509(bio, cert->x509);
 	if (status < 0)
@@ -1629,13 +1630,31 @@ char* freerdp_certificate_get_pem_ex(const rdpCertificate* cert, size_t* pLength
 	}
 
 	// Updated rfc to handle specific policy issues
-	// https://datatracker.ietf.org/doc/html/rfc7299
-	if ( freerdp_certificate_policies(cert, "2.23.140.1.2.1") ) {
-		(void)freerdp_bio_read_pem_with_policy(bio, &pem, pLength);
+	//https://datatracker.ietf.org/doc/html/rfc7299
+	if (freerdp_certificate_policies(cert, "2.23.140.1.2.1")) {
+		(void)freerdp_bio_read_pem_with_policy(bio, &pem, &len);
 	} else {
-		(void)bio_read_pem(bio, &pem, pLength);
+		(void)bio_read_pem(bio, &pem, &len);
 	}
 
+	if (pem)
+	{
+		char* tmp = (char*)realloc(pem, len + 1);
+		if (!tmp)
+		{
+			WLog_ERR(TAG, "realloc failure");
+			free(pem);
+			pem = NULL;
+			len = 0;
+		}
+		else
+		{
+			pem = tmp;
+			pem[len] = '\0';
+		}
+	}
+
+	*pLength = len;
 fail:
 	BIO_free_all(bio);
 	return pem;
