diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..e69a55c40 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -256,7 +256,8 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
   struct Curl_easy *doh = NULL;
   CURLcode result = CURLE_OK;
   timediff_t timeout_ms;
-  DOHcode d = doh_req_encode(host, dnstype, p->req_body, sizeof(p->req_body),
+// FIXME: Crash CWE-457: Use of Uninitialized Variable
+   DOHcode d = doh_req_encode(host, dnstype, p->req_body, sizeof(p->req_body),
                              &p->req_body_len);
   if(d) {
     failf(data, "Failed to encode DoH packet [%d]", d);
@@ -268,8 +269,9 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
 
   timeout_ms = Curl_timeleft(data, NULL, TRUE);
   if(timeout_ms <= 0) {
-    result = CURLE_OPERATION_TIMEDOUT;
-    goto error;
+    /* Ensure DOH handle is NULL on timeout */
+    p->doh = NULL;
+    result = CURLE_OPERATION_TIMEDOUT;    goto error;
   }
   /* Curl_open() is the internal version of curl_easy_init() */
   result = Curl_open(&doh);
