diff --git a/lib/doh.c b/lib/doh.c
index 8769372e0..5b7fa1132 100644
--- a/lib/doh.c
+++ b/lib/doh.c
@@ -256,9 +256,14 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
   struct Curl_easy *doh = NULL;
   CURLcode result = CURLE_OK;
   timediff_t timeout_ms;
-  DOHcode d = doh_req_encode(host, dnstype, p->req_body, sizeof(p->req_body),
+  /* Initialize DOH handle to NULL to prevent uninitialized use */
+  p->doh = NULL;
+// FIXME: Crash CWE-457: Use of Uninitialized Variable
+   DOHcode d = doh_req_encode(host, dnstype, p->req_body, sizeof(p->req_body),
                              &p->req_body_len);
   if(d) {
+    /* Keep DOH handle NULL on error */
+    p->doh = NULL;
     failf(data, "Failed to encode DoH packet [%d]", d);
     return CURLE_OUT_OF_MEMORY;
   }
@@ -268,8 +273,9 @@ static CURLcode doh_run_probe(struct Curl_easy *data,
 
   timeout_ms = Curl_timeleft(data, NULL, TRUE);
   if(timeout_ms <= 0) {
-    result = CURLE_OPERATION_TIMEDOUT;
-    goto error;
+    /* Keep DOH handle NULL on timeout */
+    p->doh = NULL;
+    result = CURLE_OPERATION_TIMEDOUT;    goto error;
   }
   /* Curl_open() is the internal version of curl_easy_init() */
   result = Curl_open(&doh);
