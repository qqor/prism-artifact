{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-03_vuln_4",
  "source_directory": "/home/qqor/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.1119756,
    "prompt_tokens": 62676,
    "completion_tokens": 9780
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -219,7 +219,7 @@\n      * </p>\n      */\n     private static final Pattern PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN =\n-            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d*)?\");\n+            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d{1,9})?\");\n \n     private static FileTime fileTimeFromOptionalSeconds(final long seconds) {\n         return seconds <= 0 ? null : FileTimes.fromUnixTime(seconds);\n@@ -271,8 +271,20 @@\n         if (!PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN.matcher(value).matches()) {\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n         }\n-\n-        final BigDecimal epochSeconds = new BigDecimal(value);\n+        \n+        // Truncate fractional part to nanosecond precision to prevent oversized BigDecimal scales\n+        String canonical = value;\n+        int dot = canonical.indexOf('.');\n+        if (dot >= 0) {\n+            String intPart = canonical.substring(0, dot);\n+            String frac = canonical.substring(dot + 1);\n+            if (frac.length() > 9) {\n+                frac = frac.substring(0, 9);\n+            }\n+            canonical = intPart + \".\" + frac;\n+        }\n+\n+        final BigDecimal epochSeconds = new BigDecimal(canonical);\n         final long seconds = epochSeconds.longValue();\n         final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n         try {\n",
  "stdout": "",
  "stderr": ""
}