--- a/libfreerdp/crypto/x509_utils.c
+++ b/libfreerdp/crypto/x509_utils.c
@@ -448,14 +448,20 @@
         GENERAL_NAME *gen_name = sk_GENERAL_NAME_value(san_names, i);
 
         if (gen_name->type == GEN_DNS) {
-			// Allocate string length + 1 for security
-			dns_name = malloc( strlen((char *)ASN1_STRING_get0_data(gen_name->d.dNSName)) + 1);
+			/* Determine the correct byte length of the DNS name */
+			size_t san_len = (size_t)ASN1_STRING_length(gen_name->d.dNSName);
+
+			/* Allocate san_len + 1 bytes to hold the string plus NUL */
+			dns_name = malloc(san_len + 1);
 
 			if (dns_name == NULL)
 				goto end;
-			
-			memcpy(dns_name, (char *)ASN1_STRING_get0_data(gen_name->d.dNSName),  
-				ASN1_STRING_length(gen_name->d.dNSName)) ;
+
+			/* Copy the exact bytes and NUL-terminate */
+			memcpy(dns_name,
+			       ASN1_STRING_get0_data(gen_name->d.dNSName),
+			       san_len);
+			dns_name[san_len] = '\0';
 			
             if (!verify_san(dns_name)) {
 				free(dns_name);
