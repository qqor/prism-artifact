--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1851,16 +1851,20 @@
 	WINPR_ASSERT(mcs);
 
 	const size_t blockLength = Stream_GetRemainingLength(s);
-	if (blockLength < 4)
-		return FALSE;
-
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
-
-	if (mcs->channelCount > CHANNEL_MAX_COUNT)
-		return FALSE;
+	if (blockLength < 1)
+		return FALSE;
+
+	UINT8 count = 0;
+	Stream_Read_UINT8(s, count); /* channelCount */
+
+	if (count > CHANNEL_MAX_COUNT)
+		return FALSE;
+
+	/* name (CHANNEL_NAME_LEN+1) + options (4 bytes) per channel */
+	if ((blockLength - 1) < (size_t)count * (CHANNEL_NAME_LEN + 1 + 4))
+		return FALSE;
+
+	mcs->channelCount = count;
 
 	/* channelDefArray */
 	for (UINT32 i = 0; i < mcs->channelCount; i++)
