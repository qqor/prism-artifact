{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_004",
  "source_directory": "/tasks_new/freerdp_fp-full-01/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.3989568,
    "prompt_tokens": 144664,
    "completion_tokens": 54506
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/core/gcc.c\n+++ b/libfreerdp/core/gcc.c\n@@ -1851,16 +1851,20 @@\n \tWINPR_ASSERT(mcs);\n \n \tconst size_t blockLength = Stream_GetRemainingLength(s);\n-\tif (blockLength < 4)\n-\t\treturn FALSE;\n-\n-\tStream_Read_UINT8(s, mcs->channelCount); /* channelCount */\n-\n-\tif (blockLength < 4 + (UINT8)mcs->channelCount * 12)\n-\t\treturn FALSE;\n-\n-\tif (mcs->channelCount > CHANNEL_MAX_COUNT)\n-\t\treturn FALSE;\n+\tif (blockLength < 1)\n+\t\treturn FALSE;\n+\n+\tUINT8 count = 0;\n+\tStream_Read_UINT8(s, count); /* channelCount */\n+\n+\tif (count > CHANNEL_MAX_COUNT)\n+\t\treturn FALSE;\n+\n+\t/* name (CHANNEL_NAME_LEN+1) + options (4 bytes) per channel */\n+\tif ((blockLength - 1) < (size_t)count * (CHANNEL_NAME_LEN + 1 + 4))\n+\t\treturn FALSE;\n+\n+\tmcs->channelCount = count;\n \n \t/* channelDefArray */\n \tfor (UINT32 i = 0; i < mcs->channelCount; i++)\n",
  "stdout": "",
  "stderr": ""
}