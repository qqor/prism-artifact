[2;36m[12/28/25 12:43:36][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=905864;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=39145;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmprdg62a_r[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/freerdp_fp-delta-01_vuln_001/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766925816.4217048[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-01_vuln_001.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=838323;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=321947;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/28/25 12:44:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=361652;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51827;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m31.97[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=114493;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=592607;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=283485;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=747729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=253683;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=862307;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m31[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=514129;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=279221;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:44:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.94[0m seconds;               ]8;id=358666;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=518400;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 12:44:10][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=887897;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=749497;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=968405;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=475000;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=862446;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=651785;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=877823;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=702258;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:44:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.10[0m seconds;               ]8;id=636237;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=877457;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=564291;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=705283;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:44:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=226619;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=818709;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 12:44:15][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=720503;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=108161;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2078885108[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171026af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a171028e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171028e80[0m[39m,[0m[1;36m0x55a17104c770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a170ce7f4f[0m[39m bp [0m[1;36m0x7ffc58af1740[0m[39m sp [0m[1;36m0x7ffc58af1738[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a170cdfbb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a170cdf277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a170b960f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55a170b81365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a170b86dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55a170bb20a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f85b179c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55a170b7954d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmprh1_3gdl[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2078885108[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171026af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a171028e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171028e80[0m[39m,[0m[1;36m0x55a17104c770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a170ce7f4f[0m[39m bp [0m[1;36m0x7ffc58af1740[0m[39m sp [0m[1;36m0x7ffc58af1738[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a170cdfbb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a170cdf277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a170b960f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55a170b81365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a170b86dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55a170bb20a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f85b179c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55a170b7954d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000010200[0m: fa fa fa fa fa fa[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010400[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmprh1_3gdl[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m.                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/28/25 12:44:23][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=342779;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=292333;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 12:45:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=591000;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=538929;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 12:45:26][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=866329;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=261566;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=809449;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=191505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:45:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.94[0m seconds;               ]8;id=391442;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=700310;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=805917;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=4868;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpsq7bx6ot[0m                                                 ]8;id=346930;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=314971;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/28/25 12:45:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m23.26[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=365795;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=783988;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=143814;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=677863;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:46:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m12.81[0m seconds;             ]8;id=365916;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=212373;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=155154;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=177059;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:46:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m2.32[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=917211;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=256947;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=134022;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=234748;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=254480;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=298307;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=431316;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=328419;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:46:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.93[0m seconds;               ]8;id=120157;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=690977;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=86518;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=406689;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:46:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.07[0m seconds;               ]8;id=857743;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=17561;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=212327;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=277137;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:46:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.91[0m seconds;               ]8;id=543374;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=764397;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=519336;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=626498;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         @@ [1;36m-1534[0m,[1;36m9[0m +[1;36m1534[0m,[1;36m9[0m @@                                                               [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mbio[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mppem[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       const uint16_t blocksize = [1;36m2048[0m;                                            [2m                [0m
[2;36m                    [0m         -       uint16_t offset = [1;36m0[0m;                                                        [2m                [0m
[2;36m                    [0m         -       uint16_t length = blocksize;                                                [2m                [0m
[2;36m                    [0m         +       const size_t blocksize = [1;36m2048[0m;                                              [2m                [0m
[2;36m                    [0m         +       size_t offset = [1;36m0[0m;                                                          [2m                [0m
[2;36m                    [0m         +       size_t length = blocksize;                                                  [2m                [0m
[2;36m                    [0m                 char* pem = NULL;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 *ppem = NULL;                                                               [2m                [0m
[2;36m                    [0m         @@ [1;36m-1545[0m,[1;36m6[0m +[1;36m1545[0m,[1;36m10[0m @@                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 while [1m([0mstatus != [1;36m0[0m[1m)[0m                                                         [2m                [0m
[2;36m                    [0m                 [1m{[0m                                                                           [2m                [0m
[2;36m                    [0m         +               [35m/[0m* Prevent size_t wrap on very large inputs *[35m/[0m                      [2m                [0m
[2;36m                    [0m         +               if [1m([0mlength > SIZE_MAX - blocksize - [1;36m1[0m[1m)[0m                              [2m                [0m
[2;36m                    [0m         +                       goto fail;                                                  [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m                         char* tmp = [1;35mrealloc[0m[1m([0mpem, length + [1;36m1[0m[1m)[0m;                               [2m                [0m
[2;36m                    [0m                         if [1m([0m!tmp[1m)[0m                                                           [2m                [0m
[2;36m                    [0m                                 goto fail;                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-1553[0m,[1;36m7[0m +[1;36m1557[0m,[1;36m11[0m @@                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                         [1;35mERR_clear_error[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -               status = [1;35mBIO_read[0m[1m([0mbio, &pem[1m[[0moffset[1m][0m, [1m([0mint[1m)[0m[1m([0mlength - offset[1m)[0m[1m)[0m;       [2m                [0m
[2;36m                    [0m         +               [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m         +                       size_t toRead = length - offset;                            [2m                [0m
[2;36m                    [0m         +                       int chunk = [1m([0mtoRead > INT_MAX[1m)[0m ? INT_MAX : [1m([0mint[1m)[0mtoRead;     [2m                [0m
[2;36m                    [0m         +                       status = [1;35mBIO_read[0m[1m([0mbio, &pem[1m[[0moffset[1m][0m, chunk[1m)[0m;                [2m                [0m
[2;36m                    [0m         +               [1m}[0m                                                                   [2m                [0m
[2;36m                    [0m                         if [1m([0mstatus [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2078885108[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171026af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a171028e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171028e80[0m[39m,[0m[1;36m0x55a17104c770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a170ce7f4f[0m[39m bp [0m[1;36m0x7ffc58af1740[0m[39m sp [0m[1;36m0x7ffc58af1738[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a170cdfbb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a170cdf277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a170b960f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55a170b81365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a170b86dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55a170bb20a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f85b179c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55a170b7954d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmprh1_3gdl[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow was detected by AddressSanitizer when running the [0m           [2m                [0m
[2;36m                    [0m         [39m`TestFuzzCryptoCertificateDataSetPEM` fuzz target. The overflow occurs in the [0m      [2m                [0m
[2;36m                    [0m         [39mfunction `freerdp_bio_read_pem_with_policy` [0m[1;39m([0m[39min `certificate.c`[0m[1;39m)[0m[39m as a one-byte [0m     [2m                [0m
[2;36m                    [0m         [39mwrite past the end of an allocated buffer. The crash is reached via the certificate[0m [2m                [0m
[2;36m                    [0m         [39mloading and parsing routines [0m[1;39m([0m[39m`freerdp_certificate_get_pem_ex`, [0m                    [2m                [0m
[2;36m                    [0m         [39m`freerdp_certificate_data_load_cache`, etc.[0m[1;39m)[0m[39m when processing a PEM testcase [0m        [2m                [0m
[2;36m                    [0m         [39mprovided by the fuzzer.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  AddressSanitizer reports a heap-buffer-overflow in FreeRDP’s certificate handling[0m [2m                [0m
[2;36m                    [0m         [39mcode. The specific error is a one-byte write outside the bounds of a heap [0m          [2m                [0m
[2;36m                    [0m         [39mallocation.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- How the issue manifests  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m  While fuzzing with libFuzzer [0m[1;39m([0m[39m`TestFuzzCryptoCertificateDataSetPEM`[0m[1;39m)[0m[39m, the [0m        [2m                [0m
[2;36m                    [0m         [39msanitizer log shows:  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m    • ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m  [0m     [2m                [0m
[2;36m                    [0m         [39m    • WRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0  [0m                                 [2m                [0m
[2;36m                    [0m         [39m    • SCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m[39m  [0m           [2m                [0m
[2;36m                    [0m         [39m    • Address [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m[1;36m0x1[0m[39m. [0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m  The shadow memory dump indicates that the offending write target lies in a heap [0m  [2m                [0m
[2;36m                    [0m         [39mredzone [0m[1;39m([0m[39m`fa` bytes[0m[1;39m)[0m[39m, confirming an out-of-bounds write.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Crash stack trace highlights  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. freerdp_bio_read_pem_with_policy [0m[1;39m([0m[39mcertificate.[0m[1;92mc:1570[0m[1;39m)[0m[39m  [0m                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. freerdp_certificate_get_pem_ex [0m[1;39m([0m[39mcertificate.[0m[1;92mc:1634[0m[1;39m)[0m[39m  [0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. freerdp_certificate_data_load_cache [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:84[0m[1;39m)[0m[39m  [0m                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. freerdp_certificate_data_new_nocopy [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:126[0m[1;39m)[0m[39m  [0m               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m5[0m[39m. freerdp_certificate_data_new_from_pem [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:155[0m[1;39m)[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m6[0m[39m. LLVMFuzzerTestOneInput [0m[1;39m([0m[39mTestFuzzCryptoCertificateDataSetPEM.[0m[1;92mc:13[0m[1;39m)[0m[39m  [0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Important observations  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m    • The overflow is triggered during PEM reading/parsing under a “policy” path.  [0m [2m                [0m
[2;36m                    [0m         [39m    • The wild pointer lies immediately beyond a one-byte region, suggesting an [0m    [2m                [0m
[2;36m                    [0m         [39moff-by-one or buffer-size miscalculation.  [0m                                         [2m                [0m
[2;36m                    [0m         [39m    • The fuzz harness repeatedly loads a single input [0m[1;36m100[0m[39m times under libFuzzer [0m   [2m                [0m
[2;36m                    [0m         [39mwith an entropic power schedule.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code areas for investigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m    – `libfreerdp/crypto/certificate.c`, especially [0m                                [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` and `freerdp_certificate_get_pem_ex`.  [0m          [2m                [0m
[2;36m                    [0m         [39m    – `libfreerdp/crypto/certificate_data.c`, in the functions that allocate or [0m    [2m                [0m
[2;36m                    [0m         [39mwrap certificate buffers [0m[1;39m([0m[39m`freerdp_certificate_data_load_cache`, [0m                   [2m                [0m
[2;36m                    [0m         [39m`freerdp_certificate_data_new_nocopy`, `freerdp_certificate_data_new_from_pem`[0m[1;39m)[0m[39m.  [0m  [2m                [0m
[2;36m                    [0m         [39m    – The fuzz harness entry point [0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`core/test/TestFuzzCryptoCertificateDataSetPEM.c`[0m[1;39m)[0m[39m to understand how the input is [0m [2m                [0m
[2;36m                    [0m         [39mfed into the PEM reader.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis issue warrants a review of buffer allocations and write loops in the PEM [0m      [2m                [0m
[2;36m                    [0m         [39mparsing and policy-enforcement routines to determine how the one-byte overflow [0m     [2m                [0m
[2;36m                    [0m         [39moccurs.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2078885108[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171026af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a171028e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x55a171028e80[0m[39m,[0m[1;36m0x55a17104c770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a170ce7f4f[0m[39m bp [0m[1;36m0x7ffc58af1740[0m[39m sp [0m[1;36m0x7ffc58af1738[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a170ce7f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a170cdf861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a170cdfbb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a170cdf277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a170b960f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55a170b81365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a170b86dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55a170bb20a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f85b179c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55a170b7954d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmprh1_3gdl[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1580[0m[39m-[0m[1;36m1700[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1582:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* pLength[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:   [0m[39mreturn [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mcert, pLength, TRUE[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1644:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_subject[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1650:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_issuer[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1656:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_upn[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_upn[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1662:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_email[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_email[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1668:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_validity[0m[1;39m([0m[39mconst rdpCertificate* cert, BOOL [0m       [2m                [0m
[2;36m                    [0m         [39mstartDate[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_date[0m[1;39m([0m[39mcert->x509, startDate[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1674:B[0m[39mOOL [0m[1;35mfreerdp_certificate_check_eku[0m[1;39m([0m[39mconst rdpCertificate* cert, int nid[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_check_eku[0m[1;39m([0m[39mcert->x509, nid[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1678[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1679[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1680:B[0m[39mOOL [0m[1;35mfreerdp_certificate_get_public_key[0m[1;39m([0m[39mconst rdpCertificate* cert, BYTE** [0m    [2m                [0m
[2;36m                    [0m         [39mPublicKey,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1681[0m[39m:                                        DWORD* PublicKeyLength[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1682[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1683[0m[39m:   [0m[39mBYTE* ptr = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1684[0m[39m:   [0m[39mBYTE* optr = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1685[0m[39m:   [0m[39mint length = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1686[0m[39m:   [0m[39mBOOL status = FALSE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1687[0m[39m:   [0m[39mEVP_PKEY* pkey = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1688[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1689[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1690[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1691[0m[39m:   [0m[39mpkey = [0m[1;35mX509_get0_pubkey[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1692[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1693[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!pkey[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1694[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1695[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"X509_get_pubkey[0m[32m([0m[32m)[0m[32m failed"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1696[0m[39m:   [0m[39m        [0m[39mgoto exit;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1697[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1698[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1699[0m[39m:   [0m[39mlength = [0m[1;35mi2d_PublicKey[0m[1;39m([0m[39mpkey, NULL[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1700[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1640[0m[39m-[0m[1;36m1700[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1644:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_subject[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1650:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_issuer[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1656:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_upn[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_upn[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1662:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_email[0m[1;39m([0m[39mconst rdpCertificate* cert[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_email[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1668:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_validity[0m[1;39m([0m[39mconst rdpCertificate* cert, BOOL [0m       [2m                [0m
[2;36m                    [0m         [39mstartDate[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_get_date[0m[1;39m([0m[39mcert->x509, startDate[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1674:B[0m[39mOOL [0m[1;35mfreerdp_certificate_check_eku[0m[1;39m([0m[39mconst rdpCertificate* cert, int nid[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:   [0m[39mreturn [0m[1;35mx509_utils_check_eku[0m[1;39m([0m[39mcert->x509, nid[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1678[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1679[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1680:B[0m[39mOOL [0m[1;35mfreerdp_certificate_get_public_key[0m[1;39m([0m[39mconst rdpCertificate* cert, BYTE** [0m    [2m                [0m
[2;36m                    [0m         [39mPublicKey,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1681[0m[39m:                                        DWORD* PublicKeyLength[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1682[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1683[0m[39m:   [0m[39mBYTE* ptr = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1684[0m[39m:   [0m[39mBYTE* optr = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1685[0m[39m:   [0m[39mint length = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1686[0m[39m:   [0m[39mBOOL status = FALSE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1687[0m[39m:   [0m[39mEVP_PKEY* pkey = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1688[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1689[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1690[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1691[0m[39m:   [0m[39mpkey = [0m[1;35mX509_get0_pubkey[0m[1;39m([0m[39mcert->x509[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1692[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1693[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!pkey[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1694[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1695[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"X509_get_pubkey[0m[32m([0m[32m)[0m[32m failed"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1696[0m[39m:   [0m[39m        [0m[39mgoto exit;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1697[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1698[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1699[0m[39m:   [0m[39mlength = [0m[1;35mi2d_PublicKey[0m[1;39m([0m[39mpkey, NULL[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1700[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   The one-byte heap overflow in `freerdp_bio_read_pem_with_policy` is caused by [0m   [2m                [0m
[2;36m                    [0m         [39musing [0m[1;36m16[0m[39m-bit counters [0m[1;39m([0m[39m`uint16_t offset` and `uint16_t length`[0m[1;39m)[0m[39m. As soon as [0m        [2m                [0m
[2;36m                    [0m         [39maccumulated `offset` or `length` surpasses [0m[1;36m65[0m[39m [0m[1;36m535[0m[39m, the variables wrap around, [0m      [2m                [0m
[2;36m                    [0m         [39mleading to under- or over-allocation. The final write  [0m                             [2m                [0m
[2;36m                    [0m         [39m      pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   then lands outside the [0m[1;39m([0m[39mwrapped[0m[1;39m)[0m[39m allocation, tripping AddressSanitizer.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Core Fix  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   a. Change the types of `blocksize`, `offset`, and `length` from `uint16_t` to [0m   [2m                [0m
[2;36m                    [0m         [39m`size_t`, so they can grow without wrapping for realistic PEM sizes.  [0m              [2m                [0m
[2;36m                    [0m         [39m   b. After switching to `size_t`, clamp the requested read size to `INT_MAX` when [0m [2m                [0m
[2;36m                    [0m         [39mpassing to `BIO_read`, since it expects an `int`.  [0m                                 [2m                [0m
[2;36m                    [0m         [39m   c. Add a defensive check to prevent `length + blocksize` from overflowing [0m       [2m                [0m
[2;36m                    [0m         [39m`SIZE_MAX - [0m[1;36m1[0m[39m` before each `realloc`.  [0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Patch Steps  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m   In libfreerdp/crypto/certificate.c → `freerdp_bio_read_pem_with_policy`:[0m         [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m1[0m[39m. Replace:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         const uint16_t blocksize = [0m[1;36m2048[0m[39m;  [0m                                         [2m                [0m
[2;36m                    [0m         [39m         uint16_t offset = [0m[1;36m0[0m[39m;  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m         uint16_t length = blocksize;  [0m                                             [2m                [0m
[2;36m                    [0m         [39m      with:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m         const size_t blocksize = [0m[1;36m2048[0m[39m;  [0m                                           [2m                [0m
[2;36m                    [0m         [39m         size_t offset = [0m[1;36m0[0m[39m;  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m         size_t length = blocksize;  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m2[0m[39m. Before `realloc`, add:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Prevent size_t wrap on very large inputs  [0m                              [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mlength > SIZE_MAX - blocksize - [0m[1;36m1[0m[1;39m)[0m[39m  [0m                                   [2m                [0m
[2;36m                    [0m         [39m          goto fail;  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m3[0m[39m. Compute the read chunk safely:[0m                                                [2m                [0m
[2;36m                    [0m         [39m         size_t toRead = length - offset;  [0m                                         [2m                [0m
[2;36m                    [0m         [39m         int chunk = [0m[1;39m([0m[39mtoRead > INT_MAX[0m[1;39m)[0m[39m ? INT_MAX : [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mtoRead;  [0m                  [2m                [0m
[2;36m                    [0m         [39m         status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, chunk[0m[1;39m)[0m[39m;  [0m                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m4[0m[39m. Keep the rest of the loop logic unchanged so that we still:[0m                   [2m                [0m
[2;36m                    [0m         [39m      – [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m      – advance `offset` by `status`  [0m                                              [2m                [0m
[2;36m                    [0m         [39m      – bump `length` by `blocksize`  [0m                                              [2m                [0m
[2;36m                    [0m         [39m      – break on `status == [0m[1;36m0[0m[39m`  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m5[0m[39m. The final `pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;` and setting `*plength = offset` remain valid,[0m [2m                [0m
[2;36m                    [0m         [39msince `offset < length`, and the buffer is `length + [0m[1;36m1[0m[39m` bytes long.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Preservation of Existing Behavior  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   – The only logic altered is the integer width of the counters.  [0m                 [2m                [0m
[2;36m                    [0m         [39m   – Fuzzing entry points and all callers [0m[1;39m([0m[39mincluding the policy check in [0m           [2m                [0m
[2;36m                    [0m         [39m`freerdp_certificate_get_pem_ex`[0m[1;39m)[0m[39m remain untouched.  [0m                               [2m                [0m
[2;36m                    [0m         [39m   – No harness or test code is modified; existing tests for normal-sized [0m          [2m                [0m
[2;36m                    [0m         [39mcertificates will continue to pass.  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   – We maintain chunked reads of [0m[1;36m2[0m[39m [0m[1;36m048[0m[39m bytes per iteration, exactly as before.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Side-Effects and Mitigations  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   – Certificates larger than ~[0m[1;36m2[0m[39m [0m[1;36m147[0m[39m [0m[1;36m483[0m[39m [0m[1;36m647[0m[39m bytes per read iteration are clamped [0m  [2m                [0m
[2;36m                    [0m         [39mto `INT_MAX`; this is well beyond any plausible PEM certificate size.  [0m             [2m                [0m
[2;36m                    [0m         [39m   – The overflow guard [0m[1;39m([0m[39m`length > SIZE_MAX - blocksize - [0m[1;36m1[0m[39m`[0m[1;39m)[0m[39m will silently fail on[0m [2m                [0m
[2;36m                    [0m         [39mastronomic inputs, returning `FALSE`. This is acceptable given unbounded Fuzzer [0m    [2m                [0m
[2;36m                    [0m         [39minput; legitimate certificates are orders of magnitude smaller.  [0m                   [2m                [0m
[2;36m                    [0m         [39m   – Memory usage will grow according to the certificate size, as intended.  [0m       [2m                [0m
[2;36m                    [0m         [39m   – No other code paths or utility functions are modified, so the broader FreeRDP [0m [2m                [0m
[2;36m                    [0m         [39mlogic is unaffected.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Testing  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   – Run existing fuzz target `TestFuzzCryptoCertificateDataSetPEM` to confirm no [0m  [2m                [0m
[2;36m                    [0m         [39mmore heap-buffer-overflow.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   – Fuzz with large synthetic PEMs up to ~[0m[1;36m100[0m[39m MB to verify no [0m[1;36m16[0m[39m-bit wraparound [0m   [2m                [0m
[2;36m                    [0m         [39mand correct NUL-termination.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   – Exercise `bio_read_pem` path [0m[1;39m([0m[39mnon-policy[0m[1;39m)[0m[39m to ensure behavior remains [0m          [2m                [0m
[2;36m                    [0m         [39mconsistent.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBy widening the counters to `size_t` and clamping the BIO read arguments, we [0m       [2m                [0m
[2;36m                    [0m         [39meliminate the off-by-one caused by [0m[1;36m16[0m[39m-bit wrapping, fully resolving the [0m            [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow while preserving all existing certificate parsing behavior.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=721436;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=877020;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=707938;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=423151;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmprdg62a_r[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/freerdp_fp-delta-01_vuln_001/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766925970.6636665[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-01_vuln_001.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/28/25 12:46:11][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=241505;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=360179;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=572278;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=240203;file:///home/user/crete/scripts/benchmark/__main__.py#309\[2m309[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=633;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=535012;file:///home/user/crete/scripts/benchmark/__main__.py#312\[2m312[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
