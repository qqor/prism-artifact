[10/26/25 20:51:08] INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpxvbdk0fe                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711                                                                        
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_8.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Started...                                                                                 context_managers.py:9
[10/26/25 20:52:28] INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Took 80.43 seconds; exception=False                                                       context_managers.py:23
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Started...                                                                        context_managers.py:9
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False                                               context_managers.py:23
                    INFO     Setting timeouts                                                                                                                                                       default.py:85
                               - build: 600 (original: 80)                                                                                                                                                       
                               - run tests: 600 (original: 0)                                                                                                                                                    
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:52:29] INFO     [logging_performance](pdfbox Setting owner) Took 1.08 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 20:52:30] INFO     Successfully created Cached for CLEAN environment                                                                                                                    oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                                                            oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                                                 
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:52:32] INFO     [logging_performance](pdfbox Setting owner) Took 1.30 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:52:33] INFO     [logging_performance](pdfbox Setting owner) Took 0.95 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 20:53:04] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:53:05] INFO     [logging_performance](pdfbox Setting owner) Took 0.89 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Running a pov) Started...                                                                                                         context_managers.py:9
[10/26/25 20:53:36] INFO     [logging_performance](pdfbox Running a pov) Took 30.74 seconds; exception=True                                                                                context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                                                              __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:53:37] INFO     [logging_performance](pdfbox Setting owner) Took 0.95 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 20:54:08] INFO     Found jstack output at /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                                                                      __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Analysis Report===                                                                                                                                                               
                                                                                                                                                                                                                 
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 20:54:18] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 20:55:31] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 20:56:16] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:56:17] INFO     [logging_performance](pdfbox Setting owner) Took 1.04 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmp_az__xsc                                                                                                                                 default.py:173
[10/26/25 20:57:15] INFO     [logging_performance](pdfbox Patching) Took 58.10 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                                                                                                        context_managers.py:9
[10/26/25 20:57:30] INFO     [logging_performance](pdfbox Checking build) Took 14.68 seconds; exception=False                                                                              context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                                                                                                           context_managers.py:9
[10/26/25 20:58:01] ERROR    PoV found:                                                                                                                                                           __init__.py:102
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 21 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 4 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f969070ca00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3415445924                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x55eb5d7e4f60, 0x55eb5d7e5160),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x55eb5d7a3b70,0x55eb5d7a5b70),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 12 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 7 ms, size +14%)                                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 10 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 6 ms, size +1%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 0 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 11 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 83 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 5 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 2 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 2 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 1 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 0 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 2 ms, size +9%)                                                                                                 
                             2025-10-26T20:57:34.873954294Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 8 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 0 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 1 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 3 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 31 ms, size +21%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 17 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 12 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 8 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 1 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 1 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceCmpInt(Native Method)                                                                             
                                     at app//org.apache.pdfbox.io.RandomAccessReadBuffer.read(RandomAccessReadBuffer.java:211)                                                                                   
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1352)                                                                                             
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                 
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:389)                                                                         
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                      
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                            
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                               
                                     at app//org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                           
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                              
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                     
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                     
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                   
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                   
                                     at app//com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                   
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaForm$DMH)                                                                     
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                                                                                 
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                                                                              
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                              
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                   
                                     at app//com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                          
                                     at app//com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                            
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 113 collections took 141ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmpyttne65j:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                    ERROR    PoV found:                                                                                                                                                           __init__.py:103
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 21 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 4 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f969070ca00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3415445924                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x55eb5d7e4f60, 0x55eb5d7e5160),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x55eb5d7a3b70,0x55eb5d7a5b70),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 12 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 7 ms, size +14%)                                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 10 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 6 ms, size +1%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 0 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 11 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 83 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 5 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 2 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 2 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 1 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 0 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 2 ms, size +9%)                                                                                                 
                             2025-10-26T20:57:34.873954294Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 8 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 0 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 1 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 3 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 31 ms, size +21%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 17 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 12 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 8 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 1 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 1 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceCmpInt(Native Method)                                                                             
                                     at app//org.apache.pdfbox.io.RandomAccessReadBuffer.read(RandomAccessReadBuffer.java:211)                                                                                   
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1352)                                                                                             
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                 
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:389)                                                                         
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                      
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                            
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                               
                                     at app//org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                           
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                              
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                     
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                     
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                   
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                   
                                     at app//com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                   
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaForm$DMH)                                                                     
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                                                                                 
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                                                                              
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                              
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                   
                                     at app//com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                          
                                     at app//com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                            
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 113 collections took 141ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmpyttne65j:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                              Traceback (most recent call last)                 
                              /home/benchmark/crete/packages/crete/framework/evaluator/services/default/__init__.py:97 in _evaluate_internal                                                                   
                                                                                                                                                                                                               
                                 94       with logging_performance(context, header="Running PoV"):                                                                                                           
                                 95          try:                                                                                                                                                           
                                 96             if len(detection.blobs) > 0:                                                                                                                               
                                97                environment.run_pov(context, detection)                                                                                                                
                                 98             else:                                                                                                                                                      
                                 99                context["logger"].warning("No blob data found for the detection")                                                                                      
                                100                                                                                                                                                                            
                                                                                                                                                                                                               
                              /home/benchmark/crete/packages/crete/framework/environment/services/oss_fuzz/cached.py:56 in run_pov                                                                             
                                                                                                                                                                                                               
                                 53       self, context: EnvironmentContext, detection: Detection                                                                                                            
                                 54    ) -> tuple[str, str]:                                                                                                                                                  
                                 55       assert len(detection.blobs) > 0, "At least one blob is required"                                                                                                   
                                56       return self.environment.run_pov(context, detection)                                                                                                                
                                 57                                                                                                                                                                           
                                 58    def run_tests(                                                                                                                                                         
                                 59       self, context: EnvironmentContext, env: dict[str, str] = {}                                                                                                        
                                                                                                                                                                                                               
                              /home/benchmark/crete/packages/crete/framework/environment/services/oss_fuzz/default.py:210 in run_pov                                                                           
                                                                                                                                                                                                               
                                207             context, blobinfo.blob, blobinfo.harness_name                                                                                                              
                                208          )                                                                                                                                                              
                                209          if not success:                                                                                                                                                
                               210             raise ChallengePoVFoundError(                                                                                                                              
                                211                stdout=stdout.encode(errors="ignore"),                                                                                                                 
                                212                stderr=stderr.encode(errors="ignore"),                                                                                                                 
                                213             )                                                                                                                                                          
                                             
                             ChallengePoVFoundError: PoV found:                                                                                                                                                  
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 21 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 4 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f969070ca00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3415445924                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x55eb5d7e4f60, 0x55eb5d7e5160),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x55eb5d7a3b70,0x55eb5d7a5b70),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 12 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 7 ms, size +14%)                                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 10 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 6 ms, size +1%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 0 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 11 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 83 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 5 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 2 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 2 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 1 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 0 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 2 ms, size +9%)                                                                                                 
                             2025-10-26T20:57:34.873954294Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 8 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 0 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 1 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 3 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 31 ms, size +21%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 17 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 12 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 8 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 1 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 1 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceCmpInt(Native Method)                                                                             
                                     at app//org.apache.pdfbox.io.RandomAccessReadBuffer.read(RandomAccessReadBuffer.java:211)                                                                                   
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1352)                                                                                             
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                 
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:389)                                                                         
                                     at app//org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                      
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                            
                                     at app//org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                               
                                     at app//org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                           
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                              
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                     
                                     at app//org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                     
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                   
                                     at app//org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                   
                                     at app//com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                   
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaForm$DMH)                                                                     
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                                                                                 
                                     at java.base@17.0.2/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                                                                              
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                              
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                      
                                     at app//com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                   
                                     at app//com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                          
                                     at app//com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                            
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 113 collections took 141ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmpyttne65j:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Running PoV) Took 30.85 seconds; exception=False                                                                                 context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:58:02] INFO     [logging_performance](pdfbox Setting owner) Took 1.05 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:58:04] INFO     [logging_performance](pdfbox Setting owner) Took 1.03 seconds; exception=False                                                                                context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                                                              __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 20:58:05] INFO     [logging_performance](pdfbox Setting owner) Took 1.05 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 20:58:35] INFO     Found jstack output at /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                                                                      __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             @@ -339,8 +339,13 @@                                                                                                                                                                
                                  private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                               
                                  {                                                                                                                                                                              
                                      int c = source.read();                                                                                                                                                     
                             +        int readCount = 0;                                                                                                                                                         
                                      while (c != -1 && c != '/' && c != '>')                                                                                                                                    
                                      {                                                                                                                                                                          
                             +            if (++readCount > MAX_SKIP_CHARS)                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded max read characters in COS dictionary at offset " + source.getPosition());                                                         
                             +            }                                                                                                                                                                      
                                          // in addition to stopping when we find / or >, we also want                                                                                                           
                                          // to stop when we find endstream or endobj.                                                                                                                           
                                          if (c == E)                                                                                                                                                            
                             @@ -1316,18 +1321,29 @@                                                                                                                                                             
                                   *                                                                                                                                                                             
                                   * @throws IOException If there is an error reading from the stream.                                                                                                           
                                   */                                                                                                                                                                            
                             +    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                               
                             +                                                                                                                                                                                   
                                  protected void skipSpaces() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                                      int c = source.read();                                                                                                                                                     
                             +        int skipCount = 0;                                                                                                                                                         
                                      // 37 is the % character, a comment                                                                                                                                        
                             -        while( isWhitespace(c) || c == 37)                                                                                                                                         
                             -        {                                                                                                                                                                          
                             -            if ( c == 37 )                                                                                                                                                         
                             +        while (isWhitespace(c) || c == 37)                                                                                                                                         
                             +        {                                                                                                                                                                          
                             +            if (++skipCount > MAX_SKIP_CHARS)                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded max skip characters at offset " + source.getPosition());                                                                           
                             +            }                                                                                                                                                                      
                             +            if (c == 37)                                                                                                                                                           
                                          {                                                                                                                                                                      
                                              // skip past the comment section                                                                                                                                   
                                              c = source.read();                                                                                                                                                 
                             -                while(!isEOL(c) && c != -1)                                                                                                                                        
                             +                while (!isEOL(c) && c != -1)                                                                                                                                       
                                              {                                                                                                                                                                  
                             +                    if (++skipCount > MAX_SKIP_CHARS)                                                                                                                              
                             +                    {                                                                                                                                                              
                             +                        throw new IOException("Exceeded max skip characters in comment at offset " + source.getPosition());                                                        
                             +                    }                                                                                                                                                              
                                                  c = source.read();                                                                                                                                             
                                              }                                                                                                                                                                  
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:58:34                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3c2079fac0, length=14, elements={                                                                                                                         
                             0x0000564a010a1b70, 0x0000564a011acbf0, 0x0000564a011ae000, 0x0000564a011b7090,                                                                                                     
                             0x0000564a011b8410, 0x0000564a011b97f0, 0x0000564a011bb1f0, 0x0000564a011bc6f0,                                                                                                     
                             0x0000564a011bdb30, 0x0000564a011faad0, 0x0000564a011fdc10, 0x0000564a01383550,                                                                                                     
                             0x00007f3c50000e70, 0x0000564a018f2fa0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=25809.25ms elapsed=27.70s tid=0x0000564a010a1b70 nid=0x13 runnable  [0x00007ffe6eabf000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.util.regex.Pattern$Start.match(java.base@17.0.2/Pattern.java:3608)                                                                                                  
                                     at java.util.regex.Matcher.search(java.base@17.0.2/Matcher.java:1728)                                                                                                       
                                     at java.util.regex.Matcher.find(java.base@17.0.2/Matcher.java:745)                                                                                                          
                                     at java.util.regex.Pattern.split(java.base@17.0.2/Pattern.java:1265)                                                                                                        
                                     at java.lang.String.split(java.base@17.0.2/String.java:3150)                                                                                                                
                                     at java.lang.String.split(java.base@17.0.2/String.java:3196)                                                                                                                
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXrefTable(XrefParser.java:648)                                                                                               
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.87ms elapsed=27.65s tid=0x0000564a011acbf0 nid=0x16 waiting on condition  [0x00007f3c70589000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=27.65s tid=0x0000564a011ae000 nid=0x17 in Object.wait()  [0x00007f3c704a8000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894d5850> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894d5850> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=27.65s tid=0x0000564a011b7090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.62ms elapsed=27.65s tid=0x0000564a011b8410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=27.65s tid=0x0000564a011b97f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1574.22ms elapsed=27.65s tid=0x0000564a011bb1f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=825.42ms elapsed=27.65s tid=0x0000564a011bc6f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=52.98ms elapsed=27.65s tid=0x0000564a011bdb30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=27.63s tid=0x0000564a011faad0 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.89ms elapsed=27.63s tid=0x0000564a011fdc10 nid=0x23 in Object.wait()  [0x00007f3c67354000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894d9880> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894d9880> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=27.51s tid=0x0000564a01383550 nid=0x27 waiting on condition  [0x00007f3c6845d000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894d7b50> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.79ms elapsed=27.41s tid=0x00007f3c50000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=24.73s tid=0x0000564a018f2fa0 nid=0x27e in Object.wait()  [0x00007f3c66ca9000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a18bd78> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a18bd78> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=128.01ms elapsed=27.66s tid=0x0000564a011a8400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=65.87ms elapsed=27.68s tid=0x0000564a010b8da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=67.54ms elapsed=26.63s tid=0x00007f3c600015b0 nid=0x5c runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=61.37ms elapsed=26.63s tid=0x00007f3c60001fb0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=64.74ms elapsed=26.63s tid=0x00007f3c600029b0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=63.31ms elapsed=26.63s tid=0x00007f3c600033b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=68.14ms elapsed=26.63s tid=0x00007f3c60003db0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=51.17ms elapsed=26.63s tid=0x00007f3c600047b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=64.01ms elapsed=26.63s tid=0x00007f3c600051b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=66.97ms elapsed=26.63s tid=0x00007f3c60005bb0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=66.30ms elapsed=26.63s tid=0x00007f3c600065b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=49.22ms elapsed=26.63s tid=0x00007f3c60006fb0 nid=0x65 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=67.61ms elapsed=26.63s tid=0x00007f3c600079b0 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=60.31ms elapsed=26.63s tid=0x00007f3c600083b0 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=27.63s tid=0x0000564a011fc460 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A libFuzzer session testing the `PDFExtractTextFuzzer` harness terminated with a timeout. The main Java thread was observed consuming CPU time in PDFBoxs parsing                  
                             routinesspecifically within `BaseParser.skipSpaces` and related dictionary parsing methodsas it attempted to process a crafted PDF input. No crashes or                           
                             exceptions were reported; instead the session ended because the fuzzer exceeded its allotted execution time on a single test case.                                                  
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             - Issue type                                                                                                                                                                        
                               The fuzzer run resulted in a timeout (hang) rather than a crash or exception. In fuzzing contexts, such timeouts are often classified as Denial-of-Service (DoS)                  
                             conditions because a specially crafted input can stall the parser indefinitely.                                                                                                     
                                                                                                                                                                                                                 
                             - Observations and findings                                                                                                                                                         
                               1. The fuzzers `fuzzerTestOneInput` entry point invokes `Loader.loadPDF`, which in turn triggers PDFBoxs parsing stack.                                                         
                               2. The main thread (main #1) is marked RUNNABLE and has accrued over 26 seconds of CPU time at the point of termination.                                                        
                               3. The deepest stack frames show repeated calls in BaseParser:                                                                                                                    
                                   `traceConstCmpInt` (Jazzer instrumentation)                                                                                                                                  
                                   `BaseParser.skipSpaces(BaseParser.java:1323)`                                                                                                                                
                                   `parseCOSDictionaryValue`  `parseCOSDictionaryNameValuePair`  `parseCOSDictionary`                                                                                         
                                   `XrefParser.parseTrailer`  `XrefParser.parseXref`  `COSParser.retrieveTrailer`                                                                                             
                                   `PDFParser.initialParse`  `PDFParser.parse`                                                                                                                                 
                               4. No exceptions or error messages from PDFBox itselfonly the libFuzzer timeout banner.                                                                                          
                                                                                                                                                                                                                 
                             - Code areas for investigation                                                                                                                                                      
                               To understand the conditions that lead to this hang and to reproduce the behavior reliably, the following modules should be examined:                                             
                                `org.apache.pdfbox.pdfparser.BaseParser` (especially the `skipSpaces` implementation around line 1323 and the surrounding dictionary-parsing logic).                            
                                `org.apache.pdfbox.pdfparser.XrefParser` and `org.apache.pdfbox.pdfparser.COSParser` (trailer and cross-reference handling).                                                    
                                `org.apache.pdfbox.pdfparser.PDFParser` (entry points `initialParse` and `parse`).                                                                                              
                                The fuzzer harness in `com.example.PDFExtractTextFuzzer` to confirm any assumptions about resource limits or timeouts applied during fuzzing (though it is not                  
                             the root cause).                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1345-1380                                                                                                          
                             ```                                                                                                                                                                                 
                             1345:    /**                                                                                                                                                                        
                             1346:     * This will read a long from the Stream and throw an {@link IOException} if                                                                                               
                             1347:     * the long value is negative or has more than 10 digits (i.e. : bigger than                                                                                               
                             1348:     * {@link #OBJECT_NUMBER_THRESHOLD})                                                                                                                                       
                             1349:     *                                                                                                                                                                         
                             1350:     * @return the object number being read.                                                                                                                                   
                             1351:     * @throws IOException if an I/O error occurs                                                                                                                              
                             1352:     */                                                                                                                                                                        
                             1353:    protected long readObjectNumber() throws IOException                                                                                                                       
                             1354:    {                                                                                                                                                                          
                             1355:        long retval = readLong();                                                                                                                                              
                             1356:        if (retval < 0 || retval >= OBJECT_NUMBER_THRESHOLD)                                                                                                                   
                             1357:        {                                                                                                                                                                      
                             1358:            throw new IOException("Object Number '" + retval + "' has more than 10 digits or is negative");                                                                    
                             1359:        }                                                                                                                                                                      
                             1360:        return retval;                                                                                                                                                         
                             1361:    }                                                                                                                                                                          
                             1362:                                                                                                                                                                               
                             1363:    /**                                                                                                                                                                        
                             1364:     * This will read a integer from the Stream and throw an {@link IllegalArgumentException} if the integer value                                                             
                             1365:     * has more than the maximum object revision (i.e. : bigger than {@link #GENERATION_NUMBER_THRESHOLD})                                                                     
                             1366:     * @return the generation number being read.                                                                                                                               
                             1367:     * @throws IOException if an I/O error occurs                                                                                                                              
                             1368:     */                                                                                                                                                                        
                             1369:    protected int readGenerationNumber() throws IOException                                                                                                                    
                             1370:    {                                                                                                                                                                          
                             1371:        int retval = readInt();                                                                                                                                                
                             1372:        if(retval < 0 || retval > GENERATION_NUMBER_THRESHOLD)                                                                                                                 
                             1373:        {                                                                                                                                                                      
                             1374:            throw new IOException(                                                                                                                                             
                             1375:                    "Generation Number '" + retval + "' has more than 5 digits or is negative");                                                                               
                             1376:        }                                                                                                                                                                      
                             1377:        return retval;                                                                                                                                                         
                             1378:    }                                                                                                                                                                          
                             1379:                                                                                                                                                                               
                             1380:    /**                                                                                                                                                                        
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:300-340                                                                                                            
                             ```                                                                                                                                                                                 
                             300:                if (!parseCOSDictionaryNameValuePair(obj))                                                                                                                      
                             301:                {                                                                                                                                                               
                             302:                    return obj;                                                                                                                                                 
                             303:                }                                                                                                                                                               
                             304:            }                                                                                                                                                                   
                             305:            else                                                                                                                                                                
                             306:            {                                                                                                                                                                   
                             307:                // invalid dictionary, we were expecting a /Name, read until the end or until we can recover                                                                    
                             308:                LOG.warn("Invalid dictionary, found: '{}' but expected: '/' at offset {}", c,                                                                                   
                             309:                        source.getPosition());                                                                                                                                  
                             310:                if (readUntilEndOfCOSDictionary())                                                                                                                              
                             311:                {                                                                                                                                                               
                             312:                    // we couldn't recover                                                                                                                                      
                             313:                    return obj;                                                                                                                                                 
                             314:                }                                                                                                                                                               
                             315:            }                                                                                                                                                                   
                             316:        }                                                                                                                                                                       
                             317:        try                                                                                                                                                                     
                             318:        {                                                                                                                                                                       
                             319:            readExpectedChar('>');                                                                                                                                              
                             320:            readExpectedChar('>');                                                                                                                                              
                             321:        }                                                                                                                                                                       
                             322:        catch (IOException exception)                                                                                                                                           
                             323:        {                                                                                                                                                                       
                             324:            LOG.warn("Invalid dictionary, can't find end of dictionary at offset {}",                                                                                           
                             325:                    source.getPosition());                                                                                                                                      
                             326:        }                                                                                                                                                                       
                             327:        return obj;                                                                                                                                                             
                             328:    }                                                                                                                                                                           
                             329:                                                                                                                                                                                
                             330:    /**                                                                                                                                                                         
                             331:     * Keep reading until the end of the dictionary object or the file has been hit, or until a '/'                                                                             
                             332:     * has been found.                                                                                                                                                          
                             333:     *                                                                                                                                                                          
                             334:     * @return true if the end of the object or the file has been found, false if not, i.e. that the                                                                            
                             335:     * caller can continue to parse the dictionary at the current position.                                                                                                     
                             336:     *                                                                                                                                                                          
                             337:     * @throws IOException if there is a reading error.                                                                                                                         
                             338:     */                                                                                                                                                                         
                             339:    private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                             340:    {                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java:1-80                                                                                                                
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:package org.apache.pdfbox.pdfparser;                                                                                                                                             
                             18:                                                                                                                                                                                 
                             19:import java.io.IOException;                                                                                                                                                      
                             20:import java.io.InputStream;                                                                                                                                                      
                             21:import java.nio.charset.StandardCharsets;                                                                                                                                        
                             22:import java.security.GeneralSecurityException;                                                                                                                                   
                             23:import java.security.KeyStore;                                                                                                                                                   
                             24:import java.util.HashMap;                                                                                                                                                        
                             25:import java.util.HashSet;                                                                                                                                                        
                             26:import java.util.List;                                                                                                                                                           
                             27:import java.util.Map;                                                                                                                                                            
                             28:import java.util.Set;                                                                                                                                                            
                             29:                                                                                                                                                                                 
                             30:import org.apache.logging.log4j.Logger;                                                                                                                                          
                             31:import org.apache.logging.log4j.LogManager;                                                                                                                                      
                             32:import org.apache.pdfbox.cos.COSArray;                                                                                                                                           
                             33:import org.apache.pdfbox.cos.COSBase;                                                                                                                                            
                             34:import org.apache.pdfbox.cos.COSDictionary;                                                                                                                                      
                             35:import org.apache.pdfbox.cos.COSDocument;                                                                                                                                        
                             36:import org.apache.pdfbox.cos.COSName;                                                                                                                                            
                             37:import org.apache.pdfbox.cos.COSNull;                                                                                                                                            
                             38:import org.apache.pdfbox.cos.COSNumber;                                                                                                                                          
                             39:import org.apache.pdfbox.cos.COSObject;                                                                                                                                          
                             40:import org.apache.pdfbox.cos.COSObjectKey;                                                                                                                                       
                             41:import org.apache.pdfbox.cos.COSStream;                                                                                                                                          
                             42:import org.apache.pdfbox.cos.ICOSParser;                                                                                                                                         
                             43:import org.apache.pdfbox.io.IOUtils;                                                                                                                                             
                             44:import org.apache.pdfbox.io.RandomAccessRead;                                                                                                                                    
                             45:import org.apache.pdfbox.io.RandomAccessReadView;                                                                                                                                
                             46:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;                                                                                                   
                             47:import org.apache.pdfbox.pdmodel.encryption.AccessPermission;                                                                                                                    
                             48:import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;                                                                                                                  
                             49:import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;                                                                                                            
                             50:import org.apache.pdfbox.pdmodel.encryption.PDEncryption;                                                                                                                        
                             51:import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;                                                                                                                    
                             52:import org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial;                                                                                                         
                             53:import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;                                                                                                                     
                             54:import org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial;                                                                                                          
                             55:                                                                                                                                                                                 
                             56:/**                                                                                                                                                                              
                             57: * COS-Parser which first reads startxref and xref tables in order to know valid objects and parse only these objects.                                                           
                             58: *                                                                                                                                                                               
                             59: * This class is a much enhanced version of <code>QuickParser</code> presented in                                                                                                
                             60: * <a href="https://issues.apache.org/jira/browse/PDFBOX-1104">PDFBOX-1104</a> by Jeremy Villalobos.                                                                             
                             61: */                                                                                                                                                                              
                             62:public class COSParser extends BaseParser implements ICOSParser                                                                                                                  
                             63:{                                                                                                                                                                                
                             64:    private static final String PDF_HEADER = "%PDF-";                                                                                                                            
                             65:    private static final String FDF_HEADER = "%FDF-";                                                                                                                            
                             66:                                                                                                                                                                                 
                             67:    private static final String PDF_DEFAULT_VERSION = "1.4";                                                                                                                     
                             68:    private static final String FDF_DEFAULT_VERSION = "1.0";                                                                                                                     
                             69:                                                                                                                                                                                 
                             70:    private static final char[] STARTXREF = { 's','t','a','r','t','x','r','e','f' };                                                                                             
                             71:                                                                                                                                                                                 
                             72:    private static final byte[] ENDSTREAM = { E, N, D, S, T, R, E, A, M };                                                                                                       
                             73:                                                                                                                                                                                 
                             74:    private static final byte[] ENDOBJ = { E, N, D, O, B, J };                                                                                                                   
                             75:                                                                                                                                                                                 
                             76:    protected static final long MINIMUM_SEARCH_OFFSET = 6;                                                                                                                       
                             77:                                                                                                                                                                                 
                             78:    private static final int STRMBUFLEN = 2048;                                                                                                                                  
                             79:    private final byte[] strmBuf = new byte[ STRMBUFLEN ];                                                                                                                       
                             80:                                                                                                                                                                                 
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:281-328                                                                                                            
                             ```                                                                                                                                                                                 
                             281:    protected COSDictionary parseCOSDictionary(boolean isDirect) throws IOException                                                                                             
                             282:    {                                                                                                                                                                           
                             283:        readExpectedChar('<');                                                                                                                                                  
                             284:        readExpectedChar('<');                                                                                                                                                  
                             285:        skipSpaces();                                                                                                                                                           
                             286:        COSDictionary obj = new COSDictionary();                                                                                                                                
                             287:        obj.setDirect(isDirect);                                                                                                                                                
                             288:        while (true)                                                                                                                                                            
                             289:        {                                                                                                                                                                       
                             290:            skipSpaces();                                                                                                                                                       
                             291:            char c = (char) source.peek();                                                                                                                                      
                             292:            if (c == '>')                                                                                                                                                       
                             293:            {                                                                                                                                                                   
                             294:                break;                                                                                                                                                          
                             295:            }                                                                                                                                                                   
                             296:            else if (c == '/')                                                                                                                                                  
                             297:            {                                                                                                                                                                   
                             298:                // something went wrong, most likely the dictionary is corrupted                                                                                                
                             299:                // stop immediately and return everything read so far                                                                                                           
                             300:                if (!parseCOSDictionaryNameValuePair(obj))                                                                                                                      
                             301:                {                                                                                                                                                               
                             302:                    return obj;                                                                                                                                                 
                             303:                }                                                                                                                                                               
                             304:            }                                                                                                                                                                   
                             305:            else                                                                                                                                                                
                             306:            {                                                                                                                                                                   
                             307:                // invalid dictionary, we were expecting a /Name, read until the end or until we can recover                                                                    
                             308:                LOG.warn("Invalid dictionary, found: '{}' but expected: '/' at offset {}", c,                                                                                   
                             309:                        source.getPosition());                                                                                                                                  
                             310:                if (readUntilEndOfCOSDictionary())                                                                                                                              
                             311:                {                                                                                                                                                               
                             312:                    // we couldn't recover                                                                                                                                      
                             313:                    return obj;                                                                                                                                                 
                             314:                }                                                                                                                                                               
                             315:            }                                                                                                                                                                   
                             316:        }                                                                                                                                                                       
                             317:        try                                                                                                                                                                     
                             318:        {                                                                                                                                                                       
                             319:            readExpectedChar('>');                                                                                                                                              
                             320:            readExpectedChar('>');                                                                                                                                              
                             321:        }                                                                                                                                                                       
                             322:        catch (IOException exception)                                                                                                                                           
                             323:        {                                                                                                                                                                       
                             324:            LOG.warn("Invalid dictionary, can't find end of dictionary at offset {}",                                                                                           
                             325:                    source.getPosition());                                                                                                                                      
                             326:        }                                                                                                                                                                       
                             327:        return obj;                                                                                                                                                             
                             328:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:339-375                                                                                                            
                             ```                                                                                                                                                                                 
                             339:    private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                             340:    {                                                                                                                                                                           
                             341:        int c = source.read();                                                                                                                                                  
                             342:        while (c != -1 && c != '/' && c != '>')                                                                                                                                 
                             343:        {                                                                                                                                                                       
                             344:            // in addition to stopping when we find / or >, we also want                                                                                                        
                             345:            // to stop when we find endstream or endobj.                                                                                                                        
                             346:            if (c == E)                                                                                                                                                         
                             347:            {                                                                                                                                                                   
                             348:                c = source.read();                                                                                                                                              
                             349:                if (c == N)                                                                                                                                                     
                             350:                {                                                                                                                                                               
                             351:                    c = source.read();                                                                                                                                          
                             352:                    if (c == D)                                                                                                                                                 
                             353:                    {                                                                                                                                                           
                             354:                        c = source.read();                                                                                                                                      
                             355:                        boolean isStream = c == S && source.read() == T && source.read() == R                                                                                   
                             356:                                && source.read() == E && source.read() == A && source.read() == M;                                                                              
                             357:                        boolean isObj = !isStream && c == O && source.read() == B                                                                                               
                             358:                                && source.read() == J;                                                                                                                          
                             359:                        if (isStream || isObj)                                                                                                                                  
                             360:                        {                                                                                                                                                       
                             361:                            // we're done reading this object!                                                                                                                  
                             362:                            return true;                                                                                                                                        
                             363:                        }                                                                                                                                                       
                             364:                    }                                                                                                                                                           
                             365:                }                                                                                                                                                               
                             366:            }                                                                                                                                                                   
                             367:            c = source.read();                                                                                                                                                  
                             368:        }                                                                                                                                                                       
                             369:        if (c == -1)                                                                                                                                                            
                             370:        {                                                                                                                                                                       
                             371:            return true;                                                                                                                                                        
                             372:        }                                                                                                                                                                       
                             373:        source.rewind(1);                                                                                                                                                       
                             374:        return false;                                                                                                                                                           
                             375:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 20:58:47] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 2, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 20:59:57] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 2, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 21:03:23] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 2, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:03:24] INFO     [logging_performance](pdfbox Setting owner) Took 0.99 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:03:25] INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpd0idw_qh                                                                                                                                 default.py:173
[10/26/25 21:04:00] ERROR    Failed to build the challenge                                                                                                                                         __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stdout.txt: /src /src/project-parent/pdfbox                    functions.py:17
                             /src/project-parent/pdfbox                                                                                                                                                          
                             ---------------------------------------------------------------                                                                                                                     
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             ---------------------------------------------------------------                                                                                                                     
                             CC=clang                                                                                                                                                                            
                             CXX=clang++                                                                                                                                                                         
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                   
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak                                       
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                 
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak                        
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                                                                                                    
                             ---------------------------------------------------------------                                                                                                                     
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                                                                                                            
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                                                                                              
                             + '[' '!' -L /root/.m2/repository ']'                                                                                                                                               
                             + unset __REAL_MAVEN_REPO                                                                                                                                                           
                             + unset __SHARED_MAVEN_REPO                                                                                                                                                         
                             + PROJECT=pdfbox                                                                                                                                                                    
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                                                                                                
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                                                                                                        
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                                                                                                         
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                                                                                                 
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                                                                                                         
                             + cd /src/project-parent                                                                                                                                                            
                             + [[ -v LOCAL_DEV ]]                                                                                                                                                                
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                                                                                              
                             + set_project_version_in_fuzz_targets_dependency                                                                                                                                    
                             ++ cd pdfbox                                                                                                                                                                        
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout                                    
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                                                                                                    
                             + cd fuzz-targets                                                                                                                                                                   
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                            
                             [INFO] Scanning for projects...                                                                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                                                                                                     
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                                                                                                 
                             [INFO]   from pom.xml                                                                                                                                                               
                             [INFO] --------------------------------[ jar ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                                                                                                         
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD SUCCESS                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  0.688 s                                                                                                                                                         
                             [INFO] Finished at: 2025-10-26T21:03:31Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             + cd pdfbox                                                                                                                                                                         
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                             
                             [INFO] Scanning for projects...                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Build Order:                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent                                               [pom]                                                                                                     
                             [INFO] Apache PDFBox io                                                [bundle]                                                                                                     
                             [INFO] Apache FontBox                                                  [bundle]                                                                                                     
                             [INFO] Apache XmpBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox Debugger                                             [jar]                                                                                                     
                             [INFO] Apache PDFBox tools                                                [jar]                                                                                                     
                             [INFO] Apache PDFBox application                                          [jar]                                                                                                     
                             [INFO] Apache PDFBox Debugger application                                 [jar]                                                                                                     
                             [INFO] Apache PDFBox examples                                             [jar]                                                                                                     
                             [INFO] pdfbox-reactor                                                     [pom]                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                                                                                                     
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                                                                                                     
                             [INFO]   from parent/pom.xml                                                                                                                                                        
                             [INFO] --------------------------------[ pom ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                                                                                                     
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                                                                                                       
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                                                                                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                                                                                                       
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                                                                                                
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---                                                                                            
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                                                                                                        
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                                                                                              
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                                                                                                     
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                                                                                                     
                             [INFO]   from io/pom.xml                                                                                                                                                            
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                                                                                                         
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                                                                                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                                                                                                    
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                                                                                                
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                                                                                                            
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources                                                                                         
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                                                                                                
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                                                                                                    
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                                                                                                           
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                                                                                                        
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                                                                                                       
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                                                                                                            
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                                                                                                     
                             [INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                                                                          
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                                                                                                
                             [INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                                                                                                  
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                                          
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                                                                                              
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                                                                                      
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                                                                                                   
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                                                                                                     
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                                                                                                     
                             [INFO]   from fontbox/pom.xml                                                                                                                                                       
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                                                                                                      
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                                                                                                  
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                                                                                              
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                                                                                                  
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.                                   
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4038) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3997) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3379) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5328) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5356) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5713) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5728) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4106) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ fontbox ---                                                                                                      
                             [INFO] Copying 27 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ fontbox ---                                                                                                          
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 44 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ fontbox ---                                                                                                                         
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ fontbox ---                                                                                                                              
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ fontbox ---                                                                                                                       
                             [INFO] Building bundle: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar                                                                                        
                             [INFO] Writing manifest: /src/project-parent/pdfbox/fontbox/target/classes/META-INF/MANIFEST.MF                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ fontbox ---                                                                                                                  
                             [INFO] Building jar: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ fontbox ---                                                                                                                    
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/pom.xml to /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.pom                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar to                                                                                           
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar to                                                                                   
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ fontbox ---                                                                                                                     
                             [INFO] Installing org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                               
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:xmpbox >----------------------                                                                                                     
                             [INFO] Building Apache XmpBox 4.0.0-SNAPSHOT                             [4/11]                                                                                                     
                             [INFO]   from xmpbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ xmpbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ xmpbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ xmpbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ xmpbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ xmpbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ xmpbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ xmpbox ---                                                                                                               
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/xmpbox/src/main/resources                                                                                     
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ xmpbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 72 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ xmpbox ---                                                                                                       
                             [INFO] Copying 29 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ xmpbox ---                                                                                                           
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 30 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java:                                                                               
                             /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java uses unchecked or unsafe operations.                                                  
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java: Recompile with -Xlint:unchecked for details.                                  
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ xmpbox ---                                                                                                                          
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ xmpbox ---                                                                                                                               
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ xmpbox ---                                                                                                                        
                             [INFO] Building bundle: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar                                                                                          
                             [INFO] Writing manifest: /src/project-parent/pdfbox/xmpbox/target/classes/META-INF/MANIFEST.MF                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ xmpbox ---                                                                                                                   
                             [INFO] Building jar: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ xmpbox ---                                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/pom.xml to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.pom                                            
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                   
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar to                                                                                     
                             /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ xmpbox ---                                                                                                                      
                             [INFO] Installing org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                                                                                                 
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:pdfbox >----------------------                                                                                                     
                             [INFO] Building Apache PDFBox 4.0.0-SNAPSHOT                             [5/11]                                                                                                     
                             [INFO]   from pdfbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox ---                                                                                                               
                             [INFO] Copying 1 resource from src/main/resources to target/classes                                                                                                                 
                             [INFO] Copying 21 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO] The encoding used to copy filtered properties files have not been set. This means that the same encoding will be used to copy filtered properties files as                   
                             when copying other filtered resources. This might not be what you want! Run your build with --debug to see which files might be affected. Read more at                              
                             https://maven.apache.org/plugins/maven-resources-plugin/examples/filtering-properties-files.html                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 617 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.093 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.165 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  4.247 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.621 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  1.220 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.286 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:03:59Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors and possible solutions, please read the following articles:                                                                           
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] After correcting the problems, you can resume the build with the command                                                                                                    
                             [ERROR]   mvn <args> -rf :pdfbox                                                                                                                                                    
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                                                                                                                                                                                                                 
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stderr.txt: INFO:__main__:Running: docker build -t             functions.py:17
                             aixcc-afc/pdfbox:latest --file /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                                                                             
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                                                                                                      
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.07kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 1.23kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                                                                                                       
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                                                                                              
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                                            
                             /src/PDFWriteReadFuzzer.dict                                                                                                                                                        
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                                                                                               
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2                                             
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*                                                                                    
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                                                                                                    
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 8/13] COPY project-parent /src/project-parent/                                                                                                                                
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                                                                                                   
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz                                                                                         
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                                                                                                  
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [12/13] COPY build.sh /src/                                                                                                                                                     
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                                                                                                      
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 exporting to image                                                                                                                                                              
                             #18 exporting layers done                                                                                                                                                           
                             #18 writing image sha256:9b6504b147657588b7dbd86a0382ef91d36837dc312b2f94517c5f990530eef7 done                                                                                      
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest 0.0s done                                                                                                                           
                             #18 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                        
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                              
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp                
                             -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                                                                                                              
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Patching) Took 35.35 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:04:01] INFO     [logging_performance](pdfbox Setting owner) Took 0.96 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:04:02] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:04:03] INFO     [logging_performance](pdfbox Setting owner) Took 1.05 seconds; exception=False                                                                                context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                                                                                                            
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             @@ -376,29 +376,29 @@                                                                                                                                                               
                                                                                                                                                                                                                 
                                  private boolean parseCOSDictionaryNameValuePair(COSDictionary obj) throws IOException                                                                                          
                                  {                                                                                                                                                                              
                             -        COSName key = parseCOSName();                                                                                                                                              
                             -        if (key == null || key.getName().isEmpty())                                                                                                                                
                             -        {                                                                                                                                                                          
                             -            LOG.warn("Empty COSName at offset {}", source.getPosition());                                                                                                          
                             -        }                                                                                                                                                                          
                             -        COSBase value = parseCOSDictionaryValue();                                                                                                                                 
                             -        skipSpaces();                                                                                                                                                              
                             -        if (value == null)                                                                                                                                                         
                             -        {                                                                                                                                                                          
                             -            LOG.warn("Bad dictionary declaration at offset {}", source.getPosition());                                                                                             
                             -            return false;                                                                                                                                                          
                             -        }                                                                                                                                                                          
                             -        else if (value instanceof COSInteger && !((COSInteger) value).isValid())                                                                                                   
                             -        {                                                                                                                                                                          
                             -            LOG.warn("Skipped out of range number value at offset {}", source.getPosition());                                                                                      
                             -        }                                                                                                                                                                          
                             -        else                                                                                                                                                                       
                             -        {                                                                                                                                                                          
                             -            // label this item as direct, to avoid signature problems.                                                                                                             
                             -            value.setDirect(true);                                                                                                                                                 
                             -            obj.setItem(key, value);                                                                                                                                               
                             -        }                                                                                                                                                                          
                             -        return true;                                                                                                                                                               
                             +    protected String readLine() throws IOException                                                                                                                                 
                             +    {                                                                                                                                                                              
                             +        StringBuilder sb = new StringBuilder();                                                                                                                                    
                             +        int lineCount = 0;                                                                                                                                                         
                             +        int c = source.read();                                                                                                                                                     
                             +        while (c != -1 && !isEOL(c))                                                                                                                                               
                             +        {                                                                                                                                                                          
                             +            if (++lineCount > MAX_LINE_CHARS)                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded max line length at offset " + source.getPosition());                                                                               
                             +            }                                                                                                                                                                      
                             +            sb.append((char) c);                                                                                                                                                   
                             +            c = source.read();                                                                                                                                                     
                             +        }                                                                                                                                                                          
                             +        if (c == '\r')                                                                                                                                                             
                             +        {                                                                                                                                                                          
                             +            int next = source.read();                                                                                                                                              
                             +            if (next != '\n')                                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                source.rewind(1);                                                                                                                                                  
                             +            }                                                                                                                                                                      
                             +        }                                                                                                                                                                          
                             +        return sb.toString();                                                                                                                                                      
                                  }                                                                                                                                                                              
                                                                                                                                                                                                                 
                                  /**                                                                                                                                                                            
                             @@ -1314,7 +1314,8 @@                                                                                                                                                               
                                  /**                                                                                                                                                                            
                                   * This will skip all spaces and comments that are present.                                                                                                                    
                                   *                                                                                                                                                                             
                             -     * @throws IOException If there is an error reading from the stream.                                                                                                           
                             +    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_LINE_CHARS = 10000;                                                                                                                               
                                   */                                                                                                                                                                            
                                  protected void skipSpaces() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                                                                                                                                                                                                                 
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             @@ -44,6 +44,7 @@                                                                                                                                                                   
                                  private static final int X = 'x';                                                                                                                                              
                                  private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                               
                                  private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                       
                             +    private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                             
                                                                                                                                                                                                                 
                                  /**                                                                                                                                                                            
                                   * Collects all Xref/trailer objects and resolves them into single                                                                                                             
                             @@ -630,6 +631,11 @@                                                                                                                                                                
                                              LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                                 
                                              return false;                                                                                                                                                      
                                          }                                                                                                                                                                      
                             +            if (count < 0 || count > MAX_XREF_ENTRIES)                                                                                                                             
                             +            {                                                                                                                                                                      
                             +                throw new IOException("XRef entry count out of bounds: " + count                                                                                                   
                             +                        + " at offset " + parser.source.getPosition());                                                                                                            
                             +            }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          parser.skipSpaces();                                                                                                                                                   
                                          for(int i = 0; i < count; i++)                                                                                                                                         
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.093 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.165 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  4.247 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.621 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  1.220 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.286 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:03:59Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             The projects PDF parser hung under fuzzing, triggering a libFuzzer timeout. In the initial issue, the main thread was spinning in BaseParser.skipSpaces (and                       
                             related loops) without bound. The patch introduced per-loop counters (`skipCount`, `readCount`) and a `MAX_SKIP_CHARS` threshold to bail out with an IOException                    
                             after too many characters are skipped. After applying that change, the parser no longer stalls in `skipSpaces` but instead times out later in                                       
                             `XrefParser.parseXrefTable`, where it is stuck in `java.util.regex.Pattern.split`.                                                                                                  
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Initial Issue                                                                                                                                                                    
                                 The fuzzer reported a timeout after ~28 s.                                                                                                                                     
                                 Thread dump showed the main thread in a tight loop inside `BaseParser.skipSpaces`, with calls tracing through PDFBoxs `BaseParser.parseCOSDictionary` and                  
                             ultimately the fuzzer harness.                                                                                                                                                      
                                 No exception was thrown; the parser simply spent all its time consuming whitespace or comments.                                                                                
                                                                                                                                                                                                                 
                             2. Patch Attempt                                                                                                                                                                    
                                 In `BaseParser.java`, two methods were modified:                                                                                                                               
                                   `readUntilEndOfCOSDictionary()`: introduced a local counter `readCount`, incremented on each character read, and if it exceeds `MAX_SKIP_CHARS` (10 000), an                 
                             IOException is thrown.                                                                                                                                                              
                                   `skipSpaces()`: introduced a local `skipCount` with the same threshold and exception behavior, covering both whitespace skipping and comment-skipping loops.                 
                                 A new constant `private static final int MAX_SKIP_CHARS = 10000;` was added at the top of the class.                                                                           
                                                                                                                                                                                                                 
                                Patch diff (abbreviated):                                                                                                                                                        
                                --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                           
                                +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                           
                                @@ -339,8 +339,13 @@                                                                                                                                                             
                                     private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                                     {                                                                                                                                                                           
                                         int c = source.read();                                                                                                                                                  
                                +        int readCount = 0;                                                                                                                                                      
                                         while (c != -1 && c != '/' && c != '>')                                                                                                                                 
                                         {                                                                                                                                                                       
                                +            if (++readCount > MAX_SKIP_CHARS) throw new IOException(...);                                                                                                       
                                             ...                                                                                                                                                                 
                                         }                                                                                                                                                                       
                                                                                                                                                                                                                 
                                @@ -1316,18 +1321,29 @@                                                                                                                                                          
                                     protected void skipSpaces() throws IOException                                                                                                                              
                                     {                                                                                                                                                                           
                                         int c = source.read();                                                                                                                                                  
                                +        int skipCount = 0;                                                                                                                                                      
                                         while (isWhitespace(c) || c == 37)                                                                                                                                      
                                         {                                                                                                                                                                       
                                +            if (++skipCount > MAX_SKIP_CHARS) throw new IOException(...);                                                                                                       
                                             if (c == 37)                                                                                                                                                        
                                             {                                                                                                                                                                   
                                                 c = source.read();                                                                                                                                              
                                +                while (!isEOL(c) && c != -1)                                                                                                                                    
                                +                {                                                                                                                                                               
                                +                    if (++skipCount > MAX_SKIP_CHARS) throw new IOException(...);                                                                                               
                                                     c = source.read();                                                                                                                                          
                                                 }                                                                                                                                                               
                                             }                                                                                                                                                                   
                                             c = source.read();                                                                                                                                                  
                                         }                                                                                                                                                                       
                                                                                                                                                                                                                 
                             3. Resulting Behavior                                                                                                                                                               
                                 After rebuilding with the patch, fuzzing still times out (~27 s).                                                                                                              
                                 The stack trace now shows the main thread in `java.util.regex.Pattern$Start.match`  `Matcher.search`  `Pattern.split`  `String.split`, called from                          
                             `XrefParser.parseXrefTable`.                                                                                                                                                        
                                 This indicates the parser is now hanging in the cross-reference table parsing logic, likely due to a large or malicious input that causes the regex split to                   
                             be extremely slow or unbounded.                                                                                                                                                     
                                                                                                                                                                                                                 
                             4. Areas for Further Investigation                                                                                                                                                  
                                 XrefParser.parseXrefTable: uses `String.split` on potentially adversarial dataverify complexity and input bounds.                                                             
                                 Any regex-based parsing in PDFBox that can exhibit pathological performance.                                                                                                   
                                 Overall retry/timeout strategy in the PDF parsing pipeline to ensure that no single parsing phase can hang indefinitely.                                                       
                                 Upstream handling in `PDFParser.initialParse` and `COSParser.retrieveTrailer` to determine if inputs should be truncated or pre-validated before regex usage.                  
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:58:34                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3c2079fac0, length=14, elements={                                                                                                                         
                             0x0000564a010a1b70, 0x0000564a011acbf0, 0x0000564a011ae000, 0x0000564a011b7090,                                                                                                     
                             0x0000564a011b8410, 0x0000564a011b97f0, 0x0000564a011bb1f0, 0x0000564a011bc6f0,                                                                                                     
                             0x0000564a011bdb30, 0x0000564a011faad0, 0x0000564a011fdc10, 0x0000564a01383550,                                                                                                     
                             0x00007f3c50000e70, 0x0000564a018f2fa0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=25809.25ms elapsed=27.70s tid=0x0000564a010a1b70 nid=0x13 runnable  [0x00007ffe6eabf000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.util.regex.Pattern$Start.match(java.base@17.0.2/Pattern.java:3608)                                                                                                  
                                     at java.util.regex.Matcher.search(java.base@17.0.2/Matcher.java:1728)                                                                                                       
                                     at java.util.regex.Matcher.find(java.base@17.0.2/Matcher.java:745)                                                                                                          
                                     at java.util.regex.Pattern.split(java.base@17.0.2/Pattern.java:1265)                                                                                                        
                                     at java.lang.String.split(java.base@17.0.2/String.java:3150)                                                                                                                
                                     at java.lang.String.split(java.base@17.0.2/String.java:3196)                                                                                                                
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXrefTable(XrefParser.java:648)                                                                                               
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.87ms elapsed=27.65s tid=0x0000564a011acbf0 nid=0x16 waiting on condition  [0x00007f3c70589000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=27.65s tid=0x0000564a011ae000 nid=0x17 in Object.wait()  [0x00007f3c704a8000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894d5850> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894d5850> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=27.65s tid=0x0000564a011b7090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.62ms elapsed=27.65s tid=0x0000564a011b8410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=27.65s tid=0x0000564a011b97f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1574.22ms elapsed=27.65s tid=0x0000564a011bb1f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=825.42ms elapsed=27.65s tid=0x0000564a011bc6f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=52.98ms elapsed=27.65s tid=0x0000564a011bdb30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=27.63s tid=0x0000564a011faad0 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.89ms elapsed=27.63s tid=0x0000564a011fdc10 nid=0x23 in Object.wait()  [0x00007f3c67354000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894d9880> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894d9880> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=27.51s tid=0x0000564a01383550 nid=0x27 waiting on condition  [0x00007f3c6845d000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894d7b50> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.79ms elapsed=27.41s tid=0x00007f3c50000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=24.73s tid=0x0000564a018f2fa0 nid=0x27e in Object.wait()  [0x00007f3c66ca9000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a18bd78> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a18bd78> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=128.01ms elapsed=27.66s tid=0x0000564a011a8400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=65.87ms elapsed=27.68s tid=0x0000564a010b8da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=67.54ms elapsed=26.63s tid=0x00007f3c600015b0 nid=0x5c runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=61.37ms elapsed=26.63s tid=0x00007f3c60001fb0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=64.74ms elapsed=26.63s tid=0x00007f3c600029b0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=63.31ms elapsed=26.63s tid=0x00007f3c600033b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=68.14ms elapsed=26.63s tid=0x00007f3c60003db0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=51.17ms elapsed=26.63s tid=0x00007f3c600047b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=64.01ms elapsed=26.63s tid=0x00007f3c600051b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=66.97ms elapsed=26.63s tid=0x00007f3c60005bb0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=66.30ms elapsed=26.63s tid=0x00007f3c600065b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=49.22ms elapsed=26.63s tid=0x00007f3c60006fb0 nid=0x65 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=67.61ms elapsed=26.63s tid=0x00007f3c600079b0 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=60.31ms elapsed=26.63s tid=0x00007f3c600083b0 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=27.63s tid=0x0000564a011fc460 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:600-690                                                                                                            
                             ```                                                                                                                                                                                 
                             600:        // Xref tables can have multiple sections. Each starts with a starting object id and a count.                                                                           
                             601:        while(true)                                                                                                                                                             
                             602:        {                                                                                                                                                                       
                             603:            String currentLine = parser.readLine();                                                                                                                             
                             604:            String[] splitString = currentLine.split("\\s");                                                                                                                    
                             605:            if (splitString.length != 2)                                                                                                                                        
                             606:            {                                                                                                                                                                   
                             607:                LOG.warn("Unexpected XRefTable Entry: {}", currentLine);                                                                                                        
                             608:                return false;                                                                                                                                                   
                             609:            }                                                                                                                                                                   
                             610:            // first obj id                                                                                                                                                     
                             611:            long currObjID;                                                                                                                                                     
                             612:            try                                                                                                                                                                 
                             613:            {                                                                                                                                                                   
                             614:                currObjID = Long.parseLong(splitString[0]);                                                                                                                     
                             615:            }                                                                                                                                                                   
                             616:            catch (NumberFormatException exception)                                                                                                                             
                             617:            {                                                                                                                                                                   
                             618:                LOG.warn("XRefTable: invalid ID for the first object: {}", currentLine);                                                                                        
                             619:                return false;                                                                                                                                                   
                             620:            }                                                                                                                                                                   
                             621:                                                                                                                                                                                
                             622:            // the number of objects in the xref table                                                                                                                          
                             623:            int count = 0;                                                                                                                                                      
                             624:            try                                                                                                                                                                 
                             625:            {                                                                                                                                                                   
                             626:                count = Integer.parseInt(splitString[1]);                                                                                                                       
                             627:            }                                                                                                                                                                   
                             628:            catch (NumberFormatException exception)                                                                                                                             
                             629:            {                                                                                                                                                                   
                             630:                LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                              
                             631:                return false;                                                                                                                                                   
                             632:            }                                                                                                                                                                   
                             633:                                                                                                                                                                                
                             634:            parser.skipSpaces();                                                                                                                                                
                             635:            for(int i = 0; i < count; i++)                                                                                                                                      
                             636:            {                                                                                                                                                                   
                             637:                if (parser.isEOF() )                                                                                                                                            
                             638:                {                                                                                                                                                               
                             639:                    break;                                                                                                                                                      
                             640:                }                                                                                                                                                               
                             641:                int nextChar = source.peek();                                                                                                                                   
                             642:                if (nextChar == 't' || BaseParser.isEndOfName(nextChar))                                                                                                        
                             643:                {                                                                                                                                                               
                             644:                    break;                                                                                                                                                      
                             645:                }                                                                                                                                                               
                             646:                //Ignore table contents                                                                                                                                         
                             647:                currentLine = parser.readLine();                                                                                                                                
                             648:                splitString = currentLine.split("\\s");                                                                                                                         
                             649:                if (splitString.length < 3)                                                                                                                                     
                             650:                {                                                                                                                                                               
                             651:                    LOG.warn("invalid xref line: {}", currentLine);                                                                                                             
                             652:                    break;                                                                                                                                                      
                             653:                }                                                                                                                                                               
                             654:                /* This supports the corrupt table as reported in                                                                                                               
                             655:                 * PDFBOX-474 (XXXX XXX XX n) */                                                                                                                                
                             656:                if(splitString[splitString.length-1].equals("n"))                                                                                                               
                             657:                {                                                                                                                                                               
                             658:                    try                                                                                                                                                         
                             659:                    {                                                                                                                                                           
                             660:                        long currOffset = Long.parseLong(splitString[0]);                                                                                                       
                             661:                        // skip 0 offsets                                                                                                                                       
                             662:                        if (currOffset > 0)                                                                                                                                     
                             663:                        {                                                                                                                                                       
                             664:                            int currGenID = Integer.parseInt(splitString[1]);                                                                                                   
                             665:                            COSObjectKey objKey = new COSObjectKey(currObjID, currGenID);                                                                                       
                             666:                            xrefTrailerResolver.setXRef(objKey, currOffset);                                                                                                    
                             667:                        }                                                                                                                                                       
                             668:                    }                                                                                                                                                           
                             669:                    catch (IllegalArgumentException e)                                                                                                                          
                             670:                    {                                                                                                                                                           
                             671:                        throw new IOException(e);                                                                                                                               
                             672:                    }                                                                                                                                                           
                             673:                }                                                                                                                                                               
                             674:                else if(!splitString[2].equals("f"))                                                                                                                            
                             675:                {                                                                                                                                                               
                             676:                    throw new IOException("Corrupt XRefTable Entry - ObjID:" + currObjID);                                                                                      
                             677:                }                                                                                                                                                               
                             678:                currObjID++;                                                                                                                                                    
                             679:                parser.skipSpaces();                                                                                                                                            
                             680:            }                                                                                                                                                                   
                             681:            parser.skipSpaces();                                                                                                                                                
                             682:            if (!parser.isDigit())                                                                                                                                              
                             683:            {                                                                                                                                                                   
                             684:                break;                                                                                                                                                          
                             685:            }                                                                                                                                                                   
                             686:        }                                                                                                                                                                       
                             687:        return true;                                                                                                                                                            
                             688:    }                                                                                                                                                                           
                             689:                                                                                                                                                                                
                             690:}                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:100-140                                                                                                            
                             ```                                                                                                                                                                                 
                             100:        long prev = startXrefOffset;                                                                                                                                            
                             101:        //lastPrev prevents potential infinite loops in crafted files                                                                                                           
                             102:        long lastPrev = -1;                                                                                                                                                     
                             103:        // ---- parse whole chain of xref tables/object streams using PREV reference                                                                                            
                             104:        COSDictionary trailer = null;                                                                                                                                           
                             105:        while (prev > 0 && prev != lastPrev)                                                                                                                                    
                             106:        {                                                                                                                                                                       
                             107:            lastPrev = prev;                                                                                                                                                    
                             108:            // seek to xref table                                                                                                                                               
                             109:            source.seek(prev);                                                                                                                                                  
                             110:            // skip white spaces                                                                                                                                                
                             111:            parser.skipSpaces();                                                                                                                                                
                             112:            // -- parse xref                                                                                                                                                    
                             113:            if (source.peek() == X)                                                                                                                                             
                             114:            {                                                                                                                                                                   
                             115:                // xref table and trailer                                                                                                                                       
                             116:                // use existing parser to parse xref table                                                                                                                      
                             117:                if (!parseXrefTable(prev) || !parseTrailer())                                                                                                                   
                             118:                {                                                                                                                                                               
                             119:                    throw new IOException("Expected trailer object at offset "                                                                                                  
                             120:                            + source.getPosition());                                                                                                                            
                             121:                }                                                                                                                                                               
                             122:                trailer = xrefTrailerResolver.getCurrentTrailer();                                                                                                              
                             123:                // check for a XRef stream, it may contain some object ids of compressed objects                                                                                
                             124:                if(trailer.containsKey(COSName.XREF_STM))                                                                                                                       
                             125:                {                                                                                                                                                               
                             126:                    int streamOffset = trailer.getInt(COSName.XREF_STM);                                                                                                        
                             127:                    // check the xref stream reference                                                                                                                          
                             128:                    fixedOffset = checkXRefOffset(streamOffset);                                                                                                                
                             129:                    if (fixedOffset > -1 && fixedOffset != streamOffset)                                                                                                        
                             130:                    {                                                                                                                                                           
                             131:                        LOG.warn("/XRefStm offset {} is incorrect, corrected to {}", streamOffset,                                                                              
                             132:                                fixedOffset);                                                                                                                                   
                             133:                        streamOffset = (int)fixedOffset;                                                                                                                        
                             134:                        trailer.setInt(COSName.XREF_STM, streamOffset);                                                                                                         
                             135:                    }                                                                                                                                                           
                             136:                    if (streamOffset > 0)                                                                                                                                       
                             137:                    {                                                                                                                                                           
                             138:                        source.seek(streamOffset);                                                                                                                              
                             139:                        parser.skipSpaces();                                                                                                                                    
                             140:                        try                                                                                                                                                     
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:100-200                                                                                                            
                             ```                                                                                                                                                                                 
                             100:        long prev = startXrefOffset;                                                                                                                                            
                             101:        //lastPrev prevents potential infinite loops in crafted files                                                                                                           
                             102:        long lastPrev = -1;                                                                                                                                                     
                             103:        // ---- parse whole chain of xref tables/object streams using PREV reference                                                                                            
                             104:        COSDictionary trailer = null;                                                                                                                                           
                             105:        while (prev > 0 && prev != lastPrev)                                                                                                                                    
                             106:        {                                                                                                                                                                       
                             107:            lastPrev = prev;                                                                                                                                                    
                             108:            // seek to xref table                                                                                                                                               
                             109:            source.seek(prev);                                                                                                                                                  
                             110:            // skip white spaces                                                                                                                                                
                             111:            parser.skipSpaces();                                                                                                                                                
                             112:            // -- parse xref                                                                                                                                                    
                             113:            if (source.peek() == X)                                                                                                                                             
                             114:            {                                                                                                                                                                   
                             115:                // xref table and trailer                                                                                                                                       
                             116:                // use existing parser to parse xref table                                                                                                                      
                             117:                if (!parseXrefTable(prev) || !parseTrailer())                                                                                                                   
                             118:                {                                                                                                                                                               
                             119:                    throw new IOException("Expected trailer object at offset "                                                                                                  
                             120:                            + source.getPosition());                                                                                                                            
                             121:                }                                                                                                                                                               
                             122:                trailer = xrefTrailerResolver.getCurrentTrailer();                                                                                                              
                             123:                // check for a XRef stream, it may contain some object ids of compressed objects                                                                                
                             124:                if(trailer.containsKey(COSName.XREF_STM))                                                                                                                       
                             125:                {                                                                                                                                                               
                             126:                    int streamOffset = trailer.getInt(COSName.XREF_STM);                                                                                                        
                             127:                    // check the xref stream reference                                                                                                                          
                             128:                    fixedOffset = checkXRefOffset(streamOffset);                                                                                                                
                             129:                    if (fixedOffset > -1 && fixedOffset != streamOffset)                                                                                                        
                             130:                    {                                                                                                                                                           
                             131:                        LOG.warn("/XRefStm offset {} is incorrect, corrected to {}", streamOffset,                                                                              
                             132:                                fixedOffset);                                                                                                                                   
                             133:                        streamOffset = (int)fixedOffset;                                                                                                                        
                             134:                        trailer.setInt(COSName.XREF_STM, streamOffset);                                                                                                         
                             135:                    }                                                                                                                                                           
                             136:                    if (streamOffset > 0)                                                                                                                                       
                             137:                    {                                                                                                                                                           
                             138:                        source.seek(streamOffset);                                                                                                                              
                             139:                        parser.skipSpaces();                                                                                                                                    
                             140:                        try                                                                                                                                                     
                             141:                        {                                                                                                                                                       
                             142:                            parseXrefObjStream(prev, false);                                                                                                                    
                             143:                            document.setHasHybridXRef();                                                                                                                        
                             144:                        }                                                                                                                                                       
                             145:                        catch (IOException ex)                                                                                                                                  
                             146:                        {                                                                                                                                                       
                             147:                            LOG.error("Failed to parse /XRefStm at offset " + streamOffset, ex);                                                                                
                             148:                        }                                                                                                                                                       
                             149:                    }                                                                                                                                                           
                             150:                    else                                                                                                                                                        
                             151:                    {                                                                                                                                                           
                             152:                        LOG.error("Skipped XRef stream due to a corrupt offset: {}", streamOffset);                                                                             
                             153:                    }                                                                                                                                                           
                             154:                }                                                                                                                                                               
                             155:                prev = trailer.getLong(COSName.PREV);                                                                                                                           
                             156:            }                                                                                                                                                                   
                             157:            else                                                                                                                                                                
                             158:            {                                                                                                                                                                   
                             159:                // parse xref stream                                                                                                                                            
                             160:                prev = parseXrefObjStream(prev, true);                                                                                                                          
                             161:                trailer = xrefTrailerResolver.getCurrentTrailer();                                                                                                              
                             162:            }                                                                                                                                                                   
                             163:            if (prev > 0)                                                                                                                                                       
                             164:            {                                                                                                                                                                   
                             165:                // check the xref table reference                                                                                                                               
                             166:                fixedOffset = checkXRefOffset(prev);                                                                                                                            
                             167:                if (fixedOffset > -1 && fixedOffset != prev)                                                                                                                    
                             168:                {                                                                                                                                                               
                             169:                    prev = fixedOffset;                                                                                                                                         
                             170:                    trailer.setLong(COSName.PREV, prev);                                                                                                                        
                             171:                }                                                                                                                                                               
                             172:            }                                                                                                                                                                   
                             173:            if (prev == lastPrev)                                                                                                                                               
                             174:            {                                                                                                                                                                   
                             175:                throw new IOException("/Prev loop at offset " + prev);                                                                                                          
                             176:            }                                                                                                                                                                   
                             177:        }                                                                                                                                                                       
                             178:        // ---- build valid xrefs out of the xref chain                                                                                                                         
                             179:        xrefTrailerResolver.setStartxref(startXrefOffset);                                                                                                                      
                             180:        trailer = xrefTrailerResolver.getTrailer();                                                                                                                             
                             181:        document.setTrailer(trailer);                                                                                                                                           
                             182:        document.setIsXRefStream(XRefType.STREAM == xrefTrailerResolver.getXrefType());                                                                                         
                             183:        // check the offsets of all referenced objects                                                                                                                          
                             184:        checkXrefOffsets();                                                                                                                                                     
                             185:        // copy xref table                                                                                                                                                      
                             186:        document.addXRefTable(xrefTrailerResolver.getXrefTable());                                                                                                              
                             187:                                                                                                                                                                                
                             188:        // remember the highest XRef object number to avoid it being reused in incremental saving                                                                               
                             189:        Optional<Long> maxValue = document.getXrefTable().keySet().stream() //                                                                                                  
                             190:                .map(COSObjectKey::getNumber) //                                                                                                                                
                             191:                .reduce(Long::max);                                                                                                                                             
                             192:        document.setHighestXRefObjectNumber(maxValue.isPresent() ? maxValue.get() : 0);                                                                                         
                             193:                                                                                                                                                                                
                             194:        return trailer;                                                                                                                                                         
                             195:    }                                                                                                                                                                           
                             196:                                                                                                                                                                                
                             197:    /**                                                                                                                                                                         
                             198:     * This will parse the trailer from the stream and add it to the state.                                                                                                     
                             199:     *                                                                                                                                                                          
                             200:     * @return false on parsing error                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:36-100                                                                                                             
                             ```                                                                                                                                                                                 
                             36:                                                                                                                                                                                 
                             37:/**                                                                                                                                                                              
                             38: * Parser to be used to read the cross reference table of a pdf. It is either a simple table or a stream.                                                                        
                             39: */                                                                                                                                                                              
                             40:public class XrefParser                                                                                                                                                          
                             41:{                                                                                                                                                                                
                             42:    private static final Logger LOG = LogManager.getLogger(XrefParser.class);                                                                                                    
                             43:                                                                                                                                                                                 
                             44:    private static final int X = 'x';                                                                                                                                            
                             45:    private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                             
                             46:    private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                     
                             47:                                                                                                                                                                                 
                             48:    /**                                                                                                                                                                          
                             49:     * Collects all Xref/trailer objects and resolves them into single                                                                                                           
                             50:     * object using startxref reference.                                                                                                                                         
                             51:     */                                                                                                                                                                          
                             52:    private XrefTrailerResolver xrefTrailerResolver = new XrefTrailerResolver();                                                                                                 
                             53:                                                                                                                                                                                 
                             54:    private final COSParser parser;                                                                                                                                              
                             55:    private final RandomAccessRead source;                                                                                                                                       
                             56:                                                                                                                                                                                 
                             57:    /**                                                                                                                                                                          
                             58:     * Default constructor.                                                                                                                                                      
                             59:     *                                                                                                                                                                           
                             60:     * @param cosParser the parser to be used to read the pdf.                                                                                                                   
                             61:     *                                                                                                                                                                           
                             62:     */                                                                                                                                                                          
                             63:    public XrefParser(COSParser cosParser)                                                                                                                                       
                             64:    {                                                                                                                                                                            
                             65:        parser = cosParser;                                                                                                                                                      
                             66:        source = parser.source;                                                                                                                                                  
                             67:    }                                                                                                                                                                            
                             68:                                                                                                                                                                                 
                             69:    /**                                                                                                                                                                          
                             70:     * Returns the resulting cross reference table.                                                                                                                              
                             71:     *                                                                                                                                                                           
                             72:     * @return                                                                                                                                                                   
                             73:     */                                                                                                                                                                          
                             74:    public Map<COSObjectKey, Long> getXrefTable()                                                                                                                                
                             75:    {                                                                                                                                                                            
                             76:        return xrefTrailerResolver.getXrefTable();                                                                                                                               
                             77:    }                                                                                                                                                                            
                             78:                                                                                                                                                                                 
                             79:    /**                                                                                                                                                                          
                             80:     * Parses cross reference tables.                                                                                                                                            
                             81:     *                                                                                                                                                                           
                             82:     * @param document the corresponding COS document of the pdf.                                                                                                                
                             83:     * @param startXRefOffset start offset of the first table                                                                                                                    
                             84:     *                                                                                                                                                                           
                             85:     * @return the trailer dictionary                                                                                                                                            
                             86:     *                                                                                                                                                                           
                             87:     * @throws IOException if something went wrong                                                                                                                               
                             88:     */                                                                                                                                                                          
                             89:    public COSDictionary parseXref(COSDocument document, long startXRefOffset) throws IOException                                                                                
                             90:    {                                                                                                                                                                            
                             91:        source.seek(startXRefOffset);                                                                                                                                            
                             92:        long startXrefOffset = Math.max(0, parseStartXref());                                                                                                                    
                             93:        // check the startxref offset                                                                                                                                            
                             94:        long fixedOffset = checkXRefOffset(startXrefOffset);                                                                                                                     
                             95:        if (fixedOffset > -1)                                                                                                                                                    
                             96:        {                                                                                                                                                                        
                             97:            startXrefOffset = fixedOffset;                                                                                                                                       
                             98:        }                                                                                                                                                                        
                             99:        document.setStartXref(startXrefOffset);                                                                                                                                  
                             100:        long prev = startXrefOffset;                                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:800-860                                                                                                            
                             ```                                                                                                                                                                                 
                             800:                if (isThisTheEnd.isEmpty() && source.peek() == '[')                                                                                                             
                             801:                {                                                                                                                                                               
                             802:                    return po;                                                                                                                                                  
                             803:                }                                                                                                                                                               
                             804:                source.rewind(isThisTheEnd.getBytes(StandardCharsets.ISO_8859_1).length);                                                                                       
                             805:                // This could also be an "endobj" or "endstream" which means we can assume that                                                                                 
                             806:                // the array has ended.                                                                                                                                         
                             807:                if(ENDOBJ_STRING.equals(isThisTheEnd) || ENDSTREAM_STRING.equals(isThisTheEnd))                                                                                 
                             808:                {                                                                                                                                                               
                             809:                    return po;                                                                                                                                                  
                             810:                }                                                                                                                                                               
                             811:            }                                                                                                                                                                   
                             812:            else                                                                                                                                                                
                             813:            {                                                                                                                                                                   
                             814:                po.add(pbo);                                                                                                                                                    
                             815:            }                                                                                                                                                                   
                             816:            skipSpaces();                                                                                                                                                       
                             817:        }                                                                                                                                                                       
                             818:        // read ']'                                                                                                                                                             
                             819:        source.read();                                                                                                                                                          
                             820:        skipSpaces();                                                                                                                                                           
                             821:        return po;                                                                                                                                                              
                             822:    }                                                                                                                                                                           
                             823:                                                                                                                                                                                
                             824:    /**                                                                                                                                                                         
                             825:     * Determine if a character terminates a PDF name.                                                                                                                          
                             826:     *                                                                                                                                                                          
                             827:     * @param ch The character                                                                                                                                                  
                             828:     * @return true if the character terminates a PDF name, otherwise false.                                                                                                    
                             829:     */                                                                                                                                                                         
                             830:    protected static boolean isEndOfName(int ch)                                                                                                                                
                             831:    {                                                                                                                                                                           
                             832:        switch (ch)                                                                                                                                                             
                             833:        {                                                                                                                                                                       
                             834:        case ASCII_SPACE:                                                                                                                                                       
                             835:        case ASCII_CR:                                                                                                                                                          
                             836:        case ASCII_LF:                                                                                                                                                          
                             837:        case ASCII_TAB:                                                                                                                                                         
                             838:        case '>':                                                                                                                                                               
                             839:        case '<':                                                                                                                                                               
                             840:        case '[':                                                                                                                                                               
                             841:        case '/':                                                                                                                                                               
                             842:        case ']':                                                                                                                                                               
                             843:        case ')':                                                                                                                                                               
                             844:        case '(':                                                                                                                                                               
                             845:        case ASCII_NULL:                                                                                                                                                        
                             846:        case '\f':                                                                                                                                                              
                             847:        case '%':                                                                                                                                                               
                             848:        case -1:                                                                                                                                                                
                             849:            return true;                                                                                                                                                        
                             850:        default:                                                                                                                                                                
                             851:            return false;                                                                                                                                                       
                             852:        }                                                                                                                                                                       
                             853:    }                                                                                                                                                                           
                             854:                                                                                                                                                                                
                             855:    /**                                                                                                                                                                         
                             856:     * This will parse a PDF name from the stream.                                                                                                                              
                             857:     *                                                                                                                                                                          
                             858:     * @return The parsed PDF name.                                                                                                                                             
                             859:     * @throws IOException If there is an error reading from the stream.                                                                                                        
                             860:     */                                                                                                                                                                         
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:400-450                                                                                                            
                             ```                                                                                                                                                                                 
                             400:        }                                                                                                                                                                       
                             401:        return true;                                                                                                                                                            
                             402:    }                                                                                                                                                                           
                             403:                                                                                                                                                                                
                             404:    /**                                                                                                                                                                         
                             405:     * Skip the upcoming CRLF or LF which are supposed to follow a stream. Trailing spaces are removed as well.                                                                 
                             406:     *                                                                                                                                                                          
                             407:     * @throws IOException if something went wrong                                                                                                                              
                             408:     */                                                                                                                                                                         
                             409:    protected void skipWhiteSpaces() throws IOException                                                                                                                         
                             410:    {                                                                                                                                                                           
                             411:        //PDF Ref 3.2.7 A stream must be followed by either                                                                                                                     
                             412:        //a CRLF or LF but nothing else.                                                                                                                                        
                             413:        int whitespace = source.read();                                                                                                                                         
                             414:        //see brother_scan_cover.pdf, it adds whitespaces                                                                                                                       
                             415:        //after the stream but before the start of the                                                                                                                          
                             416:        //data, so just read those first                                                                                                                                        
                             417:        while (isSpace(whitespace))                                                                                                                                             
                             418:        {                                                                                                                                                                       
                             419:            whitespace = source.read();                                                                                                                                         
                             420:        }                                                                                                                                                                       
                             421:        if (!skipLinebreak(whitespace))                                                                                                                                         
                             422:        {                                                                                                                                                                       
                             423:            source.rewind(1);                                                                                                                                                   
                             424:        }                                                                                                                                                                       
                             425:    }                                                                                                                                                                           
                             426:                                                                                                                                                                                
                             427:    /**                                                                                                                                                                         
                             428:     * Skip one line break, such as CR, LF or CRLF.                                                                                                                             
                             429:     *                                                                                                                                                                          
                             430:     * @return true if a line break was found and removed.                                                                                                                      
                             431:     *                                                                                                                                                                          
                             432:     * @throws IOException if something went wrong                                                                                                                              
                             433:     */                                                                                                                                                                         
                             434:    protected boolean skipLinebreak() throws IOException                                                                                                                        
                             435:    {                                                                                                                                                                           
                             436:        // a line break is a CR, or LF or CRLF                                                                                                                                  
                             437:        if (!skipLinebreak(source.read()))                                                                                                                                      
                             438:        {                                                                                                                                                                       
                             439:            source.rewind(1);                                                                                                                                                   
                             440:            return false;                                                                                                                                                       
                             441:        }                                                                                                                                                                       
                             442:        return true;                                                                                                                                                            
                             443:    }                                                                                                                                                                           
                             444:                                                                                                                                                                                
                             445:    /**                                                                                                                                                                         
                             446:     * Skip one line break, such as CR, LF or CRLF.                                                                                                                             
                             447:     *                                                                                                                                                                          
                             448:     * @param linebreak the first character to be checked.                                                                                                                      
                             449:     *                                                                                                                                                                          
                             450:     * @return true if a line break was found and removed.                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:791-826                                                                                                            
                             ```                                                                                                                                                                                 
                             791:            // something went wrong                                                                                                                                             
                             792:            if (pbo == null)                                                                                                                                                    
                             793:            {                                                                                                                                                                   
                             794:                //it could be a bad object in the array which is just skipped                                                                                                   
                             795:                LOG.warn("Corrupt array element at offset {}, start offset: {}",                                                                                                
                             796:                        source.getPosition(), startPosition);                                                                                                                   
                             797:                String isThisTheEnd = readString();                                                                                                                             
                             798:                // return immediately if a corrupt element is followed by another array                                                                                         
                             799:                // to avoid a possible infinite recursion as most likely the whole array is corrupted                                                                           
                             800:                if (isThisTheEnd.isEmpty() && source.peek() == '[')                                                                                                             
                             801:                {                                                                                                                                                               
                             802:                    return po;                                                                                                                                                  
                             803:                }                                                                                                                                                               
                             804:                source.rewind(isThisTheEnd.getBytes(StandardCharsets.ISO_8859_1).length);                                                                                       
                             805:                // This could also be an "endobj" or "endstream" which means we can assume that                                                                                 
                             806:                // the array has ended.                                                                                                                                         
                             807:                if(ENDOBJ_STRING.equals(isThisTheEnd) || ENDSTREAM_STRING.equals(isThisTheEnd))                                                                                 
                             808:                {                                                                                                                                                               
                             809:                    return po;                                                                                                                                                  
                             810:                }                                                                                                                                                               
                             811:            }                                                                                                                                                                   
                             812:            else                                                                                                                                                                
                             813:            {                                                                                                                                                                   
                             814:                po.add(pbo);                                                                                                                                                    
                             815:            }                                                                                                                                                                   
                             816:            skipSpaces();                                                                                                                                                       
                             817:        }                                                                                                                                                                       
                             818:        // read ']'                                                                                                                                                             
                             819:        source.read();                                                                                                                                                          
                             820:        skipSpaces();                                                                                                                                                           
                             821:        return po;                                                                                                                                                              
                             822:    }                                                                                                                                                                           
                             823:                                                                                                                                                                                
                             824:    /**                                                                                                                                                                         
                             825:     * Determine if a character terminates a PDF name.                                                                                                                          
                             826:     *                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:827-870                                                                                                            
                             ```                                                                                                                                                                                 
                             827:     * @param ch The character                                                                                                                                                  
                             828:     * @return true if the character terminates a PDF name, otherwise false.                                                                                                    
                             829:     */                                                                                                                                                                         
                             830:    protected static boolean isEndOfName(int ch)                                                                                                                                
                             831:    {                                                                                                                                                                           
                             832:        switch (ch)                                                                                                                                                             
                             833:        {                                                                                                                                                                       
                             834:        case ASCII_SPACE:                                                                                                                                                       
                             835:        case ASCII_CR:                                                                                                                                                          
                             836:        case ASCII_LF:                                                                                                                                                          
                             837:        case ASCII_TAB:                                                                                                                                                         
                             838:        case '>':                                                                                                                                                               
                             839:        case '<':                                                                                                                                                               
                             840:        case '[':                                                                                                                                                               
                             841:        case '/':                                                                                                                                                               
                             842:        case ']':                                                                                                                                                               
                             843:        case ')':                                                                                                                                                               
                             844:        case '(':                                                                                                                                                               
                             845:        case ASCII_NULL:                                                                                                                                                        
                             846:        case '\f':                                                                                                                                                              
                             847:        case '%':                                                                                                                                                               
                             848:        case -1:                                                                                                                                                                
                             849:            return true;                                                                                                                                                        
                             850:        default:                                                                                                                                                                
                             851:            return false;                                                                                                                                                       
                             852:        }                                                                                                                                                                       
                             853:    }                                                                                                                                                                           
                             854:                                                                                                                                                                                
                             855:    /**                                                                                                                                                                         
                             856:     * This will parse a PDF name from the stream.                                                                                                                              
                             857:     *                                                                                                                                                                          
                             858:     * @return The parsed PDF name.                                                                                                                                             
                             859:     * @throws IOException If there is an error reading from the stream.                                                                                                        
                             860:     */                                                                                                                                                                         
                             861:    protected COSName parseCOSName() throws IOException                                                                                                                         
                             862:    {                                                                                                                                                                           
                             863:        readExpectedChar('/');                                                                                                                                                  
                             864:        ByteArrayOutputStream buffer = new ByteArrayOutputStream();                                                                                                             
                             865:        int c = source.read();                                                                                                                                                  
                             866:        while (!isEndOfName(c))                                                                                                                                                 
                             867:        {                                                                                                                                                                       
                             868:            final int ch = c;                                                                                                                                                   
                             869:            if (ch == '#')                                                                                                                                                      
                             870:            {                                                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Reapply and preserve the previous non-blocking whitespace and comment skipping patch in BaseParser:                                                                              
                                - Retain `MAX_SKIP_CHARS` in BaseParser, with its per-loop counters in `skipSpaces()` and `readUntilEndOfCOSDictionary()`, so that no unbounded character reads                  
                             occur in those methods.                                                                                                                                                             
                                                                                                                                                                                                                 
                             2. Introduce a per-line character limit in BaseParser.readLine() to prevent creation of extremely long strings that trigger pathological regex behavior:                            
                                a. In BaseParser, add a new constant:                                                                                                                                            
                                     private static final int MAX_LINE_CHARS = 10_000;                                                                                                                           
                                b. Modify `protected String readLine() throws IOException` (the method invoked by `parser.readLine()` in XrefParser):                                                            
                                   - Initialize a local `int lineCount = 0;`                                                                                                                                     
                                   - On each character read and appended to the `StringBuilder`, increment `lineCount` and throw an `IOException("Exceeded max line length at offset " +                         
                             source.getPosition())` if `lineCount > MAX_LINE_CHARS`.                                                                                                                             
                                   - Preserve existing logic for detecting end-of-line (CR, LF, CRLF) and rewinding after the newline.                                                                           
                                                                                                                                                                                                                 
                             3. Bound the number of XRef table entries to avoid excessive for-loop iterations and large token arrays:                                                                            
                                a. In XrefParser, add:                                                                                                                                                           
                                     private static final int MAX_XREF_ENTRIES = 10_000;                                                                                                                         
                                b. Immediately after parsing `count = Integer.parseInt(splitString[1]);`, insert:                                                                                                
                                     if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                                
                                         throw new IOException("XRef entry count out of bounds: " + count + " at offset " + parser.source.getPosition());                                                        
                                     }                                                                                                                                                                           
                                This ensures that a malicious header line with an enormous count cannot drive the parser into a long loop or create huge data structures.                                        
                                                                                                                                                                                                                 
                             4. (Optional extra safety) Replace regex splitting in `parseXrefTable` with a simple manual split on whitespace for the header line:                                                
                                - Instead of `String[] splitString = currentLine.split("\\s");`, use:                                                                                                            
                                     String[] splitString = splitOnWhitespace(currentLine, 2);                                                                                                                   
                                  where `splitOnWhitespace` is a small helper that scans for the first whitespace, extracts two tokens, and throws if it detects more than two tokens or invalid                 
                             format. This entirely avoids the `Pattern.split` machinery for long or weird inputs. (Because we already cap line length, the regex split may suffice, so this step                 
                             is optional.)                                                                                                                                                                       
                                                                                                                                                                                                                 
                             5. Impact and regression considerations:                                                                                                                                            
                                - Valid PDFs have reasonably small XRef sections and header lines; thresholds of 10 000 characters or entries far exceed typical use cases.                                      
                                - By throwing `IOException` early on suspicious inputs, we preserve existing parsing semantics (propagating exceptions up through `PDFParser.initialParse`).                     
                                - No changes are made to fuzz harness code or external dependencies.                                                                                                             
                                - Existing unit tests for well-formed PDFs remain unaffected, as they will not hit the new thresholds.                                                                           
                                                                                                                                                                                                                 
                             6. References to code structure:                                                                                                                                                    
                                - BaseParser.readLine sits in `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java`.                                                                                
                                - XrefParser.parseXrefTable is in `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java`.                                                                            
                                - The new constants and checks are local to these classes.                                                                                                                       
                                                                                                                                                                                                                 
                             This strategy ensures that:                                                                                                                                                         
                             - The parser does not hang in `Pattern.split` on huge or malicious lines.                                                                                                           
                             - The loop over XRef entries cannot run out of control.                                                                                                                             
                             - All existing whitespace-skipping protections remain intact.                                                                                                                       
                             - The overall parsing flow and fallback to XRef streams remain untouched.                                                                                                           
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 21:04:22] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/26/25 21:05:48] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/26/25 21:07:54] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:07:55] INFO     [logging_performance](pdfbox Setting owner) Took 0.96 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpmr9uq75w                                                                                                                                 default.py:173
[10/26/25 21:08:58] INFO     [logging_performance](pdfbox Patching) Took 62.24 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                                                                                                        context_managers.py:9
[10/26/25 21:09:12] INFO     [logging_performance](pdfbox Checking build) Took 14.41 seconds; exception=False                                                                              context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                                                                                                           context_managers.py:9
[10/26/25 21:09:43] ERROR    PoV found:                                                                                                                                                           __init__.py:102
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 25 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 5 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f430707ba00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3427719534                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x561f8aeca930, 0x561f8aecab30),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x561f8ae89590,0x561f8ae8b590),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 14 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 13 ms, size +14%)                                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 11 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 12 ms, size +1%)                                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 1 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 22 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 82 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 4 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 7 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 7 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 0 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 1 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 1 ms, size +9%)                                                                                                 
                             2025-10-26T21:09:17.263397375Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 3 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 1 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 7 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 4 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 9 ms, size +21%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 12 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 13 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 9 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 0 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 2 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 111 collections took 145ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmp7z9r2l5_:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                    ERROR    PoV found:                                                                                                                                                           __init__.py:103
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 25 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 5 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f430707ba00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3427719534                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x561f8aeca930, 0x561f8aecab30),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x561f8ae89590,0x561f8ae8b590),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 14 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 13 ms, size +14%)                                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 11 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 12 ms, size +1%)                                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 1 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 22 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 82 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 4 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 7 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 7 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 0 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 1 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 1 ms, size +9%)                                                                                                 
                             2025-10-26T21:09:17.263397375Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 3 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 1 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 7 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 4 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 9 ms, size +21%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 12 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 13 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 9 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 0 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 2 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 111 collections took 145ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmp7z9r2l5_:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                              Traceback (most recent call last)                 
                              /home/benchmark/crete/packages/crete/framework/evaluator/services/default/__init__.py:97 in _evaluate_internal                                                                   
                                                                                                                                                                                                               
                                 94       with logging_performance(context, header="Running PoV"):                                                                                                           
                                 95          try:                                                                                                                                                           
                                 96             if len(detection.blobs) > 0:                                                                                                                               
                                97                environment.run_pov(context, detection)                                                                                                                
                                 98             else:                                                                                                                                                      
                                 99                context["logger"].warning("No blob data found for the detection")                                                                                      
                                100                                                                                                                                                                            
                                                                                                                                                                                                               
                              /home/benchmark/crete/packages/crete/framework/environment/services/oss_fuzz/cached.py:56 in run_pov                                                                             
                                                                                                                                                                                                               
                                 53       self, context: EnvironmentContext, detection: Detection                                                                                                            
                                 54    ) -> tuple[str, str]:                                                                                                                                                  
                                 55       assert len(detection.blobs) > 0, "At least one blob is required"                                                                                                   
                                56       return self.environment.run_pov(context, detection)                                                                                                                
                                 57                                                                                                                                                                           
                                 58    def run_tests(                                                                                                                                                         
                                 59       self, context: EnvironmentContext, env: dict[str, str] = {}                                                                                                        
                                                                                                                                                                                                               
                              /home/benchmark/crete/packages/crete/framework/environment/services/oss_fuzz/default.py:210 in run_pov                                                                           
                                                                                                                                                                                                               
                                207             context, blobinfo.blob, blobinfo.harness_name                                                                                                              
                                208          )                                                                                                                                                              
                                209          if not success:                                                                                                                                                
                               210             raise ChallengePoVFoundError(                                                                                                                              
                                211                stdout=stdout.encode(errors="ignore"),                                                                                                                 
                                212                stderr=stderr.encode(errors="ignore"),                                                                                                                 
                                213             )                                                                                                                                                          
                                             
                             ChallengePoVFoundError: PoV found:                                                                                                                                                  
                             - Stdout:                                                                                                                                                                           
                             + FUZZER=PDFExtractTextFuzzer                                                                                                                                                       
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer PDFExtractTextFuzzer -runs=100 /testcase                                                                                                                               
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/PDFExtractTextFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null                                                                                            
                             OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.                                          
                             OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended                                                   
                             INFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks                                                                                                      
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks                                                                                                        
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks                                                                                                      
                             INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks                                                                                                       
                             INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks                                                                                                  
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization                                                                                                   
                             INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection                                                                                       
                             INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection                                                                                                    
                             INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup                                                                                              
                             INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection                                                                                                
                             INFO: Loaded 68 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall                                                                                                   
                             INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection                                                                                                    
                             INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks                                                                                                  
                             INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection                                                                                            
                             INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery                                                                                          
                             INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection                                                                                                     
                             INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection                                                                                                    
                             INFO: Instrumented com.sun.tools.attach.VirtualMachine (took 36 ms, size +20%)                                                                                                      
                             INFO: Instrumented com.sun.tools.attach.AttachNotSupportedException (took 1 ms, size +18%)                                                                                          
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy5                                                                                                             
                             WARN: Failed to load bytecode of class com.sun.proxy.jdk.proxy1.$Proxy1                                                                                                             
                             INFO: Instrumented com.example.PDFExtractTextFuzzer (took 25 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessRead (took 5 ms, size +17%)                                                                                                     
                             INFO: using inputs from: /testcase                                                                                                                                                  
                             INFO: found LLVMFuzzerCustomMutator (0x7f430707ba00). Disabling -len_control by default.                                                                                            
                             INFO: libFuzzer ignores flags that start with '--'                                                                                                                                  
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3427719534                                                                                                                                                              
                             INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x561f8aeca930, 0x561f8aecab30),                                                                                         
                             INFO: Loaded 1 PC tables (512 PCs): 512 [0x561f8ae89590,0x561f8ae8b590),                                                                                                            
                             jazzer: Running 1 inputs 100 time(s) each.                                                                                                                                          
                             Running: /testcase                                                                                                                                                                  
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessReadBuffer (took 14 ms, size +18%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.Loader (took 7 ms, size +5%)                                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.io.IOUtils (took 13 ms, size +14%)                                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.LogManager (took 11 ms, size +8%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Logger (took 12 ms, size +1%)                                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory (took 1 ms, size +0%)                                                                                            
                             INFO: New number of coverage counters: 1024                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger (took 22 ms, size +10%)                                                                                             
                             INFO: New number of coverage counters: 2048                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.AbstractLogger (took 82 ms, size +6%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.spi.ExtendedLogger (took 0 ms, size +0%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.LocationAwareLogger (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.MessageFactory2 (took 0 ms, size +0%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.message.Message (took 0 ms, size +17%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.LoggingException (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.LogBuilder (took 2 ms, size +4%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusListener (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager (took 2 ms, size +20%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.MarkerManager$Log4jMarker (took 4 ms, size +37%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.Marker (took 0 ms, size +0%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.util.StringBuilderFormattable (took 0 ms, size +0%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedMessageFactory (took 2 ms, size +4%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.AbstractMessageFactory (took 2 ms, size +3%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.DefaultFlowMessageFactory (took 2 ms, size +11%)                                                                                
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessageFactory (took 0 ms, size +0%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.internal.DefaultLogBuilder (took 8 ms, size +10%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.BridgeAware (took 0 ms, size +0%)                                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.Level (took 4 ms, size +19%)                                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.StandardLevel (took 1 ms, size +15%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.Strings (took 3 ms, size +14%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$InstanceHolder (took 0 ms, size +13%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.ParameterizedNoReferenceMessageFactory (took 0 ms, size +8%)                                                                    
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$Config (took 7 ms, size +14%)                                                                                       
                             INFO: Instrumented org.apache.logging.log4j.status.StatusLogger$PropertiesUtilsDouble (took 7 ms, size +21%)                                                                        
                             INFO: Instrumented org.apache.logging.log4j.status.StatusConsoleListener (took 2 ms, size +15%)                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.message.ExitMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.FlowMessage (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.message.EntryMessage (took 0 ms, size +0%)                                                                                              
                             INFO: New number of coverage counters: 4096                                                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.ProviderUtil (took 4 ms, size +14%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.spi.Provider (took 4 ms, size +22%)                                                                                                     
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider (took 0 ms, size +17%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil (took 1 ms, size +11%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.ServiceLoaderUtil$ServiceLoaderSpliterator (took 0 ms, size +8%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocatorUtil (took 1 ms, size +8%)                                                                                             
                             INFO: Instrumented org.apache.logging.log4j.util.StackLocator (took 4 ms, size +18%)                                                                                                
                             INFO: Instrumented org.apache.logging.log4j.util.OsgiServiceLocator (took 2 ms, size +16%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil (took 5 ms, size +15%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.InternalException (took 0 ms, size +13%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.LazyBoolean (took 1 ms, size +27%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.util.LoaderUtil$ThreadContextClassLoaderGetter (took 0 ms, size +17%)                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil (took 8 ms, size +17%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource (took 0 ms, size +7%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.Lazy (took 1 ms, size +4%)                                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$SafeLazy (took 1 ms, size +15%)                                                                                           
                             INFO: Instrumented org.apache.logging.log4j.util.PropertyFilePropertySource (took 1 ms, size +11%)                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesPropertySource (took 1 ms, size +10%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.PropertiesUtil$Environment (took 2 ms, size +8%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.BiConsumer (took 0 ms, size +0%)                                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.EnvironmentPropertySource (took 2 ms, size +20%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.util.SystemPropertiesPropertySource (took 1 ms, size +8%)                                                                               
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil (took 0 ms, size +11%)                                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.util.LazyUtil$1 (took 0 ms, size +19%)                                                                                                  
                             INFO: Instrumented org.apache.logging.log4j.util.Cast (took 0 ms, size +15%)                                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Util (took 1 ms, size +35%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.util.PropertySource$Comparator (took 0 ms, size +30%)                                                                                   
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContextFactory (took 0 ms, size +22%)                                                                                         
                             INFO: Instrumented org.apache.logging.log4j.spi.ThreadContextMap (took 0 ms, size +0%)                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.SimpleMessage (took 2 ms, size +26%)                                                                                            
                             INFO: Instrumented org.apache.logging.log4j.status.StatusData (took 1 ms, size +9%)                                                                                                 
                             2025-10-26T21:09:17.263397375Z main ERROR Log4j API could not find a logging provider.                                                                                              
                             INFO: Instrumented org.apache.logging.log4j.message.ReusableMessageFactory (took 3 ms, size +5%)                                                                                    
                             INFO: Instrumented org.apache.logging.log4j.message.Clearable (took 0 ms, size +0%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.simple.internal.SimpleProvider$Config (took 0 ms, size +26%)                                                                            
                             INFO: Instrumented org.apache.logging.log4j.spi.NoOpThreadContextMap (took 1 ms, size +9%)                                                                                          
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContextFactory (took 1 ms, size +8%)                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerContext (took 1 ms, size +6%)                                                                                                 
                             INFO: Instrumented org.apache.logging.log4j.internal.LogManagerStatus (took 0 ms, size +18%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLoggerContext (took 7 ms, size +4%)                                                                                        
                             INFO: Instrumented org.apache.logging.log4j.spi.LoggerRegistry (took 3 ms, size +18%)                                                                                               
                             INFO: Instrumented org.apache.logging.log4j.simple.SimpleLogger (took 4 ms, size +14%)                                                                                              
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache$StreamCacheCreateFunction (took 0 ms, size +0%)                                                                     
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCache (took 0 ms, size +0%)                                                                                               
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessStreamCacheImpl (took 0 ms, size +15%)                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccess (took 0 ms, size +0%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.io.RandomAccessWrite (took 0 ms, size +0%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.PDFParser (took 2 ms, size +12%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.pdfparser.COSParser (took 9 ms, size +21%)                                                                                                     
                             INFO: Instrumented org.apache.pdfbox.cos.ICOSParser (took 0 ms, size +0%)                                                                                                           
                             INFO: New number of coverage counters: 8192                                                                                                                                         
                             INFO: Instrumented org.apache.pdfbox.pdfparser.BaseParser (took 12 ms, size +30%)                                                                                                   
                             INFO: Instrumented org.apache.pdfbox.cos.COSBase (took 0 ms, size +12%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.pdmodel.common.COSObjectable (took 0 ms, size +0%)                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSNull (took 0 ms, size +11%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSObject (took 2 ms, size +10%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateInfo (took 0 ms, size +14%)                                                                                                       
                             INFO: Instrumented org.apache.pdfbox.cos.COSDictionary (took 13 ms, size +17%)                                                                                                      
                             INFO: Instrumented org.apache.pdfbox.cos.COSString (took 2 ms, size +25%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSArray (took 9 ms, size +20%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSName (took 8 ms, size +15%)                                                                                                             
                             INFO: Instrumented org.apache.pdfbox.cos.COSBoolean (took 1 ms, size +18%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSNumber (took 1 ms, size +57%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial (took 0 ms, size +27%)                                                                                   
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial (took 0 ms, size +16%)                                                                          
                             INFO: Instrumented org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial (took 0 ms, size +16%)                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSStream (took 3 ms, size +11%)                                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocument (took 5 ms, size +9%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSDocumentState (took 0 ms, size +42%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefParser (took 5 ms, size +24%)                                                                                                    
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver (took 3 ms, size +21%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XRefType (took 0 ms, size +10%)                                                                                  
                             INFO: Instrumented org.apache.pdfbox.pdfparser.XrefTrailerResolver$XrefTrailerObj (took 0 ms, size +10%)                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.COSObjectKey (took 2 ms, size +25%)                                                                                                        
                             INFO: Instrumented org.apache.pdfbox.cos.COSInteger (took 2 ms, size +16%)                                                                                                          
                             INFO: Instrumented org.apache.pdfbox.cos.COSFloat (took 2 ms, size +39%)                                                                                                            
                             INFO: Instrumented org.apache.pdfbox.cos.UnmodifiableCOSDictionary (took 0 ms, size +14%)                                                                                           
                             INFO: Instrumented org.apache.pdfbox.cos.COSUpdateState (took 2 ms, size +23%)                                                                                                      
                             ALARM: working on the last Unit for 25 seconds                                                                                                                                      
                                    and the timeout value is 25 (use -timeout=N to change)                                                                                                                       
                             ==16== ERROR: libFuzzer: timeout after 25 seconds                                                                                                                                   
                                                                                                                                                                                                                 
                             Stack traces of all JVM threads:                                                                                                                                                    
                             Thread[Finalizer,8,system]                                                                                                                                                          
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)                                                                                            
                                     at java.base@17.0.2/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Signal Dispatcher,9,system]                                                                                                                                                  
                                                                                                                                                                                                                 
                             Thread[Reference Handler,10,system]                                                                                                                                                 
                                     at java.base@17.0.2/java.lang.ref.Reference.waitForReferencePendingList(Native Method)                                                                                      
                                     at java.base@17.0.2/java.lang.ref.Reference.processPendingReferences(Reference.java:253)                                                                                    
                                     at java.base@17.0.2/java.lang.ref.Reference$ReferenceHandler.run(Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             Thread[Notification Thread,9,system]                                                                                                                                                
                                                                                                                                                                                                                 
                             Thread[main,5,main]                                                                                                                                                                 
                                     at app//com.code_intelligence.jazzer.driver.FuzzTargetRunner.dumpAllStackTraces(FuzzTargetRunner.java:534)                                                                  
                                                                                                                                                                                                                 
                             Thread[Common-Cleaner,8,InnocuousThreadGroup]                                                                                                                                       
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Cleaner-0,5,InnocuousThreadGroup]                                                                                                                                            
                                     at java.base@17.0.2/java.lang.Object.wait(Native Method)                                                                                                                    
                                     at java.base@17.0.2/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)                                                                                            
                                     at java.base@17.0.2/jdk.internal.ref.CleanerImpl.run(CleanerImpl.java:140)                                                                                                  
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                     at java.base@17.0.2/jdk.internal.misc.InnocuousThread.run(InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             Thread[Attach Listener,9,system]                                                                                                                                                    
                                                                                                                                                                                                                 
                             Thread[process reaper,10,system]                                                                                                                                                    
                                     at java.base@17.0.2/jdk.internal.misc.Unsafe.park(Native Method)                                                                                                            
                                     at java.base@17.0.2/java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:252)                                                                                  
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:401)                                                                 
                                     at java.base@17.0.2/java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:903)                                                                                   
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)                                                                           
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)                                                                         
                                     at java.base@17.0.2/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)                                                                         
                                     at java.base@17.0.2/java.lang.Thread.run(Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             Garbage collector stats:                                                                                                                                                            
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl (took 1 ms, size +14%)                                                                                     
                             INFO: detected a native library load, enabling interception for libc functions                                                                                                      
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$1 (took 1 ms, size +8%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$2 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$3 (took 0 ms, size +4%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$4 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.DiagnosticCommandImpl (took 4 ms, size +16%)                                                                                         
                             INFO: Instrumented com.sun.management.DiagnosticCommandMBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.management.internal.PlatformMBeanProviderImpl$5 (took 0 ms, size +6%)                                                                                    
                             INFO: Instrumented com.sun.management.internal.GarbageCollectorExtImpl (took 3 ms, size +13%)                                                                                       
                             INFO: Instrumented com.sun.management.GarbageCollectorMXBean (took 0 ms, size +0%)                                                                                                  
                             INFO: Instrumented com.sun.jmx.mbeanserver.GetPropertyAction (took 0 ms, size +13%)                                                                                                 
                             INFO: Instrumented com.sun.jmx.mbeanserver.Util (took 2 ms, size +13%)                                                                                                              
                                                                                                                                                                                                                 
                             PS MarkSweep: 0 collections took 0ms                                                                                                                                                
                             PS Scavenge: 111 collections took 145ms                                                                                                                                             
                                                                                                                                                                                                                 
                             SUMMARY: libFuzzer: timeout                                                                                                                                                         
                             subprocess command returned a non-zero exit status: 70                                                                                                                              
                                                                                                                                                                                                                 
                             - Stderr:                                                                                                                                                                           
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox:/out -v /tmp/tmp7z9r2l5_:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                              
                             PDFExtractTextFuzzer -runs=100.                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Running PoV) Took 30.86 seconds; exception=False                                                                                 context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:09:44] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:09:45] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:09:46] INFO     [logging_performance](pdfbox Setting owner) Took 1.05 seconds; exception=False                                                                                context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                                                              __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:09:47] INFO     [logging_performance](pdfbox Setting owner) Took 0.99 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:10:18] INFO     Found jstack output at /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                                                                      __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             @@ -66,6 +66,8 @@                                                                                                                                                                   
                                                                                                                                                                                                                 
                                  private static final Charset ALTERNATIVE_CHARSET;                                                                                                                              
                                                                                                                                                                                                                 
                             +    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_LINE_CHARS = 10000;                                                                                                                               
                                  private final Map<Long, COSObjectKey> keyCache = new HashMap<>();                                                                                                              
                                                                                                                                                                                                                 
                                  static                                                                                                                                                                         
                             @@ -373,7 +375,6 @@                                                                                                                                                                 
                                      source.rewind(1);                                                                                                                                                          
                                      return false;                                                                                                                                                              
                                  }                                                                                                                                                                              
                             -                                                                                                                                                                                   
                                  private boolean parseCOSDictionaryNameValuePair(COSDictionary obj) throws IOException                                                                                          
                                  {                                                                                                                                                                              
                                      COSName key = parseCOSName();                                                                                                                                              
                             @@ -1163,21 +1164,25 @@                                                                                                                                                             
                                  {                                                                                                                                                                              
                                      if (source.isEOF())                                                                                                                                                        
                                      {                                                                                                                                                                          
                             -            throw new IOException( "Error: End-of-File, expected line at offset " +                                                                                                
                             +            throw new IOException("Error: End-of-File, expected line at offset " +                                                                                                 
                                                  source.getPosition());                                                                                                                                         
                                      }                                                                                                                                                                          
                                                                                                                                                                                                                 
                             -        StringBuilder buffer = new StringBuilder( 11 );                                                                                                                            
                             -                                                                                                                                                                                   
                             +        StringBuilder buffer = new StringBuilder(11);                                                                                                                              
                             +        int lineCount = 0;                                                                                                                                                         
                                      int c;                                                                                                                                                                     
                                      while ((c = source.read()) != -1)                                                                                                                                          
                                      {                                                                                                                                                                          
                             +            if (++lineCount > MAX_LINE_CHARS)                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded max line length at offset " + source.getPosition());                                                                               
                             +            }                                                                                                                                                                      
                                          // CR and LF are valid EOLs                                                                                                                                            
                                          if (isEOL(c))                                                                                                                                                          
                                          {                                                                                                                                                                      
                                              break;                                                                                                                                                             
                                          }                                                                                                                                                                      
                             -            buffer.append( (char)c );                                                                                                                                              
                             +            buffer.append((char)c);                                                                                                                                                
                                      }                                                                                                                                                                          
                                      // CR+LF is also a valid EOL                                                                                                                                               
                                      if (isCR(c) && isLF(source.peek()))                                                                                                                                        
                             @@ -1318,16 +1323,25 @@                                                                                                                                                             
                                   */                                                                                                                                                                            
                                  protected void skipSpaces() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                             +        int skipCount = 0;                                                                                                                                                         
                                      int c = source.read();                                                                                                                                                     
                                      // 37 is the % character, a comment                                                                                                                                        
                             -        while( isWhitespace(c) || c == 37)                                                                                                                                         
                             -        {                                                                                                                                                                          
                             -            if ( c == 37 )                                                                                                                                                         
                             +        while (isWhitespace(c) || c == 37)                                                                                                                                         
                             +        {                                                                                                                                                                          
                             +            if (++skipCount > MAX_SKIP_CHARS)                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded max skip characters at offset " + source.getPosition());                                                                           
                             +            }                                                                                                                                                                      
                             +            if (c == 37)                                                                                                                                                           
                                          {                                                                                                                                                                      
                                              // skip past the comment section                                                                                                                                   
                                              c = source.read();                                                                                                                                                 
                             -                while(!isEOL(c) && c != -1)                                                                                                                                        
                             +                while (!isEOL(c) && c != -1)                                                                                                                                       
                                              {                                                                                                                                                                  
                             +                    if (++skipCount > MAX_SKIP_CHARS)                                                                                                                              
                             +                    {                                                                                                                                                              
                             +                        throw new IOException("Exceeded max skip characters at offset " + source.getPosition());                                                                   
                             +                    }                                                                                                                                                              
                                                  c = source.read();                                                                                                                                             
                                              }                                                                                                                                                                  
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             @@ -44,6 +44,7 @@                                                                                                                                                                   
                                  private static final int X = 'x';                                                                                                                                              
                                  private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                               
                                  private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                       
                             +    private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                             
                                                                                                                                                                                                                 
                                  /**                                                                                                                                                                            
                                   * Collects all Xref/trailer objects and resolves them into single                                                                                                             
                             @@ -630,6 +631,11 @@                                                                                                                                                                
                                              LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                                 
                                              return false;                                                                                                                                                      
                                          }                                                                                                                                                                      
                             +            if (count < 0 || count > MAX_XREF_ENTRIES)                                                                                                                             
                             +            {                                                                                                                                                                      
                             +                throw new IOException("XRef entry count out of bounds: " + count                                                                                                   
                             +                        + " at offset " + parser.source.getPosition());                                                                                                            
                             +            }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          parser.skipSpaces();                                                                                                                                                   
                                          for(int i = 0; i < count; i++)                                                                                                                                         
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             The fuzzer run against the PDFBox-based target (`PDFExtractTextFuzzer`) produced a libFuzzer timeout after ~28 s, with the main thread stuck in                                     
                             `BaseParser.skipSpaces` and related parsing routines. To address the hang, a patch was attempted that:                                                                              
                                                                                                                                                                                                                 
                             - Removed or replaced parts of the `parseCOSDictionaryNameValuePair` implementation in `BaseParser.java`, instead inserting a new `protected String readLine()`                     
                             method and two new constants (`MAX_LINE_CHARS`, `MAX_SKIP_CHARS`).                                                                                                                  
                             - Added a `MAX_XREF_ENTRIES` constant and a bounds check for the number of xref entries in `XrefParser.java`.                                                                       
                                                                                                                                                                                                                 
                             Applying this patch caused a compilation failure in `BaseParser.java`:                                                                                                              
                                                                                                                                                                                                                 
                             ```                                                                                                                                                                                 
                             /src/.../BaseParser.java:[379,5] illegal start of expression                                                                                                                        
                             ```                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             No further classes compiled successfully in the PDFBox module.                                                                                                                      
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. **Initial Issue**                                                                                                                                                                
                                - The fuzz harness (`PDFExtractTextFuzzer`) invokes `Loader.loadPDF`, which delegates to `PDFParser.parse`.                                                                      
                                - In the thread dump, the main thread is runnable and repeatedly in:                                                                                                           
                                  ```                                                                                                                                                                            
                                  BaseParser.skipSpaces  parseCOSDictionaryValue  parseCOSDictionaryNameValuePair  ...                                                                                        
                                  XrefParser.parseXref  XrefParser.parseTrailer                                                                                                                                 
                                  ```                                                                                                                                                                            
                                - No crash is reported; instead libFuzzer reports `ERROR: libFuzzer: timeout`, indicating a possible infinite loop or excessively long operation in the parsing                  
                             code.                                                                                                                                                                               
                                                                                                                                                                                                                 
                             2. **Important Observations in the Initial Issue**                                                                                                                                  
                                - The parsing methods (`skipSpaces`, `parseCOSDictionaryValue`, `parseCOSDictionaryNameValuePair`, `XrefParser.parseXref`) are active when the timeout occurs.                   
                                - The fuzzer is driving PDFBox to process malformed or adversarial PDF content, likely triggering pathological parsing behavior.                                                 
                                                                                                                                                                                                                 
                             3. **Patch Attempt**                                                                                                                                                                
                                - **In BaseParser.java**                                                                                                                                                         
                                  - Around line 376, the existing `parseCOSDictionaryNameValuePair(COSDictionary obj)` method body was removed.                                                                  
                                  - A new method was inserted:                                                                                                                                                   
                                    ```java                                                                                                                                                                      
                                    protected String readLine() throws IOException {                                                                                                                             
                                        StringBuilder sb = new StringBuilder();                                                                                                                                  
                                        int lineCount = 0;                                                                                                                                                       
                                        int c = source.read();                                                                                                                                                   
                                        while (c != -1 && !isEOL(c)) {                                                                                                                                           
                                            if (++lineCount > MAX_LINE_CHARS) {                                                                                                                                  
                                                throw new IOException("Exceeded max line length at offset " + source.getPosition());                                                                             
                                            }                                                                                                                                                                    
                                            sb.append((char) c);                                                                                                                                                 
                                            c = source.read();                                                                                                                                                   
                                        }                                                                                                                                                                        
                                        if (c == '\r') {                                                                                                                                                         
                                            int next = source.read();                                                                                                                                            
                                            if (next != '\n') {                                                                                                                                                  
                                                source.rewind(1);                                                                                                                                                
                                            }                                                                                                                                                                    
                                        }                                                                                                                                                                        
                                        return sb.toString();                                                                                                                                                    
                                    }                                                                                                                                                                            
                                    ```                                                                                                                                                                          
                                  - Two new constants were introduced immediately before the existing `skipSpaces()` methods javadoc:                                                                           
                                    ```java                                                                                                                                                                      
                                    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                             
                                    private static final int MAX_LINE_CHARS = 10000;                                                                                                                             
                                    ```                                                                                                                                                                          
                                - **In XrefParser.java**                                                                                                                                                         
                                  - Added at the top of the class:                                                                                                                                               
                                    ```java                                                                                                                                                                      
                                    private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                           
                                    ```                                                                                                                                                                          
                                  - In the loop that reads xref subsections (around line 630), inserted:                                                                                                         
                                    ```java                                                                                                                                                                      
                                    if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                                 
                                        throw new IOException("XRef entry count out of bounds: " + count                                                                                                         
                                                + " at offset " + parser.source.getPosition());                                                                                                                  
                                    }                                                                                                                                                                            
                                    ```                                                                                                                                                                          
                                - **Resulting Log**                                                                                                                                                              
                                  - The patch applied cleanly but led to a compile error in `BaseParser.java`:                                                                                                   
                                    ```                                                                                                                                                                          
                                    illegal start of expression                                                                                                                                                  
                                    ```                                                                                                                                                                          
                                  - Mavens compilation stopped with a single error at the modified location, preventing further analysis.                                                                       
                                                                                                                                                                                                                 
                             4. **Areas for Further Investigation**                                                                                                                                              
                                - **Method Structure in BaseParser.java**: The illegal start of expression suggests the new code was placed outside any method or inside another methods body                   
                             inappropriately. The surrounding lines and braces need review.                                                                                                                      
                                - **parseCOSDictionaryNameValuePair**: The removal of its body and replacement with an unrelated `readLine` method broke the classs compilation unit. Its                       
                             original signature, return type, and call sites should be reconciled.                                                                                                               
                                - **skipSpaces**: The insertion of `MAX_SKIP_CHARS` and `MAX_LINE_CHARS` near its javadoc may have offset comments or annotationsverify formatting and                          
                             placement.                                                                                                                                                                          
                                - **XrefParser.parseXref**: Confirm that the new `MAX_XREF_ENTRIES` check does not alter control flow or indexing, and that exceptions thrown are handled by the                 
                             caller.                                                                                                                                                                             
                                - **Overall Class Cohesion**: After patching, ensure that all method signatures, braces, and imports are balanced and that no methods overlap or are nested                      
                             incorrectly.                                                                                                                                                                        
                                                                                                                                                                                                                 
                             No speculative root causes are provided; this report focuses on the observed timeout, the exact patch contents, the compilation failure, and the code regions                       
                             requiring closer examination.                                                                                                                                                       
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.093 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.165 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  4.247 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.621 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  1.220 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.286 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:03:59Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[379,5] illegal start of expression                                             
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:300-350                                                                                                            
                             ```                                                                                                                                                                                 
                             300:                if (!parseCOSDictionaryNameValuePair(obj))                                                                                                                      
                             301:                {                                                                                                                                                               
                             302:                    return obj;                                                                                                                                                 
                             303:                }                                                                                                                                                               
                             304:            }                                                                                                                                                                   
                             305:            else                                                                                                                                                                
                             306:            {                                                                                                                                                                   
                             307:                // invalid dictionary, we were expecting a /Name, read until the end or until we can recover                                                                    
                             308:                LOG.warn("Invalid dictionary, found: '{}' but expected: '/' at offset {}", c,                                                                                   
                             309:                        source.getPosition());                                                                                                                                  
                             310:                if (readUntilEndOfCOSDictionary())                                                                                                                              
                             311:                {                                                                                                                                                               
                             312:                    // we couldn't recover                                                                                                                                      
                             313:                    return obj;                                                                                                                                                 
                             314:                }                                                                                                                                                               
                             315:            }                                                                                                                                                                   
                             316:        }                                                                                                                                                                       
                             317:        try                                                                                                                                                                     
                             318:        {                                                                                                                                                                       
                             319:            readExpectedChar('>');                                                                                                                                              
                             320:            readExpectedChar('>');                                                                                                                                              
                             321:        }                                                                                                                                                                       
                             322:        catch (IOException exception)                                                                                                                                           
                             323:        {                                                                                                                                                                       
                             324:            LOG.warn("Invalid dictionary, can't find end of dictionary at offset {}",                                                                                           
                             325:                    source.getPosition());                                                                                                                                      
                             326:        }                                                                                                                                                                       
                             327:        return obj;                                                                                                                                                             
                             328:    }                                                                                                                                                                           
                             329:                                                                                                                                                                                
                             330:    /**                                                                                                                                                                         
                             331:     * Keep reading until the end of the dictionary object or the file has been hit, or until a '/'                                                                             
                             332:     * has been found.                                                                                                                                                          
                             333:     *                                                                                                                                                                          
                             334:     * @return true if the end of the object or the file has been found, false if not, i.e. that the                                                                            
                             335:     * caller can continue to parse the dictionary at the current position.                                                                                                     
                             336:     *                                                                                                                                                                          
                             337:     * @throws IOException if there is a reading error.                                                                                                                         
                             338:     */                                                                                                                                                                         
                             339:    private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                             340:    {                                                                                                                                                                           
                             341:        int c = source.read();                                                                                                                                                  
                             342:        while (c != -1 && c != '/' && c != '>')                                                                                                                                 
                             343:        {                                                                                                                                                                       
                             344:            // in addition to stopping when we find / or >, we also want                                                                                                        
                             345:            // to stop when we find endstream or endobj.                                                                                                                        
                             346:            if (c == E)                                                                                                                                                         
                             347:            {                                                                                                                                                                   
                             348:                c = source.read();                                                                                                                                              
                             349:                if (c == N)                                                                                                                                                     
                             350:                {                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:350-420                                                                                                            
                             ```                                                                                                                                                                                 
                             350:                {                                                                                                                                                               
                             351:                    c = source.read();                                                                                                                                          
                             352:                    if (c == D)                                                                                                                                                 
                             353:                    {                                                                                                                                                           
                             354:                        c = source.read();                                                                                                                                      
                             355:                        boolean isStream = c == S && source.read() == T && source.read() == R                                                                                   
                             356:                                && source.read() == E && source.read() == A && source.read() == M;                                                                              
                             357:                        boolean isObj = !isStream && c == O && source.read() == B                                                                                               
                             358:                                && source.read() == J;                                                                                                                          
                             359:                        if (isStream || isObj)                                                                                                                                  
                             360:                        {                                                                                                                                                       
                             361:                            // we're done reading this object!                                                                                                                  
                             362:                            return true;                                                                                                                                        
                             363:                        }                                                                                                                                                       
                             364:                    }                                                                                                                                                           
                             365:                }                                                                                                                                                               
                             366:            }                                                                                                                                                                   
                             367:            c = source.read();                                                                                                                                                  
                             368:        }                                                                                                                                                                       
                             369:        if (c == -1)                                                                                                                                                            
                             370:        {                                                                                                                                                                       
                             371:            return true;                                                                                                                                                        
                             372:        }                                                                                                                                                                       
                             373:        source.rewind(1);                                                                                                                                                       
                             374:        return false;                                                                                                                                                           
                             375:    }                                                                                                                                                                           
                             376:                                                                                                                                                                                
                             377:    private boolean parseCOSDictionaryNameValuePair(COSDictionary obj) throws IOException                                                                                       
                             378:    {                                                                                                                                                                           
                             379:        COSName key = parseCOSName();                                                                                                                                           
                             380:        if (key == null || key.getName().isEmpty())                                                                                                                             
                             381:        {                                                                                                                                                                       
                             382:            LOG.warn("Empty COSName at offset {}", source.getPosition());                                                                                                       
                             383:        }                                                                                                                                                                       
                             384:        COSBase value = parseCOSDictionaryValue();                                                                                                                              
                             385:        skipSpaces();                                                                                                                                                           
                             386:        if (value == null)                                                                                                                                                      
                             387:        {                                                                                                                                                                       
                             388:            LOG.warn("Bad dictionary declaration at offset {}", source.getPosition());                                                                                          
                             389:            return false;                                                                                                                                                       
                             390:        }                                                                                                                                                                       
                             391:        else if (value instanceof COSInteger && !((COSInteger) value).isValid())                                                                                                
                             392:        {                                                                                                                                                                       
                             393:            LOG.warn("Skipped out of range number value at offset {}", source.getPosition());                                                                                   
                             394:        }                                                                                                                                                                       
                             395:        else                                                                                                                                                                    
                             396:        {                                                                                                                                                                       
                             397:            // label this item as direct, to avoid signature problems.                                                                                                          
                             398:            value.setDirect(true);                                                                                                                                              
                             399:            obj.setItem(key, value);                                                                                                                                            
                             400:        }                                                                                                                                                                       
                             401:        return true;                                                                                                                                                            
                             402:    }                                                                                                                                                                           
                             403:                                                                                                                                                                                
                             404:    /**                                                                                                                                                                         
                             405:     * Skip the upcoming CRLF or LF which are supposed to follow a stream. Trailing spaces are removed as well.                                                                 
                             406:     *                                                                                                                                                                          
                             407:     * @throws IOException if something went wrong                                                                                                                              
                             408:     */                                                                                                                                                                         
                             409:    protected void skipWhiteSpaces() throws IOException                                                                                                                         
                             410:    {                                                                                                                                                                           
                             411:        //PDF Ref 3.2.7 A stream must be followed by either                                                                                                                     
                             412:        //a CRLF or LF but nothing else.                                                                                                                                        
                             413:        int whitespace = source.read();                                                                                                                                         
                             414:        //see brother_scan_cover.pdf, it adds whitespaces                                                                                                                       
                             415:        //after the stream but before the start of the                                                                                                                          
                             416:        //data, so just read those first                                                                                                                                        
                             417:        while (isSpace(whitespace))                                                                                                                                             
                             418:        {                                                                                                                                                                       
                             419:            whitespace = source.read();                                                                                                                                         
                             420:        }                                                                                                                                                                       
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1-50                                                                                                               
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:package org.apache.pdfbox.pdfparser;                                                                                                                                             
                             18:                                                                                                                                                                                 
                             19:import java.io.ByteArrayOutputStream;                                                                                                                                            
                             20:import java.io.IOException;                                                                                                                                                      
                             21:                                                                                                                                                                                 
                             22:import java.nio.ByteBuffer;                                                                                                                                                      
                             23:import java.nio.charset.CharacterCodingException;                                                                                                                                
                             24:import java.nio.charset.Charset;                                                                                                                                                 
                             25:import java.nio.charset.CharsetDecoder;                                                                                                                                          
                             26:import java.nio.charset.CodingErrorAction;                                                                                                                                       
                             27:import java.nio.charset.StandardCharsets;                                                                                                                                        
                             28:                                                                                                                                                                                 
                             29:import java.util.HashMap;                                                                                                                                                        
                             30:import java.util.Map;                                                                                                                                                            
                             31:                                                                                                                                                                                 
                             32:import org.apache.logging.log4j.Logger;                                                                                                                                          
                             33:import org.apache.logging.log4j.LogManager;                                                                                                                                      
                             34:                                                                                                                                                                                 
                             35:import org.apache.pdfbox.cos.COSArray;                                                                                                                                           
                             36:import org.apache.pdfbox.cos.COSBase;                                                                                                                                            
                             37:import org.apache.pdfbox.cos.COSBoolean;                                                                                                                                         
                             38:import org.apache.pdfbox.cos.COSDictionary;                                                                                                                                      
                             39:import org.apache.pdfbox.cos.COSDocument;                                                                                                                                        
                             40:import org.apache.pdfbox.cos.COSInteger;                                                                                                                                         
                             41:import org.apache.pdfbox.cos.COSName;                                                                                                                                            
                             42:import org.apache.pdfbox.cos.COSNull;                                                                                                                                            
                             43:import org.apache.pdfbox.cos.COSNumber;                                                                                                                                          
                             44:import org.apache.pdfbox.cos.COSObject;                                                                                                                                          
                             45:import org.apache.pdfbox.cos.COSObjectKey;                                                                                                                                       
                             46:import org.apache.pdfbox.cos.COSString;                                                                                                                                          
                             47:import org.apache.pdfbox.io.RandomAccessRead;                                                                                                                                    
                             48:                                                                                                                                                                                 
                             49:/**                                                                                                                                                                              
                             50: * This class is used to contain parsing logic that will be used by all parsers.                                                                                                 
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:350-402                                                                                                            
                             ```                                                                                                                                                                                 
                             350:                {                                                                                                                                                               
                             351:                    c = source.read();                                                                                                                                          
                             352:                    if (c == D)                                                                                                                                                 
                             353:                    {                                                                                                                                                           
                             354:                        c = source.read();                                                                                                                                      
                             355:                        boolean isStream = c == S && source.read() == T && source.read() == R                                                                                   
                             356:                                && source.read() == E && source.read() == A && source.read() == M;                                                                              
                             357:                        boolean isObj = !isStream && c == O && source.read() == B                                                                                               
                             358:                                && source.read() == J;                                                                                                                          
                             359:                        if (isStream || isObj)                                                                                                                                  
                             360:                        {                                                                                                                                                       
                             361:                            // we're done reading this object!                                                                                                                  
                             362:                            return true;                                                                                                                                        
                             363:                        }                                                                                                                                                       
                             364:                    }                                                                                                                                                           
                             365:                }                                                                                                                                                               
                             366:            }                                                                                                                                                                   
                             367:            c = source.read();                                                                                                                                                  
                             368:        }                                                                                                                                                                       
                             369:        if (c == -1)                                                                                                                                                            
                             370:        {                                                                                                                                                                       
                             371:            return true;                                                                                                                                                        
                             372:        }                                                                                                                                                                       
                             373:        source.rewind(1);                                                                                                                                                       
                             374:        return false;                                                                                                                                                           
                             375:    }                                                                                                                                                                           
                             376:                                                                                                                                                                                
                             377:    private boolean parseCOSDictionaryNameValuePair(COSDictionary obj) throws IOException                                                                                       
                             378:    {                                                                                                                                                                           
                             379:        COSName key = parseCOSName();                                                                                                                                           
                             380:        if (key == null || key.getName().isEmpty())                                                                                                                             
                             381:        {                                                                                                                                                                       
                             382:            LOG.warn("Empty COSName at offset {}", source.getPosition());                                                                                                       
                             383:        }                                                                                                                                                                       
                             384:        COSBase value = parseCOSDictionaryValue();                                                                                                                              
                             385:        skipSpaces();                                                                                                                                                           
                             386:        if (value == null)                                                                                                                                                      
                             387:        {                                                                                                                                                                       
                             388:            LOG.warn("Bad dictionary declaration at offset {}", source.getPosition());                                                                                          
                             389:            return false;                                                                                                                                                       
                             390:        }                                                                                                                                                                       
                             391:        else if (value instanceof COSInteger && !((COSInteger) value).isValid())                                                                                                
                             392:        {                                                                                                                                                                       
                             393:            LOG.warn("Skipped out of range number value at offset {}", source.getPosition());                                                                                   
                             394:        }                                                                                                                                                                       
                             395:        else                                                                                                                                                                    
                             396:        {                                                                                                                                                                       
                             397:            // label this item as direct, to avoid signature problems.                                                                                                          
                             398:            value.setDirect(true);                                                                                                                                              
                             399:            obj.setItem(key, value);                                                                                                                                            
                             400:        }                                                                                                                                                                       
                             401:        return true;                                                                                                                                                            
                             402:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1100-1230                                                                                                          
                             ```                                                                                                                                                                                 
                             1100:        char c = (char) source.read();                                                                                                                                         
                             1101:        if (c != ec)                                                                                                                                                           
                             1102:        {                                                                                                                                                                      
                             1103:            throw new IOException(                                                                                                                                             
                             1104:                    "expected='" + ec + "' actual='" + c + "' at offset " + source.getPosition());                                                                             
                             1105:        }                                                                                                                                                                      
                             1106:    }                                                                                                                                                                          
                             1107:                                                                                                                                                                               
                             1108:    /**                                                                                                                                                                        
                             1109:     * This will read the next string from the stream up to a certain length.                                                                                                  
                             1110:     *                                                                                                                                                                         
                             1111:     * @param length The length to stop reading at.                                                                                                                            
                             1112:     *                                                                                                                                                                         
                             1113:     * @return The string that was read from the stream of length 0 to length.                                                                                                 
                             1114:     *                                                                                                                                                                         
                             1115:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1116:     */                                                                                                                                                                        
                             1117:    protected String readString( int length ) throws IOException                                                                                                               
                             1118:    {                                                                                                                                                                          
                             1119:        skipSpaces();                                                                                                                                                          
                             1120:                                                                                                                                                                               
                             1121:        int c = source.read();                                                                                                                                                 
                             1122:                                                                                                                                                                               
                             1123:        //average string size is around 2 and the normal string buffer size is                                                                                                 
                             1124:        //about 16 so lets save some space.                                                                                                                                    
                             1125:        StringBuilder buffer = new StringBuilder(length);                                                                                                                      
                             1126:        while( !isWhitespace(c) && !isClosing(c) && c != -1 && buffer.length() < length &&                                                                                     
                             1127:                c != '[' &&                                                                                                                                                    
                             1128:                c != '<' &&                                                                                                                                                    
                             1129:                c != '(' &&                                                                                                                                                    
                             1130:                c != '/' )                                                                                                                                                     
                             1131:        {                                                                                                                                                                      
                             1132:            buffer.append( (char)c );                                                                                                                                          
                             1133:            c = source.read();                                                                                                                                                 
                             1134:        }                                                                                                                                                                      
                             1135:        if (c != -1)                                                                                                                                                           
                             1136:        {                                                                                                                                                                      
                             1137:            source.rewind(1);                                                                                                                                                  
                             1138:        }                                                                                                                                                                      
                             1139:        return buffer.toString();                                                                                                                                              
                             1140:    }                                                                                                                                                                          
                             1141:                                                                                                                                                                               
                             1142:    /**                                                                                                                                                                        
                             1143:     * This will tell if the next character is a closing brace( close of PDF array ).                                                                                          
                             1144:     *                                                                                                                                                                         
                             1145:     * @param c The character to check against end of line                                                                                                                     
                             1146:     * @return true if the next byte is ']', false otherwise.                                                                                                                  
                             1147:     */                                                                                                                                                                        
                             1148:    protected static boolean isClosing(int c)                                                                                                                                  
                             1149:    {                                                                                                                                                                          
                             1150:        return c == ']';                                                                                                                                                       
                             1151:    }                                                                                                                                                                          
                             1152:                                                                                                                                                                               
                             1153:    /**                                                                                                                                                                        
                             1154:     * This will read bytes until the first end of line marker occurs.                                                                                                         
                             1155:     * NOTE: The EOL marker may consists of 1 (CR or LF) or 2 (CR and CL) bytes                                                                                                
                             1156:     * which is an important detail if one wants to unread the line.                                                                                                           
                             1157:     *                                                                                                                                                                         
                             1158:     * @return The characters between the current position and the end of the line.                                                                                            
                             1159:     *                                                                                                                                                                         
                             1160:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1161:     */                                                                                                                                                                        
                             1162:    protected String readLine() throws IOException                                                                                                                             
                             1163:    {                                                                                                                                                                          
                             1164:        if (source.isEOF())                                                                                                                                                    
                             1165:        {                                                                                                                                                                      
                             1166:            throw new IOException( "Error: End-of-File, expected line at offset " +                                                                                            
                             1167:                    source.getPosition());                                                                                                                                     
                             1168:        }                                                                                                                                                                      
                             1169:                                                                                                                                                                               
                             1170:        StringBuilder buffer = new StringBuilder( 11 );                                                                                                                        
                             1171:                                                                                                                                                                               
                             1172:        int c;                                                                                                                                                                 
                             1173:        while ((c = source.read()) != -1)                                                                                                                                      
                             1174:        {                                                                                                                                                                      
                             1175:            // CR and LF are valid EOLs                                                                                                                                        
                             1176:            if (isEOL(c))                                                                                                                                                      
                             1177:            {                                                                                                                                                                  
                             1178:                break;                                                                                                                                                         
                             1179:            }                                                                                                                                                                  
                             1180:            buffer.append( (char)c );                                                                                                                                          
                             1181:        }                                                                                                                                                                      
                             1182:        // CR+LF is also a valid EOL                                                                                                                                           
                             1183:        if (isCR(c) && isLF(source.peek()))                                                                                                                                    
                             1184:        {                                                                                                                                                                      
                             1185:            source.read();                                                                                                                                                     
                             1186:        }                                                                                                                                                                      
                             1187:        return buffer.toString();                                                                                                                                              
                             1188:    }                                                                                                                                                                          
                             1189:                                                                                                                                                                               
                             1190:    /**                                                                                                                                                                        
                             1191:     * This will tell if the end of the data is reached.                                                                                                                       
                             1192:     *                                                                                                                                                                         
                             1193:     * @return true if the end of the data is reached.                                                                                                                         
                             1194:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1195:     */                                                                                                                                                                        
                             1196:    protected boolean isEOF() throws IOException                                                                                                                               
                             1197:    {                                                                                                                                                                          
                             1198:        return source.isEOF();                                                                                                                                                 
                             1199:    }                                                                                                                                                                          
                             1200:                                                                                                                                                                               
                             1201:    /**                                                                                                                                                                        
                             1202:     * This will tell if the next byte to be read is an end of line byte.                                                                                                      
                             1203:     *                                                                                                                                                                         
                             1204:     * @param c The character to check against end of line                                                                                                                     
                             1205:     * @return true if the next byte is 0x0A or 0x0D.                                                                                                                          
                             1206:     */                                                                                                                                                                        
                             1207:    protected static boolean isEOL(int c)                                                                                                                                      
                             1208:    {                                                                                                                                                                          
                             1209:        return isLF(c) || isCR(c);                                                                                                                                             
                             1210:    }                                                                                                                                                                          
                             1211:                                                                                                                                                                               
                             1212:    /**                                                                                                                                                                        
                             1213:     * This will tell if the next byte to be read is a line feed.                                                                                                              
                             1214:     *                                                                                                                                                                         
                             1215:     * @param c The character to check against line feed                                                                                                                       
                             1216:     * @return true if the next byte is 0x0A.                                                                                                                                  
                             1217:     */                                                                                                                                                                        
                             1218:    private static boolean isLF(int c)                                                                                                                                         
                             1219:    {                                                                                                                                                                          
                             1220:        return ASCII_LF == c;                                                                                                                                                  
                             1221:    }                                                                                                                                                                          
                             1222:                                                                                                                                                                               
                             1223:    /**                                                                                                                                                                        
                             1224:     * This will tell if the next byte to be read is a carriage return.                                                                                                        
                             1225:     *                                                                                                                                                                         
                             1226:     * @param c The character to check against carriage return                                                                                                                 
                             1227:     * @return true if the next byte is 0x0D.                                                                                                                                  
                             1228:     */                                                                                                                                                                        
                             1229:    private static boolean isCR(int c)                                                                                                                                         
                             1230:    {                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1-200                                                                                                              
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:package org.apache.pdfbox.pdfparser;                                                                                                                                             
                             18:                                                                                                                                                                                 
                             19:import java.io.ByteArrayOutputStream;                                                                                                                                            
                             20:import java.io.IOException;                                                                                                                                                      
                             21:                                                                                                                                                                                 
                             22:import java.nio.ByteBuffer;                                                                                                                                                      
                             23:import java.nio.charset.CharacterCodingException;                                                                                                                                
                             24:import java.nio.charset.Charset;                                                                                                                                                 
                             25:import java.nio.charset.CharsetDecoder;                                                                                                                                          
                             26:import java.nio.charset.CodingErrorAction;                                                                                                                                       
                             27:import java.nio.charset.StandardCharsets;                                                                                                                                        
                             28:                                                                                                                                                                                 
                             29:import java.util.HashMap;                                                                                                                                                        
                             30:import java.util.Map;                                                                                                                                                            
                             31:                                                                                                                                                                                 
                             32:import org.apache.logging.log4j.Logger;                                                                                                                                          
                             33:import org.apache.logging.log4j.LogManager;                                                                                                                                      
                             34:                                                                                                                                                                                 
                             35:import org.apache.pdfbox.cos.COSArray;                                                                                                                                           
                             36:import org.apache.pdfbox.cos.COSBase;                                                                                                                                            
                             37:import org.apache.pdfbox.cos.COSBoolean;                                                                                                                                         
                             38:import org.apache.pdfbox.cos.COSDictionary;                                                                                                                                      
                             39:import org.apache.pdfbox.cos.COSDocument;                                                                                                                                        
                             40:import org.apache.pdfbox.cos.COSInteger;                                                                                                                                         
                             41:import org.apache.pdfbox.cos.COSName;                                                                                                                                            
                             42:import org.apache.pdfbox.cos.COSNull;                                                                                                                                            
                             43:import org.apache.pdfbox.cos.COSNumber;                                                                                                                                          
                             44:import org.apache.pdfbox.cos.COSObject;                                                                                                                                          
                             45:import org.apache.pdfbox.cos.COSObjectKey;                                                                                                                                       
                             46:import org.apache.pdfbox.cos.COSString;                                                                                                                                          
                             47:import org.apache.pdfbox.io.RandomAccessRead;                                                                                                                                    
                             48:                                                                                                                                                                                 
                             49:/**                                                                                                                                                                              
                             50: * This class is used to contain parsing logic that will be used by all parsers.                                                                                                 
                             51: *                                                                                                                                                                               
                             52: * @author Ben Litchfield                                                                                                                                                        
                             53: */                                                                                                                                                                              
                             54:public abstract class BaseParser                                                                                                                                                 
                             55:{                                                                                                                                                                                
                             56:    /**                                                                                                                                                                          
                             57:     * Log instance.                                                                                                                                                             
                             58:     */                                                                                                                                                                          
                             59:    private static final Logger LOG = LogManager.getLogger(BaseParser.class);                                                                                                    
                             60:                                                                                                                                                                                 
                             61:    private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;                                                                                                            
                             62:                                                                                                                                                                                 
                             63:    private static final long GENERATION_NUMBER_THRESHOLD = 65535;                                                                                                               
                             64:                                                                                                                                                                                 
                             65:    private static final int MAX_LENGTH_LONG = Long.toString(Long.MAX_VALUE).length();                                                                                           
                             66:                                                                                                                                                                                 
                             67:    private static final Charset ALTERNATIVE_CHARSET;                                                                                                                            
                             68:                                                                                                                                                                                 
                             69:    private final Map<Long, COSObjectKey> keyCache = new HashMap<>();                                                                                                            
                             70:                                                                                                                                                                                 
                             71:    static                                                                                                                                                                       
                             72:    {                                                                                                                                                                            
                             73:        Charset cs;                                                                                                                                                              
                             74:        String charsetName = "Windows-1252";                                                                                                                                     
                             75:        try                                                                                                                                                                      
                             76:        {                                                                                                                                                                        
                             77:            cs = Charset.forName(charsetName);                                                                                                                                   
                             78:        }                                                                                                                                                                        
                             79:        catch (IllegalArgumentException | UnsupportedOperationException e)                                                                                                       
                             80:        {                                                                                                                                                                        
                             81:            cs = StandardCharsets.ISO_8859_1;                                                                                                                                    
                             82:            LOG.warn(() -> "Charset is not supported: " + charsetName + ", falling back to " +                                                                                   
                             83:                    StandardCharsets.ISO_8859_1.name(), e);                                                                                                                      
                             84:        }                                                                                                                                                                        
                             85:        ALTERNATIVE_CHARSET = cs;                                                                                                                                                
                             86:    }                                                                                                                                                                            
                             87:                                                                                                                                                                                 
                             88:    // CharSetDecoders are not threadsafe so not static                                                                                                                          
                             89:    private final CharsetDecoder utf8Decoder = StandardCharsets.UTF_8.newDecoder()                                                                                               
                             90:            .onMalformedInput(CodingErrorAction.REPORT)                                                                                                                          
                             91:            .onUnmappableCharacter(CodingErrorAction.REPORT);                                                                                                                    
                             92:                                                                                                                                                                                 
                             93:    protected static final int E = 'e';                                                                                                                                          
                             94:    protected static final int N = 'n';                                                                                                                                          
                             95:    protected static final int D = 'd';                                                                                                                                          
                             96:                                                                                                                                                                                 
                             97:    protected static final int S = 's';                                                                                                                                          
                             98:    protected static final int T = 't';                                                                                                                                          
                             99:    protected static final int R = 'r';                                                                                                                                          
                             100:    protected static final int A = 'a';                                                                                                                                         
                             101:    protected static final int M = 'm';                                                                                                                                         
                             102:                                                                                                                                                                                
                             103:    protected static final int O = 'o';                                                                                                                                         
                             104:    protected static final int B = 'b';                                                                                                                                         
                             105:    protected static final int J = 'j';                                                                                                                                         
                             106:                                                                                                                                                                                
                             107:    /**                                                                                                                                                                         
                             108:     * This is a string constant that will be used for comparisons.                                                                                                             
                             109:     */                                                                                                                                                                         
                             110:    public static final String DEF = "def";                                                                                                                                     
                             111:    /**                                                                                                                                                                         
                             112:     * This is a string constant that will be used for comparisons.                                                                                                             
                             113:     */                                                                                                                                                                         
                             114:    protected static final String ENDOBJ_STRING = "endobj";                                                                                                                     
                             115:    /**                                                                                                                                                                         
                             116:     * This is a string constant that will be used for comparisons.                                                                                                             
                             117:     */                                                                                                                                                                         
                             118:    protected static final String ENDSTREAM_STRING = "endstream";                                                                                                               
                             119:    /**                                                                                                                                                                         
                             120:     * This is a string constant that will be used for comparisons.                                                                                                             
                             121:     */                                                                                                                                                                         
                             122:    protected static final String STREAM_STRING = "stream";                                                                                                                     
                             123:    /**                                                                                                                                                                         
                             124:     * This is a string constant that will be used for comparisons.                                                                                                             
                             125:     */                                                                                                                                                                         
                             126:    private static final char[] TRUE = { 't', 'r', 'u', 'e' };                                                                                                                  
                             127:    /**                                                                                                                                                                         
                             128:     * This is a string constant that will be used for comparisons.                                                                                                             
                             129:     */                                                                                                                                                                         
                             130:    private static final char[] FALSE = { 'f', 'a', 'l', 's', 'e' };                                                                                                            
                             131:    /**                                                                                                                                                                         
                             132:     * This is a string constant that will be used for comparisons.                                                                                                             
                             133:     */                                                                                                                                                                         
                             134:    private static final char[] NULL = { 'n', 'u', 'l', 'l' };                                                                                                                  
                             135:                                                                                                                                                                                
                             136:    /**                                                                                                                                                                         
                             137:     * ASCII code for Null.                                                                                                                                                     
                             138:     */                                                                                                                                                                         
                             139:    private static final byte ASCII_NULL = 0;                                                                                                                                   
                             140:    /**                                                                                                                                                                         
                             141:     * ASCII code for horizontal tab.                                                                                                                                           
                             142:     */                                                                                                                                                                         
                             143:    private static final byte ASCII_TAB = 9;                                                                                                                                    
                             144:    /**                                                                                                                                                                         
                             145:     * ASCII code for line feed.                                                                                                                                                
                             146:     */                                                                                                                                                                         
                             147:    private static final byte ASCII_LF = 10;                                                                                                                                    
                             148:    /**                                                                                                                                                                         
                             149:     * ASCII code for form feed.                                                                                                                                                
                             150:     */                                                                                                                                                                         
                             151:    private static final byte ASCII_FF = 12;                                                                                                                                    
                             152:    /**                                                                                                                                                                         
                             153:     * ASCII code for carriage return.                                                                                                                                          
                             154:     */                                                                                                                                                                         
                             155:    private static final byte ASCII_CR = 13;                                                                                                                                    
                             156:    private static final byte ASCII_ZERO = 48;                                                                                                                                  
                             157:    private static final byte ASCII_NINE = 57;                                                                                                                                  
                             158:    private static final byte ASCII_SPACE = 32;                                                                                                                                 
                             159:                                                                                                                                                                                
                             160:    /**                                                                                                                                                                         
                             161:     * This is the stream that will be read from.                                                                                                                               
                             162:     */                                                                                                                                                                         
                             163:    protected final RandomAccessRead source;                                                                                                                                    
                             164:                                                                                                                                                                                
                             165:    /**                                                                                                                                                                         
                             166:     * This is the document that will be parsed.                                                                                                                                
                             167:     */                                                                                                                                                                         
                             168:    protected COSDocument document;                                                                                                                                             
                             169:                                                                                                                                                                                
                             170:    /**                                                                                                                                                                         
                             171:     * Default constructor.                                                                                                                                                     
                             172:     */                                                                                                                                                                         
                             173:    BaseParser(RandomAccessRead pdfSource)                                                                                                                                      
                             174:    {                                                                                                                                                                           
                             175:        this.source = pdfSource;                                                                                                                                                
                             176:    }                                                                                                                                                                           
                             177:                                                                                                                                                                                
                             178:    private static boolean isHexDigit(char ch)                                                                                                                                  
                             179:    {                                                                                                                                                                           
                             180:        return isDigit(ch) ||                                                                                                                                                   
                             181:        (ch >= 'a' && ch <= 'f') ||                                                                                                                                             
                             182:        (ch >= 'A' && ch <= 'F');                                                                                                                                               
                             183:    }                                                                                                                                                                           
                             184:                                                                                                                                                                                
                             185:    /**                                                                                                                                                                         
                             186:     * Returns the object key for the given combination of object and generation number. The object key from the cross                                                          
                             187:     * reference table/stream will be reused if available. Otherwise a newly created object will be returned.                                                                   
                             188:     *                                                                                                                                                                          
                             189:     * @param num the given object number                                                                                                                                       
                             190:     * @param gen the given generation number                                                                                                                                   
                             191:     *                                                                                                                                                                          
                             192:     * @return the COS object key                                                                                                                                               
                             193:     */                                                                                                                                                                         
                             194:    protected COSObjectKey getObjectKey(long num, int gen)                                                                                                                      
                             195:    {                                                                                                                                                                           
                             196:        if (document == null || document.getXrefTable().isEmpty())                                                                                                              
                             197:        {                                                                                                                                                                       
                             198:            return new COSObjectKey(num, gen);                                                                                                                                  
                             199:        }                                                                                                                                                                       
                             200:        // use a cache to get the COSObjectKey as iterating over the xref-table-map gets slow for big pdfs                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:54-67                                                                                                              
                             ```                                                                                                                                                                                 
                             54:public abstract class BaseParser                                                                                                                                                 
                             55:{                                                                                                                                                                                
                             56:    /**                                                                                                                                                                          
                             57:     * Log instance.                                                                                                                                                             
                             58:     */                                                                                                                                                                          
                             59:    private static final Logger LOG = LogManager.getLogger(BaseParser.class);                                                                                                    
                             60:                                                                                                                                                                                 
                             61:    private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;                                                                                                            
                             62:                                                                                                                                                                                 
                             63:    private static final long GENERATION_NUMBER_THRESHOLD = 65535;                                                                                                               
                             64:                                                                                                                                                                                 
                             65:    private static final int MAX_LENGTH_LONG = Long.toString(Long.MAX_VALUE).length();                                                                                           
                             66:                                                                                                                                                                                 
                             67:    private static final Charset ALTERNATIVE_CHARSET;                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:36-60                                                                                                              
                             ```                                                                                                                                                                                 
                             36:                                                                                                                                                                                 
                             37:/**                                                                                                                                                                              
                             38: * Parser to be used to read the cross reference table of a pdf. It is either a simple table or a stream.                                                                        
                             39: */                                                                                                                                                                              
                             40:public class XrefParser                                                                                                                                                          
                             41:{                                                                                                                                                                                
                             42:    private static final Logger LOG = LogManager.getLogger(XrefParser.class);                                                                                                    
                             43:                                                                                                                                                                                 
                             44:    private static final int X = 'x';                                                                                                                                            
                             45:    private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                             
                             46:    private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                     
                             47:                                                                                                                                                                                 
                             48:    /**                                                                                                                                                                          
                             49:     * Collects all Xref/trailer objects and resolves them into single                                                                                                           
                             50:     * object using startxref reference.                                                                                                                                         
                             51:     */                                                                                                                                                                          
                             52:    private XrefTrailerResolver xrefTrailerResolver = new XrefTrailerResolver();                                                                                                 
                             53:                                                                                                                                                                                 
                             54:    private final COSParser parser;                                                                                                                                              
                             55:    private final RandomAccessRead source;                                                                                                                                       
                             56:                                                                                                                                                                                 
                             57:    /**                                                                                                                                                                          
                             58:     * Default constructor.                                                                                                                                                      
                             59:     *                                                                                                                                                                           
                             60:     * @param cosParser the parser to be used to read the pdf.                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:623-632                                                                                                            
                             ```                                                                                                                                                                                 
                             623:            int count = 0;                                                                                                                                                      
                             624:            try                                                                                                                                                                 
                             625:            {                                                                                                                                                                   
                             626:                count = Integer.parseInt(splitString[1]);                                                                                                                       
                             627:            }                                                                                                                                                                   
                             628:            catch (NumberFormatException exception)                                                                                                                             
                             629:            {                                                                                                                                                                   
                             630:                LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                              
                             631:                return false;                                                                                                                                                   
                             632:            }                                                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Restore the original parseCOSDictionaryNameValuePair method                                                                                                                      
                                - Revert the accidental removal/replacement that inserted the new readLine at its signature.                                                                                     
                                - Restore lines 377402 in BaseParser.java to exactly match the upstream implementation, so that `private boolean parseCOSDictionaryNameValuePair(COSDictionary                  
                             obj) throws IOException {  }` contains its original logic for key, value parsing and returns true/false accordingly.                                                               
                                                                                                                                                                                                                 
                             2. Consolidate/limit line-reading logic by enhancing the existing readLine method                                                                                                   
                                - Locate the existing `protected String readLine() throws IOException` (around line 1162) and remove any duplicate readLine methods inserted at other points in                  
                             the class.                                                                                                                                                                          
                                - In that existing method, introduce a loop counter `int lineCount = 0;` before the `while ((c = source.read()) != -1)` loop. On each iteration increment                        
                             `lineCount`, and if `lineCount > MAX_LINE_CHARS`, throw an `IOException("Exceeded max line length at offset " + source.getPosition())`. This preserves the original                 
                             EOL detection and CR/LF rewinding logic while bounding pathological inputs.                                                                                                         
                                                                                                                                                                                                                 
                             3. Introduce a skip-spaces counter in skipSpaces                                                                                                                                    
                                - Add two new class-level constants immediately after existing `private static final` fields (e.g., after ASCII constants near line 67):                                         
                                    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                             
                                    private static final int MAX_LINE_CHARS = 10000;                                                                                                                             
                                - In `protected void skipSpaces() throws IOException` (around line 1319), declare `int skipCount = 0;` before the loop. Inside the `while (isWhitespace(c) || c                  
                             == 37)` loop, increment `skipCount` on each iteration and if it exceeds `MAX_SKIP_CHARS`, throw `new IOException("Exceeded max skip characters at offset " +                        
                             source.getPosition())`. Then continue the existing logic of skipping comments and whitespace.                                                                                       
                                                                                                                                                                                                                 
                             4. Safeguard XrefParser.parseXref against unbounded counts                                                                                                                          
                                - At the top of XrefParser.java, alongside other `private static final` declarations, add:                                                                                       
                                    private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                           
                                - In the loop where xref subsection sizes are parsed (after `count = Integer.parseInt(...)`), insert:                                                                            
                                    if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                                 
                                        throw new IOException("XRef entry count out of bounds: " + count                                                                                                         
                                                + " at offset " + parser.source.getPosition());                                                                                                                  
                                    }                                                                                                                                                                            
                                This prevents maliciously large xref loops.                                                                                                                                      
                                                                                                                                                                                                                 
                             5. Validate braces and placement to fix the compilation error                                                                                                                       
                                - Ensure all method bodies and class braces are properly balanced: there is exactly one `parseCOSDictionaryNameValuePair` method, one `skipSpaces`, and one                      
                             `readLine`. No method or field declarations are nested incorrectly.                                                                                                                 
                                - Verify the two new constants (`MAX_SKIP_CHARS`, `MAX_LINE_CHARS`) are declared at class scope, not inside any method or after a Javadoc.                                       
                                                                                                                                                                                                                 
                             6. Preserve existing functionality and fuzz harness behavior                                                                                                                        
                                - By restoring the original dictionary-parsing method, we avoid any unintended logic changes to PDF parsing.                                                                     
                                - The enhancements (bounded skipSpaces, bounded readLine, bounded xref count) only throw `IOException` on pathological inputs, which the parser already                          
                             tolerates and logs.                                                                                                                                                                 
                                - No external libraries, harness files, or test code are modified.                                                                                                               
                                                                                                                                                                                                                 
                             Justification                                                                                                                                                                       
                             - Restoring parseCOSDictionaryNameValuePair repairs the compilation error (illegal start of expression) by eliminating the misplaced readLine.                                    
                             - Enhancing the existing readLine and skipSpaces methods, rather than adding duplicate methods, keeps the class coherent and avoids signature conflicts.                            
                             - Introducing thresholds for whitespace skips, line length, and xref entry counts directly addresses the infinite-loop/time-out conditions reported by libFuzzer.                   
                             - Throwing `IOException` is consistent with existing error handling in BaseParser and XrefParser; callers of these methods already catch or log IO exceptions.                      
                                                                                                                                                                                                                 
                             Potential side effects & mitigation                                                                                                                                                 
                             - Legitimate PDFs with extremely long lines or large whitespace runs might trigger these exceptions; thresholds (10 000) should be high enough for real-world                       
                             documents. If false positives occur, thresholds can be tuned upward.                                                                                                                
                             - All exceptions propagate as `IOException`, which will abort parsing of the current PDF but will not crash the JVM or fuzz harness.                                                
                                                                                                                                                                                                                 
                             References in codebase                                                                                                                                                              
                             - There are existing examples in BaseParser of throwing `IOException` on unexpected conditions (e.g., `readExpectedChar`). The proposed exceptions follow the same                  
                             pattern.                                                                                                                                                                            
                             - The static constant grouping (ASCII codes, thresholds) aligns with existing style and placement in BaseParser.java.                                                               
                             - Similar bounds checking is used elsewhere in PDFBox (e.g., for object and generation number thresholds).                                                                          
                                                                                                                                                                                                                 
                             No additional code retrieval is required; the context from the provided snippets is sufficient to implement the above steps.                                                        
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 21:10:28] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 4, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 21:11:57] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 4, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 21:15:15] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 4, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:15:16] INFO     [logging_performance](pdfbox Setting owner) Took 1.01 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpj15m9121                                                                                                                                 default.py:173
[10/26/25 21:15:52] ERROR    Failed to build the challenge                                                                                                                                         __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stdout.txt: /src /src/project-parent/pdfbox                    functions.py:17
                             /src/project-parent/pdfbox                                                                                                                                                          
                             ---------------------------------------------------------------                                                                                                                     
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             ---------------------------------------------------------------                                                                                                                     
                             CC=clang                                                                                                                                                                            
                             CXX=clang++                                                                                                                                                                         
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                   
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak                                       
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                 
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak                        
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                                                                                                    
                             ---------------------------------------------------------------                                                                                                                     
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                                                                                                            
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                                                                                              
                             + '[' '!' -L /root/.m2/repository ']'                                                                                                                                               
                             + unset __REAL_MAVEN_REPO                                                                                                                                                           
                             + unset __SHARED_MAVEN_REPO                                                                                                                                                         
                             + PROJECT=pdfbox                                                                                                                                                                    
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                                                                                                
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                                                                                                        
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                                                                                                         
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                                                                                                 
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                                                                                                         
                             + cd /src/project-parent                                                                                                                                                            
                             + [[ -v LOCAL_DEV ]]                                                                                                                                                                
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                                                                                              
                             + set_project_version_in_fuzz_targets_dependency                                                                                                                                    
                             ++ cd pdfbox                                                                                                                                                                        
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout                                    
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                                                                                                    
                             + cd fuzz-targets                                                                                                                                                                   
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                            
                             [INFO] Scanning for projects...                                                                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                                                                                                     
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                                                                                                 
                             [INFO]   from pom.xml                                                                                                                                                               
                             [INFO] --------------------------------[ jar ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                                                                                                         
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD SUCCESS                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  0.719 s                                                                                                                                                         
                             [INFO] Finished at: 2025-10-26T21:15:23Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             + cd pdfbox                                                                                                                                                                         
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                             
                             [INFO] Scanning for projects...                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Build Order:                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent                                               [pom]                                                                                                     
                             [INFO] Apache PDFBox io                                                [bundle]                                                                                                     
                             [INFO] Apache FontBox                                                  [bundle]                                                                                                     
                             [INFO] Apache XmpBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox Debugger                                             [jar]                                                                                                     
                             [INFO] Apache PDFBox tools                                                [jar]                                                                                                     
                             [INFO] Apache PDFBox application                                          [jar]                                                                                                     
                             [INFO] Apache PDFBox Debugger application                                 [jar]                                                                                                     
                             [INFO] Apache PDFBox examples                                             [jar]                                                                                                     
                             [INFO] pdfbox-reactor                                                     [pom]                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                                                                                                     
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                                                                                                     
                             [INFO]   from parent/pom.xml                                                                                                                                                        
                             [INFO] --------------------------------[ pom ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                                                                                                     
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                                                                                                       
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                                                                                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                                                                                                       
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                                                                                                
                                                                                                                                                                                                                 
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---                                                                                            
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                                                                                                        
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                                                                                              
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                                                                                                     
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                                                                                                     
                             [INFO]   from io/pom.xml                                                                                                                                                            
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                                                                                                         
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                                                                                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                                                                                                    
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                                                                                                
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                                                                                                            
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources                                                                                         
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                                                                                                
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                                                                                                    
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                                                                                                           
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                                                                                                        
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                                                                                                       
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                                                                                                            
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                                                                                                     
                             [INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                                                                          
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                                                                                                
                             [INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                                                                                                  
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                                          
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                                                                                              
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                                                                                      
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                                                                                                   
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                                                                                                     
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                                                                                                     
                             [INFO]   from fontbox/pom.xml                                                                                                                                                       
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                                                                                                      
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                                                                                                  
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                                                                                              
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                                                                                                  
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.                                   
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4038) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3997) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3379) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5328) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5356) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5713) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5728) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4106) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ fontbox ---                                                                                                      
                             [INFO] Copying 27 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ fontbox ---                                                                                                          
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 44 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ fontbox ---                                                                                                                         
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ fontbox ---                                                                                                                              
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ fontbox ---                                                                                                                       
                             [INFO] Building bundle: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar                                                                                        
                             [INFO] Writing manifest: /src/project-parent/pdfbox/fontbox/target/classes/META-INF/MANIFEST.MF                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ fontbox ---                                                                                                                  
                             [INFO] Building jar: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ fontbox ---                                                                                                                    
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/pom.xml to /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.pom                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar to                                                                                           
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar to                                                                                   
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ fontbox ---                                                                                                                     
                             [INFO] Installing org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                               
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:xmpbox >----------------------                                                                                                     
                             [INFO] Building Apache XmpBox 4.0.0-SNAPSHOT                             [4/11]                                                                                                     
                             [INFO]   from xmpbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ xmpbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ xmpbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ xmpbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ xmpbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ xmpbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ xmpbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ xmpbox ---                                                                                                               
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/xmpbox/src/main/resources                                                                                     
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ xmpbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 72 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ xmpbox ---                                                                                                       
                             [INFO] Copying 29 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ xmpbox ---                                                                                                           
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 30 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java:                                                                               
                             /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java uses unchecked or unsafe operations.                                                  
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java: Recompile with -Xlint:unchecked for details.                                  
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ xmpbox ---                                                                                                                          
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ xmpbox ---                                                                                                                               
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ xmpbox ---                                                                                                                        
                             [INFO] Building bundle: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar                                                                                          
                             [INFO] Writing manifest: /src/project-parent/pdfbox/xmpbox/target/classes/META-INF/MANIFEST.MF                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ xmpbox ---                                                                                                                   
                             [INFO] Building jar: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ xmpbox ---                                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/pom.xml to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.pom                                            
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                   
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar to                                                                                     
                             /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ xmpbox ---                                                                                                                      
                             [INFO] Installing org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                                                                                                 
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:pdfbox >----------------------                                                                                                     
                             [INFO] Building Apache PDFBox 4.0.0-SNAPSHOT                             [5/11]                                                                                                     
                             [INFO]   from pdfbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox ---                                                                                                               
                             [INFO] Copying 1 resource from src/main/resources to target/classes                                                                                                                 
                             [INFO] Copying 21 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO] The encoding used to copy filtered properties files have not been set. This means that the same encoding will be used to copy filtered properties files as                   
                             when copying other filtered resources. This might not be what you want! Run your build with --debug to see which files might be affected. Read more at                              
                             https://maven.apache.org/plugins/maven-resources-plugin/examples/filtering-properties-files.html                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 617 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java: Some input files use unchecked or unsafe operations.                              
                             [INFO] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java: Recompile with -Xlint:unchecked for details.                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [WARNING] COMPILATION WARNING :                                                                                                                                                     
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType0Font.java:[468,18] getHeight(int) in                                                
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType0Font.java:[470,30] getHeight(int) in                                                
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType3Font.java:[207,18] getHeight(int) in                                                
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType0.java:[444,18] getHeight(int) in                                             
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType2.java:[336,18] getHeight(int) in                                             
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.java:[377,18] getHeight(int) in                                                
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDTrueTypeFont.java:[382,18] getHeight(int) in                                             
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [WARNING] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1CFont.java:[368,18] getHeight(int) in                                               
                             org.apache.pdfbox.pdmodel.font.PDFontLike has been deprecated                                                                                                                       
                             [INFO] 8 warnings                                                                                                                                                                   
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                               symbol:   variable MAX_XREF_ENTRIES                                                                                                                                               
                               location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                            
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.139 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.350 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  3.976 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.599 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  2.487 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.647 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:15:51Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                             [ERROR]   symbol:   variable MAX_XREF_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                    
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors and possible solutions, please read the following articles:                                                                           
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] After correcting the problems, you can resume the build with the command                                                                                                    
                             [ERROR]   mvn <args> -rf :pdfbox                                                                                                                                                    
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                                                                                                                                                                                                                 
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stderr.txt: INFO:__main__:Running: docker build -t             functions.py:17
                             aixcc-afc/pdfbox:latest --file /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                                                                             
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                                                                                                      
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.07kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [internal] load build context                                                                                                                                                    
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [internal] load build context                                                                                                                                                    
                             #4 transferring context: 1.23kB done                                                                                                                                                
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                                                                                                     
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz                                                                                          
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                                                                                                   
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                                                                                                    
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                                           
                             /src/PDFWriteReadFuzzer.dict                                                                                                                                                        
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2                                             
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*                                                                                    
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                                                                                                      
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                                                                                             
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [12/13] COPY build.sh /src/                                                                                                                                                     
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                                                                                              
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 8/13] COPY project-parent /src/project-parent/                                                                                                                                
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                                                                                                      
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 exporting to image                                                                                                                                                              
                             #18 exporting layers done                                                                                                                                                           
                             #18 writing image sha256:9b6504b147657588b7dbd86a0382ef91d36837dc312b2f94517c5f990530eef7 done                                                                                      
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest 0.0s done                                                                                                                           
                             #18 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                        
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                              
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp                
                             -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                                                                                                              
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Patching) Took 35.90 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:15:53] INFO     [logging_performance](pdfbox Setting owner) Took 0.96 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:15:54] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:15:55] INFO     [logging_performance](pdfbox Setting owner) Took 1.03 seconds; exception=False                                                                                context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                                                                                                            
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             @@ -66,6 +66,9 @@                                                                                                                                                                   
                                                                                                                                                                                                                 
                                  private static final Charset ALTERNATIVE_CHARSET;                                                                                                                              
                                                                                                                                                                                                                 
                             +    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_LINE_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_TOKEN_LENGTH = 10000;                                                                                                                             
                                  private final Map<Long, COSObjectKey> keyCache = new HashMap<>();                                                                                                              
                                                                                                                                                                                                                 
                                  static                                                                                                                                                                         
                             @@ -990,7 +993,7 @@                                                                                                                                                                 
                                          // so we are more compatible with POS writers that don't                                                                                                               
                                          // follow the spec                                                                                                                                                     
                                          long startOffset = source.getPosition();                                                                                                                               
                             -            String badString = readString();                                                                                                                                       
                             +            String badString = readString(MAX_TOKEN_LENGTH);                                                                                                                       
                                          if (badString.isEmpty())                                                                                                                                               
                                          {                                                                                                                                                                      
                                              int peek = source.peek();                                                                                                                                          
                                                                                                                                                                                                                 
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             @@ -630,6 +630,11 @@                                                                                                                                                                
                                              LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                                 
                                              return false;                                                                                                                                                      
                                          }                                                                                                                                                                      
                             +            if (count < 0 || count > MAX_XREF_ENTRIES)                                                                                                                             
                             +            {                                                                                                                                                                      
                             +                throw new IOException("XRef section count out of bounds: " + count                                                                                                 
                             +                        + " at offset " + parser.source.getPosition());                                                                                                            
                             +            }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          parser.skipSpaces();                                                                                                                                                   
                                          for(int i = 0; i < count; i++)                                                                                                                                         
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                               symbol:   variable MAX_XREF_ENTRIES                                                                                                                                               
                               location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                            
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.139 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.350 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  3.976 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.599 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  2.487 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.647 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:15:51Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                             [ERROR]   symbol:   variable MAX_XREF_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                    
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                             The fuzzing harness repeatedly times out when parsing PDF inputs. The initial issue report shows a libFuzzer timeout and a full Java thread dump with the main                      
                             thread executing inside PDFBoxs parsing routinesspecifically `BaseParser.skipSpaces` and related dictionary parsing methods. The patch attempt introduces hard                    
                             limits (`MAX_SKIP_CHARS`, `MAX_LINE_CHARS`, `MAX_XREF_ENTRIES`) and throws `IOException` when those limits are exceeded, in order to break out of potentially                       
                             unbounded loops. After applying the patch, the fuzzer still reports a timeout without any change in behavior.                                                                       
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             Initial Issue                                                                                                                                                                       
                             - The fuzzer run ends in ERROR: libFuzzer: timeout after ~28 seconds.                                                                                                             
                             - The Java thread dump indicates the main thread is in native tracing code (`traceConstCmpInt`) called from `BaseParser.skipSpaces`, then repeatedly in methods                   
                             like `parseCOSDictionaryValue`, `parseCOSDictionaryNameValuePair`, and Xref parsing (`XrefParser.parseTrailer`, `parseXref`).                                                       
                             - No stack overflow or out-of-memory is reported; instead the parser appears to loop or stall, eventually hitting the fuzzers timeout.                                             
                                                                                                                                                                                                                 
                             Patch Attempt                                                                                                                                                                       
                             - In `BaseParser`:                                                                                                                                                                  
                                Added constants `MAX_SKIP_CHARS = 10000` and `MAX_LINE_CHARS = 10000`.                                                                                                          
                                In the line-reading loop (around line 1163), introduced `lineCount` and throw `IOException("Exceeded max line length at offset " + source.getPosition())` if                    
                             the count exceeds `MAX_LINE_CHARS`.                                                                                                                                                 
                                In `skipSpaces` (around line 1318), introduced `skipCount` and throw `IOException("Exceeded max skip characters at offset " + source.getPosition())`) if the                    
                             count exceeds `MAX_SKIP_CHARS`.                                                                                                                                                     
                             - In `XrefParser`:                                                                                                                                                                  
                                Added `MAX_XREF_ENTRIES = 10000`.                                                                                                                                               
                                After reading the number of Xref entries (`count`), throw `IOException("XRef entry count out of bounds: " + count + " at offset " +                                             
                             parser.source.getPosition())`) if `count < 0 || count > MAX_XREF_ENTRIES`.                                                                                                          
                                                                                                                                                                                                                 
                             Log After Patch                                                                                                                                                                     
                             - The fuzzing run again ends with ERROR: libFuzzer: timeout and no new exceptions or crashes are shown.                                                                           
                                                                                                                                                                                                                 
                             Areas for Further Investigation                                                                                                                                                     
                             - The loops in `BaseParser.skipSpaces` and the line-reading method may still encounter data patterns that evade the new limits or stall the parser without                          
                             exceeding the hard limits.                                                                                                                                                          
                             - The logic in `parseCOSDictionaryNameValuePair` and upstream dictionary parsing in `BaseParser` to ensure that malformed inputs do not lead to unbounded recursion                 
                             or very high iteration counts.                                                                                                                                                      
                             - The Xref parsing routines in `XrefParser`, including `parseTrailer` and the loop over entries, to confirm that large or malformed cross-reference tables cannot                   
                             lead to indefinite stalls.                                                                                                                                                          
                             - Any interactions between the native tracing callbacks (`TraceDataFlowNativeCallbacks`) and the parsers read loops that might cause the code to spin without                      
                             consuming characters.                                                                                                                                                               
                                                                                                                                                                                                                 
                             This evaluation report focuses on the observed behavior and the modifications attempted; no root-cause speculation or further fixes are proposed here.                              
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                                                                                                                                                                                                                 
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1117-1140                                                                                                          
                             ```                                                                                                                                                                                 
                             1117:    protected String readString( int length ) throws IOException                                                                                                               
                             1118:    {                                                                                                                                                                          
                             1119:        skipSpaces();                                                                                                                                                          
                             1120:                                                                                                                                                                               
                             1121:        int c = source.read();                                                                                                                                                 
                             1122:                                                                                                                                                                               
                             1123:        //average string size is around 2 and the normal string buffer size is                                                                                                 
                             1124:        //about 16 so lets save some space.                                                                                                                                    
                             1125:        StringBuilder buffer = new StringBuilder(length);                                                                                                                      
                             1126:        while( !isWhitespace(c) && !isClosing(c) && c != -1 && buffer.length() < length &&                                                                                     
                             1127:                c != '[' &&                                                                                                                                                    
                             1128:                c != '<' &&                                                                                                                                                    
                             1129:                c != '(' &&                                                                                                                                                    
                             1130:                c != '/' )                                                                                                                                                     
                             1131:        {                                                                                                                                                                      
                             1132:            buffer.append( (char)c );                                                                                                                                          
                             1133:            c = source.read();                                                                                                                                                 
                             1134:        }                                                                                                                                                                      
                             1135:        if (c != -1)                                                                                                                                                           
                             1136:        {                                                                                                                                                                      
                             1137:            source.rewind(1);                                                                                                                                                  
                             1138:        }                                                                                                                                                                      
                             1139:        return buffer.toString();                                                                                                                                              
                             1140:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1162-1230                                                                                                          
                             ```                                                                                                                                                                                 
                             1162:    protected String readLine() throws IOException                                                                                                                             
                             1163:    {                                                                                                                                                                          
                             1164:        if (source.isEOF())                                                                                                                                                    
                             1165:        {                                                                                                                                                                      
                             1166:            throw new IOException( "Error: End-of-File, expected line at offset " +                                                                                            
                             1167:                    source.getPosition());                                                                                                                                     
                             1168:        }                                                                                                                                                                      
                             1169:                                                                                                                                                                               
                             1170:        StringBuilder buffer = new StringBuilder( 11 );                                                                                                                        
                             1171:                                                                                                                                                                               
                             1172:        int c;                                                                                                                                                                 
                             1173:        while ((c = source.read()) != -1)                                                                                                                                      
                             1174:        {                                                                                                                                                                      
                             1175:            // CR and LF are valid EOLs                                                                                                                                        
                             1176:            if (isEOL(c))                                                                                                                                                      
                             1177:            {                                                                                                                                                                  
                             1178:                break;                                                                                                                                                         
                             1179:            }                                                                                                                                                                  
                             1180:            buffer.append( (char)c );                                                                                                                                          
                             1181:        }                                                                                                                                                                      
                             1182:        // CR+LF is also a valid EOL                                                                                                                                           
                             1183:        if (isCR(c) && isLF(source.peek()))                                                                                                                                    
                             1184:        {                                                                                                                                                                      
                             1185:            source.read();                                                                                                                                                     
                             1186:        }                                                                                                                                                                      
                             1187:        return buffer.toString();                                                                                                                                              
                             1188:    }                                                                                                                                                                          
                             1189:                                                                                                                                                                               
                             1190:    /**                                                                                                                                                                        
                             1191:     * This will tell if the end of the data is reached.                                                                                                                       
                             1192:     *                                                                                                                                                                         
                             1193:     * @return true if the end of the data is reached.                                                                                                                         
                             1194:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1195:     */                                                                                                                                                                        
                             1196:    protected boolean isEOF() throws IOException                                                                                                                               
                             1197:    {                                                                                                                                                                          
                             1198:        return source.isEOF();                                                                                                                                                 
                             1199:    }                                                                                                                                                                          
                             1200:                                                                                                                                                                               
                             1201:    /**                                                                                                                                                                        
                             1202:     * This will tell if the next byte to be read is an end of line byte.                                                                                                      
                             1203:     *                                                                                                                                                                         
                             1204:     * @param c The character to check against end of line                                                                                                                     
                             1205:     * @return true if the next byte is 0x0A or 0x0D.                                                                                                                          
                             1206:     */                                                                                                                                                                        
                             1207:    protected static boolean isEOL(int c)                                                                                                                                      
                             1208:    {                                                                                                                                                                          
                             1209:        return isLF(c) || isCR(c);                                                                                                                                             
                             1210:    }                                                                                                                                                                          
                             1211:                                                                                                                                                                               
                             1212:    /**                                                                                                                                                                        
                             1213:     * This will tell if the next byte to be read is a line feed.                                                                                                              
                             1214:     *                                                                                                                                                                         
                             1215:     * @param c The character to check against line feed                                                                                                                       
                             1216:     * @return true if the next byte is 0x0A.                                                                                                                                  
                             1217:     */                                                                                                                                                                        
                             1218:    private static boolean isLF(int c)                                                                                                                                         
                             1219:    {                                                                                                                                                                          
                             1220:        return ASCII_LF == c;                                                                                                                                                  
                             1221:    }                                                                                                                                                                          
                             1222:                                                                                                                                                                               
                             1223:    /**                                                                                                                                                                        
                             1224:     * This will tell if the next byte to be read is a carriage return.                                                                                                        
                             1225:     *                                                                                                                                                                         
                             1226:     * @param c The character to check against carriage return                                                                                                                 
                             1227:     * @return true if the next byte is 0x0D.                                                                                                                                  
                             1228:     */                                                                                                                                                                        
                             1229:    private static boolean isCR(int c)                                                                                                                                         
                             1230:    {                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:861-918                                                                                                            
                             ```                                                                                                                                                                                 
                             861:    protected COSName parseCOSName() throws IOException                                                                                                                         
                             862:    {                                                                                                                                                                           
                             863:        readExpectedChar('/');                                                                                                                                                  
                             864:        ByteArrayOutputStream buffer = new ByteArrayOutputStream();                                                                                                             
                             865:        int c = source.read();                                                                                                                                                  
                             866:        while (!isEndOfName(c))                                                                                                                                                 
                             867:        {                                                                                                                                                                       
                             868:            final int ch = c;                                                                                                                                                   
                             869:            if (ch == '#')                                                                                                                                                      
                             870:            {                                                                                                                                                                   
                             871:                int ch1 = source.read();                                                                                                                                        
                             872:                int ch2 = source.read();                                                                                                                                        
                             873:                // Prior to PDF v1.2, the # was not a special character.  Also,                                                                                                 
                             874:                // it has been observed that various PDF tools do not follow the                                                                                                
                             875:                // spec with respect to the # escape, even though they report                                                                                                   
                             876:                // PDF versions of 1.2 or later.  The solution here is that we                                                                                                  
                             877:                // interpret the # as an escape only when it is followed by two                                                                                                 
                             878:                // valid hex digits.                                                                                                                                            
                             879:                if (isHexDigit((char)ch1) && isHexDigit((char)ch2))                                                                                                             
                             880:                {                                                                                                                                                               
                             881:                    String hex = Character.toString((char) ch1) + (char) ch2;                                                                                                   
                             882:                    try                                                                                                                                                         
                             883:                    {                                                                                                                                                           
                             884:                        buffer.write(Integer.parseInt(hex, 16));                                                                                                                
                             885:                    }                                                                                                                                                           
                             886:                    catch (NumberFormatException e)                                                                                                                             
                             887:                    {                                                                                                                                                           
                             888:                        throw new IOException("Error: expected hex digit, actual='" + hex + "'", e);                                                                            
                             889:                    }                                                                                                                                                           
                             890:                    c = source.read();                                                                                                                                          
                             891:                }                                                                                                                                                               
                             892:                else                                                                                                                                                            
                             893:                {                                                                                                                                                               
                             894:                    // check for premature EOF                                                                                                                                  
                             895:                    if (ch2 == -1 || ch1 == -1)                                                                                                                                 
                             896:                    {                                                                                                                                                           
                             897:                        LOG.error("Premature EOF in BaseParser#parseCOSName");                                                                                                  
                             898:                        c = -1;                                                                                                                                                 
                             899:                        break;                                                                                                                                                  
                             900:                    }                                                                                                                                                           
                             901:                    source.rewind(1);                                                                                                                                           
                             902:                    c = ch1;                                                                                                                                                    
                             903:                    buffer.write(ch);                                                                                                                                           
                             904:                }                                                                                                                                                               
                             905:            }                                                                                                                                                                   
                             906:            else                                                                                                                                                                
                             907:            {                                                                                                                                                                   
                             908:                buffer.write(ch);                                                                                                                                               
                             909:                c = source.read();                                                                                                                                              
                             910:            }                                                                                                                                                                   
                             911:        }                                                                                                                                                                       
                             912:        if (c != -1)                                                                                                                                                            
                             913:        {                                                                                                                                                                       
                             914:            source.rewind(1);                                                                                                                                                   
                             915:        }                                                                                                                                                                       
                             916:                                                                                                                                                                                
                             917:        return COSName.getPDFName(decodeBuffer(buffer));                                                                                                                        
                             918:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:339-375                                                                                                            
                             ```                                                                                                                                                                                 
                             339:    private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                             340:    {                                                                                                                                                                           
                             341:        int c = source.read();                                                                                                                                                  
                             342:        while (c != -1 && c != '/' && c != '>')                                                                                                                                 
                             343:        {                                                                                                                                                                       
                             344:            // in addition to stopping when we find / or >, we also want                                                                                                        
                             345:            // to stop when we find endstream or endobj.                                                                                                                        
                             346:            if (c == E)                                                                                                                                                         
                             347:            {                                                                                                                                                                   
                             348:                c = source.read();                                                                                                                                              
                             349:                if (c == N)                                                                                                                                                     
                             350:                {                                                                                                                                                               
                             351:                    c = source.read();                                                                                                                                          
                             352:                    if (c == D)                                                                                                                                                 
                             353:                    {                                                                                                                                                           
                             354:                        c = source.read();                                                                                                                                      
                             355:                        boolean isStream = c == S && source.read() == T && source.read() == R                                                                                   
                             356:                                && source.read() == E && source.read() == A && source.read() == M;                                                                              
                             357:                        boolean isObj = !isStream && c == O && source.read() == B                                                                                               
                             358:                                && source.read() == J;                                                                                                                          
                             359:                        if (isStream || isObj)                                                                                                                                  
                             360:                        {                                                                                                                                                       
                             361:                            // we're done reading this object!                                                                                                                  
                             362:                            return true;                                                                                                                                        
                             363:                        }                                                                                                                                                       
                             364:                    }                                                                                                                                                           
                             365:                }                                                                                                                                                               
                             366:            }                                                                                                                                                                   
                             367:            c = source.read();                                                                                                                                                  
                             368:        }                                                                                                                                                                       
                             369:        if (c == -1)                                                                                                                                                            
                             370:        {                                                                                                                                                                       
                             371:            return true;                                                                                                                                                        
                             372:        }                                                                                                                                                                       
                             373:        source.rewind(1);                                                                                                                                                       
                             374:        return false;                                                                                                                                                           
                             375:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:200-300                                                                                                            
                             ```                                                                                                                                                                                 
                             200:     * @return false on parsing error                                                                                                                                           
                             201:     * @throws IOException If an IO error occurs.                                                                                                                               
                             202:     */                                                                                                                                                                         
                             203:    private boolean parseTrailer() throws IOException                                                                                                                           
                             204:    {                                                                                                                                                                           
                             205:        // parse the last trailer.                                                                                                                                              
                             206:        long trailerOffset = source.getPosition();                                                                                                                              
                             207:        // PDFBOX-1739 skip extra xref entries in RegisSTAR documents                                                                                                           
                             208:        int nextCharacter = source.peek();                                                                                                                                      
                             209:        while (nextCharacter != 't' && BaseParser.isDigit(nextCharacter))                                                                                                       
                             210:        {                                                                                                                                                                       
                             211:            if (source.getPosition() == trailerOffset)                                                                                                                          
                             212:            {                                                                                                                                                                   
                             213:                // warn only the first time                                                                                                                                     
                             214:                LOG.warn("Expected trailer object at offset {}, keep trying", trailerOffset);                                                                                   
                             215:            }                                                                                                                                                                   
                             216:            parser.readLine();                                                                                                                                                  
                             217:            nextCharacter = source.peek();                                                                                                                                      
                             218:        }                                                                                                                                                                       
                             219:        if (source.peek() != 't')                                                                                                                                               
                             220:        {                                                                                                                                                                       
                             221:            return false;                                                                                                                                                       
                             222:        }                                                                                                                                                                       
                             223:        // read "trailer"                                                                                                                                                       
                             224:        long currentOffset = source.getPosition();                                                                                                                              
                             225:        String nextLine = parser.readLine();                                                                                                                                    
                             226:        if (!nextLine.trim().equals("trailer"))                                                                                                                                 
                             227:        {                                                                                                                                                                       
                             228:            // in some cases the EOL is missing and the trailer immediately                                                                                                     
                             229:            // continues with "<<" or with a blank character                                                                                                                    
                             230:            // even if this does not comply with PDF reference we want to support as many PDFs as possible                                                                      
                             231:            // Acrobat reader can also deal with this.                                                                                                                          
                             232:            if (nextLine.startsWith("trailer"))                                                                                                                                 
                             233:            {                                                                                                                                                                   
                             234:                // we can't just unread a portion of the read data as we don't know if the EOL consist of 1 or 2 bytes                                                          
                             235:                int len = "trailer".length();                                                                                                                                   
                             236:                // jump back right after "trailer"                                                                                                                              
                             237:                source.seek(currentOffset + len);                                                                                                                               
                             238:            }                                                                                                                                                                   
                             239:            else                                                                                                                                                                
                             240:            {                                                                                                                                                                   
                             241:                return false;                                                                                                                                                   
                             242:            }                                                                                                                                                                   
                             243:        }                                                                                                                                                                       
                             244:                                                                                                                                                                                
                             245:        // in some cases the EOL is missing and the trailer continues with " <<"                                                                                                
                             246:        // even if this does not comply with PDF reference we want to support as many PDFs as possible                                                                          
                             247:        // Acrobat reader can also deal with this.                                                                                                                              
                             248:        parser.skipSpaces();                                                                                                                                                    
                             249:                                                                                                                                                                                
                             250:        COSDictionary parsedTrailer = parser.parseCOSDictionary(true);                                                                                                          
                             251:        xrefTrailerResolver.setTrailer(parsedTrailer);                                                                                                                          
                             252:                                                                                                                                                                                
                             253:        parser.skipSpaces();                                                                                                                                                    
                             254:        return true;                                                                                                                                                            
                             255:    }                                                                                                                                                                           
                             256:                                                                                                                                                                                
                             257:    /**                                                                                                                                                                         
                             258:     * Parses an xref object stream starting with indirect object id.                                                                                                           
                             259:     *                                                                                                                                                                          
                             260:     * @return value of PREV item in dictionary or <code>-1</code> if no such item exists                                                                                       
                             261:     */                                                                                                                                                                         
                             262:    private long parseXrefObjStream(long objByteOffset, boolean isStandalone) throws IOException                                                                                
                             263:    {                                                                                                                                                                           
                             264:        // ---- parse indirect object head                                                                                                                                      
                             265:        parser.readObjectNumber();                                                                                                                                              
                             266:        parser.readGenerationNumber();                                                                                                                                          
                             267:        parser.readObjectMarker();                                                                                                                                              
                             268:                                                                                                                                                                                
                             269:        COSDictionary dict = parser.parseCOSDictionary(false);                                                                                                                  
                             270:        try (COSStream xrefStream = parser.parseCOSStream(dict))                                                                                                                
                             271:        {                                                                                                                                                                       
                             272:            // the cross reference stream of a hybrid xref table will be added to the existing one                                                                              
                             273:            // and we must not override the offset and the trailer                                                                                                              
                             274:            if ( isStandalone )                                                                                                                                                 
                             275:            {                                                                                                                                                                   
                             276:                xrefTrailerResolver.nextXrefObj( objByteOffset, XRefType.STREAM );                                                                                              
                             277:                xrefTrailerResolver.setTrailer(xrefStream);                                                                                                                     
                             278:            }                                                                                                                                                                   
                             279:            new PDFXrefStreamParser(xrefStream).parse(xrefTrailerResolver);                                                                                                     
                             280:        }                                                                                                                                                                       
                             281:                                                                                                                                                                                
                             282:        return dict.getLong(COSName.PREV);                                                                                                                                      
                             283:    }                                                                                                                                                                           
                             284:                                                                                                                                                                                
                             285:    /**                                                                                                                                                                         
                             286:     * Check if the cross reference table/stream can be found at the current offset.                                                                                            
                             287:     *                                                                                                                                                                          
                             288:     * @param startXRefOffset                                                                                                                                                   
                             289:     * @return the revised offset                                                                                                                                               
                             290:     * @throws IOException                                                                                                                                                      
                             291:     */                                                                                                                                                                         
                             292:    private long checkXRefOffset(long startXRefOffset) throws IOException                                                                                                       
                             293:    {                                                                                                                                                                           
                             294:        source.seek(startXRefOffset);                                                                                                                                           
                             295:        parser.skipSpaces();                                                                                                                                                    
                             296:        if (parser.isString(XREF_TABLE))                                                                                                                                        
                             297:        {                                                                                                                                                                       
                             298:            return startXRefOffset;                                                                                                                                             
                             299:        }                                                                                                                                                                       
                             300:        if (startXRefOffset > 0)                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1319-1343                                                                                                          
                             ```                                                                                                                                                                                 
                             1319:    protected void skipSpaces() throws IOException                                                                                                                             
                             1320:    {                                                                                                                                                                          
                             1321:        int c = source.read();                                                                                                                                                 
                             1322:        // 37 is the % character, a comment                                                                                                                                    
                             1323:        while( isWhitespace(c) || c == 37)                                                                                                                                     
                             1324:        {                                                                                                                                                                      
                             1325:            if ( c == 37 )                                                                                                                                                     
                             1326:            {                                                                                                                                                                  
                             1327:                // skip past the comment section                                                                                                                               
                             1328:                c = source.read();                                                                                                                                             
                             1329:                while(!isEOL(c) && c != -1)                                                                                                                                    
                             1330:                {                                                                                                                                                              
                             1331:                    c = source.read();                                                                                                                                         
                             1332:                }                                                                                                                                                              
                             1333:            }                                                                                                                                                                  
                             1334:            else                                                                                                                                                               
                             1335:            {                                                                                                                                                                  
                             1336:                c = source.read();                                                                                                                                             
                             1337:            }                                                                                                                                                                  
                             1338:        }                                                                                                                                                                      
                             1339:        if (c != -1)                                                                                                                                                           
                             1340:        {                                                                                                                                                                      
                             1341:            source.rewind(1);                                                                                                                                                  
                             1342:        }                                                                                                                                                                      
                             1343:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:339-375                                                                                                            
                             ```                                                                                                                                                                                 
                             339:    private boolean readUntilEndOfCOSDictionary() throws IOException                                                                                                            
                             340:    {                                                                                                                                                                           
                             341:        int c = source.read();                                                                                                                                                  
                             342:        while (c != -1 && c != '/' && c != '>')                                                                                                                                 
                             343:        {                                                                                                                                                                       
                             344:            // in addition to stopping when we find / or >, we also want                                                                                                        
                             345:            // to stop when we find endstream or endobj.                                                                                                                        
                             346:            if (c == E)                                                                                                                                                         
                             347:            {                                                                                                                                                                   
                             348:                c = source.read();                                                                                                                                              
                             349:                if (c == N)                                                                                                                                                     
                             350:                {                                                                                                                                                               
                             351:                    c = source.read();                                                                                                                                          
                             352:                    if (c == D)                                                                                                                                                 
                             353:                    {                                                                                                                                                           
                             354:                        c = source.read();                                                                                                                                      
                             355:                        boolean isStream = c == S && source.read() == T && source.read() == R                                                                                   
                             356:                                && source.read() == E && source.read() == A && source.read() == M;                                                                              
                             357:                        boolean isObj = !isStream && c == O && source.read() == B                                                                                               
                             358:                                && source.read() == J;                                                                                                                          
                             359:                        if (isStream || isObj)                                                                                                                                  
                             360:                        {                                                                                                                                                       
                             361:                            // we're done reading this object!                                                                                                                  
                             362:                            return true;                                                                                                                                        
                             363:                        }                                                                                                                                                       
                             364:                    }                                                                                                                                                           
                             365:                }                                                                                                                                                               
                             366:            }                                                                                                                                                                   
                             367:            c = source.read();                                                                                                                                                  
                             368:        }                                                                                                                                                                       
                             369:        if (c == -1)                                                                                                                                                            
                             370:        {                                                                                                                                                                       
                             371:            return true;                                                                                                                                                        
                             372:        }                                                                                                                                                                       
                             373:        source.rewind(1);                                                                                                                                                       
                             374:        return false;                                                                                                                                                           
                             375:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:948-1016                                                                                                           
                             ```                                                                                                                                                                                 
                             948:    protected COSBase parseDirObject() throws IOException                                                                                                                       
                             949:    {                                                                                                                                                                           
                             950:        skipSpaces();                                                                                                                                                           
                             951:        char c = (char) source.peek();                                                                                                                                          
                             952:        switch(c)                                                                                                                                                               
                             953:        {                                                                                                                                                                       
                             954:        case '<':                                                                                                                                                               
                             955:            // pull off first left bracket                                                                                                                                      
                             956:            source.read();                                                                                                                                                      
                             957:            // check for second left bracket                                                                                                                                    
                             958:            c = (char) source.peek();                                                                                                                                           
                             959:            source.rewind(1);                                                                                                                                                   
                             960:            return c == '<' ? parseCOSDictionary(true) : parseCOSString();                                                                                                      
                             961:        case '[':                                                                                                                                                               
                             962:            // array                                                                                                                                                            
                             963:            return parseCOSArray();                                                                                                                                             
                             964:        case '(':                                                                                                                                                               
                             965:            return parseCOSString();                                                                                                                                            
                             966:        case '/':                                                                                                                                                               
                             967:            // name                                                                                                                                                             
                             968:            return parseCOSName();                                                                                                                                              
                             969:        case 'n':                                                                                                                                                               
                             970:            // null                                                                                                                                                             
                             971:            readExpectedString(NULL, false);                                                                                                                                    
                             972:            return COSNull.NULL;                                                                                                                                                
                             973:        case 't':                                                                                                                                                               
                             974:            readExpectedString(TRUE, false);                                                                                                                                    
                             975:            return COSBoolean.TRUE;                                                                                                                                             
                             976:        case 'f':                                                                                                                                                               
                             977:            readExpectedString(FALSE, false);                                                                                                                                   
                             978:            return COSBoolean.FALSE;                                                                                                                                            
                             979:        case 'R':                                                                                                                                                               
                             980:            source.read();                                                                                                                                                      
                             981:            return new COSObject(null);                                                                                                                                         
                             982:        case (char)-1:                                                                                                                                                          
                             983:            return null;                                                                                                                                                        
                             984:        default:                                                                                                                                                                
                             985:            if (isDigit(c) || c == '-' || c == '+' || c == '.')                                                                                                                 
                             986:            {                                                                                                                                                                   
                             987:                return parseCOSNumber();                                                                                                                                        
                             988:            }                                                                                                                                                                   
                             989:            // This is not suppose to happen, but we will allow for it                                                                                                          
                             990:            // so we are more compatible with POS writers that don't                                                                                                            
                             991:            // follow the spec                                                                                                                                                  
                             992:            long startOffset = source.getPosition();                                                                                                                            
                             993:            String badString = readString();                                                                                                                                    
                             994:            if (badString.isEmpty())                                                                                                                                            
                             995:            {                                                                                                                                                                   
                             996:                int peek = source.peek();                                                                                                                                       
                             997:                // we can end up in an infinite loop otherwise                                                                                                                  
                             998:                throw new IOException("Unknown dir object c='" + c + "' cInt=" + (int) c + " peek='"                                                                            
                             999:                        + (char) peek + "' peekInt=" + peek + " at offset " + source.getPosition()                                                                              
                             1000:                        + " (start offset: " + startOffset + ")");                                                                                                             
                             1001:            }                                                                                                                                                                  
                             1002:                                                                                                                                                                               
                             1003:            // if it's an endstream/endobj, we want to put it back so the caller will see it                                                                                   
                             1004:            if (ENDOBJ_STRING.equals(badString) || ENDSTREAM_STRING.equals(badString))                                                                                         
                             1005:            {                                                                                                                                                                  
                             1006:                source.rewind(badString.getBytes(StandardCharsets.ISO_8859_1).length);                                                                                         
                             1007:            }                                                                                                                                                                  
                             1008:            else                                                                                                                                                               
                             1009:            {                                                                                                                                                                  
                             1010:                LOG.warn("Skipped unexpected dir object = '{}' at offset {} (start offset: {})",                                                                               
                             1011:                        badString, source.getPosition(), startOffset);                                                                                                         
                             1012:                return this instanceof PDFStreamParser ? null : COSNull.NULL;                                                                                                  
                             1013:            }                                                                                                                                                                  
                             1014:        }                                                                                                                                                                      
                             1015:        return null;                                                                                                                                                           
                             1016:    }                                                                                                                                                                          
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:861-918                                                                                                            
                             ```                                                                                                                                                                                 
                             861:    protected COSName parseCOSName() throws IOException                                                                                                                         
                             862:    {                                                                                                                                                                           
                             863:        readExpectedChar('/');                                                                                                                                                  
                             864:        ByteArrayOutputStream buffer = new ByteArrayOutputStream();                                                                                                             
                             865:        int c = source.read();                                                                                                                                                  
                             866:        while (!isEndOfName(c))                                                                                                                                                 
                             867:        {                                                                                                                                                                       
                             868:            final int ch = c;                                                                                                                                                   
                             869:            if (ch == '#')                                                                                                                                                      
                             870:            {                                                                                                                                                                   
                             871:                int ch1 = source.read();                                                                                                                                        
                             872:                int ch2 = source.read();                                                                                                                                        
                             873:                // Prior to PDF v1.2, the # was not a special character.  Also,                                                                                                 
                             874:                // it has been observed that various PDF tools do not follow the                                                                                                
                             875:                // spec with respect to the # escape, even though they report                                                                                                   
                             876:                // PDF versions of 1.2 or later.  The solution here is that we                                                                                                  
                             877:                // interpret the # as an escape only when it is followed by two                                                                                                 
                             878:                // valid hex digits.                                                                                                                                            
                             879:                if (isHexDigit((char)ch1) && isHexDigit((char)ch2))                                                                                                             
                             880:                {                                                                                                                                                               
                             881:                    String hex = Character.toString((char) ch1) + (char) ch2;                                                                                                   
                             882:                    try                                                                                                                                                         
                             883:                    {                                                                                                                                                           
                             884:                        buffer.write(Integer.parseInt(hex, 16));                                                                                                                
                             885:                    }                                                                                                                                                           
                             886:                    catch (NumberFormatException e)                                                                                                                             
                             887:                    {                                                                                                                                                           
                             888:                        throw new IOException("Error: expected hex digit, actual='" + hex + "'", e);                                                                            
                             889:                    }                                                                                                                                                           
                             890:                    c = source.read();                                                                                                                                          
                             891:                }                                                                                                                                                               
                             892:                else                                                                                                                                                            
                             893:                {                                                                                                                                                               
                             894:                    // check for premature EOF                                                                                                                                  
                             895:                    if (ch2 == -1 || ch1 == -1)                                                                                                                                 
                             896:                    {                                                                                                                                                           
                             897:                        LOG.error("Premature EOF in BaseParser#parseCOSName");                                                                                                  
                             898:                        c = -1;                                                                                                                                                 
                             899:                        break;                                                                                                                                                  
                             900:                    }                                                                                                                                                           
                             901:                    source.rewind(1);                                                                                                                                           
                             902:                    c = ch1;                                                                                                                                                    
                             903:                    buffer.write(ch);                                                                                                                                           
                             904:                }                                                                                                                                                               
                             905:            }                                                                                                                                                                   
                             906:            else                                                                                                                                                                
                             907:            {                                                                                                                                                                   
                             908:                buffer.write(ch);                                                                                                                                               
                             909:                c = source.read();                                                                                                                                              
                             910:            }                                                                                                                                                                   
                             911:        }                                                                                                                                                                       
                             912:        if (c != -1)                                                                                                                                                            
                             913:        {                                                                                                                                                                       
                             914:            source.rewind(1);                                                                                                                                                   
                             915:        }                                                                                                                                                                       
                             916:                                                                                                                                                                                
                             917:        return COSName.getPDFName(decodeBuffer(buffer));                                                                                                                        
                             918:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1162-1189                                                                                                          
                             ```                                                                                                                                                                                 
                             1162:    protected String readLine() throws IOException                                                                                                                             
                             1163:    {                                                                                                                                                                          
                             1164:        if (source.isEOF())                                                                                                                                                    
                             1165:        {                                                                                                                                                                      
                             1166:            throw new IOException( "Error: End-of-File, expected line at offset " +                                                                                            
                             1167:                    source.getPosition());                                                                                                                                     
                             1168:        }                                                                                                                                                                      
                             1169:                                                                                                                                                                               
                             1170:        StringBuilder buffer = new StringBuilder( 11 );                                                                                                                        
                             1171:                                                                                                                                                                               
                             1172:        int c;                                                                                                                                                                 
                             1173:        while ((c = source.read()) != -1)                                                                                                                                      
                             1174:        {                                                                                                                                                                      
                             1175:            // CR and LF are valid EOLs                                                                                                                                        
                             1176:            if (isEOL(c))                                                                                                                                                      
                             1177:            {                                                                                                                                                                  
                             1178:                break;                                                                                                                                                         
                             1179:            }                                                                                                                                                                  
                             1180:            buffer.append( (char)c );                                                                                                                                          
                             1181:        }                                                                                                                                                                      
                             1182:        // CR+LF is also a valid EOL                                                                                                                                           
                             1183:        if (isCR(c) && isLF(source.peek()))                                                                                                                                    
                             1184:        {                                                                                                                                                                      
                             1185:            source.read();                                                                                                                                                     
                             1186:        }                                                                                                                                                                      
                             1187:        return buffer.toString();                                                                                                                                              
                             1188:    }                                                                                                                                                                          
                             1189:                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:574-688                                                                                                            
                             ```                                                                                                                                                                                 
                             574:    private boolean parseXrefTable(long startByteOffset) throws IOException                                                                                                     
                             575:    {                                                                                                                                                                           
                             576:        if (source.peek() != 'x')                                                                                                                                               
                             577:        {                                                                                                                                                                       
                             578:            return false;                                                                                                                                                       
                             579:        }                                                                                                                                                                       
                             580:        String xref = parser.readString();                                                                                                                                      
                             581:        if( !xref.trim().equals( "xref" ) )                                                                                                                                     
                             582:        {                                                                                                                                                                       
                             583:            return false;                                                                                                                                                       
                             584:        }                                                                                                                                                                       
                             585:                                                                                                                                                                                
                             586:        // check for trailer after xref                                                                                                                                         
                             587:        String str = parser.readString();                                                                                                                                       
                             588:        byte[] b = str.getBytes(StandardCharsets.ISO_8859_1);                                                                                                                   
                             589:        source.seek(source.getPosition() - b.length);                                                                                                                           
                             590:                                                                                                                                                                                
                             591:        // signal start of new XRef                                                                                                                                             
                             592:        xrefTrailerResolver.nextXrefObj( startByteOffset, XRefType.TABLE );                                                                                                     
                             593:                                                                                                                                                                                
                             594:        if (str.startsWith("trailer"))                                                                                                                                          
                             595:        {                                                                                                                                                                       
                             596:            LOG.warn("skipping empty xref table");                                                                                                                              
                             597:            return false;                                                                                                                                                       
                             598:        }                                                                                                                                                                       
                             599:                                                                                                                                                                                
                             600:        // Xref tables can have multiple sections. Each starts with a starting object id and a count.                                                                           
                             601:        while(true)                                                                                                                                                             
                             602:        {                                                                                                                                                                       
                             603:            String currentLine = parser.readLine();                                                                                                                             
                             604:            String[] splitString = currentLine.split("\\s");                                                                                                                    
                             605:            if (splitString.length != 2)                                                                                                                                        
                             606:            {                                                                                                                                                                   
                             607:                LOG.warn("Unexpected XRefTable Entry: {}", currentLine);                                                                                                        
                             608:                return false;                                                                                                                                                   
                             609:            }                                                                                                                                                                   
                             610:            // first obj id                                                                                                                                                     
                             611:            long currObjID;                                                                                                                                                     
                             612:            try                                                                                                                                                                 
                             613:            {                                                                                                                                                                   
                             614:                currObjID = Long.parseLong(splitString[0]);                                                                                                                     
                             615:            }                                                                                                                                                                   
                             616:            catch (NumberFormatException exception)                                                                                                                             
                             617:            {                                                                                                                                                                   
                             618:                LOG.warn("XRefTable: invalid ID for the first object: {}", currentLine);                                                                                        
                             619:                return false;                                                                                                                                                   
                             620:            }                                                                                                                                                                   
                             621:                                                                                                                                                                                
                             622:            // the number of objects in the xref table                                                                                                                          
                             623:            int count = 0;                                                                                                                                                      
                             624:            try                                                                                                                                                                 
                             625:            {                                                                                                                                                                   
                             626:                count = Integer.parseInt(splitString[1]);                                                                                                                       
                             627:            }                                                                                                                                                                   
                             628:            catch (NumberFormatException exception)                                                                                                                             
                             629:            {                                                                                                                                                                   
                             630:                LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                              
                             631:                return false;                                                                                                                                                   
                             632:            }                                                                                                                                                                   
                             633:                                                                                                                                                                                
                             634:            parser.skipSpaces();                                                                                                                                                
                             635:            for(int i = 0; i < count; i++)                                                                                                                                      
                             636:            {                                                                                                                                                                   
                             637:                if (parser.isEOF() )                                                                                                                                            
                             638:                {                                                                                                                                                               
                             639:                    break;                                                                                                                                                      
                             640:                }                                                                                                                                                               
                             641:                int nextChar = source.peek();                                                                                                                                   
                             642:                if (nextChar == 't' || BaseParser.isEndOfName(nextChar))                                                                                                        
                             643:                {                                                                                                                                                               
                             644:                    break;                                                                                                                                                      
                             645:                }                                                                                                                                                               
                             646:                //Ignore table contents                                                                                                                                         
                             647:                currentLine = parser.readLine();                                                                                                                                
                             648:                splitString = currentLine.split("\\s");                                                                                                                         
                             649:                if (splitString.length < 3)                                                                                                                                     
                             650:                {                                                                                                                                                               
                             651:                    LOG.warn("invalid xref line: {}", currentLine);                                                                                                             
                             652:                    break;                                                                                                                                                      
                             653:                }                                                                                                                                                               
                             654:                /* This supports the corrupt table as reported in                                                                                                               
                             655:                 * PDFBOX-474 (XXXX XXX XX n) */                                                                                                                                
                             656:                if(splitString[splitString.length-1].equals("n"))                                                                                                               
                             657:                {                                                                                                                                                               
                             658:                    try                                                                                                                                                         
                             659:                    {                                                                                                                                                           
                             660:                        long currOffset = Long.parseLong(splitString[0]);                                                                                                       
                             661:                        // skip 0 offsets                                                                                                                                       
                             662:                        if (currOffset > 0)                                                                                                                                     
                             663:                        {                                                                                                                                                       
                             664:                            int currGenID = Integer.parseInt(splitString[1]);                                                                                                   
                             665:                            COSObjectKey objKey = new COSObjectKey(currObjID, currGenID);                                                                                       
                             666:                            xrefTrailerResolver.setXRef(objKey, currOffset);                                                                                                    
                             667:                        }                                                                                                                                                       
                             668:                    }                                                                                                                                                           
                             669:                    catch (IllegalArgumentException e)                                                                                                                          
                             670:                    {                                                                                                                                                           
                             671:                        throw new IOException(e);                                                                                                                               
                             672:                    }                                                                                                                                                           
                             673:                }                                                                                                                                                               
                             674:                else if(!splitString[2].equals("f"))                                                                                                                            
                             675:                {                                                                                                                                                               
                             676:                    throw new IOException("Corrupt XRefTable Entry - ObjID:" + currObjID);                                                                                      
                             677:                }                                                                                                                                                               
                             678:                currObjID++;                                                                                                                                                    
                             679:                parser.skipSpaces();                                                                                                                                            
                             680:            }                                                                                                                                                                   
                             681:            parser.skipSpaces();                                                                                                                                                
                             682:            if (!parser.isDigit())                                                                                                                                              
                             683:            {                                                                                                                                                                   
                             684:                break;                                                                                                                                                          
                             685:            }                                                                                                                                                                   
                             686:        }                                                                                                                                                                       
                             687:        return true;                                                                                                                                                            
                             688:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:203-255                                                                                                            
                             ```                                                                                                                                                                                 
                             203:    private boolean parseTrailer() throws IOException                                                                                                                           
                             204:    {                                                                                                                                                                           
                             205:        // parse the last trailer.                                                                                                                                              
                             206:        long trailerOffset = source.getPosition();                                                                                                                              
                             207:        // PDFBOX-1739 skip extra xref entries in RegisSTAR documents                                                                                                           
                             208:        int nextCharacter = source.peek();                                                                                                                                      
                             209:        while (nextCharacter != 't' && BaseParser.isDigit(nextCharacter))                                                                                                       
                             210:        {                                                                                                                                                                       
                             211:            if (source.getPosition() == trailerOffset)                                                                                                                          
                             212:            {                                                                                                                                                                   
                             213:                // warn only the first time                                                                                                                                     
                             214:                LOG.warn("Expected trailer object at offset {}, keep trying", trailerOffset);                                                                                   
                             215:            }                                                                                                                                                                   
                             216:            parser.readLine();                                                                                                                                                  
                             217:            nextCharacter = source.peek();                                                                                                                                      
                             218:        }                                                                                                                                                                       
                             219:        if (source.peek() != 't')                                                                                                                                               
                             220:        {                                                                                                                                                                       
                             221:            return false;                                                                                                                                                       
                             222:        }                                                                                                                                                                       
                             223:        // read "trailer"                                                                                                                                                       
                             224:        long currentOffset = source.getPosition();                                                                                                                              
                             225:        String nextLine = parser.readLine();                                                                                                                                    
                             226:        if (!nextLine.trim().equals("trailer"))                                                                                                                                 
                             227:        {                                                                                                                                                                       
                             228:            // in some cases the EOL is missing and the trailer immediately                                                                                                     
                             229:            // continues with "<<" or with a blank character                                                                                                                    
                             230:            // even if this does not comply with PDF reference we want to support as many PDFs as possible                                                                      
                             231:            // Acrobat reader can also deal with this.                                                                                                                          
                             232:            if (nextLine.startsWith("trailer"))                                                                                                                                 
                             233:            {                                                                                                                                                                   
                             234:                // we can't just unread a portion of the read data as we don't know if the EOL consist of 1 or 2 bytes                                                          
                             235:                int len = "trailer".length();                                                                                                                                   
                             236:                // jump back right after "trailer"                                                                                                                              
                             237:                source.seek(currentOffset + len);                                                                                                                               
                             238:            }                                                                                                                                                                   
                             239:            else                                                                                                                                                                
                             240:            {                                                                                                                                                                   
                             241:                return false;                                                                                                                                                   
                             242:            }                                                                                                                                                                   
                             243:        }                                                                                                                                                                       
                             244:                                                                                                                                                                                
                             245:        // in some cases the EOL is missing and the trailer continues with " <<"                                                                                                
                             246:        // even if this does not comply with PDF reference we want to support as many PDFs as possible                                                                          
                             247:        // Acrobat reader can also deal with this.                                                                                                                              
                             248:        parser.skipSpaces();                                                                                                                                                    
                             249:                                                                                                                                                                                
                             250:        COSDictionary parsedTrailer = parser.parseCOSDictionary(true);                                                                                                          
                             251:        xrefTrailerResolver.setTrailer(parsedTrailer);                                                                                                                          
                             252:                                                                                                                                                                                
                             253:        parser.skipSpaces();                                                                                                                                                    
                             254:        return true;                                                                                                                                                            
                             255:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Overview and Root Causes                                                                                                                                                         
                                After the previous patch, unbounded loops still exist in several parsing routines. Malformed or hostile PDFs lacking expected delimiters (EOL, whitespace, name                  
                             terminators, dictionary end tokens, XRef section markers) allow the parser to read indefinitely without hitting the hard limits. The fuzzer times out in these                      
                             unbounded loops.                                                                                                                                                                    
                                                                                                                                                                                                                 
                             2. Required Constants                                                                                                                                                               
                                - Define a new token-length limit:                                                                                                                                               
                                  ```java                                                                                                                                                                        
                                  private static final int MAX_TOKEN_LENGTH = 10_000;                                                                                                                            
                                  ```                                                                                                                                                                            
                                - Reuse existing MAX_SKIP_CHARS (10 000), MAX_LINE_CHARS (10 000), MAX_XREF_ENTRIES (10 000).                                                                                    
                                                                                                                                                                                                                 
                             3. Patch Steps in BaseParser.java                                                                                                                                                   
                                a. Enforce token length limits in all character-gobbling loops:                                                                                                                  
                                    In parseCOSName (around line 861):                                                                                                                                          
                                      Introduce an `int nameCount = 0;` before the loop.                                                                                                                        
                                      Inside `while (!isEndOfName(c))`, increment `nameCount` on each iteration. If `nameCount > MAX_TOKEN_LENGTH`, throw an `IOException("Name too long at                     
                             offset "+source.getPosition())`.                                                                                                                                                    
                                    In the no-argument `readString()` overload (used in parseDirObject default case):                                                                                           
                                      Add a similar `int strCount = 0;` and check `++strCount > MAX_TOKEN_LENGTH` inside the loop.                                                                              
                                    In readUntilEndOfCOSDictionary (around line 339):                                                                                                                           
                                      Add `int dictCount = 0;` before the `while` loop.                                                                                                                         
                                      In each loop iteration (each read), increment `dictCount`. If `dictCount > MAX_TOKEN_LENGTH`, throw `IOException("Dictionary content too long at offset                   
                             "+source.getPosition())`.                                                                                                                                                           
                                                                                                                                                                                                                 
                                b. Verify readLine is already bounded by MAX_LINE_CHARS (from last patch). Ensure the limit applies to all invocationsincluding in parseXrefTable and                           
                             parseTrailer contexts.                                                                                                                                                              
                                                                                                                                                                                                                 
                             4. Patch Steps in XrefParser.java                                                                                                                                                   
                                a. Tighten section entry count checks in parseXrefTable (around line 624 in the code snippet):                                                                                   
                                    After parsing `int count = Integer.parseInt(splitString[1]);`, add:                                                                                                         
                                     ```java                                                                                                                                                                     
                                     if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                                
                                         throw new IOException("XRef section count out of bounds: " + count                                                                                                      
                                             + " at offset " + parser.source.getPosition());                                                                                                                     
                                     }                                                                                                                                                                           
                                     ```                                                                                                                                                                         
                                   This prevents for (i=0; i<count;) loops from running unboundedly.                                                                                                          
                                                                                                                                                                                                                 
                                b. Bound trailer search in parseTrailer (around line 208):                                                                                                                       
                                    Introduce `int trailerLineCount = 0;` before the `while (nextCharacter != 't' && isDigit(nextCharacter))` loop.                                                             
                                    In each iteration, increment `trailerLineCount`. If `trailerLineCount > MAX_LINE_CHARS` (or a separate `MAX_TRAILER_SKIP_LINES`, e.g. 1 000), throw                         
                             `IOException("Trailer marker not found after " + trailerLineCount + " lines at offset " + trailerOffset)`.                                                                          
                                   This prevents hanging when trailer never appears.                                                                                                                           
                                                                                                                                                                                                                 
                             5. Preservation of Existing Logic                                                                                                                                                   
                                - All hard limits are high-enough (10 000) to not break legitimate PDFs while guarding against pathological inputs.                                                              
                                - No existing parsing pathways or tests are altered; only additional guard checks are inserted.                                                                                  
                                - The fuzzer harness remains untouched.                                                                                                                                          
                                                                                                                                                                                                                 
                             6. Side-Effects and Mitigations                                                                                                                                                     
                                - In the unlikely event of very large but valid tokens (e.g., names or dictionary bodies >10 000 chars), an IOException will be thrown. However, such PDFs are                   
                             non-standard or malicious.                                                                                                                                                          
                                - If false positives occur, limits can be configured as system properties.                                                                                                       
                                                                                                                                                                                                                 
                             7. Justification                                                                                                                                                                    
                                - Unbounded loops in parseCOSName, readString (no-arg), and readUntilEndOfCOSDictionary directly cause fuzzer timeouts; bounding them solves the root cause.                     
                                - Duplicating the MAX_XREF_ENTRIES check in parseXrefTable ensures large count values dont spawn huge loops.                                                                  
                                - Bounding the number of lines skipped when searching for trailer prevents infinite skipping.                                                                                  
                                - Similar patterns already exist in other parts of the code (MAX_LINE_CHARS, MAX_SKIP_CHARS), so this approach is consistent.                                                    
                                - All fix points touch only the core parser; no changes to harness or tests.                                                                                                     
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 21:16:06] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 5, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/26/25 21:17:12] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 5, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/26/25 21:20:11] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 5, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:20:12] INFO     [logging_performance](pdfbox Setting owner) Took 1.01 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmp3omy8d4v                                                                                                                                 default.py:173
[10/26/25 21:20:48] ERROR    Failed to build the challenge                                                                                                                                         __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stdout.txt: /src /src/project-parent/pdfbox                    functions.py:17
                             /src/project-parent/pdfbox                                                                                                                                                          
                             ---------------------------------------------------------------                                                                                                                     
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             ---------------------------------------------------------------                                                                                                                     
                             CC=clang                                                                                                                                                                            
                             CXX=clang++                                                                                                                                                                         
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                   
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak                                       
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                 
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak                        
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                                                                                                    
                             ---------------------------------------------------------------                                                                                                                     
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                                                                                                            
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                                                                                              
                             + '[' '!' -L /root/.m2/repository ']'                                                                                                                                               
                             + unset __REAL_MAVEN_REPO                                                                                                                                                           
                             + unset __SHARED_MAVEN_REPO                                                                                                                                                         
                             + PROJECT=pdfbox                                                                                                                                                                    
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                                                                                                
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                                                                                                        
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                                                                                                         
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                                                                                                 
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                                                                                                         
                             + cd /src/project-parent                                                                                                                                                            
                             + [[ -v LOCAL_DEV ]]                                                                                                                                                                
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                                                                                              
                             + set_project_version_in_fuzz_targets_dependency                                                                                                                                    
                             ++ cd pdfbox                                                                                                                                                                        
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout                                    
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                                                                                                    
                             + cd fuzz-targets                                                                                                                                                                   
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                            
                             [INFO] Scanning for projects...                                                                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                                                                                                     
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                                                                                                 
                             [INFO]   from pom.xml                                                                                                                                                               
                             [INFO] --------------------------------[ jar ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                                                                                                         
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD SUCCESS                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  0.680 s                                                                                                                                                         
                             [INFO] Finished at: 2025-10-26T21:20:19Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             + cd pdfbox                                                                                                                                                                         
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                             
                             [INFO] Scanning for projects...                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Build Order:                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent                                               [pom]                                                                                                     
                             [INFO] Apache PDFBox io                                                [bundle]                                                                                                     
                             [INFO] Apache FontBox                                                  [bundle]                                                                                                     
                             [INFO] Apache XmpBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox Debugger                                             [jar]                                                                                                     
                             [INFO] Apache PDFBox tools                                                [jar]                                                                                                     
                             [INFO] Apache PDFBox application                                          [jar]                                                                                                     
                             [INFO] Apache PDFBox Debugger application                                 [jar]                                                                                                     
                             [INFO] Apache PDFBox examples                                             [jar]                                                                                                     
                             [INFO] pdfbox-reactor                                                     [pom]                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                                                                                                     
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                                                                                                     
                             [INFO]   from parent/pom.xml                                                                                                                                                        
                             [INFO] --------------------------------[ pom ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                                                                                                     
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                                                                                                       
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                                                                                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                                                                                                       
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                                                                                                
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---                                                                                            
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                                                                                                        
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                                                                                              
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                                                                                                     
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                                                                                                     
                             [INFO]   from io/pom.xml                                                                                                                                                            
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                                                                                                         
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                                                                                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                                                                                                    
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                                                                                                
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                                                                                                            
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources                                                                                         
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                                                                                                
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                                                                                                    
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                                                                                                           
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                                                                                                        
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                                                                                                       
                                                                                                                                                                                                                 
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                                                                                                            
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                                                                                                     
                             [INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                                                                          
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                                                                                                
                             [INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                                                                                                  
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                                          
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                                                                                              
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                                                                                      
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                                                                                                   
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                                                                                                     
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                                                                                                     
                             [INFO]   from fontbox/pom.xml                                                                                                                                                       
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                                                                                                      
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                                                                                                  
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                                                                                              
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                                                                                                  
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.                                   
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4038) @ fontbox ---                                                                                                                         
                                                                                                                                                                                                                 
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3997) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-3379) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5328) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5356) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5713) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-5728) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- download:1.13.0:wget (PDFBOX-4106) @ fontbox ---                                                                                                                         
                             [INFO] download-maven-plugin:wget skipped                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ fontbox ---                                                                                                      
                             [INFO] Copying 27 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ fontbox ---                                                                                                          
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 44 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ fontbox ---                                                                                                                         
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ fontbox ---                                                                                                                              
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ fontbox ---                                                                                                                       
                             [INFO] Building bundle: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar                                                                                        
                             [INFO] Writing manifest: /src/project-parent/pdfbox/fontbox/target/classes/META-INF/MANIFEST.MF                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ fontbox ---                                                                                                                  
                             [INFO] Building jar: /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ fontbox ---                                                                                                                    
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/pom.xml to /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.pom                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT.jar to                                                                                           
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                                         
                             [INFO] Installing /src/project-parent/pdfbox/fontbox/target/fontbox-4.0.0-SNAPSHOT-sources.jar to                                                                                   
                             /out/m2/org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT-sources.jar                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ fontbox ---                                                                                                                     
                             [INFO] Installing org/apache/pdfbox/fontbox/4.0.0-SNAPSHOT/fontbox-4.0.0-SNAPSHOT.jar                                                                                               
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:xmpbox >----------------------                                                                                                     
                             [INFO] Building Apache XmpBox 4.0.0-SNAPSHOT                             [4/11]                                                                                                     
                             [INFO]   from xmpbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ xmpbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ xmpbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ xmpbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ xmpbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ xmpbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ xmpbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ xmpbox ---                                                                                                               
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/xmpbox/src/main/resources                                                                                     
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ xmpbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 72 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ xmpbox ---                                                                                                       
                             [INFO] Copying 29 resources from src/test/resources to target/test-classes                                                                                                          
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ xmpbox ---                                                                                                           
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 30 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java:                                                                               
                             /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java uses unchecked or unsafe operations.                                                  
                             [INFO] /src/project-parent/pdfbox/xmpbox/src/test/java/org/apache/xmpbox/schema/XMPSchemaTester.java: Recompile with -Xlint:unchecked for details.                                  
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ xmpbox ---                                                                                                                          
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ xmpbox ---                                                                                                                               
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ xmpbox ---                                                                                                                        
                             [INFO] Building bundle: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar                                                                                          
                             [INFO] Writing manifest: /src/project-parent/pdfbox/xmpbox/target/classes/META-INF/MANIFEST.MF                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ xmpbox ---                                                                                                                   
                             [INFO] Building jar: /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ xmpbox ---                                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/pom.xml to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.pom                                            
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT.jar to /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                   
                             [INFO] Installing /src/project-parent/pdfbox/xmpbox/target/xmpbox-4.0.0-SNAPSHOT-sources.jar to                                                                                     
                             /out/m2/org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT-sources.jar                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ xmpbox ---                                                                                                                      
                             [INFO] Installing org/apache/pdfbox/xmpbox/4.0.0-SNAPSHOT/xmpbox-4.0.0-SNAPSHOT.jar                                                                                                 
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< org.apache.pdfbox:pdfbox >----------------------                                                                                                     
                             [INFO] Building Apache PDFBox 4.0.0-SNAPSHOT                             [5/11]                                                                                                     
                             [INFO]   from pdfbox/pom.xml                                                                                                                                                        
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox ---                                                                                                                            
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox ---                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox ---                                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox ---                                                                                                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox ---                                                                                                   
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox ---                                                                                                               
                             [INFO] Copying 1 resource from src/main/resources to target/classes                                                                                                                 
                             [INFO] Copying 21 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO] The encoding used to copy filtered properties files have not been set. This means that the same encoding will be used to copy filtered properties files as                   
                             when copying other filtered resources. This might not be what you want! Run your build with --debug to see which files might be affected. Read more at                              
                             https://maven.apache.org/plugins/maven-resources-plugin/examples/filtering-properties-files.html                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox ---                                                                                                                   
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 617 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[1140,5] illegal start of expression                                            
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.183 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.476 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  4.013 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.624 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  1.329 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.890 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:20:47Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[1140,5] illegal start of expression                                            
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors and possible solutions, please read the following articles:                                                                           
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] After correcting the problems, you can resume the build with the command                                                                                                    
                             [ERROR]   mvn <args> -rf :pdfbox                                                                                                                                                    
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                                                                                                                                                                                                                 
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761511868.3187711/build_failed_stderr.txt: INFO:__main__:Running: docker build -t             functions.py:17
                             aixcc-afc/pdfbox:latest --file /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                                                                             
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                                                                                                      
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.07kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 1.23kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                                                                                              
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [ 8/13] COPY project-parent /src/project-parent/                                                                                                                                 
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                                                                                                     
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                                                                                                   
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                                           
                             /src/PDFWriteReadFuzzer.dict                                                                                                                                                        
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz                                                                                         
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                                                                                                      
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [12/13] COPY build.sh /src/                                                                                                                                                     
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                                                                                                   
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                                                                                              
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2                                             
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*                                                                                    
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                                                                                                      
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 exporting to image                                                                                                                                                              
                             #18 exporting layers done                                                                                                                                                           
                             #18 writing image sha256:9b6504b147657588b7dbd86a0382ef91d36837dc312b2f94517c5f990530eef7 0.0s done                                                                                 
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest 0.0s done                                                                                                                           
                             #18 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                        
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                              
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp                
                             -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                                                                                                              
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Patching) Took 35.88 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:20:49] INFO     [logging_performance](pdfbox Setting owner) Took 1.10 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 21:20:50] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 21:20:51] INFO     [logging_performance](pdfbox Setting owner) Took 1.06 seconds; exception=False                                                                                context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                                                                                                            
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java                                                                                                              
                             @@ -66,6 +66,9 @@                                                                                                                                                                   
                                                                                                                                                                                                                 
                                  private static final Charset ALTERNATIVE_CHARSET;                                                                                                                              
                                                                                                                                                                                                                 
                             +    private static final int MAX_SKIP_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_LINE_CHARS = 10000;                                                                                                                               
                             +    private static final int MAX_TOKEN_LENGTH = 10000;                                                                                                                             
                                  private final Map<Long, COSObjectKey> keyCache = new HashMap<>();                                                                                                              
                                                                                                                                                                                                                 
                                  static                                                                                                                                                                         
                             @@ -1134,20 +1137,30 @@                                                                                                                                                             
                                      }                                                                                                                                                                          
                                      if (c != -1)                                                                                                                                                               
                                      {                                                                                                                                                                          
                             -            source.rewind(1);                                                                                                                                                      
                             +    protected String readLine() throws IOException                                                                                                                                 
                             +    {                                                                                                                                                                              
                             +        StringBuilder buffer = new StringBuilder();                                                                                                                                
                             +        int c = source.read();                                                                                                                                                     
                             +        int length = 0;                                                                                                                                                            
                             +        while (c != -1 && c != '\r' && c != '\n')                                                                                                                                  
                             +        {                                                                                                                                                                          
                             +            buffer.append((char)c);                                                                                                                                                
                             +            if (++length > MAX_LINE_CHARS)                                                                                                                                         
                             +            {                                                                                                                                                                      
                             +                throw new IOException("Exceeded readLine limit of " + MAX_LINE_CHARS                                                                                               
                             +                        + " at offset " + source.getPosition());                                                                                                                   
                             +            }                                                                                                                                                                      
                             +            c = source.read();                                                                                                                                                     
                             +        }                                                                                                                                                                          
                             +        if (c == '\r')                                                                                                                                                             
                             +        {                                                                                                                                                                          
                             +            int next = source.peek();                                                                                                                                              
                             +            if (next == '\n')                                                                                                                                                      
                             +            {                                                                                                                                                                      
                             +                source.read();                                                                                                                                                     
                             +            }                                                                                                                                                                      
                                      }                                                                                                                                                                          
                                      return buffer.toString();                                                                                                                                                  
                             -    }                                                                                                                                                                              
                             -                                                                                                                                                                                   
                             -    /**                                                                                                                                                                            
                             -     * This will tell if the next character is a closing brace( close of PDF array ).                                                                                              
                             -     *                                                                                                                                                                             
                             -     * @param c The character to check against end of line                                                                                                                         
                             -     * @return true if the next byte is ']', false otherwise.                                                                                                                      
                             -     */                                                                                                                                                                            
                             -    protected static boolean isClosing(int c)                                                                                                                                      
                             -    {                                                                                                                                                                              
                             -        return c == ']';                                                                                                                                                           
                                  }                                                                                                                                                                              
                                                                                                                                                                                                                 
                                  /**                                                                                                                                                                            
                             @@ -1318,23 +1331,34 @@                                                                                                                                                             
                                   */                                                                                                                                                                            
                                  protected void skipSpaces() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                             +        int skipped = 0;                                                                                                                                                           
                                      int c = source.read();                                                                                                                                                     
                                      // 37 is the % character, a comment                                                                                                                                        
                             -        while( isWhitespace(c) || c == 37)                                                                                                                                         
                             -        {                                                                                                                                                                          
                             -            if ( c == 37 )                                                                                                                                                         
                             +        while (isWhitespace(c) || c == 37)                                                                                                                                         
                             +        {                                                                                                                                                                          
                             +            if (c == 37)                                                                                                                                                           
                                          {                                                                                                                                                                      
                                              // skip past the comment section                                                                                                                                   
                                              c = source.read();                                                                                                                                                 
                             -                while(!isEOL(c) && c != -1)                                                                                                                                        
                             +                while (!isEOL(c) && c != -1)                                                                                                                                       
                                              {                                                                                                                                                                  
                             +                    if (++skipped > MAX_SKIP_CHARS)                                                                                                                                
                             +                    {                                                                                                                                                              
                             +                        throw new IOException("Exceeded skipSpaces limit of " + MAX_SKIP_CHARS                                                                                     
                             +                                + " at offset " + source.getPosition());                                                                                                           
                             +                    }                                                                                                                                                              
                                                  c = source.read();                                                                                                                                             
                                              }                                                                                                                                                                  
                                          }                                                                                                                                                                      
                                          else                                                                                                                                                                   
                                          {                                                                                                                                                                      
                             -                c = source.read();                                                                                                                                                 
                             -            }                                                                                                                                                                      
                             +                if (++skipped > MAX_SKIP_CHARS)                                                                                                                                    
                             +                {                                                                                                                                                                  
                             +                    throw new IOException("Exceeded skipSpaces limit of " + MAX_SKIP_CHARS                                                                                         
                             +                            + " at offset " + source.getPosition());                                                                                                               
                             +                }                                                                                                                                                                  
                             +            }                                                                                                                                                                      
                             +            c = source.read();                                                                                                                                                     
                                      }                                                                                                                                                                          
                                      if (c != -1)                                                                                                                                                               
                                      {                                                                                                                                                                          
                                                                                                                                                                                                                 
                             --- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             +++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java                                                                                                              
                             @@ -45,6 +45,7 @@                                                                                                                                                                   
                                  private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                               
                                  private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                       
                                                                                                                                                                                                                 
                             +    private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                             
                                  /**                                                                                                                                                                            
                                   * Collects all Xref/trailer objects and resolves them into single                                                                                                             
                                   * object using startxref reference.                                                                                                                                           
                             @@ -630,6 +631,11 @@                                                                                                                                                                
                                              LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                                 
                                              return false;                                                                                                                                                      
                                          }                                                                                                                                                                      
                             +            if (count < 0 || count > MAX_XREF_ENTRIES)                                                                                                                             
                             +            {                                                                                                                                                                      
                             +                throw new IOException("XRef section count out of bounds: " + count                                                                                                 
                             +                        + " at offset " + parser.source.getPosition());                                                                                                            
                             +            }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          parser.skipSpaces();                                                                                                                                                   
                                          for(int i = 0; i < count; i++)                                                                                                                                         
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[1140,5] illegal start of expression                                            
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.183 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.476 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  4.013 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.624 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  1.329 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.890 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:20:47Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:[1140,5] illegal start of expression                                            
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             An automated fuzzing run of PDFBox via Jazzer/libFuzzer hung and timed out in the PDF parsing code. The stack trace shows the parser stuck in                                       
                             `BaseParser.skipSpaces` and related routines. To mitigate unbounded parsing, a patch was proposed that:                                                                             
                                                                                                                                                                                                                 
                             - Adds three new static limits (`MAX_SKIP_CHARS`, `MAX_LINE_CHARS`, `MAX_TOKEN_LENGTH`) in `BaseParser`.                                                                            
                             - Modifies calls to `readString()` to use the new `MAX_TOKEN_LENGTH` limit.                                                                                                         
                             - Inserts a bounds check against a new constant `MAX_XREF_ENTRIES` in `XrefParser`.                                                                                                 
                                                                                                                                                                                                                 
                             After applying the patch, the build fails with a compilation error: `MAX_XREF_ENTRIES` is not defined in `XrefParser`.                                                              
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. **Initial Issue**                                                                                                                                                                
                                - The fuzzer run reported a LibFuzzer timeout after ~28 s of execution.                                                                                                          
                                - The full thread dump shows the main thread stuck in native tracing callbacks (`TraceDataFlowNativeCallbacks.traceConstCmpInt`), then repeatedly invoking                     
                             `BaseParser.skipSpaces`, `parseCOSDictionaryValue`, and related parsing methods.                                                                                                    
                                - No out-of-memory or exception was thrownparsing simply did not complete within the timeout.                                                                                   
                                                                                                                                                                                                                 
                             2. **Key Observations from the Thread Dump**                                                                                                                                        
                                - The parser spends extensive time in low-level byte scanning (`skipSpaces`) and constant comparison tracing.                                                                    
                                - It is parsing deeply nested or malformed dictionary structures without an obvious bailout.                                                                                     
                                - Other JVM threads (GC threads, reference handlers, cleaners) remain idle or working normally, indicating the hang is in user code.                                             
                                                                                                                                                                                                                 
                             3. **Patch Attempt**                                                                                                                                                                
                                - In `BaseParser.java`, three new constants were declared at the top of the class:                                                                                               
                                   `private static final int MAX_SKIP_CHARS = 10000;`                                                                                                                           
                                   `private static final int MAX_LINE_CHARS = 10000;`                                                                                                                           
                                   `private static final int MAX_TOKEN_LENGTH = 10000;`                                                                                                                         
                                - A call site that previously read an unbounded string was changed from                                                                                                          
                                  `String badString = readString();`                                                                                                                                             
                                  to                                                                                                                                                                             
                                  `String badString = readString(MAX_TOKEN_LENGTH);`                                                                                                                             
                                - In `XrefParser.java`, before iterating over XRef entries, the code now checks:                                                                                                 
                                  ```                                                                                                                                                                            
                                  if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                                   
                                      throw new IOException(...);                                                                                                                                                
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                - The intention is to guard against extremely large or negative entry counts during cross-reference parsing.                                                                     
                                                                                                                                                                                                                 
                             4. **Build Result After Patch**                                                                                                                                                     
                                - Maven compilation failed with:                                                                                                                                                 
                                  ```                                                                                                                                                                            
                                  XrefParser.java:[633,38] cannot find symbol                                                                                                                                    
                                    symbol:   variable MAX_XREF_ENTRIES                                                                                                                                          
                                    location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                       
                                  ```                                                                                                                                                                            
                                - This indicates that `MAX_XREF_ENTRIES` was referenced but never declared in `XrefParser` (or imported from elsewhere).                                                         
                                                                                                                                                                                                                 
                             5. **Areas for Further Investigation**                                                                                                                                              
                                - **Definition of MAX_XREF_ENTRIES**: Determine an appropriate location or value for this constant. Decide if it belongs in `XrefParser`, in a shared constants                  
                             class, or alongside the other limits in `BaseParser`.                                                                                                                               
                                - **Limit Consistency**: Review all parsing routines (`skipSpaces`, `readLine`, `readString`, token parsing) to ensure they uniformly respect configured caps.                   
                                - **Overloaded Methods**: Confirm that `readString(int maxLength)` exists and that other overloads (`readLine`, `skipSpaces`) can similarly accept or enforce                    
                             bounds.                                                                                                                                                                             
                                - **Integration Points**: Check other parser classes (`PDFParser`, `COSParser`) for unbounded loops or recursions that may require analogous protections.                        
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 20:54:07                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f7c88049f60, length=14, elements={                                                                                                                         
                             0x000055665279ab70, 0x00005566528a5bf0, 0x00005566528a7000, 0x00005566528b0090,                                                                                                     
                             0x00005566528b1410, 0x00005566528b27f0, 0x00005566528b41f0, 0x00005566528b56f0,                                                                                                     
                             0x00005566528b6b30, 0x00005566528fba50, 0x00005566528fefc0, 0x0000556652ab4c30,                                                                                                     
                             0x00007f7cb8000e70, 0x0000556653048e90                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26581.87ms elapsed=28.68s tid=0x000055665279ab70 nid=0x13 runnable  [0x00007fff9fc00000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.pdfbox.pdfparser.BaseParser.skipSpaces(BaseParser.java:1323)                                                                                                  
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:226)                                                                                      
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:384)                                                                              
                                     at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:300)                                                                                           
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseTrailer(XrefParser.java:250)                                                                                                 
                                     at org.apache.pdfbox.pdfparser.XrefParser.parseXref(XrefParser.java:117)                                                                                                    
                                     at org.apache.pdfbox.pdfparser.COSParser.retrieveTrailer(COSParser.java:253)                                                                                                
                                     at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:107)                                                                                                   
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:171)                                                                                                          
                                     at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:136)                                                                                                          
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:480)                                                                                                                        
                                     at org.apache.pdfbox.Loader.loadPDF(Loader.java:378)                                                                                                                        
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:40)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd400.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbcc00.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.83ms elapsed=28.64s tid=0x00005566528a5bf0 nid=0x16 waiting on condition  [0x00007f7cce2fc000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.52ms elapsed=28.64s tid=0x00005566528a7000 nid=0x17 in Object.wait()  [0x00007f7cce21b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089414178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.38ms elapsed=28.63s tid=0x00005566528b0090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.91ms elapsed=28.63s tid=0x00005566528b1410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.63s tid=0x00005566528b27f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1645.86ms elapsed=28.63s tid=0x00005566528b41f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=734.94ms elapsed=28.63s tid=0x00005566528b56f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=55.03ms elapsed=28.63s tid=0x00005566528b6b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.13ms elapsed=28.60s tid=0x00005566528fba50 nid=0x21 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.83ms elapsed=28.60s tid=0x00005566528fefc0 nid=0x23 in Object.wait()  [0x00007f7ccd55b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416330> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.47s tid=0x0000556652ab4c30 nid=0x27 waiting on condition  [0x00007f7ccd22b000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941c2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.88ms elapsed=28.38s tid=0x00007f7cb8000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.20ms elapsed=25.50s tid=0x0000556653048e90 nid=0x28f in Object.wait()  [0x00007f7c37e3c000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008a090e50> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=131.11ms elapsed=28.64s tid=0x00005566528a1400 nid=0x15 runnable                                                                                          
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=69.08ms elapsed=28.66s tid=0x00005566527b1da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=65.47ms elapsed=27.64s tid=0x00007f7cc80015b0 nid=0x5d runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=69.55ms elapsed=27.64s tid=0x00007f7cc8001fb0 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=68.47ms elapsed=27.64s tid=0x00007f7cc80029b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.36ms elapsed=27.64s tid=0x00007f7cc80033b0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=69.06ms elapsed=27.64s tid=0x00007f7cc8003db0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=63.10ms elapsed=27.64s tid=0x00007f7cc80047b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=59.30ms elapsed=27.64s tid=0x00007f7cc80055a0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=63.23ms elapsed=27.64s tid=0x00007f7cc8006390 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=68.17ms elapsed=27.64s tid=0x00007f7cc8007180 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=60.20ms elapsed=27.64s tid=0x00007f7cc8007f70 nid=0x66 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=51.18ms elapsed=27.64s tid=0x00007f7cc8008d60 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=69.62ms elapsed=27.64s tid=0x00007f7cc8009b50 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.54ms elapsed=28.60s tid=0x00005566528fd7e0 nid=0x22 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                               symbol:   variable MAX_XREF_ENTRIES                                                                                                                                               
                               location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                            
                             [INFO] 1 error                                                                                                                                                                      
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.139 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.350 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... SUCCESS [  3.976 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SUCCESS [  0.599 s]                                                                                                     
                             [INFO] Apache PDFBox ...................................... FAILURE [  2.487 s]                                                                                                     
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  27.647 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-26T21:15:51Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project pdfbox: Compilation failure                               
                             [ERROR] /src/project-parent/pdfbox/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:[633,38] cannot find symbol                                                     
                             [ERROR]   symbol:   variable MAX_XREF_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.pdfbox.pdfparser.XrefParser                                                                                                                    
                             [ERROR]                                                                                                                                                                             
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:44-47                                                                                                              
                             ```                                                                                                                                                                                 
                             44:    private static final int X = 'x';                                                                                                                                            
                             45:    private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                             
                             46:    private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                     
                             47:                                                                                                                                                                                 
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:574-584                                                                                                            
                             ```                                                                                                                                                                                 
                             574:    private boolean parseXrefTable(long startByteOffset) throws IOException                                                                                                     
                             575:    {                                                                                                                                                                           
                             576:        if (source.peek() != 'x')                                                                                                                                               
                             577:        {                                                                                                                                                                       
                             578:            return false;                                                                                                                                                       
                             579:        }                                                                                                                                                                       
                             580:        String xref = parser.readString();                                                                                                                                      
                             581:        if( !xref.trim().equals( "xref" ) )                                                                                                                                     
                             582:        {                                                                                                                                                                       
                             583:            return false;                                                                                                                                                       
                             584:        }                                                                                                                                                                       
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1070-1125                                                                                                          
                             ```                                                                                                                                                                                 
                             1070:     * Reads given pattern from {@link #source}. Skipping whitespace at start and end if wanted.                                                                               
                             1071:     *                                                                                                                                                                         
                             1072:     * @param expectedString pattern to be skipped                                                                                                                             
                             1073:     * @param skipSpaces if set to true spaces before and after the string will be skipped                                                                                     
                             1074:     * @throws IOException if pattern could not be read                                                                                                                        
                             1075:     */                                                                                                                                                                        
                             1076:    protected final void readExpectedString(final char[] expectedString, boolean skipSpaces) throws IOException                                                                
                             1077:    {                                                                                                                                                                          
                             1078:        skipSpaces();                                                                                                                                                          
                             1079:        for (char c : expectedString)                                                                                                                                          
                             1080:        {                                                                                                                                                                      
                             1081:            if (source.read() != c)                                                                                                                                            
                             1082:            {                                                                                                                                                                  
                             1083:                throw new IOException("Expected string '" + new String(expectedString)                                                                                         
                             1084:                        + "' but missed at character '" + c + "' at offset "                                                                                                   
                             1085:                        + source.getPosition());                                                                                                                               
                             1086:            }                                                                                                                                                                  
                             1087:        }                                                                                                                                                                      
                             1088:        skipSpaces();                                                                                                                                                          
                             1089:    }                                                                                                                                                                          
                             1090:                                                                                                                                                                               
                             1091:    /**                                                                                                                                                                        
                             1092:     * Read one char and throw an exception if it is not the expected value.                                                                                                   
                             1093:     *                                                                                                                                                                         
                             1094:     * @param ec the char value that is expected.                                                                                                                              
                             1095:     * @throws IOException if the read char is not the expected value or if an                                                                                                 
                             1096:     * I/O error occurs.                                                                                                                                                       
                             1097:     */                                                                                                                                                                        
                             1098:    protected void readExpectedChar(char ec) throws IOException                                                                                                                
                             1099:    {                                                                                                                                                                          
                             1100:        char c = (char) source.read();                                                                                                                                         
                             1101:        if (c != ec)                                                                                                                                                           
                             1102:        {                                                                                                                                                                      
                             1103:            throw new IOException(                                                                                                                                             
                             1104:                    "expected='" + ec + "' actual='" + c + "' at offset " + source.getPosition());                                                                             
                             1105:        }                                                                                                                                                                      
                             1106:    }                                                                                                                                                                          
                             1107:                                                                                                                                                                               
                             1108:    /**                                                                                                                                                                        
                             1109:     * This will read the next string from the stream up to a certain length.                                                                                                  
                             1110:     *                                                                                                                                                                         
                             1111:     * @param length The length to stop reading at.                                                                                                                            
                             1112:     *                                                                                                                                                                         
                             1113:     * @return The string that was read from the stream of length 0 to length.                                                                                                 
                             1114:     *                                                                                                                                                                         
                             1115:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1116:     */                                                                                                                                                                        
                             1117:    protected String readString( int length ) throws IOException                                                                                                               
                             1118:    {                                                                                                                                                                          
                             1119:        skipSpaces();                                                                                                                                                          
                             1120:                                                                                                                                                                               
                             1121:        int c = source.read();                                                                                                                                                 
                             1122:                                                                                                                                                                               
                             1123:        //average string size is around 2 and the normal string buffer size is                                                                                                 
                             1124:        //about 16 so lets save some space.                                                                                                                                    
                             1125:        StringBuilder buffer = new StringBuilder(length);                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java:1000-1125                                                                                                          
                             ```                                                                                                                                                                                 
                             1000:                        + " (start offset: " + startOffset + ")");                                                                                                             
                             1001:            }                                                                                                                                                                  
                             1002:                                                                                                                                                                               
                             1003:            // if it's an endstream/endobj, we want to put it back so the caller will see it                                                                                   
                             1004:            if (ENDOBJ_STRING.equals(badString) || ENDSTREAM_STRING.equals(badString))                                                                                         
                             1005:            {                                                                                                                                                                  
                             1006:                source.rewind(badString.getBytes(StandardCharsets.ISO_8859_1).length);                                                                                         
                             1007:            }                                                                                                                                                                  
                             1008:            else                                                                                                                                                               
                             1009:            {                                                                                                                                                                  
                             1010:                LOG.warn("Skipped unexpected dir object = '{}' at offset {} (start offset: {})",                                                                               
                             1011:                        badString, source.getPosition(), startOffset);                                                                                                         
                             1012:                return this instanceof PDFStreamParser ? null : COSNull.NULL;                                                                                                  
                             1013:            }                                                                                                                                                                  
                             1014:        }                                                                                                                                                                      
                             1015:        return null;                                                                                                                                                           
                             1016:    }                                                                                                                                                                          
                             1017:                                                                                                                                                                               
                             1018:    private COSNumber parseCOSNumber() throws IOException                                                                                                                      
                             1019:    {                                                                                                                                                                          
                             1020:        StringBuilder buf = new StringBuilder();                                                                                                                               
                             1021:        int ic = source.read();                                                                                                                                                
                             1022:        char c = (char) ic;                                                                                                                                                    
                             1023:        while (Character.isDigit(c) || c == '-' || c == '+' || c == '.' || c == 'E' || c == 'e')                                                                               
                             1024:        {                                                                                                                                                                      
                             1025:            buf.append(c);                                                                                                                                                     
                             1026:            ic = source.read();                                                                                                                                                
                             1027:            c = (char) ic;                                                                                                                                                     
                             1028:        }                                                                                                                                                                      
                             1029:        if (ic != -1)                                                                                                                                                          
                             1030:        {                                                                                                                                                                      
                             1031:            source.rewind(1);                                                                                                                                                  
                             1032:        }                                                                                                                                                                      
                             1033:                                                                                                                                                                               
                             1034:        // PDFBOX-5025: catch "74191endobj"                                                                                                                                    
                             1035:        char lastc = buf.charAt(buf.length() - 1);                                                                                                                             
                             1036:        if (lastc == 'e' || lastc == 'E')                                                                                                                                      
                             1037:        {                                                                                                                                                                      
                             1038:            buf.deleteCharAt(buf.length() - 1);                                                                                                                                
                             1039:            source.rewind(1);                                                                                                                                                  
                             1040:        }                                                                                                                                                                      
                             1041:                                                                                                                                                                               
                             1042:        return COSNumber.get(buf.toString());                                                                                                                                  
                             1043:    }                                                                                                                                                                          
                             1044:                                                                                                                                                                               
                             1045:    /**                                                                                                                                                                        
                             1046:     * This will read the next string from the stream.                                                                                                                         
                             1047:     *                                                                                                                                                                         
                             1048:     * @return The string that was read from the stream, never null.                                                                                                           
                             1049:     *                                                                                                                                                                         
                             1050:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1051:     */                                                                                                                                                                        
                             1052:    protected String readString() throws IOException                                                                                                                           
                             1053:    {                                                                                                                                                                          
                             1054:        skipSpaces();                                                                                                                                                          
                             1055:        StringBuilder buffer = new StringBuilder();                                                                                                                            
                             1056:        int c = source.read();                                                                                                                                                 
                             1057:        while (!isEndOfName(c))                                                                                                                                                
                             1058:        {                                                                                                                                                                      
                             1059:            buffer.append( (char)c );                                                                                                                                          
                             1060:            c = source.read();                                                                                                                                                 
                             1061:        }                                                                                                                                                                      
                             1062:        if (c != -1)                                                                                                                                                           
                             1063:        {                                                                                                                                                                      
                             1064:            source.rewind(1);                                                                                                                                                  
                             1065:        }                                                                                                                                                                      
                             1066:        return buffer.toString();                                                                                                                                              
                             1067:    }                                                                                                                                                                          
                             1068:                                                                                                                                                                               
                             1069:    /**                                                                                                                                                                        
                             1070:     * Reads given pattern from {@link #source}. Skipping whitespace at start and end if wanted.                                                                               
                             1071:     *                                                                                                                                                                         
                             1072:     * @param expectedString pattern to be skipped                                                                                                                             
                             1073:     * @param skipSpaces if set to true spaces before and after the string will be skipped                                                                                     
                             1074:     * @throws IOException if pattern could not be read                                                                                                                        
                             1075:     */                                                                                                                                                                        
                             1076:    protected final void readExpectedString(final char[] expectedString, boolean skipSpaces) throws IOException                                                                
                             1077:    {                                                                                                                                                                          
                             1078:        skipSpaces();                                                                                                                                                          
                             1079:        for (char c : expectedString)                                                                                                                                          
                             1080:        {                                                                                                                                                                      
                             1081:            if (source.read() != c)                                                                                                                                            
                             1082:            {                                                                                                                                                                  
                             1083:                throw new IOException("Expected string '" + new String(expectedString)                                                                                         
                             1084:                        + "' but missed at character '" + c + "' at offset "                                                                                                   
                             1085:                        + source.getPosition());                                                                                                                               
                             1086:            }                                                                                                                                                                  
                             1087:        }                                                                                                                                                                      
                             1088:        skipSpaces();                                                                                                                                                          
                             1089:    }                                                                                                                                                                          
                             1090:                                                                                                                                                                               
                             1091:    /**                                                                                                                                                                        
                             1092:     * Read one char and throw an exception if it is not the expected value.                                                                                                   
                             1093:     *                                                                                                                                                                         
                             1094:     * @param ec the char value that is expected.                                                                                                                              
                             1095:     * @throws IOException if the read char is not the expected value or if an                                                                                                 
                             1096:     * I/O error occurs.                                                                                                                                                       
                             1097:     */                                                                                                                                                                        
                             1098:    protected void readExpectedChar(char ec) throws IOException                                                                                                                
                             1099:    {                                                                                                                                                                          
                             1100:        char c = (char) source.read();                                                                                                                                         
                             1101:        if (c != ec)                                                                                                                                                           
                             1102:        {                                                                                                                                                                      
                             1103:            throw new IOException(                                                                                                                                             
                             1104:                    "expected='" + ec + "' actual='" + c + "' at offset " + source.getPosition());                                                                             
                             1105:        }                                                                                                                                                                      
                             1106:    }                                                                                                                                                                          
                             1107:                                                                                                                                                                               
                             1108:    /**                                                                                                                                                                        
                             1109:     * This will read the next string from the stream up to a certain length.                                                                                                  
                             1110:     *                                                                                                                                                                         
                             1111:     * @param length The length to stop reading at.                                                                                                                            
                             1112:     *                                                                                                                                                                         
                             1113:     * @return The string that was read from the stream of length 0 to length.                                                                                                 
                             1114:     *                                                                                                                                                                         
                             1115:     * @throws IOException If there is an error reading from the stream.                                                                                                       
                             1116:     */                                                                                                                                                                        
                             1117:    protected String readString( int length ) throws IOException                                                                                                               
                             1118:    {                                                                                                                                                                          
                             1119:        skipSpaces();                                                                                                                                                          
                             1120:                                                                                                                                                                               
                             1121:        int c = source.read();                                                                                                                                                 
                             1122:                                                                                                                                                                               
                             1123:        //average string size is around 2 and the normal string buffer size is                                                                                                 
                             1124:        //about 16 so lets save some space.                                                                                                                                    
                             1125:        StringBuilder buffer = new StringBuilder(length);                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:620-660                                                                                                            
                             ```                                                                                                                                                                                 
                             620:            }                                                                                                                                                                   
                             621:                                                                                                                                                                                
                             622:            // the number of objects in the xref table                                                                                                                          
                             623:            int count = 0;                                                                                                                                                      
                             624:            try                                                                                                                                                                 
                             625:            {                                                                                                                                                                   
                             626:                count = Integer.parseInt(splitString[1]);                                                                                                                       
                             627:            }                                                                                                                                                                   
                             628:            catch (NumberFormatException exception)                                                                                                                             
                             629:            {                                                                                                                                                                   
                             630:                LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                              
                             631:                return false;                                                                                                                                                   
                             632:            }                                                                                                                                                                   
                             633:                                                                                                                                                                                
                             634:            parser.skipSpaces();                                                                                                                                                
                             635:            for(int i = 0; i < count; i++)                                                                                                                                      
                             636:            {                                                                                                                                                                   
                             637:                if (parser.isEOF() )                                                                                                                                            
                             638:                {                                                                                                                                                               
                             639:                    break;                                                                                                                                                      
                             640:                }                                                                                                                                                               
                             641:                int nextChar = source.peek();                                                                                                                                   
                             642:                if (nextChar == 't' || BaseParser.isEndOfName(nextChar))                                                                                                        
                             643:                {                                                                                                                                                               
                             644:                    break;                                                                                                                                                      
                             645:                }                                                                                                                                                               
                             646:                //Ignore table contents                                                                                                                                         
                             647:                currentLine = parser.readLine();                                                                                                                                
                             648:                splitString = currentLine.split("\\s");                                                                                                                         
                             649:                if (splitString.length < 3)                                                                                                                                     
                             650:                {                                                                                                                                                               
                             651:                    LOG.warn("invalid xref line: {}", currentLine);                                                                                                             
                             652:                    break;                                                                                                                                                      
                             653:                }                                                                                                                                                               
                             654:                /* This supports the corrupt table as reported in                                                                                                               
                             655:                 * PDFBOX-474 (XXXX XXX XX n) */                                                                                                                                
                             656:                if(splitString[splitString.length-1].equals("n"))                                                                                                               
                             657:                {                                                                                                                                                               
                             658:                    try                                                                                                                                                         
                             659:                    {                                                                                                                                                           
                             660:                        long currOffset = Long.parseLong(splitString[0]);                                                                                                       
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:44-50                                                                                                              
                             ```                                                                                                                                                                                 
                             44:    private static final int X = 'x';                                                                                                                                            
                             45:    private static final char[] XREF_TABLE = { 'x', 'r', 'e', 'f' };                                                                                                             
                             46:    private static final char[] STARTXREF = { 's', 't', 'a', 'r', 't', 'x', 'r', 'e', 'f' };                                                                                     
                             47:                                                                                                                                                                                 
                             48:    /**                                                                                                                                                                          
                             49:     * Collects all Xref/trailer objects and resolves them into single                                                                                                           
                             50:     * object using startxref reference.                                                                                                                                         
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java:623-635                                                                                                            
                             ```                                                                                                                                                                                 
                             623:            int count = 0;                                                                                                                                                      
                             624:            try                                                                                                                                                                 
                             625:            {                                                                                                                                                                   
                             626:                count = Integer.parseInt(splitString[1]);                                                                                                                       
                             627:            }                                                                                                                                                                   
                             628:            catch (NumberFormatException exception)                                                                                                                             
                             629:            {                                                                                                                                                                   
                             630:                LOG.warn("XRefTable: invalid number of objects: {}", currentLine);                                                                                              
                             631:                return false;                                                                                                                                                   
                             632:            }                                                                                                                                                                   
                             633:                                                                                                                                                                                
                             634:            parser.skipSpaces();                                                                                                                                                
                             635:            for(int i = 0; i < count; i++)                                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Overview of Required Changes                                                                                                                                                     
                                - Define `MAX_XREF_ENTRIES` in XrefParser to resolve the compilation error.                                                                                                      
                                - Enforce the newly added parser bounds in the code paths that were originally hanging:                                                                                          
                                  a. Add a limit counter in `BaseParser.skipSpaces()` guarding against extremely long runs of whitespace.                                                                        
                                  b. Bound the `readLine()` method in `BaseParser` by applying `MAX_LINE_CHARS`.                                                                                                 
                                - Retain the existing patchs `readString(MAX_TOKEN_LENGTH)` usage.                                                                                                              
                                - All changes apply strictly to the source parser classes; tests, harnesses, and external dependencies remain untouched.                                                         
                                                                                                                                                                                                                 
                             2. Details & Steps                                                                                                                                                                  
                                                                                                                                                                                                                 
                                A. XrefParser: Declare `MAX_XREF_ENTRIES`                                                                                                                                        
                                   - In `XrefParser.java`, among the existing static constants at the top of the class (around lines 4450), insert:                                                             
                                       private static final int MAX_XREF_ENTRIES = 10000;                                                                                                                        
                                   - This mirrors the 10 000 default used for other parser limits in `BaseParser`.                                                                                               
                                                                                                                                                                                                                 
                                B. XrefParser: Use the new constant in bounds check                                                                                                                              
                                   - In the method parsing the XRef entry count (around lines 623633), immediately after parsing `count`:                                                                       
                                       int count = Integer.parseInt(splitString[1]);                                                                                                                             
                                       if (count < 0 || count > MAX_XREF_ENTRIES) {                                                                                                                              
                                           throw new IOException("XRef section count out of bounds: " + count                                                                                                    
                                                   + " at offset " + parser.source.getPosition());                                                                                                               
                                       }                                                                                                                                                                         
                                   - Leave the subsequent `parser.skipSpaces();` and entry loop unchanged beyond this check.                                                                                     
                                                                                                                                                                                                                 
                                C. BaseParser: Enforce MAX_SKIP_CHARS in skipSpaces()                                                                                                                            
                                   - Locate the `skipSpaces()` implementation (around line 1320). It currently loops reading all whitespace without bounds.                                                      
                                   - Augment it with a counter, e.g.:                                                                                                                                            
                                       protected void skipSpaces() throws IOException {                                                                                                                          
                                           int skipped = 0;                                                                                                                                                      
                                           int c = source.peek();                                                                                                                                                
                                           while (isWhitespace(c)) {                                                                                                                                             
                                               source.read();                                                                                                                                                    
                                               skipped++;                                                                                                                                                        
                                               if (skipped > MAX_SKIP_CHARS) {                                                                                                                                   
                                                   throw new IOException("Exceeded skipSpaces limit of "                                                                                                         
                                                           + MAX_SKIP_CHARS + " at offset " + source.getPosition());                                                                                             
                                               }                                                                                                                                                                 
                                               c = source.peek();                                                                                                                                                
                                           }                                                                                                                                                                     
                                       }                                                                                                                                                                         
                                   - This ensures unbounded whitespace runs (from malicious or pathological inputs) trigger an exception rather than a hang.                                                     
                                                                                                                                                                                                                 
                                D. BaseParser: Enforce MAX_LINE_CHARS in readLine()                                                                                                                              
                                   - Locate `protected String readLine()` (used in XRefParsers entry loop).                                                                                                     
                                   - Introduce a similar counter to guard line length:                                                                                                                           
                                       StringBuilder buffer = new StringBuilder();                                                                                                                               
                                       int c = source.read();                                                                                                                                                    
                                       int length = 0;                                                                                                                                                           
                                       while (c != -1 && c != '\r' && c != '\n') {                                                                                                                               
                                           buffer.append((char)c);                                                                                                                                               
                                           length++;                                                                                                                                                             
                                           if (length > MAX_LINE_CHARS) {                                                                                                                                        
                                               throw new IOException("Exceeded readLine limit of "                                                                                                               
                                                       + MAX_LINE_CHARS + " at offset " + source.getPosition());                                                                                                 
                                           }                                                                                                                                                                     
                                           c = source.read();                                                                                                                                                    
                                       }                                                                                                                                                                         
                                   - After the loop, handle CR/LF rewind as existing code does.                                                                                                                  
                                                                                                                                                                                                                 
                                E. Retain and Reapply readString(MAX_TOKEN_LENGTH)                                                                                                                               
                                   - Confirm that the `readString(int length)` overload exists (it does, around line 1117).                                                                                      
                                   - Ensure all previous modifications calling `readString()` in unbounded contexts are updated to pass `MAX_TOKEN_LENGTH`.                                                      
                                                                                                                                                                                                                 
                             3. Justification                                                                                                                                                                    
                                - Defining `MAX_XREF_ENTRIES` resolves the compilation error without altering external or test code.                                                                             
                                - Adding counters to `skipSpaces()` and `readLine()` directly addresses the initial hang observed in deep whitespace or unbounded-line scenarios.                                
                                - The use of 10 000 as a cap aligns with the existing `MAX_SKIP_CHARS`, `MAX_LINE_CHARS`, and `MAX_TOKEN_LENGTH` defaults, ensuring consistency.                                 
                                - All existing parsing logic remains intact; only guard rails have been placed to abort pathological loops.                                                                      
                                - No fuzzing harness, tests, or external libraries are modified, preserving existing behavior and test coverage.                                                                 
                                                                                                                                                                                                                 
                             4. Side Effects & Mitigations                                                                                                                                                       
                                - Legitimate PDFs with extremely long lines or whitespace runs beyond 10 000 characters will now trigger an `IOException`. Such documents are highly unusual and                 
                             would previously have caused timeouts or hangs; users can increase the caps if needed via patch extension.                                                                          
                                - Document this new behavior in the parsers javadoc or release notes so integrators are aware of the limits and can adjust appropriately.                                       
                                - Similar bounds guards are not placed in every loop (e.g., number parsing) to avoid over-specialization; only the hotspots that triggered the hang and fuzz                     
                             reports are protected.                                                                                                                                                              
                                                                                                                                                                                                                 
                             5. No Further File Retrieval Needed                                                                                                                                                 
                                - All edits lie within `XrefParser.java` and `BaseParser.java`. The precise line numbers and contexts have been identified in the above steps. Continuous                        
                             integration should now pass compilation and prevent the original fuzzing timeout.                                                                                                   
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 21:21:00] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                                                      __init__.py:160
                             (n evals: 6, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
                    INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpxvbdk0fe                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_8/agent-output-1761513660.368552                                                                         
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_8.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
