[2;36m[12/28/25 12:49:10][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=797053;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=933909;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpt886nb1p[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/freerdp_fp-delta-03_vuln_003/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766926150.9698806[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-03_vuln_003.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=734266;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=664117;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/28/25 12:49:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=410274;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=191072;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m32.13[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=362363;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807219;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=922151;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=492494;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=914203;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=32422;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m32[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=982550;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=960846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:49:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=883470;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=245635;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=131470;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=145067;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=415058;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=529424;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=255198;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=421382;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m[12/28/25 12:49:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=639869;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=316464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:49:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.14[0m seconds;               ]8;id=326007;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=757056;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=195097;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=920756;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:49:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.89[0m seconds;               ]8;id=525535;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=320811;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 12:49:49][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=266676;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=284204;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCodecs[0m                                                             [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCodecs -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                     [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m              [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2413512931[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m20557[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea93be8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55799ea98c35[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m20557[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea98c38[0m[39m,[0m[1;36m0x55799eae9108[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                             [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1326[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1536[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m64[0m[39m + runLengthFactor [0m[1;36m193[0m[39m > pixelCount [0m [2m                [0m
[2;36m                    [0m         [1;36m105[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;36m0x7fa7a34f0e20[0m[39m [0m[1;39m([0m[39mpc [0m          [2m                [0m
[2;36m                    [0m         [1;36m0x55799e676fc5[0m[39m bp [0m[1;36m0x7ffc8feb9550[0m[39m sp [0m[1;36m0x7ffc8feb9320[0m[39m T0[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a WRITE memory access.[0m                                [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m30[0m[39m [0m[1;39m([0m[39mwild-addr-write[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message_metadata [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m                                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m1320:10[0m                                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55799e64473d[0m[39m in TestFreeRDPCodecRemoteFX [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m184:7[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55799e64473d[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m460:2[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55799e4fb0f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55799e4e6365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55799e4ebdff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55799e5170a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fa7a346c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55799e4de54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCodecs+0x12a54d[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata--rfx_process_message--TestFreeRDPCodecRemoteFX[0m         [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m[39m in [0m      [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata[0m                                                        [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp7bo4v0zn[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCodecs -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCodecs[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCodecs -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                     [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m             [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2413512931[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m20557[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea93be8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55799ea98c35[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m20557[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea98c38[0m[39m,[0m[1;36m0x55799eae9108[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                             [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1326[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1536[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m64[0m[39m + runLengthFactor [0m[1;36m193[0m[39m [0m[1m>[0m pixelCount  [2m                [0m
[2;36m                    [0m         [1;36m105[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1m[[0m[1;92m12:49:49:834[0m[1m][0m [1m[[0m[1;92m18:0000[0m0012[1m][0m [1m[[0mERROR[1m][0m[1m[[0mcom.freerdp.codec.clear[1m][0m - [1m[[0mclear_decompress[1m][0m: [2m                [0m
[2;36m                    [0m         clear_decompress_residual_data failed!                                              [2m                [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                       [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1;36m0x7fa7a34f0e20[0m [1m([0mpc           [2m                [0m
[2;36m                    [0m         [1;36m0x55799e676fc5[0m bp [1;36m0x7ffc8feb9550[0m sp [1;36m0x7ffc8feb9320[0m T0[1m)[0m                              [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a WRITE memory access.                                [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m30[0m [1m([0mwild-addr-write[1m)[0m                                                     [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55799e676fc5[0m in rfx_process_message_metadata                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m:[1;92m734:26[0m                                          [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55799e676fc5[0m in rfx_process_message                                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m:[1;92m1320:10[0m                                         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55799e64473d[0m in TestFreeRDPCodecRemoteFX                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m:[1;92m184:7[0m                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55799e64473d[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m:[1;92m460:2[0m                           [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55799e4fb0f0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55799e4e6365[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55799e4ebdff[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55799e5170a2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x7fa7a346c082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55799e4de54d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCodecs+0x12a54d[0m[1m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN:                                                                        [2m                [0m
[2;36m                    [0m         rfx_process_message_metadata--rfx_process_message--TestFreeRDPCodecRemoteFX         [2m                [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                   [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m:[1;92m734:26[0m in       [2m                [0m
[2;36m                    [0m         rfx_process_message_metadata                                                        [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp7bo4v0zn[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         TestFuzzCodecs -[33mruns[0m=[1;36m100[0m.                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/28/25 12:49:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=923834;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=518684;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 12:51:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=490788;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=561426;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/28/25 12:53:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=830212;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=161701;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=975778;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=543345;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:53:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.07[0m seconds;               ]8;id=882685;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=994413;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=953603;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=493696;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpz1m1_jzd[0m                                                 ]8;id=693529;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=470346;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/28/25 12:53:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m23.98[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=966040;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=25301;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=857769;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=770431;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:54:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m12.77[0m seconds;             ]8;id=732525;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=540120;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=493155;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=802400;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:54:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m5.29[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=253034;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=600398;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=527960;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=410455;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=773744;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=430880;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=24900;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=297442;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.95[0m seconds;               ]8;id=238244;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=330547;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 12:54:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=931343;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=158047;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:54:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.02[0m seconds;               ]8;id=301703;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=86611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=910420;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=751033;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/28/25 12:54:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.94[0m seconds;               ]8;id=810827;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=23308;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/28/25 12:54:17][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=20672;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=645215;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/codec/rfx.c                                                        [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/codec/rfx.c                                                        [2m                [0m
[2;36m                    [0m         @@ [1;36m-139[0m,[1;36m7[0m +[1;36m139[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                 PROFILER_PRINT_FOOTER                                                       [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -UINT64 metadataBlock = [1m([0mUINT64[1m)[0m&explicit_bzero;                                    [2m                [0m
[2;36m                    [0m         +[35m/[0m* Removed global metadataBlock; metadata handling is now skipped entirely *[35m/[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static INLINE void [1;35mrfx_tile_init[0m[1m([0mvoid* obj[1m)[0m                                        [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-176[0m,[1;36m7[0m +[1;36m176[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                 return tile;                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -UINT64 metadataData = [1;36m0[0m;                                                           [2m                [0m
[2;36m                    [0m         +[35m/[0m* Removed global metadataData; metadata handling is now skipped entirely *[35m/[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static INLINE void [1;35mrfx_decoder_tile_free[0m[1m([0mvoid* obj[1m)[0m                                [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-671[0m,[1;36m13[0m +[1;36m671[0m,[1;36m10[0m @@                                                               [2m                [0m
[2;36m                    [0m                 [1;35mStream_Read_UINT32[0m[1m([0m                                                         [2m                [0m
[2;36m                    [0m                     s, frameIdx[1m)[0m; [35m/[0m* frameIdx [1m([0m[1;36m4[0m bytes[1m)[0m, if codec is in video mode, must be [2m                [0m
[2;36m                    [0m         ignored *[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m                 [1;35mStream_Read_UINT16[0m[1m([0ms, numRegions[1m)[0m; [35m/[0m* numRegions [1m([0m[1;36m2[0m bytes[1m)[0m *[35m/[0m               [2m                [0m
[2;36m                    [0m         -       if [1m([0m[1;35mStream_GetRemainingLength[0m[1m([0ms[1m)[0m >= [1;36m8[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m         -       [1m{[0m                                                                           [2m                [0m
[2;36m                    [0m         -               UINT64 blockOffset = [1;36m0[0m;                                             [2m                [0m
[2;36m                    [0m         -               [1;35mStream_Read_UINT64[0m[1m([0ms, blockOffset[1m)[0m;                                 [2m                [0m
[2;36m                    [0m         -               [1;35mStream_Read_UINT64[0m[1m([0ms, metadataData[1m)[0m;                                [2m                [0m
[2;36m                    [0m         -               metadataBlock += blockOffset;                                       [2m                [0m
[2;36m                    [0m         -       [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m         +       [35m/[0m* Skip legacy metadata blockOffset and metadataData fields *[35m/[0m              [2m                [0m
[2;36m                    [0m         +       if [1m([0m![1;35mStream_CheckAndLogRequiredLengthWLog[0m[1m([0mcontext->priv->log, s, [1;36m16[0m[1m)[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         +           return FALSE;                                                           [2m                [0m
[2;36m                    [0m         +       [1;35mStream_SafeSeek[0m[1m([0ms, [1;36m16[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m                 [1;35mWLog_Print[0m[1m([0mcontext->priv->log, WLOG_DEBUG,                                  [2m                [0m
[2;36m                    [0m                            [32m"RFX_FRAME_BEGIN: frameIdx: %"[0m PRIu32 [32m" numRegions: %"[0m PRIu16    [2m                [0m
[2;36m                    [0m         [32m""[0m, frameIdx,                                                                       [2m                [0m
[2;36m                    [0m                            numRegions[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-725[0m,[1;36m13[0m +[1;36m722[0m,[1;36m11[0m @@                                                               [2m                [0m
[2;36m                    [0m                         return FALSE;                                                       [2m                [0m
[2;36m                    [0m                 [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       [1;35mStream_Read_UINT32[0m[1m([0ms, magic[1m)[0m; [35m/[0m* magic [1m([0m[1;36m4[0m bytes[1m)[0m, [1;36m0xCACCACCA[0m *[35m/[0m             [2m                [0m
[2;36m                    [0m         -       if [1m([0mmagic != WF_MAGIC[1m)[0m                                                      [2m                [0m
[2;36m                    [0m         -       [1m{[0m                                                                           [2m                [0m
[2;36m                    [0m         -               [1;35mWLog_Print[0m[1m([0mcontext->priv->log, WLOG_ERROR, [32m"invalid magic number [0m   [2m                [0m
[2;36m                    [0m         [32m0x%08"[0m PRIX32 [32m""[0m, magic[1m)[0m;                                                           [2m                [0m
[2;36m                    [0m         -               return FALSE;                                                       [2m                [0m
[2;36m                    [0m         -       [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m         -       *[1m([0mUINT64*[1m)[0mmetadataBlock = metadataData;                                     [2m                [0m
[2;36m                    [0m         +       [35m/[0m* Skip metadata block entirely without memory writes *[35m/[0m                    [2m                [0m
[2;36m                    [0m         +       if [1m([0m![1;35mStream_CheckAndLogRequiredLengthWLog[0m[1m([0mcontext->priv->log, s, [1;36m12[0m[1m)[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         +           return FALSE;                                                           [2m                [0m
[2;36m                    [0m         +       [35m/[0m* [1;36m4[0m bytes magic + [1;36m8[0m bytes metadataData *[35m/[0m                                  [2m                [0m
[2;36m                    [0m         +       [1;35mStream_SafeSeek[0m[1m([0ms, [1;36m12[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m                 return TRUE;                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCodecs[0m                                                             [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCodecs -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                     [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m              [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2413512931[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m20557[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea93be8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55799ea98c35[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m20557[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea98c38[0m[39m,[0m[1;36m0x55799eae9108[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                             [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1326[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1536[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m64[0m[39m + runLengthFactor [0m[1;36m193[0m[39m > pixelCount [0m [2m                [0m
[2;36m                    [0m         [1;36m105[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;36m0x7fa7a34f0e20[0m[39m [0m[1;39m([0m[39mpc [0m          [2m                [0m
[2;36m                    [0m         [1;36m0x55799e676fc5[0m[39m bp [0m[1;36m0x7ffc8feb9550[0m[39m sp [0m[1;36m0x7ffc8feb9320[0m[39m T0[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a WRITE memory access.[0m                                [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m30[0m[39m [0m[1;39m([0m[39mwild-addr-write[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message_metadata [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m                                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m1320:10[0m                                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55799e64473d[0m[39m in TestFreeRDPCodecRemoteFX [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m184:7[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55799e64473d[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m460:2[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55799e4fb0f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55799e4e6365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55799e4ebdff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55799e5170a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fa7a346c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55799e4de54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCodecs+0x12a54d[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata--rfx_process_message--TestFreeRDPCodecRemoteFX[0m         [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m[39m in [0m      [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata[0m                                                        [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp7bo4v0zn[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCodecs -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDuring an automated fuzzing session of the FreeRDP codec component, the [0m            [2m                [0m
[2;36m                    [0m         [39mTestFuzzCodecs harness triggered a fatal crash in the RemoteFX codec [0m               [2m                [0m
[2;36m                    [0m         [39mimplementation. AddressSanitizer reports a segmentation fault due to a wild, [0m       [2m                [0m
[2;36m                    [0m         [39mout-of-bounds write in the function `rfx_process_message_metadata` [0m[1;39m([0m[39mrfx.[0m[1;92mc:734[0m[1;39m)[0m[39m. The[0m [2m                [0m
[2;36m                    [0m         [39merror surfaces after several “clear_decompress_residual_data” failures in the Clear[0m [2m                [0m
[2;36m                    [0m         [39mcodec and indicates memory corruption in the handling of RemoteFX message metadata.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue Manifestation  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m  • The fuzzer invoked `TestFuzzCodecs` with a specially crafted input [0m             [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[35m/[0m[95mtestcase[0m[39m`[0m[1;39m)[0m[39m.  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m  • Several error logs appear from the Clear codec [0m[1;39m([0m[39m`com.freerdp.codec.clear`[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mindicating mismatches between `pixelIndex`, `runLengthFactor`, and `pixelCount`.  [0m  [2m                [0m
[2;36m                    [0m         [39m  • Immediately afterward, AddressSanitizer flags a SEGV [0m[1;39m([0m[39mwrite to address [0m         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x7fa7a34f0e20[0m[39m`[0m[1;39m)[0m[39m in `rfx_process_message_metadata`.  [0m                              [2m                [0m
[2;36m                    [0m         [39m  • The call stack is:  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. `rfx_process_message_metadata` [0m[1;39m([0m[39mrfx.[0m[1;92mc:734[0m[1;39m)[0m[39m  [0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. `rfx_process_message` [0m[1;39m([0m[39mrfx.[0m[1;92mc:1320[0m[1;39m)[0m[39m  [0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. `TestFreeRDPCodecRemoteFX` in the fuzz harness [0m[1;39m([0m[39mTestFuzzCodecs.[0m[1;92mc:184[0m[1;39m)[0m[39m  [0m      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. `LLVMFuzzerTestOneInput` → Fuzzer driver loop → `main`  [0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability Type  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  The sanitizer classifies this as a “wild-addr-write,” indicating an out-of-bounds[0m [2m                [0m
[2;36m                    [0m         [39mor otherwise invalid memory write. This falls under memory-corruption [0m              [2m                [0m
[2;36m                    [0m         [39mvulnerabilities.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Key Observations  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m  • The crash occurs in the RemoteFX codec path, not in the initial Clear codec [0m    [2m                [0m
[2;36m                    [0m         [39mpath.  [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m  • Prior to the crash, the Clear codec reports multiple residual data errors, [0m     [2m                [0m
[2;36m                    [0m         [39msuggesting malformed or unexpected input data.  [0m                                    [2m                [0m
[2;36m                    [0m         [39m  • The fuzz harness [0m[1;39m([0m[39m`TestFuzzCodecs`[0m[1;39m)[0m[39m drives both codec implementations via [0m      [2m                [0m
[2;36m                    [0m         [39mshared entry points [0m[1;39m([0m[39m`TestFreeRDPCodecRemoteFX`[0m[1;39m)[0m[39m.  [0m                                 [2m                [0m
[2;36m                    [0m         [39m  • AddressSanitizer cannot provide additional heap or stack frame details beyond [0m  [2m                [0m
[2;36m                    [0m         [39mthe failing instruction.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Areas for Investigation  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. **rfx.c around line [0m[1;36m734[0m[39m** – Examine bounds checks and pointer arithmetic in [0m   [2m                [0m
[2;36m                    [0m         [39m`rfx_process_message_metadata`.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. **rfx.c around line [0m[1;36m1320[0m[39m** – Follow how metadata parsing transitions to outer [0m [2m                [0m
[2;36m                    [0m         [39mmessage processing in `rfx_process_message`.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. **TestFuzzCodecs.c** – Review the RemoteFX test harness to understand how [0m     [2m                [0m
[2;36m                    [0m         [39minputs are fed into `rfx_process_message`.  [0m                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. **Clear codec residual handling** – Although the crash is in RemoteFX, the [0m    [2m                [0m
[2;36m                    [0m         [39mpreceding Clear codec errors may hint at shared buffer or state corruption. Files [0m  [2m                [0m
[2;36m                    [0m         [39munder `libfreerdp/codec/clear` and `libfreerdp/codec/rfx` are relevant.  [0m           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. **Input size and format validation** – Assess existing length checks and [0m      [2m                [0m
[2;36m                    [0m         [39merror-handling paths in metadata and message parsing routines.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo fixes or root-cause speculation are provided here; this report is intended to [0m   [2m                [0m
[2;36m                    [0m         [39mguide further code review and forensic analysis of the RemoteFX metadata processing[0m [2m                [0m
[2;36m                    [0m         [39mlogic.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCodecs[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCodecs -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                     [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m             [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2413512931[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m20557[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea93be8[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55799ea98c35[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m20557[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m20557[0m[39m [0m[1;39m[[0m[1;36m0x55799ea98c38[0m[39m,[0m[1;36m0x55799eae9108[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCodecs[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                             [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1326[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:831[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m257[0m[39m != pixelCount [0m[1;36m1536[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:832[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mclear_decompress_residual_data[0m[1;39m][0m[39m: pixelIndex [0m[1;36m64[0m[39m + runLengthFactor [0m[1;36m193[0m[39m > pixelCount [0m [2m                [0m
[2;36m                    [0m         [1;36m105[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;92m12:49:49:834[0m[1;39m][0m[39m [0m[1;39m[[0m[1;92m18:0000[0m[39m0012[0m[1;39m][0m[39m [0m[1;39m[[0m[39mERROR[0m[1;39m][0m[1;39m[[0m[39mcom.freerdp.codec.clear[0m[1;39m][0m[39m - [0m[1;39m[[0m[39mclear_decompress[0m[1;39m][0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39mclear_decompress_residual_data failed![0m                                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;36m0x7fa7a34f0e20[0m[39m [0m[1;39m([0m[39mpc [0m          [2m                [0m
[2;36m                    [0m         [1;36m0x55799e676fc5[0m[39m bp [0m[1;36m0x7ffc8feb9550[0m[39m sp [0m[1;36m0x7ffc8feb9320[0m[39m T0[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a WRITE memory access.[0m                                [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m30[0m[39m [0m[1;39m([0m[39mwild-addr-write[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message_metadata [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m                                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55799e676fc5[0m[39m in rfx_process_message [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m1320:10[0m                                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55799e64473d[0m[39m in TestFreeRDPCodecRemoteFX [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m184:7[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55799e64473d[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/codec/test/[0m[95mTestFuzzCodecs.c[0m[39m:[0m[1;92m460:2[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55799e4fb0f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55799e4e6365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55799e4ebdff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55799e5170a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fa7a346c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55799e4de54d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCodecs+0x12a54d[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata--rfx_process_message--TestFreeRDPCodecRemoteFX[0m         [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/FreeRDP/libfreerdp/codec/[0m[95mrfx.c[0m[39m:[0m[1;92m734:26[0m[39m in [0m      [2m                [0m
[2;36m                    [0m         [39mrfx_process_message_metadata[0m                                                        [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp7bo4v0zn[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCodecs -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:130[0m[39m-[0m[1;36m200[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_ycbcr_to_rgb[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_encode_rgb[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_encode_component[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_rlgr_encode[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_differential_encode[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_quantization_encode[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_dwt_2d_encode[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_rgb_to_ycbcr[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;35mPROFILER_PRINT[0m[1;39m([0m[39mcontext->priv->prof_rfx_encode_format_rgb[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mPROFILER_PRINT_FOOTER[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:UINT64 metadataBlock = [0m[1;39m([0m[39mUINT64[0m[1;39m)[0m[39m&explicit_bzero;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:static INLINE void [0m[1;35mrfx_tile_init[0m[1;39m([0m[39mvoid* obj[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mRFX_TILE* tile = [0m[1;39m([0m[39mRFX_TILE*[0m[1;39m)[0m[39mobj;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mif [0m[1;39m([0m[39mtile[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39m        [0m[39mtile->x = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39mtile->y = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39m        [0m[39mtile->YLen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mtile->YData = NULL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39m        [0m[39mtile->CbLen = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39m        [0m[39mtile->CbData = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39m        [0m[39mtile->CrLen = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39m        [0m[39mtile->CrData = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:static INLINE void* [0m[1;35mrfx_decoder_tile_new[0m[1;39m([0m[39mconst void* val[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39mconst size_t size = 4ULL * 64ULL * 64ULL;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39mRFX_TILE* tile = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[1;35mWINPR_UNUSED[0m[1;39m([0m[39mval[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mtile = [0m[1;39m([0m[39mRFX_TILE*[0m[1;39m)[0m[1;35mwinpr_aligned_calloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mRFX_TILE[0m[1;39m)[0m[39m, [0m[1;36m32[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mtile->data = [0m[1;39m([0m[39mBYTE*[0m[1;39m)[0m[1;35mwinpr_aligned_malloc[0m[1;39m([0m[39msize, [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39m        [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[39mtile[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mtile->data, [0m[1;36m0xff[0m[39m, size[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mtile->allocated = TRUE;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mreturn tile;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:UINT64 metadataData = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:static INLINE void [0m[1;35mrfx_decoder_tile_free[0m[1;39m([0m[39mvoid* obj[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39mRFX_TILE* tile = [0m[1;39m([0m[39mRFX_TILE*[0m[1;39m)[0m[39mobj;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39mif [0m[1;39m([0m[39mtile[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mtile->allocated[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[39mtile->data[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m        [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[39mtile[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:static INLINE void* [0m[1;35mrfx_encoder_tile_new[0m[1;39m([0m[39mconst void* val[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[1;35mWINPR_UNUSED[0m[1;39m([0m[39mval[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[39mreturn [0m[1;35mwinpr_aligned_calloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mRFX_TILE[0m[1;39m)[0m[39m, [0m[1;36m32[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:static INLINE void [0m[1;35mrfx_encoder_tile_free[0m[1;39m([0m[39mvoid* obj[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:650[0m[39m-[0m[1;36m720[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:                                                   UINT16* WINPR_RESTRICT [0m      [2m                [0m
[2;36m                    [0m         [39mpExpectedBlockType[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    [0m[39mUINT32 frameIdx = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:    [0m[39mUINT16 numRegions = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_FRAME_BEGIN[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected [0m     [2m                [0m
[2;36m                    [0m         [32mwants WBT_FRAME_BEGIN"[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    [0m[39m*pExpectedBlockType = WBT_REGION;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthWLog[0m[1;39m([0m[39mcontext->priv->log, s, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[1;35mStream_Read_UINT32[0m[1;39m([0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[39m    s, frameIdx[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* frameIdx [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m, if codec is in video mode, must be[0m [2m                [0m
[2;36m                    [0m         [39mignored *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, numRegions[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* numRegions [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m >= [0m[1;36m8[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    [0m[39m        UINT64 blockOffset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT64[0m[1;39m([0m[39ms, blockOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT64[0m[1;39m([0m[39ms, metadataData[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:    [0m[39m        metadataBlock += blockOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:    [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_DEBUG,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[39m           [0m[32m"RFX_FRAME_BEGIN: frameIdx: %"[0m[39m PRIu32 [0m[32m" numRegions: %"[0m[39m PRIu16 [0m   [2m                [0m
[2;36m                    [0m         [32m""[0m[39m, frameIdx,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:    [0m[39m           numRegions[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:static INLINE BOOL [0m[1;35mrfx_process_message_frame_end[0m[1;39m([0m[39mRFX_CONTEXT* WINPR_RESTRICT [0m   [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:                                                 RFX_MESSAGE* WINPR_RESTRICT [0m   [2m                [0m
[2;36m                    [0m         [39mmessage,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:                                                 wStream* WINPR_RESTRICT s,[0m     [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:                                                 UINT16* WINPR_RESTRICT [0m        [2m                [0m
[2;36m                    [0m         [39mpExpectedBlockType[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_FRAME_END[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected, [0m    [2m                [0m
[2;36m                    [0m         [32mwants WBT_FRAME_END"[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:    [0m[39m*pExpectedBlockType = WBT_FRAME_BEGIN;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_DEBUG, [0m[32m"RFX_FRAME_END"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:static INLINE BOOL [0m[1;35mrfx_process_message_metadata[0m[1;39m([0m[39mRFX_CONTEXT* WINPR_RESTRICT [0m    [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mRFX_MESSAGE* WINPR_RESTRICT message,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mwStream* WINPR_RESTRICT s,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mUINT16* WINPR_RESTRICT pExpectedBlockType[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:    [0m[39mUINT32 magic = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:709[0m[39m-[0m[1;36m736[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:static INLINE BOOL [0m[1;35mrfx_process_message_metadata[0m[1;39m([0m[39mRFX_CONTEXT* WINPR_RESTRICT [0m    [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mRFX_MESSAGE* WINPR_RESTRICT message,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mwStream* WINPR_RESTRICT s,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mUINT16* WINPR_RESTRICT pExpectedBlockType[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:    [0m[39mUINT32 magic = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_FRAME_END[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected [0m     [2m                [0m
[2;36m                    [0m         [32mwants WBT_FRAME_END [0m[32m([0m[32m0x%x[0m[32m)[0m[32m"[0m[39m, *pExpectedBlockType[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:    [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, magic[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* magic [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m, [0m[1;36m0xCACCACCA[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmagic != WF_MAGIC[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"invalid magic number [0m   [2m                [0m
[2;36m                    [0m         [32m0x%08"[0m[39m PRIX32 [0m[32m""[0m[39m, magic[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:    [0m[39m*[0m[1;39m([0m[39mUINT64*[0m[1;39m)[0m[39mmetadataBlock = metadataData;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx_constants.h:[0m[1;36m1[0m[39m-[0m[1;36m82[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * FreeRDP: A Remote Desktop Protocol Implementation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * RemoteFX Codec Library - API Header[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * Copyright [0m[1;36m2011[0m[39m Vic Lee[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * Licensed under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * you may not use this file except in compliance with the License.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * You may obtain a copy of the License at[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#ifndef FREERDP_LIB_CODEC_RFX_CONSTANTS_H[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#define FREERDP_LIB_CODEC_RFX_CONSTANTS_H[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include <freerdp/api.h>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m* sync *[0m[35m/[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#define WF_MAGIC [0m[1;36m0xCACCACCA[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define WF_VERSION_1_0 [0m[1;36m0x0100[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m* blockType *[0m[35m/[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#define WBT_SYNC [0m[1;36m0xCCC0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define WBT_CODEC_VERSIONS [0m[1;36m0xCCC1[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#define WBT_CHANNELS [0m[1;36m0xCCC2[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define WBT_CONTEXT [0m[1;36m0xCCC3[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#define WBT_FRAME_BEGIN [0m[1;36m0xCCC4[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#define WBT_FRAME_END [0m[1;36m0xCCC5[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#define WBT_REGION [0m[1;36m0xCCC6[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#define WBT_EXTENSION [0m[1;36m0xCCC7[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define WBT_METADATA [0m[1;36m0xCCC8[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#define CBT_REGION [0m[1;36m0xCAC1[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#define CBT_TILESET [0m[1;36m0xCAC2[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#define CBT_TILE [0m[1;36m0xCAC3[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#define PROGRESSIVE_WBT_SYNC [0m[1;36m0xCCC0[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#define PROGRESSIVE_WBT_FRAME_BEGIN [0m[1;36m0xCCC1[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#define PROGRESSIVE_WBT_FRAME_END [0m[1;36m0xCCC2[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:#define PROGRESSIVE_WBT_CONTEXT [0m[1;36m0xCCC3[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#define PROGRESSIVE_WBT_REGION [0m[1;36m0xCCC4[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#define PROGRESSIVE_WBT_TILE_SIMPLE [0m[1;36m0xCCC5[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define PROGRESSIVE_WBT_TILE_FIRST [0m[1;36m0xCCC6[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#define PROGRESSIVE_WBT_TILE_UPGRADE [0m[1;36m0xCCC7[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m[35m/[0m[39m* tileSize *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define CT_TILE_64x64 [0m[1;36m0x0040[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m* properties.flags *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#define CODEC_MODE [0m[1;36m0x02[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[35m/[0m[39m* properties.cct *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#define COL_CONV_ICT [0m[1;36m0x1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m[35m/[0m[39m* properties.xft *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#define CLW_XFORM_DWT_53_A [0m[1;36m0x1[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* properties.et *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#define CLW_ENTROPY_RLGR1 [0m[1;36m0x01[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#define CLW_ENTROPY_RLGR3 [0m[1;36m0x04[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m[35m/[0m[39m* properties.qt *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#define SCALAR_QUANTIZATION [0m[1;36m0x1[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#ifdef __cplusplus[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m72:e[0m[39mxtern [0m[32m"C"[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mFREERDP_LOCAL const char* [0m[1;35mrfx_get_progressive_block_type_string[0m[1;39m([0m[39mUINT16 [0m     [2m                [0m
[2;36m                    [0m         [39mblockType[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:#ifdef __cplusplus[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:#endif [0m[35m/[0m[39m* FREERDP_LIB_CODEC_RFX_CONSTANTS_H *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx_types.h:[0m[1;36m98[0m[39m-[0m[1;36m127[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:struct S_RFX_MESSAGE[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mUINT32 frameIdx;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39m * The rects array represents the updated region of the frame. The UI[0m       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39m * requires to clip drawing destination base on the union of the rects.[0m     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39mUINT16 numRects;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39mRFX_RECT* rects;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m * The tiles array represents the actual frame data. Each tile is always[0m    [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m * 64x64. Note that only pixels inside the updated region [0m[1;39m([0m[39mrepresented as[0m   [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m * rects described above[0m[1;39m)[0m[39m are valid. Pixels outside of the region may[0m       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39m * contain arbitrary data.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39mUINT16 numTiles;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39msize_t allocatedTiles;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39mRFX_TILE** tiles;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mUINT16 numQuant;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32* quantVals;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mUINT32 tilesDataSize;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mBOOL freeArray;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:875[0m[39m-[0m[1;36m1171[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:static INLINE BOOL [0m[1;35mrfx_process_message_tileset[0m[1;39m([0m[39mRFX_CONTEXT* WINPR_RESTRICT [0m     [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:                                               RFX_MESSAGE* WINPR_RESTRICT [0m     [2m                [0m
[2;36m                    [0m         [39mmessage,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:                                               wStream* WINPR_RESTRICT s,[0m       [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:                                               UINT16* WINPR_RESTRICT [0m          [2m                [0m
[2;36m                    [0m         [39mpExpectedBlockType[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[39mBOOL rc = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[39msize_t close_cnt = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:    [0m[39mBYTE quant = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    [0m[39mRFX_TILE* tile = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    [0m[39mUINT32* quants = NULL;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[39mUINT16 subtype = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    [0m[39mUINT16 numTiles = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:    [0m[39mUINT32 blockLen = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[39mUINT32 blockType = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    [0m[39mUINT32 tilesDataSize = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[39mPTP_WORK* work_objects = NULL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    [0m[39mRFX_TILE_PROCESS_WORK_PARAM* params = NULL;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:    [0m[39mvoid* pmem = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_EXTENSION[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected [0m     [2m                [0m
[2;36m                    [0m         [32mwants a tileset"[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:    [0m[39m*pExpectedBlockType = WBT_FRAME_END;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthWLog[0m[1;39m([0m[39mcontext->priv->log, s, [0m[1;36m14[0m[1;39m)[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, subtype[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* subtype [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m must be set to [0m        [2m                [0m
[2;36m                    [0m         [39mCBT_TILESET [0m[1;39m([0m[1;36m0xCAC2[0m[1;39m)[0m[39m *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:    [0m[39mif [0m[1;39m([0m[39msubtype != CBT_TILESET[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"invalid subtype, [0m       [2m                [0m
[2;36m                    [0m         [32mexpected CBT_TILESET."[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:    [0m[1;35mStream_Seek_UINT16[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;                   [0m[35m/[0m[39m* idx [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m, must be set to [0m  [2m                [0m
[2;36m                    [0m         [1;36m0x0000[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    [0m[1;35mStream_Seek_UINT16[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;                   [0m[35m/[0m[39m* properties [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, context->numQuant[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* numQuant [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    [0m[1;35mStream_Seek_UINT8[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;                    [0m[35m/[0m[39m* tileSize [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, must be set [0m [2m                [0m
[2;36m                    [0m         [39mto [0m[1;36m0x40[0m[39m *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39mif [0m[1;39m([0m[39mcontext->numQuant < [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"no quantization [0m        [2m                [0m
[2;36m                    [0m         [32mvalue."[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, numTiles[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* numTiles [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[39mif [0m[1;39m([0m[39mnumTiles < [0m[1;36m1[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Windows Server [0m[1;36m2012[0m[39m [0m[1;39m([0m[39mnot R2[0m[1;39m)[0m[39m can send empty tile sets *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:    [0m[39m        [0m[39mreturn TRUE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:    [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, tilesDataSize[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* tilesDataSize [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m936[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m937[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mpmem =[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    [0m[39m          [0m[1;35mwinpr_aligned_recalloc[0m[1;39m([0m[39mcontext->quants, context->numQuant, [0m[1;36m10[0m[39m * [0m  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39m, [0m[1;36m32[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:    [0m[39mquants = context->quants = [0m[1;39m([0m[39mUINT32*[0m[1;39m)[0m[39mpmem;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:    [0m[35m/[0m[39m* quantVals *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthOfSizeWLog[0m[1;39m([0m[39mcontext->priv->log, s, [0m     [2m                [0m
[2;36m                    [0m         [39mcontext->numQuant, 5ull[0m[1;39m)[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:    [0m[39mfor [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < context->numQuant; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:    [0m[39m        [0m[35m/[0m[39m* RFX_CODEC_QUANT *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, quant[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant & [0m[1;36m0x0F[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant >> [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, quant[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant & [0m[1;36m0x0F[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant >> [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, quant[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant & [0m[1;36m0x0F[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant >> [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, quant[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant & [0m[1;36m0x0F[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant >> [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, quant[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant & [0m[1;36m0x0F[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:    [0m[39m        [0m[39m*quants++ = [0m[1;39m([0m[39mquant >> [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_DEBUG,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:    [0m[39m        [0m[39m           [0m[32m"quant %d [0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32[0m [2m                [0m
[2;36m                    [0m         [32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:    [0m[39m        [0m[39m           [0m[32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32 [0m[32m" %"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m."[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:    [0m[39m        [0m[39m           i, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[1;39m][0m[39m, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m[1;36m1[0m[1;39m][0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:    [0m[39m        [0m[39m           context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m[1;36m2[0m[1;39m][0m[39m, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[1;39m][0m[39m,[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:    [0m[39m        [0m[39m           context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m[1;36m4[0m[1;39m][0m[39m, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[1;39m][0m[39m,[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:    [0m[39m        [0m[39m           context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m[1;36m6[0m[1;39m][0m[39m, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[1;39m][0m[39m,[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:    [0m[39m        [0m[39m           context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m[1;36m8[0m[1;39m][0m[39m, context->quants[0m[1;39m[[0m[39mi * [0m[1;36m10[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [1;36m9[0m[1;39m][0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39mfor [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < message->numTiles; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[39m        [0m[1;35mObjectPool_Return[0m[1;39m([0m[39mcontext->priv->TilePool, message->tiles[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:    [0m[39m        [0m[39mmessage->tiles[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mrfx_allocate_tiles[0m[1;39m([0m[39mmessage, numTiles, FALSE[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[39mif [0m[1;39m([0m[39mcontext->priv->UseThreads[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:    [0m[39m        [0m[39mwork_objects = [0m[1;39m([0m[39mPTP_WORK*[0m[1;39m)[0m[1;35mwinpr_aligned_calloc[0m[1;39m([0m[39mmessage->numTiles, [0m  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mPTP_WORK[0m[1;39m)[0m[39m, [0m[1;36m32[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:    [0m[39m        [0m[39mparams = [0m[1;39m([0m[39mRFX_TILE_PROCESS_WORK_PARAM*[0m[1;39m)[0m[1;35mwinpr_aligned_recalloc[0m[1;39m([0m      [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:    [0m[39m        [0m[39m    NULL, message->numTiles, [0m[1;35msizeof[0m[1;39m([0m[39mRFX_TILE_PROCESS_WORK_PARAM[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!work_objects[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[39mparams[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!params[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39mwork_objects[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:   [0m[35m/[0m[39m* tiles *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:   [0m[39mclose_cnt = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:   [0m[39mrc = FALSE;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:   [0m[39mif [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m >= tilesDataSize[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:   [0m[39m        [0m[39mrc = TRUE;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < message->numTiles; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:   [0m[39m        [0m[39m        [0m[39mwStream subBuffer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:   [0m[39m        [0m[39m        [0m[39mwStream* sub = NULL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mtile = [0m                                               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mRFX_TILE*[0m[1;39m)[0m[1;35mObjectPool_Take[0m[1;39m([0m[39mcontext->priv->TilePool[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1018[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"RfxMessageTileSet failed to get tile [0m   [2m                [0m
[2;36m                    [0m         [32mfrom object pool"[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1019[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1020[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1021[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1022[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1023[0m[39m:   [0m[39m        [0m[39m        [0m[39mmessage->tiles[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = tile;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1024[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1025[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* RFX_TILE *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1026[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m                                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthWLog[0m[1;39m([0m[39mcontext->priv->log, s, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1027[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1028[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1029[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"RfxMessageTileSet packet too small to [0m  [2m                [0m
[2;36m                    [0m         [32mread tile %d/%"[0m[39m PRIu16 [0m[32m""[0m[39m, i,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1030[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           message->numTiles[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1031[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1032[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1033[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1034[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1035[0m[39m:   [0m[39m        [0m[39m        [0m[39msub = [0m[1;35mStream_StaticInit[0m[1;39m([0m[39m&subBuffer, [0m[1;35mStream_Pointer[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1036[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1037[0m[39m:   [0m[39m        [0m[39m        [0m[39m    sub, blockType[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* blockType [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m, must be set to[0m [2m                [0m
[2;36m                    [0m         [39mCBT_TILE [0m[1;39m([0m[1;36m0xCAC3[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1038[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39msub, blockLen[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* blockLen [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m1039[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_SafeSeek[0m[1;39m([0m[39ms, blockLen[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mblockLen < [0m[1;36m6[0m[39m + [0m[1;36m13[0m[1;39m)[0m[39m ||[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthWLog[0m[1;39m([0m[39mcontext->priv->log, sub, blockLen - [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"RfxMessageTileSet not enough bytes to [0m  [2m                [0m
[2;36m                    [0m         [32mread tile %d/%"[0m[39m PRIu16[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m" with [0m[32mblocklen[0m[32m=%"[0m[39m PRIu32 [0m[32m""[0m[39m,[0m            [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           i, message->numTiles, blockLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mblockType != CBT_TILE[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"unknown block type 0x%"[0m[39m PRIX32 [0m[32m", [0m      [2m                [0m
[2;36m                    [0m         [32mexpected CBT_TILE [0m[32m([0m[32m0xCAC3[0m[32m)[0m[32m."[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           blockType[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39msub, tile->quantIdxY[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* quantIdxY [0m[1;39m([0m[1;36m1[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39msub, tile->quantIdxCb[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* quantIdxCb [0m[1;39m([0m[1;36m1[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39msub, tile->quantIdxCr[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* quantIdxCr [0m[1;39m([0m[1;36m1[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mtile->quantIdxY >= context->numQuant[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"quantIdxY %"[0m[39m PRIu8 [0m[32m" >= numQuant %"[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mPRIu8, tile->quantIdxY,[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           context->numQuant[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mtile->quantIdxCb >= context->numQuant[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"quantIdxCb %"[0m[39m PRIu8 [0m[32m" >= numQuant %"[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mPRIu8, tile->quantIdxCb,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           context->numQuant[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mtile->quantIdxCr >= context->numQuant[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           [0m[32m"quantIdxCr %"[0m[39m PRIu8 [0m[32m" >= numQuant %"[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mPRIu8, tile->quantIdxCr,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m           context->numQuant[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39msub, tile->xIdx[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* xIdx [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39msub, tile->yIdx[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* yIdx [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39msub, tile->YLen[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* YLen [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39msub, tile->CbLen[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* CbLen [0m[1;39m([0m[1;36m2[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39msub, tile->CrLen[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* CrLen [0m[1;39m([0m[1;36m2[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_GetPointer[0m[1;39m([0m[39msub, tile->YData[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_SafeSeek[0m[1;39m([0m[39msub, tile->YLen[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_GetPointer[0m[1;39m([0m[39msub, tile->CbData[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_SafeSeek[0m[1;39m([0m[39msub, tile->CbLen[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1106[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1107[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1108[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1109[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1110[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_GetPointer[0m[1;39m([0m[39msub, tile->CrData[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1111[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_SafeSeek[0m[1;39m([0m[39msub, tile->CrLen[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1112[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1113[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1114[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1115[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1116[0m[39m:   [0m[39m        [0m[39m        [0m[39mtile->x = tile->xIdx * [0m[1;36m64[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1117[0m[39m:   [0m[39m        [0m[39m        [0m[39mtile->y = tile->yIdx * [0m[1;36m64[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1118[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1119[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mcontext->priv->UseThreads[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1120[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1121[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!params[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1122[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1123[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1124[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1125[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1127[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mparams[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.context = context;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1128[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mparams[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tile = message->tiles[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1129[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1130[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mwork_objects[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m =[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1131[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m          [0m                                          [2m                [0m
[2;36m                    [0m         [1;35mCreateThreadpoolWork[0m[1;39m([0m[39mrfx_process_message_tile_work_callback,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1132[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m                               [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39m&params[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39m&context->priv->ThreadPoolEnv[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1133[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1134[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m [2m                [0m
[2;36m                    [0m         [32m"CreateThreadpoolWork failed."[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1135[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mrc = FALSE;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1136[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1137[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1138[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1139[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mSubmitThreadpoolWork[0m[1;39m([0m[39mwork_objects[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mclose_cnt = i + [0m[1;36m1[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:   [0m[39m        [0m[39m        [0m[39melse[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mrfx_decode_rgb[0m[1;39m([0m[39mcontext, tile, tile->data, [0m[1;36m64[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcontext->priv->UseThreads[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < close_cnt; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWaitForThreadpoolWorkCallbacks[0m[1;39m([0m[39mwork_objects[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m, FALSE[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mCloseThreadpoolWork[0m[1;39m([0m[39mwork_objects[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:   [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39mwork_objects[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:   [0m[1;35mwinpr_aligned_free[0m[1;39m([0m[39mparams[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:   [0m[39mfor [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < message->numTiles; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;39m([0m[39mtile = message->tiles[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:   [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:   [0m[39m        [0m[39mtile->YLen = tile->CbLen = tile->CrLen = [0m[1;36m0[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:   [0m[39m        [0m[39mtile->YData = tile->CbData = tile->CrData = NULL;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:650[0m[39m-[0m[1;36m684[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:                                                   UINT16* WINPR_RESTRICT [0m      [2m                [0m
[2;36m                    [0m         [39mpExpectedBlockType[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    [0m[39mUINT32 frameIdx = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:    [0m[39mUINT16 numRegions = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_FRAME_BEGIN[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected [0m     [2m                [0m
[2;36m                    [0m         [32mwants WBT_FRAME_BEGIN"[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    [0m[39m*pExpectedBlockType = WBT_REGION;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthWLog[0m[1;39m([0m[39mcontext->priv->log, s, [0m[1;36m6[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[1;35mStream_Read_UINT32[0m[1;39m([0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[39m    s, frameIdx[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* frameIdx [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m, if codec is in video mode, must be[0m [2m                [0m
[2;36m                    [0m         [39mignored *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, numRegions[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* numRegions [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m >= [0m[1;36m8[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    [0m[39m        UINT64 blockOffset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT64[0m[1;39m([0m[39ms, blockOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    [0m[39m        [0m[1;35mStream_Read_UINT64[0m[1;39m([0m[39ms, metadataData[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:    [0m[39m        metadataBlock += blockOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:    [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_DEBUG,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[39m           [0m[32m"RFX_FRAME_BEGIN: frameIdx: %"[0m[39m PRIu32 [0m[32m" numRegions: %"[0m[39m PRIu16 [0m   [2m                [0m
[2;36m                    [0m         [32m""[0m[39m, frameIdx,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:    [0m[39m           numRegions[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/codec/rfx.[0m[1;92mc:709[0m[39m-[0m[1;36m736[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:static INLINE BOOL [0m[1;35mrfx_process_message_metadata[0m[1;39m([0m[39mRFX_CONTEXT* WINPR_RESTRICT [0m    [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mRFX_MESSAGE* WINPR_RESTRICT message,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mwStream* WINPR_RESTRICT s,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m   [0m [2m                [0m
[2;36m                    [0m         [39mUINT16* WINPR_RESTRICT pExpectedBlockType[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:    [0m[39mUINT32 magic = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->priv[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mpExpectedBlockType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:    [0m[39mif [0m[1;39m([0m[39m*pExpectedBlockType != WBT_FRAME_END[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"message unexpected [0m     [2m                [0m
[2;36m                    [0m         [32mwants WBT_FRAME_END [0m[32m([0m[32m0x%x[0m[32m)[0m[32m"[0m[39m, *pExpectedBlockType[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:    [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, magic[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* magic [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m, [0m[1;36m0xCACCACCA[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmagic != WF_MAGIC[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:    [0m[39m        [0m[1;35mWLog_Print[0m[1;39m([0m[39mcontext->priv->log, WLOG_ERROR, [0m[32m"invalid magic number [0m   [2m                [0m
[2;36m                    [0m         [32m0x%08"[0m[39m PRIX32 [0m[32m""[0m[39m, magic[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:    [0m[39m*[0m[1;39m([0m[39mUINT64*[0m[1;39m)[0m[39mmetadataBlock = metadataData;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Introduce per‐message metadata storage instead of the current globals:[0m           [2m                [0m
[2;36m                    [0m         [39m   a. In rfx_types.h, extend the RFX_MESSAGE struct:[0m                                [2m                [0m
[2;36m                    [0m         [39m      - Add UINT16 numMetadata;      [0m[35m/[0m[35m/[0m[39m number of metadata entries expected[0m         [2m                [0m
[2;36m                    [0m         [39m      - Add UINT16 metaIndex;        [0m[35m/[0m[35m/[0m[39m current write index into metadata[0m[1;39m[[0m[1;39m][0m         [2m                [0m
[2;36m                    [0m         [39m      - Add UINT64* metadata;        [0m[35m/[0m[35m/[0m[39m array to hold metadata values[0m               [2m                [0m
[2;36m                    [0m         [39m   b. Remove the file‐scope globals `metadataBlock` and `metadataData` in rfx.c.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Allocate and initialize the metadata array when the message’s tile count is [0m     [2m                [0m
[2;36m                    [0m         [39mknown:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - In rfx_process_message_tileset, immediately after reading `numTiles`:[0m          [2m                [0m
[2;36m                    [0m         [39m     • Set `message->numMetadata = numTiles;`[0m                                       [2m                [0m
[2;36m                    [0m         [39m     • Allocate `message->metadata = [0m[1;35mcalloc[0m[1;39m([0m[39mnumTiles, [0m[1;35msizeof[0m[1;39m([0m[39mUINT64[0m[1;39m)[0m[1;39m)[0m[39m;`[0m             [2m                [0m
[2;36m                    [0m         [39m     • Initialize `message->metaIndex = [0m[1;36m0[0m[39m;`[0m                                         [2m                [0m
[2;36m                    [0m         [39m     • On allocation failure, return FALSE.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. On frame‐begin, reset the per‐message metadata index and stash any blockOffset [0m  [2m                [0m
[2;36m                    [0m         [39mif required:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - In rfx_process_message_frame_begin:[0m                                            [2m                [0m
[2;36m                    [0m         [39m     • Remove arithmetic on the global `metadataBlock`.[0m                             [2m                [0m
[2;36m                    [0m         [39m     • After reading `blockOffset` and the first `metadataData`, simply record the [0m [2m                [0m
[2;36m                    [0m         [39moffset:[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m         – Store `message->metaIndex = [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mblockOffset;`  [0m[1;39m([0m[39mso that subsequent [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata writes go to the right slot[0m[1;39m)[0m[39m.[0m                                              [2m                [0m
[2;36m                    [0m         [39m         – Optionally store the first `metadataData` into [0m                          [2m                [0m
[2;36m                    [0m         [39m`message->metadata[0m[1;39m[[0m[39mmetaIndex[0m[1;39m][0m[39m` and then increment `metaIndex`.[0m                      [2m                [0m
[2;36m                    [0m         [39m     • Ensure that no writes occur via global pointers.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. In rfx_process_message_metadata, write into the message’s metadata array with [0m   [2m                [0m
[2;36m                    [0m         [39mbounds checking:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - After validating the magic number:[0m                                             [2m                [0m
[2;36m                    [0m         [39m     • Check `if [0m[1;39m([0m[39mmessage->metaIndex >= message->numMetadata[0m[1;39m)[0m[39m return FALSE;`[0m        [2m                [0m
[2;36m                    [0m         [39m     • Assign `message->metadata[0m[1;39m[[0m[39mmessage->metaIndex++[0m[1;39m][0m[39m = localMetadataData;`  [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mwhere `localMetadataData` was captured earlier in frame_begin or passed through [0m   [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m.[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m     • Return TRUE on success.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Clean up metadata storage when the message is destroyed:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - In the message‐free or context cleanup path, add:[0m                              [2m                [0m
[2;36m                    [0m         [39m     • `[0m[1;35mfree[0m[1;39m([0m[39mmessage->metadata[0m[1;39m)[0m[39m;`[0m                                                   [2m                [0m
[2;36m                    [0m         [39m     • Reset `message->metadata = NULL; message->numMetadata = message->metaIndex =[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m;`[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Preserve existing logic and fuzzer harness:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Do not modify any fuzzing or harness code—only the rfx codec sources.[0m          [2m                [0m
[2;36m                    [0m         [39m   - All blockType checks and stream reads remain untouched.[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Existing tile allocation, decoding, and logging logic remains unchanged.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mJustification:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- This strategy removes the invalid global pointer arithmetic that caused wild [0m     [2m                [0m
[2;36m                    [0m         [39mwrites.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- By keeping metadata in a per‐message array, we guarantee bounds‐checked writes [0m   [2m                [0m
[2;36m                    [0m         [39mand avoid memory corruption.[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- The change preserves existing message parsing flow, block ordering, and logging.[0m  [2m                [0m
[2;36m                    [0m         [39m- Memory allocation for metadata scales with `numTiles`, matching the codec’s [0m      [2m                [0m
[2;36m                    [0m         [39msemantics.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Freeing the array in the normal cleanup path ensures no leaks.[0m                    [2m                [0m
[2;36m                    [0m         [39m- No harness, fuzzer, or external library code is modified; existing tests and [0m     [2m                [0m
[2;36m                    [0m         [39mfunctionality remain intact.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=482027;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=452015;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=715964;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=995119;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpt886nb1p[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/freerdp_fp-delta-03_vuln_003/[0m[95magent-outp[0m [2m               [0m
[2;36m                    [0m         [95mut-1766926457.4258227[0m                                                                [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/freerdp_fp-delta-03_vuln_003.toml                     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=624996;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=818143;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=329376;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=759297;file:///home/qqor/crete/scripts/benchmark/__main__.py#309\[2m309[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=97367;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=92603;file:///home/qqor/crete/scripts/benchmark/__main__.py#312\[2m312[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
