[10/26/25 19:43:41] INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmp1mfzy76k                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_4/agent-output-1761507821.897845                                                                         
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_4.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Started...                                                                                 context_managers.py:9
[10/26/25 19:44:59] INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Took 77.93 seconds; exception=False                                                       context_managers.py:23
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Started...                                                                        context_managers.py:9
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False                                               context_managers.py:23
                    INFO     Setting timeouts                                                                                                                                                       default.py:85
                               - build: 600 (original: 77)                                                                                                                                                       
                               - run tests: 600 (original: 0)                                                                                                                                                    
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:45:00] INFO     [logging_performance](pdfbox Setting owner) Took 0.95 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:45:01] INFO     Successfully created Cached for CLEAN environment                                                                                                                    oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                                                            oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                                                 
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:45:03] INFO     [logging_performance](pdfbox Setting owner) Took 1.19 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:45:04] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:45:35] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:45:36] INFO     [logging_performance](pdfbox Setting owner) Took 0.93 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Running a pov) Started...                                                                                                         context_managers.py:9
[10/26/25 19:46:07] INFO     [logging_performance](pdfbox Running a pov) Took 30.67 seconds; exception=True                                                                                context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                                                              __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:46:08] INFO     [logging_performance](pdfbox Setting owner) Took 1.03 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:46:39] INFO     Found jstack output at /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                                                                      __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 19:46:38                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3d8c0e55f0, length=14, elements={                                                                                                                         
                             0x00005619977f7b70, 0x0000561997902bf0, 0x0000561997904000, 0x000056199790d090,                                                                                                     
                             0x000056199790e410, 0x000056199790f7f0, 0x00005619979111f0, 0x00005619979126f0,                                                                                                     
                             0x0000561997913b30, 0x0000561997950bc0, 0x0000561997953d10, 0x0000561997b017c0,                                                                                                     
                             0x00007f3dbc000e70, 0x0000561998032df0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26660.05ms elapsed=28.71s tid=0x00005619977f7b70 nid=0x13 runnable  [0x00007fffa4788000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:640)                                                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=1.17ms elapsed=28.66s tid=0x0000561997902bf0 nid=0x16 waiting on condition  [0x00007f3dd122c000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.48ms elapsed=28.66s tid=0x0000561997904000 nid=0x17 in Object.wait()  [0x00007f3dd114b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.26ms elapsed=28.65s tid=0x000056199790d090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.72ms elapsed=28.65s tid=0x000056199790e410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.65s tid=0x000056199790f7f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=2009.63ms elapsed=28.65s tid=0x00005619979111f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=819.64ms elapsed=28.65s tid=0x00005619979126f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=46.75ms elapsed=28.65s tid=0x0000561997913b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.64s tid=0x0000561997950bc0 nid=0x1f runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.37ms elapsed=28.64s tid=0x0000561997953d10 nid=0x23 in Object.wait()  [0x00007f3dd048b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.56ms elapsed=28.52s tid=0x0000561997b017c0 nid=0x27 waiting on condition  [0x00007f3dd011e000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941e2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.76ms elapsed=28.39s tid=0x00007f3dbc000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.15ms elapsed=25.43s tid=0x0000561998032df0 nid=0x29c in Object.wait()  [0x00007f3d82e26000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.50ms elapsed=28.66s tid=0x00005619978fe400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=64.33ms elapsed=28.68s tid=0x000056199780eda0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=53.34ms elapsed=27.56s tid=0x00007f3dcc001570 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=51.76ms elapsed=27.56s tid=0x00007f3dcc001f70 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=65.36ms elapsed=27.56s tid=0x00007f3dcc002970 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.43ms elapsed=27.56s tid=0x00007f3dcc003760 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=58.97ms elapsed=27.56s tid=0x00007f3dcc004550 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=65.93ms elapsed=27.56s tid=0x00007f3dcc005340 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=58.14ms elapsed=27.56s tid=0x00007f3dcc006130 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=55.95ms elapsed=27.56s tid=0x00007f3dcc006f20 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=46.80ms elapsed=27.56s tid=0x00007f3dcc007d10 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=54.86ms elapsed=27.56s tid=0x00007f3dcc008b00 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=49.90ms elapsed=27.56s tid=0x00007f3dcc0098f0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=58.88ms elapsed=27.56s tid=0x00007f3dcc00a6e0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=11.87ms elapsed=28.64s tid=0x0000561997952550 nid=0x20 waiting on condition                                                                 
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 19:46:38                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3d8c0e55f0, length=14, elements={                                                                                                                         
                             0x00005619977f7b70, 0x0000561997902bf0, 0x0000561997904000, 0x000056199790d090,                                                                                                     
                             0x000056199790e410, 0x000056199790f7f0, 0x00005619979111f0, 0x00005619979126f0,                                                                                                     
                             0x0000561997913b30, 0x0000561997950bc0, 0x0000561997953d10, 0x0000561997b017c0,                                                                                                     
                             0x00007f3dbc000e70, 0x0000561998032df0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26660.05ms elapsed=28.71s tid=0x00005619977f7b70 nid=0x13 runnable  [0x00007fffa4788000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:640)                                                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=1.17ms elapsed=28.66s tid=0x0000561997902bf0 nid=0x16 waiting on condition  [0x00007f3dd122c000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.48ms elapsed=28.66s tid=0x0000561997904000 nid=0x17 in Object.wait()  [0x00007f3dd114b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.26ms elapsed=28.65s tid=0x000056199790d090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.72ms elapsed=28.65s tid=0x000056199790e410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.65s tid=0x000056199790f7f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=2009.63ms elapsed=28.65s tid=0x00005619979111f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=819.64ms elapsed=28.65s tid=0x00005619979126f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=46.75ms elapsed=28.65s tid=0x0000561997913b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.64s tid=0x0000561997950bc0 nid=0x1f runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.37ms elapsed=28.64s tid=0x0000561997953d10 nid=0x23 in Object.wait()  [0x00007f3dd048b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.56ms elapsed=28.52s tid=0x0000561997b017c0 nid=0x27 waiting on condition  [0x00007f3dd011e000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941e2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.76ms elapsed=28.39s tid=0x00007f3dbc000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.15ms elapsed=25.43s tid=0x0000561998032df0 nid=0x29c in Object.wait()  [0x00007f3d82e26000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.50ms elapsed=28.66s tid=0x00005619978fe400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=64.33ms elapsed=28.68s tid=0x000056199780eda0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=53.34ms elapsed=27.56s tid=0x00007f3dcc001570 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=51.76ms elapsed=27.56s tid=0x00007f3dcc001f70 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=65.36ms elapsed=27.56s tid=0x00007f3dcc002970 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.43ms elapsed=27.56s tid=0x00007f3dcc003760 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=58.97ms elapsed=27.56s tid=0x00007f3dcc004550 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=65.93ms elapsed=27.56s tid=0x00007f3dcc005340 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=58.14ms elapsed=27.56s tid=0x00007f3dcc006130 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=55.95ms elapsed=27.56s tid=0x00007f3dcc006f20 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=46.80ms elapsed=27.56s tid=0x00007f3dcc007d10 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=54.86ms elapsed=27.56s tid=0x00007f3dcc008b00 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=49.90ms elapsed=27.56s tid=0x00007f3dcc0098f0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=58.88ms elapsed=27.56s tid=0x00007f3dcc00a6e0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=11.87ms elapsed=28.64s tid=0x0000561997952550 nid=0x20 waiting on condition                                                                 
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Analysis Report===                                                                                                                                                               
                                                                                                                                                                                                                 
                             ===Evaluation End===                                                                                                                                                                
[10/26/25 19:46:47] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 19:48:06] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/26/25 19:49:03] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:49:04] INFO     [logging_performance](pdfbox Setting owner) Took 0.92 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:49:05] INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpdxx6sa4u                                                                                                                                 default.py:173
[10/26/25 19:50:01] INFO     [logging_performance](pdfbox Patching) Took 56.35 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                                                                                                        context_managers.py:9
[10/26/25 19:50:15] INFO     [logging_performance](pdfbox Checking build) Took 14.49 seconds; exception=False                                                                              context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                                                                                                           context_managers.py:9
[10/26/25 19:50:22] INFO     [logging_performance](pdfbox Running PoV) Took 6.67 seconds; exception=False                                                                                  context_managers.py:23
                    INFO     [logging_performance](pdfbox Testing) Started...                                                                                                               context_managers.py:9
                    INFO     [logging_performance](pdfbox Testing) Took 0.00 seconds; exception=False                                                                                      context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:50:23] INFO     [logging_performance](pdfbox Setting owner) Took 0.94 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:50:24] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:50:25] INFO     [logging_performance](pdfbox Setting owner) Took 1.09 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/26/25 19:50:26] INFO     [logging_performance](pdfbox Setting owner) Took 0.94 seconds; exception=False                                                                                context_managers.py:23
[10/26/25 19:50:27] INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.SOUND                                                                                                                                                                   
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             @@ -540,6 +540,10 @@                                                                                                                                                                
                                   */                                                                                                                                                                            
                                  private void parseBinary(byte[] bytes) throws IOException                                                                                                                      
                                  {                                                                                                                                                                              
                             +        final int MAX_EEXEC_SEGMENT_SIZE = 50 * 1024 * 1024;                                                                                                                       
                             +        if (bytes.length > MAX_EEXEC_SEGMENT_SIZE) {                                                                                                                               
                             +            throw new IOException("Binary segment too large: " + bytes.length);                                                                                                    
                             +        }                                                                                                                                                                          
                                      byte[] decrypted;                                                                                                                                                          
                                      // Sometimes, fonts use the hex format, so this needs to be converted before decryption                                                                                    
                                      if (isBinary(bytes))                                                                                                                                                       
                             @@ -634,15 +638,17 @@                                                                                                                                                               
                                          }                                                                                                                                                                      
                                      }                                                                                                                                                                          
                                                                                                                                                                                                                 
                             -        // some fonts have "2 index" here, others have "end noaccess put"                                                                                                          
                             -        // sometimes followed by "put". Either way, we just skip until                                                                                                             
                             -        // the /CharStrings dict is found                                                                                                                                          
                             -        while (!(lexer.peekKind(Token.LITERAL)                                                                                                                                     
                             -                && lexer.peekToken().getText().equals("CharStrings")))                                                                                                             
                             -        {                                                                                                                                                                          
                             +        Token peek;                                                                                                                                                                
                             +        while ((peek = lexer.peekToken()) != null) {                                                                                                                               
                             +            if (peek.getKind() == Token.LITERAL                                                                                                                                    
                             +                && "CharStrings".equals(peek.getText())) {                                                                                                                         
                             +                break;                                                                                                                                                             
                             +            }                                                                                                                                                                      
                                          lexer.nextToken();                                                                                                                                                     
                                      }                                                                                                                                                                          
                             -                                                                                                                                                                                   
                             +        if (peek == null) {                                                                                                                                                        
                             +            throw new IOException("/CharStrings token not found");                                                                                                                 
                             +        }                                                                                                                                                                          
                                      // CharStrings dict                                                                                                                                                        
                                      read(Token.LITERAL, "CharStrings");                                                                                                                                        
                                      readCharStrings(lenIV);                                                                                                                                                    
                             @@ -707,6 +713,9 @@                                                                                                                                                                 
                                  {                                                                                                                                                                              
                                      // allocate size (array indexes may not be in-order)                                                                                                                       
                                      int length = read(Token.INTEGER).intValue();                                                                                                                               
                             +        if (length < 0 || length > 10_000) {                                                                                                                                       
                             +            throw new IOException("Invalid Subrs count: " + length);                                                                                                               
                             +        }                                                                                                                                                                          
                                      for (int i = 0; i < length; i++)                                                                                                                                           
                                      {                                                                                                                                                                          
                                          font.subrs.add(null);                                                                                                                                                  
                             @@ -777,6 +786,9 @@                                                                                                                                                                 
                                  private void readCharStrings(int lenIV) throws IOException                                                                                                                     
                                  {                                                                                                                                                                              
                                      int length = read(Token.INTEGER).intValue();                                                                                                                               
                             +        if (length < 0 || length > 100_000) {                                                                                                                                      
                             +            throw new IOException("Invalid CharStrings count: " + length);                                                                                                         
                             +        }                                                                                                                                                                          
                                      read(Token.NAME, "dict");                                                                                                                                                  
                                      // could actually be a sequence ending in "CharStrings begin", too                                                                                                         
                                      // instead of the "dup begin"                                                                                                                                              
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 19:46:38                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3d8c0e55f0, length=14, elements={                                                                                                                         
                             0x00005619977f7b70, 0x0000561997902bf0, 0x0000561997904000, 0x000056199790d090,                                                                                                     
                             0x000056199790e410, 0x000056199790f7f0, 0x00005619979111f0, 0x00005619979126f0,                                                                                                     
                             0x0000561997913b30, 0x0000561997950bc0, 0x0000561997953d10, 0x0000561997b017c0,                                                                                                     
                             0x00007f3dbc000e70, 0x0000561998032df0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26660.05ms elapsed=28.71s tid=0x00005619977f7b70 nid=0x13 runnable  [0x00007fffa4788000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:640)                                                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=1.17ms elapsed=28.66s tid=0x0000561997902bf0 nid=0x16 waiting on condition  [0x00007f3dd122c000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.48ms elapsed=28.66s tid=0x0000561997904000 nid=0x17 in Object.wait()  [0x00007f3dd114b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.26ms elapsed=28.65s tid=0x000056199790d090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.72ms elapsed=28.65s tid=0x000056199790e410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.65s tid=0x000056199790f7f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=2009.63ms elapsed=28.65s tid=0x00005619979111f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=819.64ms elapsed=28.65s tid=0x00005619979126f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=46.75ms elapsed=28.65s tid=0x0000561997913b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.64s tid=0x0000561997950bc0 nid=0x1f runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.37ms elapsed=28.64s tid=0x0000561997953d10 nid=0x23 in Object.wait()  [0x00007f3dd048b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.56ms elapsed=28.52s tid=0x0000561997b017c0 nid=0x27 waiting on condition  [0x00007f3dd011e000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941e2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.76ms elapsed=28.39s tid=0x00007f3dbc000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.15ms elapsed=25.43s tid=0x0000561998032df0 nid=0x29c in Object.wait()  [0x00007f3d82e26000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.50ms elapsed=28.66s tid=0x00005619978fe400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=64.33ms elapsed=28.68s tid=0x000056199780eda0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=53.34ms elapsed=27.56s tid=0x00007f3dcc001570 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=51.76ms elapsed=27.56s tid=0x00007f3dcc001f70 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=65.36ms elapsed=27.56s tid=0x00007f3dcc002970 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.43ms elapsed=27.56s tid=0x00007f3dcc003760 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=58.97ms elapsed=27.56s tid=0x00007f3dcc004550 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=65.93ms elapsed=27.56s tid=0x00007f3dcc005340 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=58.14ms elapsed=27.56s tid=0x00007f3dcc006130 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=55.95ms elapsed=27.56s tid=0x00007f3dcc006f20 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=46.80ms elapsed=27.56s tid=0x00007f3dcc007d10 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=54.86ms elapsed=27.56s tid=0x00007f3dcc008b00 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=49.90ms elapsed=27.56s tid=0x00007f3dcc0098f0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=58.88ms elapsed=27.56s tid=0x00007f3dcc00a6e0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=11.87ms elapsed=28.64s tid=0x0000561997952550 nid=0x20 waiting on condition                                                                 
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A libFuzzer run against the `PDFExtractTextFuzzer` target terminated with a timeout after roughly 28 seconds of execution. The Java thread dump shows the main                    
                             thread continuously executing in the Apache FontBox/ PDFBox Type 1 font parsing logic, specifically inside `Type1Parser.parseBinary`. No crash or exception was                     
                             reported; rather the fuzzer hit its time limit, indicating a potential performance hang or denial-of-service scenario when processing certain inputs.                               
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             - Issue Type                                                                                                                                                                        
                               This is a libFuzzer timeout event: the fuzz target did not complete (return or crash) within the allotted time budget. No explicit exception or error other than                  
                             the fuzzer timeout was reported.                                                                                                                                                    
                                                                                                                                                                                                                 
                             - Observations & Findings                                                                                                                                                           
                                The main thread has been running for 26660 ms (and counting) in a RUNNABLE state within the native callback `traceConstCmpInt`, invoked by                                    
                             `Type1Parser.parseBinary`.                                                                                                                                                          
                                The Java call stack leads from font parsing (FontBoxs `Type1Parser`) through PDFBoxs `PDType1Font`, `PDFontFactory`, `PDResources`, and ultimately to                         
                             `PDFTextStripper.getText`, which is invoked by the fuzzer harness.                                                                                                                  
                                No other thread is blocked or sleeping; all other JVM and GC threads are idle or in normal waiting states.                                                                      
                                                                                                                                                                                                                 
                             - Code Areas for Investigation                                                                                                                                                      
                               To understand the full scope of this timeout issue, review:                                                                                                                       
                               1. The Type 1 font parsing routines in `org.apache.fontbox.type1.Type1Parser`, especially the `parseBinary` method.                                                               
                               2. The PDFBox font-loading integration in `org.apache.pdfbox.pdmodel.font.PDType1Font` and `PDFontFactory`.                                                                       
                               3. The text extraction flow in `org.apache.pdfbox.text.PDFTextStripper` and its use of `LegacyPDFStreamEngine` or related operators (e.g., `SetFontAndSize`).                     
                               4. The fuzzing entry point in `PDFExtractTextFuzzer.fuzzerTestOneInput`, which seeds inputs into the PDFBox parsing path.                                                         
                                                                                                                                                                                                                 
                             - Vulnerability Classification                                                                                                                                                      
                               While no crash was observed, a prolonged hang suggests a potential denial-of-service or performance issue when parsing certain maliciously crafted inputs.                        
                             Further analysis of algorithmic complexity or infinite loops in the Type 1 parser is warranted.                                                                                     
                                                                                                                                                                                                                 
                             No root-cause determination or remediation strategy is provided here; this report is strictly an evaluation of the observed timeout issue.                                          
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-26 19:46:38                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f3d8c0e55f0, length=14, elements={                                                                                                                         
                             0x00005619977f7b70, 0x0000561997902bf0, 0x0000561997904000, 0x000056199790d090,                                                                                                     
                             0x000056199790e410, 0x000056199790f7f0, 0x00005619979111f0, 0x00005619979126f0,                                                                                                     
                             0x0000561997913b30, 0x0000561997950bc0, 0x0000561997953d10, 0x0000561997b017c0,                                                                                                     
                             0x00007f3dbc000e70, 0x0000561998032df0                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26660.05ms elapsed=28.71s tid=0x00005619977f7b70 nid=0x13 runnable  [0x00007fffa4788000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:640)                                                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=1.17ms elapsed=28.66s tid=0x0000561997902bf0 nid=0x16 waiting on condition  [0x00007f3dd122c000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.48ms elapsed=28.66s tid=0x0000561997904000 nid=0x17 in Object.wait()  [0x00007f3dd114b000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089412178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.26ms elapsed=28.65s tid=0x000056199790d090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.72ms elapsed=28.65s tid=0x000056199790e410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.65s tid=0x000056199790f7f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=2009.63ms elapsed=28.65s tid=0x00005619979111f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=819.64ms elapsed=28.65s tid=0x00005619979126f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=46.75ms elapsed=28.65s tid=0x0000561997913b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.64s tid=0x0000561997950bc0 nid=0x1f runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.37ms elapsed=28.64s tid=0x0000561997953d10 nid=0x23 in Object.wait()  [0x00007f3dd048b000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000894141d0> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.56ms elapsed=28.52s tid=0x0000561997b017c0 nid=0x27 waiting on condition  [0x00007f3dd011e000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x000000008941e2c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.76ms elapsed=28.39s tid=0x00007f3dbc000e70 nid=0x3e waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.15ms elapsed=25.43s tid=0x0000561998032df0 nid=0x29c in Object.wait()  [0x00007f3d82e26000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f62a8178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.50ms elapsed=28.66s tid=0x00005619978fe400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=64.33ms elapsed=28.68s tid=0x000056199780eda0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=53.34ms elapsed=27.56s tid=0x00007f3dcc001570 nid=0x5e runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=51.76ms elapsed=27.56s tid=0x00007f3dcc001f70 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=65.36ms elapsed=27.56s tid=0x00007f3dcc002970 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=60.43ms elapsed=27.56s tid=0x00007f3dcc003760 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=58.97ms elapsed=27.56s tid=0x00007f3dcc004550 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=65.93ms elapsed=27.56s tid=0x00007f3dcc005340 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=58.14ms elapsed=27.56s tid=0x00007f3dcc006130 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=55.95ms elapsed=27.56s tid=0x00007f3dcc006f20 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=46.80ms elapsed=27.56s tid=0x00007f3dcc007d10 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=54.86ms elapsed=27.56s tid=0x00007f3dcc008b00 nid=0x67 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=49.90ms elapsed=27.56s tid=0x00007f3dcc0098f0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=58.88ms elapsed=27.56s tid=0x00007f3dcc00a6e0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=11.87ms elapsed=28.64s tid=0x0000561997952550 nid=0x20 waiting on condition                                                                 
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:1-10                                                                                                                
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:600-765                                                                                                             
                             ```                                                                                                                                                                                 
                             600:                case "lenIV":                                                                                                                                                   
                             601:                    lenIV = readDictValue().get(0).intValue();                                                                                                                  
                             602:                    break;                                                                                                                                                      
                             603:                case "ND":                                                                                                                                                      
                             604:                    read(Token.START_PROC);                                                                                                                                     
                             605:                    // the access restrictions are not mandatory                                                                                                                
                             606:                    readMaybe(Token.NAME, "noaccess");                                                                                                                          
                             607:                    read(Token.NAME, "def");                                                                                                                                    
                             608:                    read(Token.END_PROC);                                                                                                                                       
                             609:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             610:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             611:                    read(Token.NAME, "def");                                                                                                                                    
                             612:                    break;                                                                                                                                                      
                             613:                case "NP":                                                                                                                                                      
                             614:                    read(Token.START_PROC);                                                                                                                                     
                             615:                    readMaybe(Token.NAME, "noaccess");                                                                                                                          
                             616:                    read(Token.NAME);                                                                                                                                           
                             617:                    read(Token.END_PROC);                                                                                                                                       
                             618:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             619:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             620:                    read(Token.NAME, "def");                                                                                                                                    
                             621:                    break;                                                                                                                                                      
                             622:                case "RD":                                                                                                                                                      
                             623:                    // /RD {string currentfile exch readstring pop} bind executeonly def                                                                                        
                             624:                    read(Token.START_PROC);                                                                                                                                     
                             625:                    readProcVoid();                                                                                                                                             
                             626:                    readMaybe(Token.NAME, "bind");                                                                                                                              
                             627:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             628:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             629:                    read(Token.NAME, "def");                                                                                                                                    
                             630:                    break;                                                                                                                                                      
                             631:                default:                                                                                                                                                        
                             632:                    readPrivate(key, readDictValue());                                                                                                                          
                             633:                    break;                                                                                                                                                      
                             634:            }                                                                                                                                                                   
                             635:        }                                                                                                                                                                       
                             636:                                                                                                                                                                                
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                                                                                                       
                             638:        // sometimes followed by "put". Either way, we just skip until                                                                                                          
                             639:        // the /CharStrings dict is found                                                                                                                                       
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                                                                                                  
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                                                                                                          
                             642:        {                                                                                                                                                                       
                             643:            lexer.nextToken();                                                                                                                                                  
                             644:        }                                                                                                                                                                       
                             645:                                                                                                                                                                                
                             646:        // CharStrings dict                                                                                                                                                     
                             647:        read(Token.LITERAL, "CharStrings");                                                                                                                                     
                             648:        readCharStrings(lenIV);                                                                                                                                                 
                             649:    }                                                                                                                                                                           
                             650:                                                                                                                                                                                
                             651:    /**                                                                                                                                                                         
                             652:     * Extracts values from the /Private dictionary.                                                                                                                            
                             653:     */                                                                                                                                                                         
                             654:    private void readPrivate(String key, List<Token> value) throws IOException                                                                                                  
                             655:    {                                                                                                                                                                           
                             656:        switch (key)                                                                                                                                                            
                             657:        {                                                                                                                                                                       
                             658:            case "BlueValues":                                                                                                                                                  
                             659:                font.blueValues = arrayToNumbers(value);                                                                                                                        
                             660:                break;                                                                                                                                                          
                             661:            case "OtherBlues":                                                                                                                                                  
                             662:                font.otherBlues = arrayToNumbers(value);                                                                                                                        
                             663:                break;                                                                                                                                                          
                             664:            case "FamilyBlues":                                                                                                                                                 
                             665:                font.familyBlues = arrayToNumbers(value);                                                                                                                       
                             666:                break;                                                                                                                                                          
                             667:            case "FamilyOtherBlues":                                                                                                                                            
                             668:                font.familyOtherBlues = arrayToNumbers(value);                                                                                                                  
                             669:                break;                                                                                                                                                          
                             670:            case "BlueScale":                                                                                                                                                   
                             671:                font.blueScale = value.get(0).floatValue();                                                                                                                     
                             672:                break;                                                                                                                                                          
                             673:            case "BlueShift":                                                                                                                                                   
                             674:                font.blueShift = value.get(0).intValue();                                                                                                                       
                             675:                break;                                                                                                                                                          
                             676:            case "BlueFuzz":                                                                                                                                                    
                             677:                font.blueFuzz = value.get(0).intValue();                                                                                                                        
                             678:                break;                                                                                                                                                          
                             679:            case "StdHW":                                                                                                                                                       
                             680:                font.stdHW = arrayToNumbers(value);                                                                                                                             
                             681:                break;                                                                                                                                                          
                             682:            case "StdVW":                                                                                                                                                       
                             683:                font.stdVW = arrayToNumbers(value);                                                                                                                             
                             684:                break;                                                                                                                                                          
                             685:            case "StemSnapH":                                                                                                                                                   
                             686:                font.stemSnapH = arrayToNumbers(value);                                                                                                                         
                             687:                break;                                                                                                                                                          
                             688:            case "StemSnapV":                                                                                                                                                   
                             689:                font.stemSnapV = arrayToNumbers(value);                                                                                                                         
                             690:                break;                                                                                                                                                          
                             691:            case "ForceBold":                                                                                                                                                   
                             692:                font.forceBold = value.get(0).booleanValue();                                                                                                                   
                             693:                break;                                                                                                                                                          
                             694:            case "LanguageGroup":                                                                                                                                               
                             695:                font.languageGroup = value.get(0).intValue();                                                                                                                   
                             696:                break;                                                                                                                                                          
                             697:            default:                                                                                                                                                            
                             698:                break;                                                                                                                                                          
                             699:        }                                                                                                                                                                       
                             700:    }                                                                                                                                                                           
                             701:                                                                                                                                                                                
                             702:    /**                                                                                                                                                                         
                             703:     * Reads the /Subrs array.                                                                                                                                                  
                             704:     * @param lenIV The number of random bytes used in charstring encryption.                                                                                                   
                             705:     */                                                                                                                                                                         
                             706:    private void readSubrs(int lenIV) throws IOException                                                                                                                        
                             707:    {                                                                                                                                                                           
                             708:        // allocate size (array indexes may not be in-order)                                                                                                                    
                             709:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             710:        for (int i = 0; i < length; i++)                                                                                                                                        
                             711:        {                                                                                                                                                                       
                             712:            font.subrs.add(null);                                                                                                                                               
                             713:        }                                                                                                                                                                       
                             714:        read(Token.NAME, "array");                                                                                                                                              
                             715:                                                                                                                                                                                
                             716:        for (int i = 0; i < length; i++)                                                                                                                                        
                             717:        {                                                                                                                                                                       
                             718:            // premature end                                                                                                                                                    
                             719:            if (lexer.peekToken() == null)                                                                                                                                      
                             720:            {                                                                                                                                                                   
                             721:                break;                                                                                                                                                          
                             722:            }                                                                                                                                                                   
                             723:            if (!(lexer.peekKind(Token.NAME) &&                                                                                                                                 
                             724:                  lexer.peekToken().getText().equals("dup")))                                                                                                                   
                             725:            {                                                                                                                                                                   
                             726:                break;                                                                                                                                                          
                             727:            }                                                                                                                                                                   
                             728:                                                                                                                                                                                
                             729:            read(Token.NAME, "dup");                                                                                                                                            
                             730:            Token index = read(Token.INTEGER);                                                                                                                                  
                             731:            read(Token.INTEGER);                                                                                                                                                
                             732:                                                                                                                                                                                
                             733:            // RD                                                                                                                                                               
                             734:            Token charstring = read(Token.CHARSTRING);                                                                                                                          
                             735:            int j = index.intValue();                                                                                                                                           
                             736:            if (j < font.subrs.size())                                                                                                                                          
                             737:            {                                                                                                                                                                   
                             738:                font.subrs.set(j, decrypt(charstring.getData(), CHARSTRING_KEY, lenIV));                                                                                        
                             739:            }                                                                                                                                                                   
                             740:            readPut();                                                                                                                                                          
                             741:        }                                                                                                                                                                       
                             742:        readDef();                                                                                                                                                              
                             743:    }                                                                                                                                                                           
                             744:                                                                                                                                                                                
                             745:    // OtherSubrs are embedded PostScript procedures which we can safely ignore                                                                                                 
                             746:    private void readOtherSubrs() throws IOException                                                                                                                            
                             747:    {                                                                                                                                                                           
                             748:        if (lexer.peekToken() == null)                                                                                                                                          
                             749:        {                                                                                                                                                                       
                             750:            throw new IOException("Missing start token of OtherSubrs procedure");                                                                                               
                             751:        }                                                                                                                                                                       
                             752:        if (lexer.peekKind(Token.START_ARRAY))                                                                                                                                  
                             753:        {                                                                                                                                                                       
                             754:            readValue();                                                                                                                                                        
                             755:            readDef();                                                                                                                                                          
                             756:        }                                                                                                                                                                       
                             757:        else                                                                                                                                                                    
                             758:        {                                                                                                                                                                       
                             759:            int length = read(Token.INTEGER).intValue();                                                                                                                        
                             760:            read(Token.NAME, "array");                                                                                                                                          
                             761:                                                                                                                                                                                
                             762:            for (int i = 0; i < length; i++)                                                                                                                                    
                             763:            {                                                                                                                                                                   
                             764:                read(Token.NAME, "dup");                                                                                                                                        
                             765:                read(Token.INTEGER); // index                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Font.java:60-115                                                                                                                
                             ```                                                                                                                                                                                 
                             60:     * Constructs a new Type1Font object from a .pfb stream.                                                                                                                     
                             61:     *                                                                                                                                                                           
                             62:     * @param pfbBytes .pfb data, including headers                                                                                                                              
                             63:     * @return a type1 font                                                                                                                                                      
                             64:     *                                                                                                                                                                           
                             65:     * @throws IOException if something went wrong                                                                                                                               
                             66:     */                                                                                                                                                                          
                             67:    public static Type1Font createWithPFB(byte[] pfbBytes) throws IOException                                                                                                    
                             68:    {                                                                                                                                                                            
                             69:        PfbParser pfb = new PfbParser(pfbBytes);                                                                                                                                 
                             70:        Type1Parser parser = new Type1Parser();                                                                                                                                  
                             71:        return parser.parse(pfb.getSegment1(), pfb.getSegment2());                                                                                                               
                             72:    }                                                                                                                                                                            
                             73:                                                                                                                                                                                 
                             74:    /**                                                                                                                                                                          
                             75:     * Constructs a new Type1Font object from two header-less .pfb segments.                                                                                                     
                             76:     *                                                                                                                                                                           
                             77:     * @param segment1 The first segment, without header                                                                                                                         
                             78:     * @param segment2 The second segment, without header                                                                                                                        
                             79:     * @return A new Type1Font instance                                                                                                                                          
                             80:     * @throws IOException if something went wrong                                                                                                                               
                             81:     */                                                                                                                                                                          
                             82:    public static Type1Font createWithSegments(byte[] segment1, byte[] segment2) throws IOException                                                                              
                             83:    {                                                                                                                                                                            
                             84:        Type1Parser parser = new Type1Parser();                                                                                                                                  
                             85:        return parser.parse(segment1, segment2);                                                                                                                                 
                             86:    }                                                                                                                                                                            
                             87:                                                                                                                                                                                 
                             88:    // font dictionary                                                                                                                                                           
                             89:    String fontName = "";                                                                                                                                                        
                             90:    Encoding encoding = null;                                                                                                                                                    
                             91:    int paintType;                                                                                                                                                               
                             92:    int fontType;                                                                                                                                                                
                             93:    List<Number> fontMatrix = Collections.emptyList();                                                                                                                           
                             94:    List<Number> fontBBox = Collections.emptyList();                                                                                                                             
                             95:    int uniqueID;                                                                                                                                                                
                             96:    float strokeWidth;                                                                                                                                                           
                             97:    String fontID = "";                                                                                                                                                          
                             98:                                                                                                                                                                                 
                             99:    // FontInfo dictionary                                                                                                                                                       
                             100:    String version = "";                                                                                                                                                        
                             101:    String notice = "";                                                                                                                                                         
                             102:    String fullName = "";                                                                                                                                                       
                             103:    String familyName = "";                                                                                                                                                     
                             104:    String weight = "";                                                                                                                                                         
                             105:    float italicAngle;                                                                                                                                                          
                             106:    boolean isFixedPitch;                                                                                                                                                       
                             107:    float underlinePosition;                                                                                                                                                    
                             108:    float underlineThickness;                                                                                                                                                   
                             109:                                                                                                                                                                                
                             110:    // Private dictionary                                                                                                                                                       
                             111:    List<Number> blueValues = Collections.emptyList();                                                                                                                          
                             112:    List<Number> otherBlues = Collections.emptyList();                                                                                                                          
                             113:    List<Number> familyBlues = Collections.emptyList();                                                                                                                         
                             114:    List<Number> familyOtherBlues = Collections.emptyList();                                                                                                                    
                             115:    float blueScale;                                                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:1-10                                                                                                                
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:65-120                                                                                                              
                             ```                                                                                                                                                                                 
                             65:        catch (NumberFormatException ex)                                                                                                                                         
                             66:        {                                                                                                                                                                        
                             67:            throw new IOException(ex);                                                                                                                                           
                             68:        }                                                                                                                                                                        
                             69:        if (segment2.length > 0)                                                                                                                                                 
                             70:        {                                                                                                                                                                        
                             71:            parseBinary(segment2);                                                                                                                                               
                             72:        }                                                                                                                                                                        
                             73:        return font;                                                                                                                                                             
                             74:    }                                                                                                                                                                            
                             75:                                                                                                                                                                                 
                             76:    /**                                                                                                                                                                          
                             77:     * Parses the ASCII portion of a Type 1 font.                                                                                                                                
                             78:     */                                                                                                                                                                          
                             79:    private void parseASCII(byte[] bytes) throws IOException                                                                                                                     
                             80:    {                                                                                                                                                                            
                             81:        if (bytes.length == 0)                                                                                                                                                   
                             82:        {                                                                                                                                                                        
                             83:            throw new IOException("ASCII segment of type 1 font is empty");                                                                                                      
                             84:        }                                                                                                                                                                        
                             85:                                                                                                                                                                                 
                             86:        // %!FontType1-1.0                                                                                                                                                       
                             87:        // %!PS-AdobeFont-1.0                                                                                                                                                    
                             88:        if (bytes.length < 2 || (bytes[0] != '%' && bytes[1] != '!'))                                                                                                            
                             89:        {                                                                                                                                                                        
                             90:            throw new IOException("Invalid start of ASCII segment of type 1 font");                                                                                              
                             91:        }                                                                                                                                                                        
                             92:                                                                                                                                                                                 
                             93:        lexer = new Type1Lexer(bytes);                                                                                                                                           
                             94:                                                                                                                                                                                 
                             95:        // (corrupt?) synthetic font                                                                                                                                             
                             96:        if ("FontDirectory".equals(lexer.peekToken().getText()))                                                                                                                 
                             97:        {                                                                                                                                                                        
                             98:            read(Token.NAME, "FontDirectory");                                                                                                                                   
                             99:            read(Token.LITERAL); // font name                                                                                                                                    
                             100:            read(Token.NAME, "known");                                                                                                                                          
                             101:            read(Token.START_PROC);                                                                                                                                             
                             102:            readProcVoid();                                                                                                                                                     
                             103:            read(Token.START_PROC);                                                                                                                                             
                             104:            readProcVoid();                                                                                                                                                     
                             105:            read(Token.NAME, "ifelse");                                                                                                                                         
                             106:        }                                                                                                                                                                       
                             107:                                                                                                                                                                                
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             117:        {                                                                                                                                                                       
                             118:            // premature end                                                                                                                                                    
                             119:            Token token = lexer.peekToken();                                                                                                                                    
                             120:            if (token == null)                                                                                                                                                  
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:649-765                                                                                                             
                             ```                                                                                                                                                                                 
                             649:    }                                                                                                                                                                           
                             650:                                                                                                                                                                                
                             651:    /**                                                                                                                                                                         
                             652:     * Extracts values from the /Private dictionary.                                                                                                                            
                             653:     */                                                                                                                                                                         
                             654:    private void readPrivate(String key, List<Token> value) throws IOException                                                                                                  
                             655:    {                                                                                                                                                                           
                             656:        switch (key)                                                                                                                                                            
                             657:        {                                                                                                                                                                       
                             658:            case "BlueValues":                                                                                                                                                  
                             659:                font.blueValues = arrayToNumbers(value);                                                                                                                        
                             660:                break;                                                                                                                                                          
                             661:            case "OtherBlues":                                                                                                                                                  
                             662:                font.otherBlues = arrayToNumbers(value);                                                                                                                        
                             663:                break;                                                                                                                                                          
                             664:            case "FamilyBlues":                                                                                                                                                 
                             665:                font.familyBlues = arrayToNumbers(value);                                                                                                                       
                             666:                break;                                                                                                                                                          
                             667:            case "FamilyOtherBlues":                                                                                                                                            
                             668:                font.familyOtherBlues = arrayToNumbers(value);                                                                                                                  
                             669:                break;                                                                                                                                                          
                             670:            case "BlueScale":                                                                                                                                                   
                             671:                font.blueScale = value.get(0).floatValue();                                                                                                                     
                             672:                break;                                                                                                                                                          
                             673:            case "BlueShift":                                                                                                                                                   
                             674:                font.blueShift = value.get(0).intValue();                                                                                                                       
                             675:                break;                                                                                                                                                          
                             676:            case "BlueFuzz":                                                                                                                                                    
                             677:                font.blueFuzz = value.get(0).intValue();                                                                                                                        
                             678:                break;                                                                                                                                                          
                             679:            case "StdHW":                                                                                                                                                       
                             680:                font.stdHW = arrayToNumbers(value);                                                                                                                             
                             681:                break;                                                                                                                                                          
                             682:            case "StdVW":                                                                                                                                                       
                             683:                font.stdVW = arrayToNumbers(value);                                                                                                                             
                             684:                break;                                                                                                                                                          
                             685:            case "StemSnapH":                                                                                                                                                   
                             686:                font.stemSnapH = arrayToNumbers(value);                                                                                                                         
                             687:                break;                                                                                                                                                          
                             688:            case "StemSnapV":                                                                                                                                                   
                             689:                font.stemSnapV = arrayToNumbers(value);                                                                                                                         
                             690:                break;                                                                                                                                                          
                             691:            case "ForceBold":                                                                                                                                                   
                             692:                font.forceBold = value.get(0).booleanValue();                                                                                                                   
                             693:                break;                                                                                                                                                          
                             694:            case "LanguageGroup":                                                                                                                                               
                             695:                font.languageGroup = value.get(0).intValue();                                                                                                                   
                             696:                break;                                                                                                                                                          
                             697:            default:                                                                                                                                                            
                             698:                break;                                                                                                                                                          
                             699:        }                                                                                                                                                                       
                             700:    }                                                                                                                                                                           
                             701:                                                                                                                                                                                
                             702:    /**                                                                                                                                                                         
                             703:     * Reads the /Subrs array.                                                                                                                                                  
                             704:     * @param lenIV The number of random bytes used in charstring encryption.                                                                                                   
                             705:     */                                                                                                                                                                         
                             706:    private void readSubrs(int lenIV) throws IOException                                                                                                                        
                             707:    {                                                                                                                                                                           
                             708:        // allocate size (array indexes may not be in-order)                                                                                                                    
                             709:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             710:        for (int i = 0; i < length; i++)                                                                                                                                        
                             711:        {                                                                                                                                                                       
                             712:            font.subrs.add(null);                                                                                                                                               
                             713:        }                                                                                                                                                                       
                             714:        read(Token.NAME, "array");                                                                                                                                              
                             715:                                                                                                                                                                                
                             716:        for (int i = 0; i < length; i++)                                                                                                                                        
                             717:        {                                                                                                                                                                       
                             718:            // premature end                                                                                                                                                    
                             719:            if (lexer.peekToken() == null)                                                                                                                                      
                             720:            {                                                                                                                                                                   
                             721:                break;                                                                                                                                                          
                             722:            }                                                                                                                                                                   
                             723:            if (!(lexer.peekKind(Token.NAME) &&                                                                                                                                 
                             724:                  lexer.peekToken().getText().equals("dup")))                                                                                                                   
                             725:            {                                                                                                                                                                   
                             726:                break;                                                                                                                                                          
                             727:            }                                                                                                                                                                   
                             728:                                                                                                                                                                                
                             729:            read(Token.NAME, "dup");                                                                                                                                            
                             730:            Token index = read(Token.INTEGER);                                                                                                                                  
                             731:            read(Token.INTEGER);                                                                                                                                                
                             732:                                                                                                                                                                                
                             733:            // RD                                                                                                                                                               
                             734:            Token charstring = read(Token.CHARSTRING);                                                                                                                          
                             735:            int j = index.intValue();                                                                                                                                           
                             736:            if (j < font.subrs.size())                                                                                                                                          
                             737:            {                                                                                                                                                                   
                             738:                font.subrs.set(j, decrypt(charstring.getData(), CHARSTRING_KEY, lenIV));                                                                                        
                             739:            }                                                                                                                                                                   
                             740:            readPut();                                                                                                                                                          
                             741:        }                                                                                                                                                                       
                             742:        readDef();                                                                                                                                                              
                             743:    }                                                                                                                                                                           
                             744:                                                                                                                                                                                
                             745:    // OtherSubrs are embedded PostScript procedures which we can safely ignore                                                                                                 
                             746:    private void readOtherSubrs() throws IOException                                                                                                                            
                             747:    {                                                                                                                                                                           
                             748:        if (lexer.peekToken() == null)                                                                                                                                          
                             749:        {                                                                                                                                                                       
                             750:            throw new IOException("Missing start token of OtherSubrs procedure");                                                                                               
                             751:        }                                                                                                                                                                       
                             752:        if (lexer.peekKind(Token.START_ARRAY))                                                                                                                                  
                             753:        {                                                                                                                                                                       
                             754:            readValue();                                                                                                                                                        
                             755:            readDef();                                                                                                                                                          
                             756:        }                                                                                                                                                                       
                             757:        else                                                                                                                                                                    
                             758:        {                                                                                                                                                                       
                             759:            int length = read(Token.INTEGER).intValue();                                                                                                                        
                             760:            read(Token.NAME, "array");                                                                                                                                          
                             761:                                                                                                                                                                                
                             762:            for (int i = 0; i < length; i++)                                                                                                                                    
                             763:            {                                                                                                                                                                   
                             764:                read(Token.NAME, "dup");                                                                                                                                        
                             765:                read(Token.INTEGER); // index                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java:1-200                                                                                                                   
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:package org.apache.fontbox.pfb;                                                                                                                                                  
                             18:                                                                                                                                                                                 
                             19:import java.io.ByteArrayInputStream;                                                                                                                                             
                             20:import java.io.EOFException;                                                                                                                                                     
                             21:import java.io.IOException;                                                                                                                                                      
                             22:import java.io.InputStream;                                                                                                                                                      
                             23:import java.nio.file.Files;                                                                                                                                                      
                             24:import java.nio.file.Paths;                                                                                                                                                      
                             25:import java.util.ArrayList;                                                                                                                                                      
                             26:import java.util.Arrays;                                                                                                                                                         
                             27:import java.util.List;                                                                                                                                                           
                             28:import org.apache.logging.log4j.LogManager;                                                                                                                                      
                             29:import org.apache.logging.log4j.Logger;                                                                                                                                          
                             30:                                                                                                                                                                                 
                             31:/**                                                                                                                                                                              
                             32: * Parser for a pfb-file.                                                                                                                                                        
                             33: *                                                                                                                                                                               
                             34: * @author Ben Litchfield                                                                                                                                                        
                             35: * @author Michael Niedermair                                                                                                                                                    
                             36: */                                                                                                                                                                              
                             37:public class PfbParser                                                                                                                                                           
                             38:{                                                                                                                                                                                
                             39:    private static final Logger LOG = LogManager.getLogger(PfbParser.class);                                                                                                     
                             40:                                                                                                                                                                                 
                             41:    /**                                                                                                                                                                          
                             42:     * the pfb header length.                                                                                                                                                    
                             43:     * (start-marker (1 byte), ascii-/binary-marker (1 byte), size (4 byte))                                                                                                     
                             44:     * 3*6 == 18                                                                                                                                                                 
                             45:     */                                                                                                                                                                          
                             46:    private static final int PFB_HEADER_LENGTH = 18;                                                                                                                             
                             47:                                                                                                                                                                                 
                             48:    /**                                                                                                                                                                          
                             49:     * the start marker.                                                                                                                                                         
                             50:     */                                                                                                                                                                          
                             51:    private static final int START_MARKER = 0x80;                                                                                                                                
                             52:                                                                                                                                                                                 
                             53:    /**                                                                                                                                                                          
                             54:     * the ascii marker.                                                                                                                                                         
                             55:     */                                                                                                                                                                          
                             56:    private static final int ASCII_MARKER = 0x01;                                                                                                                                
                             57:                                                                                                                                                                                 
                             58:    /**                                                                                                                                                                          
                             59:     * the binary marker.                                                                                                                                                        
                             60:     */                                                                                                                                                                          
                             61:    private static final int BINARY_MARKER = 0x02;                                                                                                                               
                             62:                                                                                                                                                                                 
                             63:    /**                                                                                                                                                                          
                             64:     * the EOF marker.                                                                                                                                                           
                             65:     */                                                                                                                                                                          
                             66:    private static final int EOF_MARKER = 0x03;                                                                                                                                  
                             67:                                                                                                                                                                                 
                             68:    /**                                                                                                                                                                          
                             69:     * Heuristically chosen max length to buffer a Type1 font                                                                                                                    
                             70:     */                                                                                                                                                                          
                             71:    private static final long MAX_LENGTH = 100_000_000;                                                                                                                          
                             72:                                                                                                                                                                                 
                             73:    /**                                                                                                                                                                          
                             74:     * the parsed pfb-data.                                                                                                                                                      
                             75:     */                                                                                                                                                                          
                             76:    private byte[] pfbdata;                                                                                                                                                      
                             77:                                                                                                                                                                                 
                             78:    /**                                                                                                                                                                          
                             79:     * the lengths of the records (ASCII, BINARY, ASCII)                                                                                                                         
                             80:     */                                                                                                                                                                          
                             81:    private final int[] lengths = new int[3];                                                                                                                                    
                             82:                                                                                                                                                                                 
                             83:    // sample (pfb-file)                                                                                                                                                         
                             84:    // 00000000 80 01 8b 15  00 00 25 21  50 53 2d 41  64 6f 62 65                                                                                                               
                             85:    //          ......%!PS-Adobe                                                                                                                                                 
                             86:                                                                                                                                                                                 
                             87:                                                                                                                                                                                 
                             88:    /**                                                                                                                                                                          
                             89:     * Create a new object.                                                                                                                                                      
                             90:     * @param filename  the file name                                                                                                                                            
                             91:     * @throws IOException if an IO-error occurs.                                                                                                                                
                             92:     */                                                                                                                                                                          
                             93:    public PfbParser(final String filename) throws IOException                                                                                                                   
                             94:    {                                                                                                                                                                            
                             95:        this(Files.readAllBytes(Paths.get(filename)));                                                                                                                           
                             96:    }                                                                                                                                                                            
                             97:                                                                                                                                                                                 
                             98:    /**                                                                                                                                                                          
                             99:     * Create a new object.                                                                                                                                                      
                             100:     * @param in   The input.                                                                                                                                                   
                             101:     * @throws IOException if an IO-error occurs.                                                                                                                               
                             102:     */                                                                                                                                                                         
                             103:    public PfbParser(final InputStream in) throws IOException                                                                                                                   
                             104:    {                                                                                                                                                                           
                             105:        byte[] pfb = in.readAllBytes();                                                                                                                                         
                             106:        parsePfb(pfb);                                                                                                                                                          
                             107:    }                                                                                                                                                                           
                             108:                                                                                                                                                                                
                             109:    /**                                                                                                                                                                         
                             110:     * Create a new object.                                                                                                                                                     
                             111:     * @param bytes   The input.                                                                                                                                                
                             112:     * @throws IOException if an IO-error occurs.                                                                                                                               
                             113:     */                                                                                                                                                                         
                             114:    public PfbParser(final byte[] bytes) throws IOException                                                                                                                     
                             115:    {                                                                                                                                                                           
                             116:        parsePfb(bytes);                                                                                                                                                        
                             117:    }                                                                                                                                                                           
                             118:                                                                                                                                                                                
                             119:    /**                                                                                                                                                                         
                             120:     * Parse the pfb-array.                                                                                                                                                     
                             121:     * @param pfb   The pfb-Array                                                                                                                                               
                             122:     * @throws IOException in an IO-error occurs.                                                                                                                               
                             123:     */                                                                                                                                                                         
                             124:    private void parsePfb(final byte[] pfb) throws IOException                                                                                                                  
                             125:    {                                                                                                                                                                           
                             126:        if (pfb.length < PFB_HEADER_LENGTH)                                                                                                                                     
                             127:        {                                                                                                                                                                       
                             128:            throw new IOException("PFB header missing");                                                                                                                        
                             129:        }                                                                                                                                                                       
                             130:        // read into segments and keep them                                                                                                                                     
                             131:        List<Integer> typeList = new ArrayList<>(3);                                                                                                                            
                             132:        List<byte[]> barrList = new ArrayList<>(3);                                                                                                                             
                             133:        ByteArrayInputStream in = new ByteArrayInputStream(pfb);                                                                                                                
                             134:        int total = 0;                                                                                                                                                          
                             135:        do                                                                                                                                                                      
                             136:        {                                                                                                                                                                       
                             137:            int r = in.read();                                                                                                                                                  
                             138:            if (r == -1 && total > 0)                                                                                                                                           
                             139:            {                                                                                                                                                                   
                             140:                break; // EOF                                                                                                                                                   
                             141:            }                                                                                                                                                                   
                             142:            if (r != START_MARKER)                                                                                                                                              
                             143:            {                                                                                                                                                                   
                             144:                throw new IOException("Start marker missing");                                                                                                                  
                             145:            }                                                                                                                                                                   
                             146:            int recordType = in.read();                                                                                                                                         
                             147:            if (recordType == EOF_MARKER)                                                                                                                                       
                             148:            {                                                                                                                                                                   
                             149:                break;                                                                                                                                                          
                             150:            }                                                                                                                                                                   
                             151:            if (recordType != ASCII_MARKER && recordType != BINARY_MARKER)                                                                                                      
                             152:            {                                                                                                                                                                   
                             153:                throw new IOException("Incorrect record type: " + recordType);                                                                                                  
                             154:            }                                                                                                                                                                   
                             155:                                                                                                                                                                                
                             156:            int size = in.read();                                                                                                                                               
                             157:            size += in.read() << 8;                                                                                                                                             
                             158:            size += in.read() << 16;                                                                                                                                            
                             159:            size += in.read() << 24;                                                                                                                                            
                             160:            LOG.debug("record type: {}, segment size: {}", recordType, size);                                                                                                   
                             161:            long newTotal = total + size;                                                                                                                                       
                             162:            if (newTotal > MAX_LENGTH) {                                                                                                                                        
                             163:                throw new IOException("record size would be too large: " + newTotal);                                                                                           
                             164:            }                                                                                                                                                                   
                             165:                                                                                                                                                                                
                             166:            byte[] ar = new byte[size];                                                                                                                                         
                             167:            int got = in.read(ar);                                                                                                                                              
                             168:            if (got != size)                                                                                                                                                    
                             169:            {                                                                                                                                                                   
                             170:                throw new EOFException("EOF while reading PFB font");                                                                                                           
                             171:            }                                                                                                                                                                   
                             172:            total += size;                                                                                                                                                      
                             173:            typeList.add(recordType);                                                                                                                                           
                             174:            barrList.add(ar);                                                                                                                                                   
                             175:        }                                                                                                                                                                       
                             176:        while (true);                                                                                                                                                           
                             177:                                                                                                                                                                                
                             178:        // We now have ASCII and binary segments. Lets arrange these so that the ASCII segments                                                                                 
                             179:        // come first, then the binary segments, then the last ASCII segment if it is                                                                                           
                             180:        // 0000... cleartomark                                                                                                                                                  
                             181:                                                                                                                                                                                
                             182:        pfbdata = new byte[total];                                                                                                                                              
                             183:        byte[] cleartomarkSegment = null;                                                                                                                                       
                             184:        int dstPos = 0;                                                                                                                                                         
                             185:                                                                                                                                                                                
                             186:        // copy the ASCII segments                                                                                                                                              
                             187:        for (int i = 0; i < typeList.size(); ++i)                                                                                                                               
                             188:        {                                                                                                                                                                       
                             189:            if (typeList.get(i) != ASCII_MARKER)                                                                                                                                
                             190:            {                                                                                                                                                                   
                             191:                continue;                                                                                                                                                       
                             192:            }                                                                                                                                                                   
                             193:            byte[] ar = barrList.get(i);                                                                                                                                        
                             194:            if (i == typeList.size() - 1 && ar.length < 600 && new String(ar).contains("cleartomark"))                                                                          
                             195:            {                                                                                                                                                                   
                             196:                cleartomarkSegment = ar;                                                                                                                                        
                             197:                continue;                                                                                                                                                       
                             198:            }                                                                                                                                                                   
                             199:            System.arraycopy(ar, 0, pfbdata, dstPos, ar.length);                                                                                                                
                             200:            dstPos += ar.length;                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:636-645                                                                                                             
                             ```                                                                                                                                                                                 
                             636:                                                                                                                                                                                
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                                                                                                       
                             638:        // sometimes followed by "put". Either way, we just skip until                                                                                                          
                             639:        // the /CharStrings dict is found                                                                                                                                       
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                                                                                                  
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                                                                                                          
                             642:        {                                                                                                                                                                       
                             643:            lexer.nextToken();                                                                                                                                                  
                             644:        }                                                                                                                                                                       
                             645:                                                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-200                                                                                                                
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                                                                                                     
                             3: * or more contributor license agreements.  See the NOTICE file                                                                                                                   
                             4: * distributed with this work for additional information                                                                                                                          
                             5: * regarding copyright ownership.  The ASF licenses this file                                                                                                                     
                             6: * to you under the Apache License, Version 2.0 (the                                                                                                                              
                             7: * "License"); you may not use this file except in compliance                                                                                                                     
                             8: * with the License.  You may obtain a copy of the License at                                                                                                                     
                             9: *                                                                                                                                                                                
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                    
                             11: *                                                                                                                                                                               
                             12: * Unless required by applicable law or agreed to in writing,                                                                                                                    
                             13: * software distributed under the License is distributed on an                                                                                                                   
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                                                                                                        
                             15: * KIND, either express or implied.  See the License for the                                                                                                                     
                             16: * specific language governing permissions and limitations                                                                                                                       
                             17: * under the License.                                                                                                                                                            
                             18: */                                                                                                                                                                              
                             19:                                                                                                                                                                                 
                             20:package org.apache.fontbox.type1;                                                                                                                                                
                             21:                                                                                                                                                                                 
                             22:import java.io.IOException;                                                                                                                                                      
                             23:import java.nio.BufferUnderflowException;                                                                                                                                        
                             24:import java.nio.ByteBuffer;                                                                                                                                                      
                             25:import org.apache.logging.log4j.Logger;                                                                                                                                          
                             26:import org.apache.logging.log4j.LogManager;                                                                                                                                      
                             27:/**                                                                                                                                                                              
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                                                                                                         
                             29: *                                                                                                                                                                               
                             30: * @see Type1Parser                                                                                                                                                              
                             31: *                                                                                                                                                                               
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                                                                                                            
                             33: * somewhat awkward lexical structure. It is neither regular nor                                                                                                                 
                             34: * context-free, and the execution of the program can modify the                                                                                                                 
                             35: * the behaviour of the lexer/parser.                                                                                                                                            
                             36: *                                                                                                                                                                               
                             37: * Nevertheless, this class represents an attempt to artificially separate                                                                                                       
                             38: * the PostScript parsing process into separate lexing and parsing phases                                                                                                        
                             39: * in order to reduce the complexity of the parsing phase.                                                                                                                       
                             40: *                                                                                                                                                                               
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                                                                                             
                             42: *                                                                                                                                                                               
                             43: * @author John Hewson                                                                                                                                                           
                             44: */                                                                                                                                                                              
                             45:class Type1Lexer                                                                                                                                                                 
                             46:{                                                                                                                                                                                
                             47:    /**                                                                                                                                                                          
                             48:     * Log instance.                                                                                                                                                             
                             49:     */                                                                                                                                                                          
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                                                                                                    
                             51:                                                                                                                                                                                 
                             52:    private final ByteBuffer buffer;                                                                                                                                             
                             53:    private Token aheadToken;                                                                                                                                                    
                             54:    private int openParens = 0;                                                                                                                                                  
                             55:                                                                                                                                                                                 
                             56:    /**                                                                                                                                                                          
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                                                                                             
                             58:     * @param bytes Header-less .pfb segment                                                                                                                                     
                             59:     * @throws IOException                                                                                                                                                       
                             60:     */                                                                                                                                                                          
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                                                                                                  
                             62:    {                                                                                                                                                                            
                             63:        buffer = ByteBuffer.wrap(bytes);                                                                                                                                         
                             64:        aheadToken = readToken(null);                                                                                                                                            
                             65:    }                                                                                                                                                                            
                             66:                                                                                                                                                                                 
                             67:    /**                                                                                                                                                                          
                             68:     * Returns the next token and consumes it.                                                                                                                                   
                             69:     * @return The next token.                                                                                                                                                   
                             70:     */                                                                                                                                                                          
                             71:    public Token nextToken() throws IOException                                                                                                                                  
                             72:    {                                                                                                                                                                            
                             73:        Token curToken = aheadToken;                                                                                                                                             
                             74:        //System.out.println(curToken); // for debugging                                                                                                                         
                             75:        aheadToken = readToken(curToken);                                                                                                                                        
                             76:        return curToken;                                                                                                                                                         
                             77:    }                                                                                                                                                                            
                             78:                                                                                                                                                                                 
                             79:    /**                                                                                                                                                                          
                             80:     * Returns the next token without consuming it.                                                                                                                              
                             81:     * @return The next token                                                                                                                                                    
                             82:     */                                                                                                                                                                          
                             83:    public Token peekToken()                                                                                                                                                     
                             84:    {                                                                                                                                                                            
                             85:        return aheadToken;                                                                                                                                                       
                             86:    }                                                                                                                                                                            
                             87:                                                                                                                                                                                 
                             88:    /**                                                                                                                                                                          
                             89:     * Checks if the kind of the next token equals the given one without consuming it.                                                                                           
                             90:     *                                                                                                                                                                           
                             91:     * @return true if the kind of the next token equals the given one                                                                                                           
                             92:     */                                                                                                                                                                          
                             93:    public boolean peekKind(Token.Kind kind)                                                                                                                                     
                             94:    {                                                                                                                                                                            
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                                                                                               
                             96:    }                                                                                                                                                                            
                             97:                                                                                                                                                                                 
                             98:    /**                                                                                                                                                                          
                             99:     * Reads an ASCII char from the buffer.                                                                                                                                      
                             100:     */                                                                                                                                                                         
                             101:    private char getChar() throws IOException                                                                                                                                   
                             102:    {                                                                                                                                                                           
                             103:        try                                                                                                                                                                     
                             104:        {                                                                                                                                                                       
                             105:            return (char) buffer.get();                                                                                                                                         
                             106:        }                                                                                                                                                                       
                             107:        catch (BufferUnderflowException exception)                                                                                                                              
                             108:        {                                                                                                                                                                       
                             109:            throw new IOException("Premature end of buffer reached");                                                                                                           
                             110:        }                                                                                                                                                                       
                             111:    }                                                                                                                                                                           
                             112:                                                                                                                                                                                
                             113:    /**                                                                                                                                                                         
                             114:     * Reads a single token.                                                                                                                                                    
                             115:     * @param prevToken the previous token                                                                                                                                      
                             116:     */                                                                                                                                                                         
                             117:    private Token readToken(Token prevToken) throws IOException                                                                                                                 
                             118:    {                                                                                                                                                                           
                             119:        boolean skip;                                                                                                                                                           
                             120:        do                                                                                                                                                                      
                             121:        {                                                                                                                                                                       
                             122:            skip = false;                                                                                                                                                       
                             123:            while (buffer.hasRemaining())                                                                                                                                       
                             124:            {                                                                                                                                                                   
                             125:                char c = getChar();                                                                                                                                             
                             126:                                                                                                                                                                                
                             127:                // delimiters                                                                                                                                                   
                             128:                if (c == '%')                                                                                                                                                   
                             129:                {                                                                                                                                                               
                             130:                    // comment                                                                                                                                                  
                             131:                    readComment();                                                                                                                                              
                             132:                }                                                                                                                                                               
                             133:                else if (c == '(')                                                                                                                                              
                             134:                {                                                                                                                                                               
                             135:                    return readString();                                                                                                                                        
                             136:                }                                                                                                                                                               
                             137:                else if (c == ')')                                                                                                                                              
                             138:                {                                                                                                                                                               
                             139:                    // not allowed outside a string context                                                                                                                     
                             140:                    throw new IOException("unexpected closing parenthesis");                                                                                                    
                             141:                }                                                                                                                                                               
                             142:                else if (c == '[')                                                                                                                                              
                             143:                {                                                                                                                                                               
                             144:                    return new Token(c, Token.START_ARRAY);                                                                                                                     
                             145:                }                                                                                                                                                               
                             146:                else if (c == '{')                                                                                                                                              
                             147:                {                                                                                                                                                               
                             148:                    return new Token(c, Token.START_PROC);                                                                                                                      
                             149:                }                                                                                                                                                               
                             150:                else if (c == ']')                                                                                                                                              
                             151:                {                                                                                                                                                               
                             152:                    return new Token(c, Token.END_ARRAY);                                                                                                                       
                             153:                }                                                                                                                                                               
                             154:                else if (c == '}')                                                                                                                                              
                             155:                {                                                                                                                                                               
                             156:                    return new Token(c, Token.END_PROC);                                                                                                                        
                             157:                }                                                                                                                                                               
                             158:                else if (c == '/')                                                                                                                                              
                             159:                {                                                                                                                                                               
                             160:                    String regular = readRegular();                                                                                                                             
                             161:                    if (regular == null)                                                                                                                                        
                             162:                    {                                                                                                                                                           
                             163:                        // the stream is corrupt                                                                                                                                
                             164:                        throw new DamagedFontException("Could not read token at position " +                                                                                    
                             165:                                                        buffer.position());                                                                                                     
                             166:                    }                                                                                                                                                           
                             167:                    return new Token(regular, Token.LITERAL);                                                                                                                   
                             168:                }                                                                                                                                                               
                             169:                else if (c == '<')                                                                                                                                              
                             170:                {                                                                                                                                                               
                             171:                    char c2 = getChar();                                                                                                                                        
                             172:                    if (c2 == c)                                                                                                                                                
                             173:                    {                                                                                                                                                           
                             174:                        return new Token("<<", Token.START_DICT);                                                                                                               
                             175:                    }                                                                                                                                                           
                             176:                    else                                                                                                                                                        
                             177:                    {                                                                                                                                                           
                             178:                        // code may have to be changed in something better, maybe new token type                                                                                
                             179:                        buffer.position(buffer.position() - 1);                                                                                                                 
                             180:                        return new Token(c, Token.NAME);                                                                                                                        
                             181:                    }                                                                                                                                                           
                             182:                }                                                                                                                                                               
                             183:                else if (c == '>')                                                                                                                                              
                             184:                {                                                                                                                                                               
                             185:                    char c2 = getChar();                                                                                                                                        
                             186:                    if (c2 == c)                                                                                                                                                
                             187:                    {                                                                                                                                                           
                             188:                        return new Token(">>", Token.END_DICT);                                                                                                                 
                             189:                    }                                                                                                                                                           
                             190:                    else                                                                                                                                                        
                             191:                    {                                                                                                                                                           
                             192:                        // code may have to be changed in something better, maybe new token type                                                                                
                             193:                        buffer.position(buffer.position() - 1);                                                                                                                 
                             194:                        return new Token(c, Token.NAME);                                                                                                                        
                             195:                    }                                                                                                                                                           
                             196:                }                                                                                                                                                               
                             197:                else if (Character.isWhitespace(c))                                                                                                                             
                             198:                {                                                                                                                                                               
                             199:                    skip = true;                                                                                                                                                
                             200:                }                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:541-649                                                                                                             
                             ```                                                                                                                                                                                 
                             541:    private void parseBinary(byte[] bytes) throws IOException                                                                                                                   
                             542:    {                                                                                                                                                                           
                             543:        byte[] decrypted;                                                                                                                                                       
                             544:        // Sometimes, fonts use the hex format, so this needs to be converted before decryption                                                                                 
                             545:        if (isBinary(bytes))                                                                                                                                                    
                             546:        {                                                                                                                                                                       
                             547:            decrypted = decrypt(bytes, EEXEC_KEY, 4);                                                                                                                           
                             548:        }                                                                                                                                                                       
                             549:        else                                                                                                                                                                    
                             550:        {                                                                                                                                                                       
                             551:            decrypted = decrypt(hexToBinary(bytes), EEXEC_KEY, 4);                                                                                                              
                             552:        }                                                                                                                                                                       
                             553:        lexer = new Type1Lexer(decrypted);                                                                                                                                      
                             554:                                                                                                                                                                                
                             555:        // find /Private dict                                                                                                                                                   
                             556:        Token peekToken = lexer.peekToken();                                                                                                                                    
                             557:        while (peekToken != null && !"Private".equals(peekToken.getText()))                                                                                                     
                             558:        {                                                                                                                                                                       
                             559:            // for a more thorough validation, the presence of "begin" before Private                                                                                           
                             560:            // determines how code before and following charstrings should look                                                                                                 
                             561:            // it is not currently checked anyway                                                                                                                               
                             562:            lexer.nextToken();                                                                                                                                                  
                             563:            peekToken = lexer.peekToken();                                                                                                                                      
                             564:        }                                                                                                                                                                       
                             565:        if (peekToken == null)                                                                                                                                                  
                             566:        {                                                                                                                                                                       
                             567:            throw new IOException("/Private token not found");                                                                                                                  
                             568:        }                                                                                                                                                                       
                             569:                                                                                                                                                                                
                             570:        // Private dict                                                                                                                                                         
                             571:        read(Token.LITERAL, "Private");                                                                                                                                         
                             572:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             573:        read(Token.NAME, "dict");                                                                                                                                               
                             574:        // actually could also be "/Private 10 dict def Private begin"                                                                                                          
                             575:        // instead of the "dup"                                                                                                                                                 
                             576:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             577:        read(Token.NAME, "begin");                                                                                                                                              
                             578:                                                                                                                                                                                
                             579:        int lenIV = 4; // number of random bytes at start of charstring                                                                                                         
                             580:                                                                                                                                                                                
                             581:        for (int i = 0; i < length; i++)                                                                                                                                        
                             582:        {                                                                                                                                                                       
                             583:            // premature end                                                                                                                                                    
                             584:            if (!lexer.peekKind(Token.LITERAL))                                                                                                                                 
                             585:            {                                                                                                                                                                   
                             586:                break;                                                                                                                                                          
                             587:            }                                                                                                                                                                   
                             588:                                                                                                                                                                                
                             589:            // key/value                                                                                                                                                        
                             590:            String key = read(Token.LITERAL).getText();                                                                                                                         
                             591:                                                                                                                                                                                
                             592:            switch (key)                                                                                                                                                        
                             593:            {                                                                                                                                                                   
                             594:                case "Subrs":                                                                                                                                                   
                             595:                    readSubrs(lenIV);                                                                                                                                           
                             596:                    break;                                                                                                                                                      
                             597:                case "OtherSubrs":                                                                                                                                              
                             598:                    readOtherSubrs();                                                                                                                                           
                             599:                    break;                                                                                                                                                      
                             600:                case "lenIV":                                                                                                                                                   
                             601:                    lenIV = readDictValue().get(0).intValue();                                                                                                                  
                             602:                    break;                                                                                                                                                      
                             603:                case "ND":                                                                                                                                                      
                             604:                    read(Token.START_PROC);                                                                                                                                     
                             605:                    // the access restrictions are not mandatory                                                                                                                
                             606:                    readMaybe(Token.NAME, "noaccess");                                                                                                                          
                             607:                    read(Token.NAME, "def");                                                                                                                                    
                             608:                    read(Token.END_PROC);                                                                                                                                       
                             609:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             610:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             611:                    read(Token.NAME, "def");                                                                                                                                    
                             612:                    break;                                                                                                                                                      
                             613:                case "NP":                                                                                                                                                      
                             614:                    read(Token.START_PROC);                                                                                                                                     
                             615:                    readMaybe(Token.NAME, "noaccess");                                                                                                                          
                             616:                    read(Token.NAME);                                                                                                                                           
                             617:                    read(Token.END_PROC);                                                                                                                                       
                             618:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             619:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             620:                    read(Token.NAME, "def");                                                                                                                                    
                             621:                    break;                                                                                                                                                      
                             622:                case "RD":                                                                                                                                                      
                             623:                    // /RD {string currentfile exch readstring pop} bind executeonly def                                                                                        
                             624:                    read(Token.START_PROC);                                                                                                                                     
                             625:                    readProcVoid();                                                                                                                                             
                             626:                    readMaybe(Token.NAME, "bind");                                                                                                                              
                             627:                    readMaybe(Token.NAME, "executeonly");                                                                                                                       
                             628:                    readMaybe(Token.NAME, "readonly");                                                                                                                          
                             629:                    read(Token.NAME, "def");                                                                                                                                    
                             630:                    break;                                                                                                                                                      
                             631:                default:                                                                                                                                                        
                             632:                    readPrivate(key, readDictValue());                                                                                                                          
                             633:                    break;                                                                                                                                                      
                             634:            }                                                                                                                                                                   
                             635:        }                                                                                                                                                                       
                             636:                                                                                                                                                                                
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                                                                                                       
                             638:        // sometimes followed by "put". Either way, we just skip until                                                                                                          
                             639:        // the /CharStrings dict is found                                                                                                                                       
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                                                                                                  
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                                                                                                          
                             642:        {                                                                                                                                                                       
                             643:            lexer.nextToken();                                                                                                                                                  
                             644:        }                                                                                                                                                                       
                             645:                                                                                                                                                                                
                             646:        // CharStrings dict                                                                                                                                                     
                             647:        read(Token.LITERAL, "CharStrings");                                                                                                                                     
                             648:        readCharStrings(lenIV);                                                                                                                                                 
                             649:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:636-645                                                                                                             
                             ```                                                                                                                                                                                 
                             636:                                                                                                                                                                                
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                                                                                                       
                             638:        // sometimes followed by "put". Either way, we just skip until                                                                                                          
                             639:        // the /CharStrings dict is found                                                                                                                                       
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                                                                                                  
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                                                                                                          
                             642:        {                                                                                                                                                                       
                             643:            lexer.nextToken();                                                                                                                                                  
                             644:        }                                                                                                                                                                       
                             645:                                                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:777-813                                                                                                             
                             ```                                                                                                                                                                                 
                             777:    private void readCharStrings(int lenIV) throws IOException                                                                                                                  
                             778:    {                                                                                                                                                                           
                             779:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             780:        read(Token.NAME, "dict");                                                                                                                                               
                             781:        // could actually be a sequence ending in "CharStrings begin", too                                                                                                      
                             782:        // instead of the "dup begin"                                                                                                                                           
                             783:        read(Token.NAME, "dup");                                                                                                                                                
                             784:        read(Token.NAME, "begin");                                                                                                                                              
                             785:                                                                                                                                                                                
                             786:        for (int i = 0; i < length; i++)                                                                                                                                        
                             787:        {                                                                                                                                                                       
                             788:            // premature end                                                                                                                                                    
                             789:            if (lexer.peekToken() == null)                                                                                                                                      
                             790:            {                                                                                                                                                                   
                             791:                break;                                                                                                                                                          
                             792:            }                                                                                                                                                                   
                             793:            if (lexer.peekKind(Token.NAME) &&                                                                                                                                   
                             794:                lexer.peekToken().getText().equals("end"))                                                                                                                      
                             795:            {                                                                                                                                                                   
                             796:                break;                                                                                                                                                          
                             797:            }                                                                                                                                                                   
                             798:            // key/value                                                                                                                                                        
                             799:            String name = read(Token.LITERAL).getText();                                                                                                                        
                             800:                                                                                                                                                                                
                             801:            // RD                                                                                                                                                               
                             802:            read(Token.INTEGER);                                                                                                                                                
                             803:            Token charstring = read(Token.CHARSTRING);                                                                                                                          
                             804:            font.charstrings.put(name, decrypt(charstring.getData(), CHARSTRING_KEY, lenIV));                                                                                   
                             805:            readDef();                                                                                                                                                          
                             806:        }                                                                                                                                                                       
                             807:                                                                                                                                                                                
                             808:        // some fonts have one "end", others two                                                                                                                                
                             809:        read(Token.NAME, "end");                                                                                                                                                
                             810:        // since checking ends here, this does not matter ....                                                                                                                  
                             811:        // more thorough checking would see whether there is "begin" before /Private                                                                                            
                             812:        // and expect a "def" somewhere, otherwise a "put"                                                                                                                      
                             813:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             To prevent malicious or malformed Type 1 fonts from causing unbounded loops and denialofservice timeouts, we will apply targeted bounds checks and EOF guards                     
                             within the FontBox Type1Parser and supporting classes while preserving existing parsing logic for wellformed fonts.                                                                
                                                                                                                                                                                                                 
                             1. Enforce an EOF check in the skip-ahead loop for CharStrings                                                                                                                    
                                In parseBinary, replace the unbounded:                                                                                                                                           
                                  while (!(lexer.peekKind(LITERAL) && CharStrings.equals(lexer.peekToken().getText()))) {                                                                                      
                                      lexer.nextToken();                                                                                                                                                         
                                  }                                                                                                                                                                              
                                with a loop that bails out on endofstream:                                                                                                                                     
                                  Token peek;                                                                                                                                                                    
                                  while ((peek = lexer.peekToken()) != null) {                                                                                                                                   
                                      if (peek.getKind() == Token.LITERAL                                                                                                                                        
                                          && "CharStrings".equals(peek.getText())) {                                                                                                                             
                                          break;                                                                                                                                                                 
                                      }                                                                                                                                                                          
                                      lexer.nextToken();                                                                                                                                                         
                                  }                                                                                                                                                                              
                                  if (peek == null) {                                                                                                                                                            
                                      throw new IOException("/CharStrings token not found");                                                                                                                     
                                  }                                                                                                                                                                              
                                This change stops infinite busywaiting when EOF is reached.                                                                                                                     
                                                                                                                                                                                                                 
                             2. Cap the number of CharStrings entries                                                                                                                                            
                                In readCharStrings(int lenIV), immediately after reading the declared glyph count:                                                                                               
                                  int length = read(Token.INTEGER).intValue();                                                                                                                                   
                                  if (length < 0 || length > MAX_CHARSTRING_COUNT) {                                                                                                                             
                                      throw new IOException("Invalid CharStrings count: " + length);                                                                                                             
                                  }                                                                                                                                                                              
                                where MAX_CHARSTRING_COUNT is a new private constant (e.g., 100_000). This prevents extremely large or negative counts from driving a long or infinite loop.                     
                                                                                                                                                                                                                 
                             3. Cap the number of Subroutines                                                                                                                                                    
                                Similarly, in readSubrs(int lenIV):                                                                                                                                              
                                  int length = read(Token.INTEGER).intValue();                                                                                                                                   
                                  if (length < 0 || length > MAX_SUBR_COUNT) {                                                                                                                                   
                                      throw new IOException("Invalid Subrs count: " + length);                                                                                                                   
                                  }                                                                                                                                                                              
                                using MAX_SUBR_COUNT (e.g., 10_000). This bounds the work in Subrs parsing.                                                                                                      
                                                                                                                                                                                                                 
                             4. (Optional but recommended) Limit binary segment size before decryption                                                                                                           
                                In parseBinary(byte[] bytes), at the top:                                                                                                                                        
                                  if (bytes.length > MAX_EEXEC_SEGMENT_SIZE) {                                                                                                                                   
                                      throw new IOException("Binary segment too large: " + bytes.length);                                                                                                        
                                  }                                                                                                                                                                              
                                with MAX_EEXEC_SEGMENT_SIZE set to a reasonable ceiling (e.g., 50 MB). This avoids excessive memory or CPU work on decryption and lexing.                                        
                                                                                                                                                                                                                 
                             Implementation Steps                                                                                                                                                                
                             1. In Type1Parser, define new private static constants:                                                                                                                             
                                  private static final int MAX_CHARSTRING_COUNT = 100_000;                                                                                                                       
                                  private static final int MAX_SUBR_COUNT = 10_000;                                                                                                                              
                                  private static final int MAX_EEXEC_SEGMENT_SIZE = 50 * 1024 * 1024;                                                                                                            
                             2. In parseBinary(byte[] bytes):                                                                                                                                                    
                                a) Insert the bytes.length check before calling decrypt(...).                                                                                                                    
                                b) Replace the skip-ahead while (lines ~636645) with the EOF-guarded variant above.                                                                                           
                             3. In readCharStrings (lines ~779):                                                                                                                                                 
                                a) After int length = read().intValue(), add the range check and throw IOException if out of bounds.                                                                            
                             4. In readSubrs (lines ~709):                                                                                                                                                       
                                a) After reading length, add the same style range check against MAX_SUBR_COUNT.                                                                                                  
                             5. Add unit tests using known good fonts to confirm no regression.                                                                                                                  
                                                                                                                                                                                                                 
                             Why this works                                                                                                                                                                      
                              The EOF guard ensures that malformed or truncated CharStrings sections cannot spin endlessly.                                                                                     
                              The length caps prevent attackercontrollable counts from triggering long loops in readCharStrings and readSubrs.                                                                 
                              The optional segment-size check stops oversized binary data before heavy decryption and lexing.                                                                                   
                              All existing happy-path logic stays intact, and legitimate fonts with reasonable glyph/subr counts continue to parse.                                                             
                                                                                                                                                                                                                 
                             Potential Side Effects & Mitigations                                                                                                                                                
                              Very large but valid fonts (e.g., >100 K glyphs) could be rejected. If needed, MAX_* constants can be tuned upward.                                                               
                              The new IOException aborts parsing earlier; callers (e.g., PDFBox) will surface an Invalid font error rather than hang. This is acceptable for                                  
                             fuzzing/hardening use cases.                                                                                                                                                        
                              No changes to harness or fuzz-driver code are required.                                                                                                                           
                             References in Codebase                                                                                                                                                              
                              PfbParser already uses a MAX_LENGTH ceiling when assembling segments; our MAX_EEXEC_SEGMENT_SIZE follows the same pattern but for the decrypted EEXEC stream.                     
                              Similar count checks do not exist elsewherethis approach parallels the existing PfbParser sizelimit logic.                                                                      
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Tests Result===                                                                                                                                                                  
                             No tests found                                                                                                                                                                      
                             ===Evaluation End===                                                                                                                                                                
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                                                      __init__.py:160
                             (n evals: 2, patch status: PatchStatus.SOUND)                                                                                                                                       
                    INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmp1mfzy76k                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_4/agent-output-1761508227.4109793                                                                        
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_4.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
