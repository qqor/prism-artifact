--- a/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java
+++ b/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java
@@ -85,6 +85,12 @@
         }
         if (basePath != null) {
             output = basePath.resolve(emitKey);
+            Path normalizedBase = basePath.toAbsolutePath().normalize();
+            Path normalizedOutput = output.toAbsolutePath().normalize();
+            if (!normalizedOutput.startsWith(normalizedBase)) {
+                throw new TikaEmitterException("FileSystemEmitter prevented writing outside base directory: " + emitKey);
+            }
+            output = normalizedOutput;
         } else {
             output = Paths.get(emitKey);
         }
@@ -145,6 +151,12 @@
     @Override
     public void emit(String path, InputStream inputStream, Metadata userMetadata, ParseContext parseContext) throws IOException, TikaEmitterException {
         Path target = basePath.resolve(path);
+        Path normalizedBase = basePath.toAbsolutePath().normalize();
+        Path normalizedTarget = target.toAbsolutePath().normalize();
+        if (!normalizedTarget.startsWith(normalizedBase)) {
+            throw new TikaEmitterException("FileSystemEmitter prevented writing outside base directory: " + path);
+        }
+        target = normalizedTarget;
 
         if (!Files.isDirectory(target.getParent())) {
             Files.createDirectories(target.getParent());
