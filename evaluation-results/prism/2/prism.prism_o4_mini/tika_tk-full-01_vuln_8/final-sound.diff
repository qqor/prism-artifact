--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -97,14 +97,21 @@
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
         Path tmpFile = tmpDir.resolve(fileName);
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
-        pb.directory(tmpDir.toFile());
-        try {
-            FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
-            if (result.getExitValue() == 0) {
-                metadata.set(SHELL_NO_ARGS, true);
+        // Only perform syntax check on Unix-like systems
+        String os = System.getProperty("os.name").toLowerCase(java.util.Locale.ROOT);
+        if (!os.contains("win")) {
+            ProcessBuilder pb = new ProcessBuilder("sh", "-n", fileName);
+            pb.directory(tmpDir.toFile());
+            try {
+                FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
+                if (result.getExitValue() == 0) {
+                    metadata.set(SHELL_NO_ARGS, true);
+                }
+            } finally {
+                FileUtils.deleteDirectory(tmpDir.toFile());
             }
-        } finally {
+        } else {
+            // Skip shell syntax check on Windows; do not execute untrusted script
             FileUtils.deleteDirectory(tmpDir.toFile());
         }
         return SHELL_SCRIPT;
