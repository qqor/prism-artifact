--- a/src/liblzma/check/treeck.c
+++ b/src/liblzma/check/treeck.c
@@ -83,11 +83,10 @@
       }
     }
     node->state = STATE_HASHED;
+    free(node->edges);
+    free(node);
+    return sum;
   }
-
-  // Free the node and edges
-  free(node->edges);
-  free(node);
 
   return sum;
 }
