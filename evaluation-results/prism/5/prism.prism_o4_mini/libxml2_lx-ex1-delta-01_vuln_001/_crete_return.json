{
  "project_name": "libxml2",
  "vulnerability_identifier": "libxml2_lx-ex1-delta-01_vuln_001",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-libxml2",
  "llm_usage": {
    "total_cost": 0.3728152999999999,
    "prompt_tokens": 202619,
    "completion_tokens": 34076
  },
  "variant": "sound",
  "diff": "--- a/HTMLparser.c\n+++ b/HTMLparser.c\n@@ -3331,12 +3331,16 @@\n     buffer_size = ctxt->spaceMax;\n     buffer = (xmlChar *) ctxt->spaceTab;\n     if (buffer == NULL) {\n-        buffer_size = 500;\n-        buffer = xmlMalloc(buffer_size + 1);\n+        /* initialize with a sufficiently large buffer, respecting maxLength */\n+        size_t initial = HTML_PARSER_BIG_BUFFER_SIZE;\n+        if (maxLength > 0 && (size_t)maxLength < initial)\n+            initial = (size_t)maxLength;\n+        buffer = (xmlChar *)xmlMalloc(initial + 1);\n         if (buffer == NULL) {\n             htmlErrMemory(ctxt);\n             return(NULL);\n         }\n+        buffer_size = initial;\n     }\n \n     line = input->line;\n",
  "stdout": "",
  "stderr": ""
}