[2;36m[12/24/25 02:39:02][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=572221;file:///home/qqor/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=85158;file:///home/qqor/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp7rzls329[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/aixcc/crete/reports/prism.prism_o4_mini/freerdp_fp-full-01_vuln_004/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1766511542.1219637[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/freerdp_fp-full-01_vuln_004.toml        [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/aixcc/crete/.cache/[0m[95mofficial-afc-freerdp[0m    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=889669;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=458412;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/24/25 02:39:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=941859;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=541415;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m22.63[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=258934;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=612104;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=791770;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=523559;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=171109;file:///home/qqor/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=618429;file:///home/qqor/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m22[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=584678;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=502280;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:39:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.53[0m seconds;               ]8;id=83098;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=136376;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 02:39:26][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=832429;file:///home/qqor/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=232948;file:///home/qqor/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=34627;file:///home/qqor/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=168787;file:///home/qqor/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=281056;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=439414;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=224460;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=449585;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:39:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.41[0m seconds;               ]8;id=774086;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=568108;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=958743;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=197194;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:39:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.57[0m seconds;               ]8;id=402341;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=692276;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 02:39:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=448530;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=60503;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x55c367348d91[0m bp [1;36m0x7ffceff00cd0[0m sp [1;36m0x7ffceff00cc8[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c367348d90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c367348d90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367348d90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c36734300b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c36728b2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c367062efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55c366ebd0b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55c366e8455d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c366fad099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c3672909b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367062ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ebd0b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x55c367348d91[0m bp [1;36m0x7ffceff00cd0[0m sp [1;36m0x7ffceff00cc8[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c367348d90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c367348d90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367348d90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c36734300b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c36728b2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c367062efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55c366ebd0b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55c366e8455d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c366fad099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c3672909b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367062ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ebd0b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 02:39:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=587248;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=236023;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 02:41:36][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=382872;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=340675;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 02:41:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=365498;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=516597;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=577859;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=622923;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:41:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.54[0m seconds;               ]8;id=513537;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=475732;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=187203;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=724532;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmps_s96eb7[0m                                                 ]8;id=834797;file:///home/qqor/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=89157;file:///home/qqor/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/24/25 02:42:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m21.86[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=617505;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=511411;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=999095;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=841403;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:42:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m14.62[0m seconds;             ]8;id=913073;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=25371;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=974064;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=325696;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:42:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m3.09[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=367209;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674628;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=52304;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=217873;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=238164;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=393381;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=201094;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=227897;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:42:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.50[0m seconds;               ]8;id=340963;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=733850;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 02:42:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=707173;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=457586;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 02:42:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.53[0m seconds;               ]8;id=645275;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=709266;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=427698;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=655389;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.50[0m seconds;               ]8;id=505971;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=636358;file:///home/qqor/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=706492;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=482834;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/core/mcs.h                                                         [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/core/mcs.h                                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-144[0m,[1;36m7[0m +[1;36m144[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                 BOOL globalChannelJoined;                                                   [2m                [0m
[2;36m                    [0m                 BOOL messageChannelJoined;                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       INT8 channelCount;                                                          [2m                [0m
[2;36m                    [0m         +       UINT8 channelCount;                                                         [2m                [0m
[2;36m                    [0m                 rdpMcsChannel* channels;                                                    [2m                [0m
[2;36m                    [0m          [1m}[0m;                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x55c367348d91[0m bp [1;36m0x7ffceff00cd0[0m sp [1;36m0x7ffceff00cc8[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c367348d90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c367348d90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367348d90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c36734300b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c36728b2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c367062efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55c366ebd0b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55c366e8455d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55c366fad099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55c3672909b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55c367062ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55c366fea785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55c366fea785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55c366ea1100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55c366e8c375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55c366e91e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55c366ebd0b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7f15ffa73082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         An AddressSanitizer report reveals an [1;36m8[0m-byte heap-buffer-overflow in FreeRDP’s      [2m                [0m
[2;36m                    [0m         data-reading logic. The overflow occurs when `Stream_Read` attempts to write beyond [2m                [0m
[2;36m                    [0m         the end of a [1;36m992[0m-byte heap allocation. The issue is detected during fuzz testing of [2m                [0m
[2;36m                    [0m         the server-side connection setup code.                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue Type                                                                        [2m                [0m
[2;36m                    [0m           A heap-buffer-overflow is reported by AddressSanitizer. An [1;36m8[0m-byte write lands     [2m                [0m
[2;36m                    [0m         immediately past a [1;36m992[0m-byte allocated buffer.                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Vulnerability Classification                                                      [2m                [0m
[2;36m                    [0m           This is a classic out-of-bounds write, a memory safety violation. Such overflows  [2m                [0m
[2;36m                    [0m         can lead to memory corruption, crashes, or potential code execution.                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Observation and Findings                                                          [2m                [0m
[2;36m                    [0m           • The overflow is triggered in `Stream_Read` [1m([0mwinpr/stream.h:[1;36m703[0m[1m)[0m, called by      [2m                [0m
[2;36m                    [0m         `gcc_read_client_network_data` [1m([0mlibfreerdp/core/gcc.[1;92mc:1875[0m[1m)[0m and propagating through [2m                [0m
[2;36m                    [0m         client data block parsing and conference create request handlers.                   [2m                [0m
[2;36m                    [0m           • The buffer in question was allocated by `mcs_new` [1m([0mlibfreerdp/core/mcs.[1;92mc:1446[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         via `calloc`, sized at [1;36m992[0m bytes.                                                   [2m                [0m
[2;36m                    [0m           • The write occurs at offset [1;36m992[0m [1m([0mthe first byte past the allocated block[1m)[0m when   [2m                [0m
[2;36m                    [0m         reading additional network data.                                                    [2m                [0m
[2;36m                    [0m           • The failure chain is exercised by the fuzzer entry point in                     [2m                [0m
[2;36m                    [0m         `TestFuzzCoreServer.c` [1m([0mlibfreerdp/core/test[1m)[0m, but the harness itself is not the    [2m                [0m
[2;36m                    [0m         root cause.                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Code Areas for Further Investigation                                              [2m                [0m
[2;36m                    [0m           [1;36m1[0m. **Stream Module** [1m([0mwinpr/stream.h[1m)[0m – verify bounds checks in `Stream_Read` and [2m                [0m
[2;36m                    [0m         related readers.                                                                    [2m                [0m
[2;36m                    [0m           [1;36m2[0m. **GCC Core Handlers** [1m([0mlibfreerdp/core/gcc.c[1m)[0m – review length calculations and [2m                [0m
[2;36m                    [0m         buffer usage in `gcc_read_client_network_data`, `gcc_read_client_data_blocks`, and  [2m                [0m
[2;36m                    [0m         `gcc_read_conference_create_request`.                                               [2m                [0m
[2;36m                    [0m           [1;36m3[0m. **MCS Layer** [1m([0mlibfreerdp/core/mcs.c[1m)[0m – examine buffer allocation size in      [2m                [0m
[2;36m                    [0m         `mcs_new` and ensure it matches expected read lengths.                              [2m                [0m
[2;36m                    [0m           [1;36m4[0m. **Connection Validation** [1m([0mlibfreerdp/core/freerdp.c[1m)[0m – inspect how MCS create [2m                [0m
[2;36m                    [0m         requests are validated and parsed in `freerdp_is_valid_mcs_create_request`.         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         By reviewing these modules together, developers can gain a complete view of where   [2m                [0m
[2;36m                    [0m         buffer sizes are determined, how incoming data lengths are computed, and where      [2m                [0m
[2;36m                    [0m         reads may exceed allocated memory.                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x519000001d60[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55c367348d91[0m[39m bp [0m[1;36m0x7ffceff00cd0[0m[39m sp [0m[1;36m0x7ffceff00cc8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m8[0m[39m at [0m[1;36m0x519000001d60[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c367348d90[0m[39m in Stream_Read [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c367348d90[0m[39m in gcc_read_client_network_data [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c367348d90[0m[39m in gcc_read_client_data_blocks [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c36734300b[0m[39m in gcc_read_conference_create_request [0m                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c36728b2ff[0m[39m in mcs_recv_connect_initial [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c367062efb[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c366fea785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55c366fea785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c366ea1100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55c366e8c375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55c366e91e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55c366ebd0b2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f15ffa73082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55c366e8455d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks[0m [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m992[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x519000001980[0m[39m,[0m[1;36m0x519000001d60[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55c366fad099[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55c3672909b6[0m[39m in mcs_new [0m[35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55c367062ee4[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55c366fea785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55c366fea785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55c366ea1100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55c366e8c375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55c366e91e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55c366ebd0b2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f15ffa73082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request[0m     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m[39m in Stream_Read[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/stream.h:[0m[1;36m650[0m[39m-[0m[1;36m750[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:#define [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m         \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u32_le[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:#define [0m[1;35mStream_Read_INT32[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m          \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i32_le[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:#define [0m[1;35mStream_Read_UINT32_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u32_be[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:#define [0m[1;35mStream_Read_INT32_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m       \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i32_be[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:#define [0m[1;35mStream_Read_UINT64[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m         \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u64_le[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:#define [0m[1;35mStream_Read_INT64[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m          \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i64_le[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:#define [0m[1;35mStream_Read_UINT64_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u64_be[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:#define [0m[1;35mStream_Read_INT64_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m       \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    [0m[39mdo                                     \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:    [0m[1;39m{[0m[39m                                      \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i64_be[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39mstatic INLINE void [0m[1;35mStream_Read[0m[1;39m([0m[39mwStream* _s, void* _b, size_t _n[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_b || [0m[1;39m([0m[39m_n == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[1;35mStream_GetRemainingCapacity[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m >= _n[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:    [0m[39m        [0m[1;35mmemcpy[0m[1;39m([0m[39m_b, [0m[1;39m([0m[39m_s->pointer[0m[1;39m)[0m[39m, [0m[1;39m([0m[39m_n[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39m_s, _n[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:#define [0m[1;35mStream_Peek_UINT8[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m       \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:    [0m[39mdo                                  \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:    [0m[1;39m{[0m[39m                                   \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u8[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:#define [0m[1;35mStream_Peek_INT8[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m        \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:    [0m[39mdo                                  \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:    [0m[1;39m{[0m[39m                                   \[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i8[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:#define [0m[1;35mStream_Peek_UINT16[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m          \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:    [0m[1;39m{[0m[39m                                       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u16_le[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:#define [0m[1;35mStream_Peek_INT16[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m           \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:    [0m[1;39m{[0m[39m                                       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i16_le[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:#define [0m[1;35mStream_Peek_UINT16_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:    [0m[1;39m{[0m[39m                                       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u16_be[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:#define [0m[1;35mStream_Peek_INT16_BE[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m        \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:    [0m[1;39m{[0m[39m                                       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_i16_be[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:#define [0m[1;35mStream_Peek_UINT32[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m          \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:    [0m[1;39m{[0m[39m                                       \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u32_le[0m[1;39m([0m[39m_s, FALSE[0m[1;39m)[0m[39m; \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:#define [0m[1;35mStream_Peek_INT32[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m           \[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:    [0m[39mdo                                      \[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:1420[0m[39m-[0m[1;36m1497[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1421[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m: * Instantiate new MCS module.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m: * @param transport transport[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m: * @return new MCS module[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1428[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1429[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mrdpMcs* mcs = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:   [0m[39mmcs = [0m[1;39m([0m[39mrdpMcs*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[39mmcs->transport = transport;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m[1;36m34[0m[39m, [0m[1;36m2[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->minimumParameters, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0x420[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->maximumParameters, [0m[1;36m0xFFFF[0m[39m, [0m[1;36m0xFC17[0m[39m, [0m[1;36m0xFFFF[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0xFFFF[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->domainParameters, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:   [0m[39mmcs->channelCount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:   [0m[39mmcs->baseChannelId = MCS_GLOBAL_CHANNEL_ID + [0m[1;36m1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:   [0m[39mmcs->channels = [0m[1;39m([0m[39mrdpMcsChannel*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[39mCHANNEL_MAX_COUNT, [0m                  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs->channels[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:   [0m[39m        [0m[39mgoto out_free;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:   [0m[39mreturn mcs;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:out_free:[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m: * Free MCS module.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m: * @param mcs MCS module to be freed[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:void [0m[1;35mmcs_free[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mmcs->channels[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1471:B[0m[39mOOL [0m[1;35mmcs_server_apply_to_settings[0m[1;39m([0m[39mconst rdpMcs* mcs, rdpSettings* settings[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_uint32[0m[1;39m([0m[39msettings, FreeRDP_ChannelCount, [0m           [2m                [0m
[2;36m                    [0m         [39mmcs->channelCount[0m[1;39m)[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 x = [0m[1;36m0[0m[39m; x < mcs->channelCount; x++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:   [0m[39m        [0m[39mconst rdpMcsChannel* current = &mcs->channels[0m[1;39m[[0m[39mx[0m[1;39m][0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39m        [0m[39mCHANNEL_DEF def = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39m        [0m[39mdef.options = current->options;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39m        [0m[1;35mmemcpy[0m[1;39m([0m[39mdef.name, current->Name, [0m[1;35msizeof[0m[1;39m([0m[39mdef.name[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_pointer_array[0m[1;39m([0m[39msettings, [0m                  [2m                [0m
[2;36m                    [0m         [39mFreeRDP_ChannelDefArray, x, &def[0m[1;39m)[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1492:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[39m        [0m[1;35mWLog_WARN[0m[1;39m([0m[39mTAG, [0m[32m"failed to apply settings"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1830[0m[39m-[0m[1;36m1900[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1830[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1831[0m[39m:   [0m[1;35mStream_SetPosition[0m[1;39m([0m[39ms, posCertLen[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1832[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlen <= UINT32_MAX[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1833[0m[39m:   [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, [0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[39mlen[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1834[0m[39m:   [0m[1;35mStream_SetPosition[0m[1;39m([0m[39ms, end[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1835[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1836[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1837[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1838[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1839[0m[39m: * Read a client network data block [0m[1;39m([0m[39mTS_UD_CS_NET[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1840[0m[39m: * msdn[0m[1;39m{[0m[39mcc240512[0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1841[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1842[0m[39m: * @param s stream[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1843[0m[39m: * @param mcs The MCS instance[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1844[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1845[0m[39m: * @return \b TRUE for success, \b FALSE otherwise[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1846[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1847[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1891[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1892[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1893[0m[39m: * Write a client network data block [0m[1;39m([0m[39mTS_UD_CS_NET[0m[1;39m)[0m[39m.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1894[0m[39m: * msdn[0m[1;39m{[0m[39mcc240512[0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1895[0m[39m: * @param s stream[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1896[0m[39m: * @param mcs The MCS to use[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1897[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1898[0m[39m: * @return \b TRUE for success, \b FALSE otherwise[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1899[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1900[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/freerdp.[0m[1;92mc:1400[0m[39m-[0m[1;36m1469[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1401[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1402[0m[39m:static rdpMcs* [0m[1;35mtest_mcs_new[0m[1;39m([0m[39mvoid[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1403[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1404[0m[39m:   [0m[39mrdpTransport* transport = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1405[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mfreerdp_settings_new[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1406[0m[39m:   [0m[39mrdpContext* context = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpContext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1407[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1408[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!settings[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1409[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_bool[0m[1;39m([0m[39msettings, FreeRDP_TransportDumpReplay, [0m      [2m                [0m
[2;36m                    [0m         [39mTRUE[0m[1;39m)[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1411[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1412[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1413[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1414[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1415[0m[39m:   [0m[39mcontext->settings = settings;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1416[0m[39m:   [0m[39mtransport = [0m[1;35mtransport_new[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1417[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!transport[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1418[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1419[0m[39m:   [0m[39mreturn [0m[1;35mmcs_new[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1421:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:   [0m[1;35mtransport_free[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:   [0m[1;35mfreerdp_settings_free[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1428[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1429:B[0m[39mOOL [0m[1;35mfreerdp_is_valid_mcs_create_request[0m[1;39m([0m[39mconst BYTE* data, size_t size[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:   [0m[39mwStream* s = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, data, size[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata || [0m[1;39m([0m[39msize == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:   [0m[39mrdpMcs* mcs = [0m[1;35mtest_mcs_new[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[39mBOOL result = [0m[1;35mmcs_recv_connect_initial[0m[1;39m([0m[39mmcs, s[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mtest_mcs_free[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1446:B[0m[39mOOL [0m[1;35mfreerdp_is_valid_mcs_create_response[0m[1;39m([0m[39mconst BYTE* data, size_t size[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:   [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:   [0m[39mwStream* s = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, data, size[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata || [0m[1;39m([0m[39msize == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:   [0m[39mrdpMcs* mcs = [0m[1;35mtest_mcs_new[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m:   [0m[39mBOOL result = [0m[1;35mmcs_recv_connect_response[0m[1;39m([0m[39mmcs, s[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m:   [0m[1;35mtest_mcs_free[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1463:B[0m[39mOOL [0m[1;35mfreerdp_persist_credentials[0m[1;39m([0m[39mrdpContext* context[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcontext->rdp[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:   [0m[39mreturn [0m[1;35mutils_persist_credentials[0m[1;39m([0m[39mcontext->rdp->originalSettings, [0m           [2m                [0m
[2;36m                    [0m         [39mcontext->rdp->settings[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m1[0m[39m-[0m[1;36m186[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * FreeRDP: A Remote Desktop Protocol Implementation[0m                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * T.[0m[1;36m125[0m[39m Multipoint Communication Service [0m[1;39m([0m[39mMCS[0m[1;39m)[0m[39m Protocol[0m                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * Copyright [0m[1;36m2011[0m[39m Marc-Andre Moreau <marcandre.moreau@gmail.com>[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * Copyright [0m[1;36m2015[0m[39m Thincast Technologies GmbH[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * Copyright [0m[1;36m2015[0m[39m DI [0m[1;39m([0m[39mFH[0m[1;39m)[0m[39m Martin Haimberger <martin.haimberger@thincast.com>[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * Licensed under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * you may not use this file except in compliance with the License.[0m              [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * You may obtain a copy of the License at[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#ifndef FREERDP_LIB_CORE_MCS_H[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#define FREERDP_LIB_CORE_MCS_H[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:typedef struct rdp_mcs rdpMcs;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"transport.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <freerdp/crypto/ber.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include <freerdp/api.h>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include <freerdp/types.h>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include <winpr/stream.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include <winpr/wtsapi.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m36:e[0m[39mnum MCS_Result[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39mMCS_Result_successful = [0m[1;36m0[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mMCS_Result_domain_merging = [0m[1;36m1[0m[39m,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mMCS_Result_domain_not_hierarchical = [0m[1;36m2[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mMCS_Result_no_such_channel = [0m[1;36m3[0m[39m,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39mMCS_Result_no_such_domain = [0m[1;36m4[0m[39m,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39mMCS_Result_no_such_user = [0m[1;36m5[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39mMCS_Result_not_admitted = [0m[1;36m6[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39mMCS_Result_other_user_id = [0m[1;36m7[0m[39m,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mMCS_Result_parameters_unacceptable = [0m[1;36m8[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39mMCS_Result_token_not_available = [0m[1;36m9[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39mMCS_Result_token_not_possessed = [0m[1;36m10[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39mMCS_Result_too_many_channels = [0m[1;36m11[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39mMCS_Result_too_many_tokens = [0m[1;36m12[0m[39m,[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     [0m[39mMCS_Result_too_many_users = [0m[1;36m13[0m[39m,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     [0m[39mMCS_Result_unspecified_failure = [0m[1;36m14[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     [0m[39mMCS_Result_user_rejected = [0m[1;36m15[0m[39m,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mMCS_Result_enum_length = [0m[1;36m16[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:typedef enum[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39mDomainMCSPDU_invalid = [0m[1;36m-1[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39mDomainMCSPDU_PlumbDomainIndication = [0m[1;36m0[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39mDomainMCSPDU_ErectDomainRequest = [0m[1;36m1[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mDomainMCSPDU_MergeChannelsRequest = [0m[1;36m2[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     [0m[39mDomainMCSPDU_MergeChannelsConfirm = [0m[1;36m3[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mDomainMCSPDU_PurgeChannelsIndication = [0m[1;36m4[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mDomainMCSPDU_MergeTokensRequest = [0m[1;36m5[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mDomainMCSPDU_MergeTokensConfirm = [0m[1;36m6[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39mDomainMCSPDU_PurgeTokensIndication = [0m[1;36m7[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39mDomainMCSPDU_DisconnectProviderUltimatum = [0m[1;36m8[0m[39m,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mDomainMCSPDU_RejectMCSPDUUltimatum = [0m[1;36m9[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mDomainMCSPDU_AttachUserRequest = [0m[1;36m10[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39mDomainMCSPDU_AttachUserConfirm = [0m[1;36m11[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39mDomainMCSPDU_DetachUserRequest = [0m[1;36m12[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mDomainMCSPDU_DetachUserIndication = [0m[1;36m13[0m[39m,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39mDomainMCSPDU_ChannelJoinRequest = [0m[1;36m14[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39mDomainMCSPDU_ChannelJoinConfirm = [0m[1;36m15[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mDomainMCSPDU_ChannelLeaveRequest = [0m[1;36m16[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39mDomainMCSPDU_ChannelConveneRequest = [0m[1;36m17[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mDomainMCSPDU_ChannelConveneConfirm = [0m[1;36m18[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mDomainMCSPDU_ChannelDisbandRequest = [0m[1;36m19[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mDomainMCSPDU_ChannelDisbandIndication = [0m[1;36m20[0m[39m,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39mDomainMCSPDU_ChannelAdmitRequest = [0m[1;36m21[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39mDomainMCSPDU_ChannelAdmitIndication = [0m[1;36m22[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39mDomainMCSPDU_ChannelExpelRequest = [0m[1;36m23[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mDomainMCSPDU_ChannelExpelIndication = [0m[1;36m24[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mDomainMCSPDU_SendDataRequest = [0m[1;36m25[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39mDomainMCSPDU_SendDataIndication = [0m[1;36m26[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39mDomainMCSPDU_UniformSendDataRequest = [0m[1;36m27[0m[39m,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39mDomainMCSPDU_UniformSendDataIndication = [0m[1;36m28[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mDomainMCSPDU_TokenGrabRequest = [0m[1;36m29[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mDomainMCSPDU_TokenGrabConfirm = [0m[1;36m30[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mDomainMCSPDU_TokenInhibitRequest = [0m[1;36m31[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39mDomainMCSPDU_TokenInhibitConfirm = [0m[1;36m32[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveRequest = [0m[1;36m33[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveIndication = [0m[1;36m34[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveResponse = [0m[1;36m35[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39mDomainMCSPDU_TokenGiveConfirm = [0m[1;36m36[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mDomainMCSPDU_TokenPleaseRequest = [0m[1;36m37[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mDomainMCSPDU_TokenPleaseConfirm = [0m[1;36m38[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39mDomainMCSPDU_TokenReleaseRequest = [0m[1;36m39[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39mDomainMCSPDU_TokenReleaseConfirm = [0m[1;36m40[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39mDomainMCSPDU_TokenTestRequest = [0m[1;36m41[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[39mDomainMCSPDU_TokenTestConfirm = [0m[1;36m42[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mDomainMCSPDU_enum_length = [0m[1;36m43[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m[39m DomainMCSPDU;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:typedef struct[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39mUINT32 maxChannelIds;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39mUINT32 maxUserIds;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39mUINT32 maxTokenIds;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39mUINT32 numPriorities;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39mUINT32 minThroughput;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39mUINT32 maxHeight;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39mUINT32 maxMCSPDUsize;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39mUINT32 protocolVersion;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m[1;39m}[0m[39m DomainParameters;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:struct rdp_mcs[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39mrdpTransport* transport;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mUINT16 userId;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39mUINT16 baseChannelId;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39mUINT16 messageChannelId;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39mUINT32 flags;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39mDomainParameters domainParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mDomainParameters targetParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39mDomainParameters minimumParameters;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mDomainParameters maximumParameters;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mBOOL userChannelJoined;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39mBOOL globalChannelJoined;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mBOOL messageChannelJoined;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:#define MCS_SEND_DATA_[0m[1;33mHEAD[0m[39mER_MAX_LENGTH [0m[1;36m8[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:#define MCS_TYPE_CONNECT_INITIAL [0m[1;36m0x65[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:#define MCS_TYPE_CONNECT_RESPONSE [0m[1;36m0x66[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m156:c[0m[39monst char* [0m[1;35mmcs_domain_pdu_string[0m[1;39m([0m[39mDomainMCSPDU pdu[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;92m157:B[0m[39mOOL [0m[1;35mmcs_server_apply_to_settings[0m[1;39m([0m[39mconst rdpMcs* mcs, rdpSettings* settings[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m159:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_connect_initial[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;92m160:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_connect_response[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;92m161:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_connect_response[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m162:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_erect_domain_request[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;92m163:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_erect_domain_request[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;92m164:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_attach_user_request[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;92m165:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_attach_user_request[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;92m166:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_attach_user_confirm[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;92m167:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_attach_user_confirm[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;92m168:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_channel_join_request[0m[1;39m([0m[39mrdpMcs* mcs, const [0m            [2m                [0m
[2;36m                    [0m         [39mrdpSettings* settings,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                                                 wStream* s, UINT16* [0m           [2m                [0m
[2;36m                    [0m         [39mchannelId[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;92m170:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_channel_join_request[0m[1;39m([0m[39mrdpMcs* mcs, UINT16 [0m           [2m                [0m
[2;36m                    [0m         [39mchannelId[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;92m171:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_channel_join_confirm[0m[1;39m([0m[39mrdpMcs* mcs, wStream* s, [0m      [2m                [0m
[2;36m                    [0m         [39mUINT16* channelId[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;92m172:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_channel_join_confirm[0m[1;39m([0m[39mrdpMcs* mcs, UINT16 [0m           [2m                [0m
[2;36m                    [0m         [39mchannelId[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;92m173:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_recv_disconnect_provider_ultimatum[0m[1;39m([0m[39mrdpMcs* mcs, wStream*[0m [2m                [0m
[2;36m                    [0m         [39ms, int* reason[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m174:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_send_disconnect_provider_ultimatum[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m176:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_write_domain_mcspdu_header[0m[1;39m([0m[39mwStream* s, DomainMCSPDU [0m     [2m                [0m
[2;36m                    [0m         [39mdomainMCSPDU,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                                                  UINT16 length, BYTE options[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m179:F[0m[39mREERDP_LOCAL BOOL [0m[1;35mmcs_client_begin[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m181:F[0m[39mREERDP_LOCAL void [0m[1;35mmcs_free[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mmcs_free, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m184:F[0m[39mREERDP_LOCAL rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:#endif [0m[35m/[0m[39m* FREERDP_LIB_CORE_MCS_H *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:650[0m[39m-[0m[1;36m770[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:    [0m[39msize_t length = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:    [0m[39mBOOL upwardFlag = FALSE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    [0m[39mUINT16 tlength = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mtpkt_read_header[0m[1;39m([0m[39ms, &tlength[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mtpdu_read_data[0m[1;39m([0m[39ms, &li, tlength[0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mber_read_application_tag[0m[1;39m([0m[39ms, MCS_TYPE_CONNECT_INITIAL, &length[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    [0m[35m/[0m[39m* callingDomainSelector [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mber_read_octet_string_tag[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[39m ||[0m                               [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:    [0m[39m    [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, length[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, length[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[35m/[0m[39m* calledDomainSelector [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mber_read_octet_string_tag[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[39m ||[0m                               [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    [0m[39m    [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, length[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, length[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:    [0m[35m/[0m[39m* upwardFlag [0m[1;39m([0m[39mBOOLEAN[0m[1;39m)[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mber_read_BOOL[0m[1;39m([0m[39ms, &upwardFlag[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    [0m[35m/[0m[39m* targetParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_read_domain_parameters[0m[1;39m([0m[39ms, &mcs->targetParameters[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:    [0m[35m/[0m[39m* minimumParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_read_domain_parameters[0m[1;39m([0m[39ms, &mcs->minimumParameters[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:    [0m[35m/[0m[39m* maximumParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_read_domain_parameters[0m[1;39m([0m[39ms, &mcs->maximumParameters[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mber_read_octet_string_tag[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[39m ||[0m                               [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:    [0m[39m    [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, length[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[39ms, mcs[0m[1;39m)[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_merge_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m                   [2m                [0m
[2;36m                    [0m         [39m&mcs->minimumParameters,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:    [0m[39m                                 &mcs->maximumParameters, [0m                  [2m                [0m
[2;36m                    [0m         [39m&mcs->domainParameters[0m[1;39m)[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[39mreturn [0m[1;35mtpkt_ensure_stream_consumed[0m[1;39m([0m[39ms, tlength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m: * Write an MCS Connect Initial PDU.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m: * msdn[0m[1;39m{[0m[39mcc240508[0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m: * @param s stream[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m: * @param mcs MCS module[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m: * @param userData GCC Conference Create Request[0m                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m718:B[0m[39mOOL [0m[1;35mmcs_write_connect_initial[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs, wStream* userData[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:    [0m[39msize_t length = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:    [0m[39mwStream* tmps = NULL;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:    [0m[39mBOOL ret = FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!s || !mcs || !userData[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:    [0m[39mtmps = [0m[1;35mStream_New[0m[1;39m([0m[39mNULL, [0m[1;35mStream_Capacity[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!tmps[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:    [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"Stream_New failed!"[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:    [0m[35m/[0m[39m* callingDomainSelector [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:    [0m[1;35mber_write_octet_string[0m[1;39m([0m[39mtmps, callingDomainSelector, [0m                        [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mcallingDomainSelector[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:    [0m[35m/[0m[39m* calledDomainSelector [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:    [0m[1;35mber_write_octet_string[0m[1;39m([0m[39mtmps, calledDomainSelector, [0m                         [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mcalledDomainSelector[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:    [0m[35m/[0m[39m* upwardFlag [0m[1;39m([0m[39mBOOLEAN[0m[1;39m)[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:    [0m[1;35mber_write_BOOL[0m[1;39m([0m[39mtmps, TRUE[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:    [0m[35m/[0m[39m* targetParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_write_domain_parameters[0m[1;39m([0m[39mtmps, &mcs->targetParameters[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:    [0m[39m        [0m[39mgoto out;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:    [0m[35m/[0m[39m* minimumParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_write_domain_parameters[0m[1;39m([0m[39mtmps, &mcs->minimumParameters[0m[1;39m)[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:    [0m[39m        [0m[39mgoto out;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:    [0m[35m/[0m[39m* maximumParameters [0m[1;39m([0m[39mDomainParameters[0m[1;39m)[0m[39m *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmcs_write_domain_parameters[0m[1;39m([0m[39mtmps, &mcs->maximumParameters[0m[1;39m)[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:    [0m[39m        [0m[39mgoto out;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:    [0m[35m/[0m[39m* userData [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:    [0m[1;35mber_write_octet_string[0m[1;39m([0m[39mtmps, [0m[1;35mStream_Buffer[0m[1;39m([0m[39muserData[0m[1;39m)[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mStream_GetPosition[0m[1;39m([0m[39muserData[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:    [0m[39mlength = [0m[1;35mStream_GetPosition[0m[1;39m([0m[39mtmps[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:    [0m[35m/[0m[39m* Connect-Initial [0m[1;39m([0m[39mAPPLICATION [0m[1;36m101[0m[39m, IMPLICIT SEQUENCE[0m[1;39m)[0m[39m *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:    [0m[1;35mber_write_application_tag[0m[1;39m([0m[39ms, MCS_TYPE_CONNECT_INITIAL, length[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:    [0m[1;35mStream_Write[0m[1;39m([0m[39ms, [0m[1;35mStream_Buffer[0m[1;39m([0m[39mtmps[0m[1;39m)[0m[39m, length[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:    [0m[39mret = TRUE;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:out:[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:    [0m[1;35mStream_Free[0m[1;39m([0m[39mtmps, TRUE[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:    [0m[39mreturn ret;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m: * Write an MCS Connect Response PDU.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m: * msdn[0m[1;39m{[0m[39mcc240508[0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m: * @param s stream[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m: * @param mcs MCS module[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m149[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1857[0m[39m-[0m[1;36m1864[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The overflow originates in gcc_read_client_network_data [0m                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlibfreerdp/core/gcc.c[0m[1;39m)[0m[39m when `[0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m` writes into [0m [2m                [0m
[2;36m                    [0m         [39m`mcs->channelCount`, which is declared as a signed [0m[1;36m8[0m[39m-bit [0m[1;39m([0m[39mINT8[0m[1;39m)[0m[39m in rdpMcs.  [0m        [2m                [0m
[2;36m                    [0m         [39m   - If the incoming byte is ≥[0m[1;36m128[0m[39m, it wraps to a negative signed value, bypasses [0m   [2m                [0m
[2;36m                    [0m         [39mthe `if [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m` guard, and is then cast to UINT32 [0m [2m                [0m
[2;36m                    [0m         [39min the `for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m[39m` loop, causing out-of-bounds [0m       [2m                [0m
[2;36m                    [0m         [39maccesses on `mcs->channels`.[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Writing the [0m[1;36m8[0m[39m-byte channel name into channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.Name for i beyond the [0m        [2m                [0m
[2;36m                    [0m         [39mallocated range leads to the [0m[1;36m8[0m[39m-byte heap-buffer-overflow at offset [0m[1;36m992[0m[39m.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Desired Patch[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Change the type of `channelCount` in `struct rdp_mcs` from signed INT8 to [0m     [2m                [0m
[2;36m                    [0m         [39munsigned UINT8. This ensures:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     • Reads via `Stream_Read_UINT8` correctly map [0m[1;36m0[0m[39m–[0m[1;36m255[0m[39m to [0m[1;36m0[0m[39m–[0m[1;36m255[0m[39m without wrapping [0m [2m                [0m
[2;36m                    [0m         [39mto negative values.  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m     • The existing guard `if [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m` properly [0m    [2m                [0m
[2;36m                    [0m         [39mrejects any value > CHANNEL_MAX_COUNT [0m[1;39m([0m[1;36m31[0m[1;39m)[0m[39m.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m     • The subsequent loop `for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m[39m` iterates [0m      [2m                [0m
[2;36m                    [0m         [39mexactly `channelCount` times, never exceeding the allocated array.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   a. In libfreerdp/core/mcs.h, locate the definition of rdpMcs:[0m                    [2m                [0m
[2;36m                    [0m         [39m      ```[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      struct rdp_mcs[0m                                                                [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m         …[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         INT8 channelCount;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m         rdpMcsChannel* channels;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m      ```[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   b. Change `INT8 channelCount;` to `UINT8 channelCount;`.[0m                         [2m                [0m
[2;36m                    [0m         [39m   c. Review references:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m      - `[0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m;` — now writes into UINT8, [0m        [2m                [0m
[2;36m                    [0m         [39mmatching the macro’s unsigned semantics.[0m                                            [2m                [0m
[2;36m                    [0m         [39m      - The checks `[0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[39m` and `if [0m[1;39m([0m[39mmcs->channelCount > [0m    [2m                [0m
[2;36m                    [0m         [39mCHANNEL_MAX_COUNT[0m[1;39m)[0m[39m` continue to function correctly.[0m                                 [2m                [0m
[2;36m                    [0m         [39m      - The loop `for [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m[39m` is now safe.[0m      [2m                [0m
[2;36m                    [0m         [39m   d. Rebuild the codebase and rerun AddressSanitizer and existing unit/fuzz tests [0m [2m                [0m
[2;36m                    [0m         [39mto ensure no regressions.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Converting to UINT8 aligns the variable’s type with the unsigned read macro [0m   [2m                [0m
[2;36m                    [0m         [39mand intended range [0m[1;39m[[0m[1;36m0[0m[39m..CHANNEL_MAX_COUNT[0m[1;39m][0m[39m.  [0m                                        [2m                [0m
[2;36m                    [0m         [39m   - No existing functionality is altered: valid channel counts [0m[1;39m([0m[1;36m0[0m[39m..[0m[1;36m31[0m[1;39m)[0m[39m remain [0m     [2m                [0m
[2;36m                    [0m         [39mrepresentable, and higher counts are rejected as before.  [0m                          [2m                [0m
[2;36m                    [0m         [39m   - Struct size and binary layout remain unchanged [0m[1;39m([0m[39mINT8 and UINT8 are both [0m[1;36m1[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m)[0m[39m, so no ABI breakage or test changes are needed.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side Effects & Mitigation[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - If any code elsewhere mistakenly treats `channelCount` as signed, manual audit[0m [2m                [0m
[2;36m                    [0m         [39mwill catch and update those comparisons to unsigned or size_t as needed.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - Since all comparisons and loops use unsigned arithmetic or explicit casts, [0m    [2m                [0m
[2;36m                    [0m         [39mside effects are minimal.  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Mitigation: run a full test suite [0m[1;39m([0m[39munit tests, integration tests, fuzz [0m        [2m                [0m
[2;36m                    [0m         [39mtargets[0m[1;39m)[0m[39m to validate behavior remains correct.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Reference[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - This mirrors other network-frame parsing fixes in FreeRDP [0m[1;39m([0m[39me.g., using UINT16 [0m [2m                [0m
[2;36m                    [0m         [39mfor length fields[0m[1;39m)[0m[39m to prevent signed-overflow bypasses.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 02:42:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=148959;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=891787;file:///home/qqor/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=846404;file:///home/qqor/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=743716;file:///home/qqor/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp7rzls329[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/aixcc/crete/reports/prism.prism_o4_mini/freerdp_fp-full-01_vuln_004/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1766511758.2650404[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/freerdp_fp-full-01_vuln_004.toml        [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/aixcc/crete/.cache/[0m[95mofficial-afc-freerdp[0m    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/24/25 02:42:40][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/aixcc/crete/.cache/environments/[0m[95mfreerdp[0m  ]8;id=369752;file:///home/qqor/aixcc/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=827824;file:///home/qqor/aixcc/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
