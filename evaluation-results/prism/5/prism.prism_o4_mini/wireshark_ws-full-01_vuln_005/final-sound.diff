--- a/epan/dissectors/packet-bat.c
+++ b/epan/dissectors/packet-bat.c
@@ -669,6 +669,12 @@
 		vis_packeth_raw_data[i] = tvb_get_uint8(tvb, offset);
 		offset++;
 	}
+	{
+		size_t raw_size = (size_t)vis_packeth_raw_data_size;
+		if (raw_size >= sizeof(vis_packeth_raw_data))
+			raw_size = sizeof(vis_packeth_raw_data) - 1;
+		vis_packeth_raw_data[raw_size] = '\0';
+	}
 
 	/* set protocol name */
 	col_set_str(pinfo->cinfo, COL_PROTOCOL, "BAT_VIS");
@@ -702,7 +708,7 @@
 	}
 
 	if ((vis_packeth_raw_data_size > 4) && (strlen(vis_packeth_raw_data) > 4))
-		fprintf(stderr, d_output_buffer);
+		fprintf(stderr, "%s", d_output_buffer);
 
 	tap_queue_packet(bat_tap, pinfo, vis_packeth);
 
