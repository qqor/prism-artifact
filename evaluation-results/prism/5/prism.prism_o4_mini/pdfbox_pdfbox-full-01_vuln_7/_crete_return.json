{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_7",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.15558950000000002,
    "prompt_tokens": 96785,
    "completion_tokens": 11165
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -180,6 +180,7 @@\n     private final class PageIterator implements Iterator<PDPage>\n     {\n         private final Queue<COSDictionary> queue = new ArrayDeque<>();\n+        private final Set<COSDictionary> visited = new HashSet<>();\n \n         private PageIterator(COSDictionary node)\n         {\n@@ -205,13 +206,22 @@\n          */\n         private List<COSDictionary> enqueueKids(COSDictionary node)\n         {\n+            if (node == null)\n+            {\n+                return Collections.emptyList();\n+            }\n             if (isPageTreeNode(node))\n             {\n+                // avoid cycles in malformed page trees\n+                if (!visited.add(node))\n+                {\n+                    return Collections.emptyList();\n+                }\n                 return getKids(node);\n             }\n             else\n             {\n-                if (node != null && COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n+                if (COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n                 {\n                     queue.add(node);\n                 }\n@@ -221,7 +231,7 @@\n                             () -> (node == null ? \"(null)\" : node.getCOSName(COSName.TYPE)));\n                 }\n             }\n-            return Collections.EMPTY_LIST;\n+            return Collections.emptyList();\n         }\n \n         @Override\n",
  "stdout": "",
  "stderr": ""
}