--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
@@ -172,7 +172,11 @@
                   if (IOUtils.readFully(inp, mpdata) < 0) {
                      throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");
                   }
-                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);
+                  int charCount = (mplen / 2) - 1;
+                  if (charCount > 1_000_000) {
+                      throw new IOException("Attribute name too large: " + charCount + " chars");
+                  }
+                  name = StringUtil.getFromUnicodeLE(mpdata, 0, charCount);
                   skipToBoundary(mplen, inp);
                }
 

--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFStringAttribute.java
+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFStringAttribute.java
@@ -43,12 +43,21 @@
 
       String tmpData = null;
       byte[] data = getData();
-      if(getType() == TNEFProperty.TYPE_TEXT) {
-         tmpData = StringUtil.getFromUnicodeLE(data);
+      int charCount;
+      if (getType() == TNEFProperty.TYPE_TEXT) {
+          // Unicode 16-bit LE string
+          charCount = data.length / 2;
+          if (charCount > 1_000_000) {
+              throw new IOException("TNEF string too large: " + charCount + " chars");
+          }
+          tmpData = StringUtil.getFromUnicodeLE(data, 0, charCount);
       } else {
-         tmpData = StringUtil.getFromCompressedUnicode(
-              data, 0, data.length
-         );
+          // Compressed (ISO-8859-1) string
+          charCount = data.length;
+          if (charCount > 1_000_000) {
+              throw new IOException("TNEF string too large: " + charCount + " chars");
+          }
+          tmpData = StringUtil.getFromCompressedUnicode(data, 0, charCount);
       }
 
       // Strip off the null terminator if present
