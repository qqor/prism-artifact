--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -38,6 +38,7 @@
 import org.apache.tika.mime.MediaType;
 import org.apache.tika.utils.FileProcessResult;
 import org.apache.tika.utils.ProcessUtils;
+import org.apache.tika.utils.SystemUtils;
 import org.apache.tika.utils.StringUtils;
 
 /**
@@ -97,7 +98,11 @@
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
         Path tmpFile = tmpDir.resolve(fileName);
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
+        if (SystemUtils.IS_OS_WINDOWS) {
+            FileUtils.deleteDirectory(tmpDir.toFile());
+            return SHELL_SCRIPT;
+        }
+        ProcessBuilder pb = new ProcessBuilder("sh", "-n", tmpFile.getFileName().toString());
         pb.directory(tmpDir.toFile());
         try {
             FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
