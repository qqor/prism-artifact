{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-03_vuln_4",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.40622450000000004,
    "prompt_tokens": 230411,
    "completion_tokens": 34721
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -54,6 +54,7 @@\n import org.apache.commons.compress.utils.TimeUtils;\n import org.apache.commons.io.file.attribute.FileTimes;\n import org.apache.commons.lang3.SystemProperties;\n+import org.apache.commons.lang3.StringUtils;\n \n /**\n  * An entry in a <a href=\"https://www.gnu.org/software/tar/manual/html_node/Standard.html\">Tar archive</a>.\n@@ -272,14 +273,35 @@\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n         }\n \n-        final BigDecimal epochSeconds = new BigDecimal(value);\n-        final long seconds = epochSeconds.longValue();\n-        final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n+        // Manual parsing to avoid expensive BigDecimal operations\n+        final boolean negative = value.startsWith(\"-\");\n+        final int dotIndex = value.indexOf('.');\n+        final String secondsPart = (dotIndex >= 0) ? value.substring(0, dotIndex) : value;\n+        final String fractionPart = (dotIndex >= 0) ? value.substring(dotIndex + 1) : \"\";\n+        final long seconds;\n+        try {\n+            seconds = Long.parseLong(secondsPart);\n+        } catch (NumberFormatException e) {\n+            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+        }\n+        long nanos = 0L;\n+        if (!fractionPart.isEmpty()) {\n+            // Truncate or pad the fraction to exactly 9 digits\n+            final String frac = fractionPart.length() > 9\n+                ? fractionPart.substring(0, 9)\n+                : StringUtils.rightPad(fractionPart, 9, '0');\n+            try {\n+                nanos = Long.parseLong(frac);\n+            } catch (NumberFormatException e) {\n+                throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+            }\n+            if (negative) {\n+                nanos = -nanos;\n+            }\n+        }\n         try {\n             return Instant.ofEpochSecond(seconds, nanos);\n         } catch (DateTimeException | ArithmeticException e) {\n-            // DateTimeException: Thrown if the instant exceeds the maximum or minimum instant.\n-            // ArithmeticException: Thrown if numeric overflow occurs.\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n         }\n     }\n",
  "stdout": "",
  "stderr": ""
}