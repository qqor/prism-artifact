{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.2687762,
    "prompt_tokens": 197066,
    "completion_tokens": 11819
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -980,11 +980,13 @@\n {\n \tuint32_t value = 0;\n \t\n-\tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n-\n-\tswitch (addr)\n+    value = tvb_get_letohl(tvb, offset);\n+    if (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+        gvcp_register_number[gvcp_register_count] = addr;\n+        gvcp_register_value[gvcp_register_count++] = value;\n+    }\n+\n+    switch (addr)\n \t{\n \tcase GVCP_VERSION:\n \t\tproto_tree_add_item(branch, hf_gvcp_spec_version_major, tvb, offset, 4, ENC_BIG_ENDIAN);\n",
  "stdout": "",
  "stderr": ""
}