{
  "project_name": "mongoose",
  "vulnerability_identifier": "mongoose_mg-full-01_mongoose_0",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-mongoose",
  "llm_usage": {
    "total_cost": 0.5771216000000001,
    "prompt_tokens": 246848,
    "completion_tokens": 69452
  },
  "variant": "sound",
  "diff": "--- a/src/json.c\n+++ b/src/json.c\n@@ -164,7 +164,7 @@\n         // p(\"V %s [%.*s] %d %d %d %d\\n\", path, pos, path, depth, ed, ci, ei);\n         if (depth == ed) j = i;\n         if (c == '{') {\n-          if (depth > MG_JSON_MAX_NESTING) return MG_JSON_TOO_DEEP;\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           if (depth == ed && path[pos] == '.' && ci == ei) {\n             // If we start the object, reset array indices\n             ed++, pos++, ci = ei = -1;\n@@ -173,7 +173,7 @@\n           expecting = S_KEY;\n           break;\n         } else if (c == '[') {\n-          if (depth > MG_JSON_MAX_NESTING) return MG_JSON_TOO_DEEP;\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           if (depth == ed && path[pos] == '[' && ei == ci) {\n             ed++, pos++, ci = 0;\n             for (ei = 0; path[pos] != ']' && path[pos] != '\\0'; pos++) {\n@@ -182,6 +182,7 @@\n             }\n             if (path[pos] != 0) pos++;\n           }\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           nesting[depth++] = c;\n           break;\n         } else if (c == ']' && depth > 0) {  // Empty array\n\n--- a/mongoose.c\n+++ b/mongoose.c\n@@ -2760,7 +2760,7 @@\n         // p(\"V %s [%.*s] %d %d %d %d\\n\", path, pos, path, depth, ed, ci, ei);\n         if (depth == ed) j = i;\n         if (c == '{') {\n-          if (depth > MG_JSON_MAX_NESTING) return MG_JSON_TOO_DEEP;\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           if (depth == ed && path[pos] == '.' && ci == ei) {\n             // If we start the object, reset array indices\n             ed++, pos++, ci = ei = -1;\n@@ -2769,7 +2769,7 @@\n           expecting = S_KEY;\n           break;\n         } else if (c == '[') {\n-          if (depth > MG_JSON_MAX_NESTING) return MG_JSON_TOO_DEEP;\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           if (depth == ed && path[pos] == '[' && ei == ci) {\n             ed++, pos++, ci = 0;\n             for (ei = 0; path[pos] != ']' && path[pos] != '\\0'; pos++) {\n@@ -2778,6 +2778,7 @@\n             }\n             if (path[pos] != 0) pos++;\n           }\n+          if (depth >= MG_JSON_MAX_DEPTH) return MG_JSON_TOO_DEEP;\n           nesting[depth++] = c;\n           break;\n         } else if (c == ']' && depth > 0) {  // Empty array\n",
  "stdout": "",
  "stderr": ""
}