{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-06_vuln_10",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.12333640000000001,
    "prompt_tokens": 62516,
    "completion_tokens": 12402
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n@@ -35,6 +35,8 @@\n     private static final Pattern FRACTION_FORMAT =\n             Pattern.compile(\"([+-])?(\\\\d{0,20}(?:\\\\.\\\\d{0,20})?) \" +\n             \"&fraction_format=\\\"(?:(#{1,20}) )?(#{1,20})/(#{1,20})\\\"\");\n+    /** Maximum number of digits in denominator to attempt brute-force approximation */\n+    private static final int MAX_DENOM_LENGTH = 6;\n \n     private final Matcher fractionFormatMatcher = FRACTION_FORMAT.matcher(\"\");\n     String format(String cell) {\n@@ -56,6 +58,9 @@\n         String wholeFormat = fractionFormatMatcher.group(3);\n         String numFormat = fractionFormatMatcher.group(4);\n         String denomFormat = fractionFormatMatcher.group(5);\n+        if (denomFormat.length() > MAX_DENOM_LENGTH) {\n+            return cell;\n+        }\n \n         double wholePart = Math.floor(Math.abs(val));\n         double decPart = Math.abs(val) - wholePart;\n",
  "stdout": "",
  "stderr": ""
}