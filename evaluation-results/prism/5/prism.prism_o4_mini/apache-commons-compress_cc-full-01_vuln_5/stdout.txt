[2;36m[12/23/25 16:33:44][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=671985;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=103678;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgwfyuhjp[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/reports/prism.prism_o4_mini/apache-commons-compress_cc-full-0[0m [2m               [0m
[2;36m                    [0m         [35m1_vuln_5/[0m[95magent-output-1766475224.061131[0m                                              [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc/apache-commons-compress_cc-full-01_vuln_5.toml                 [2m               [0m
[2;36m                    [0m         - Challenge project directory:                                                       [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/.cache/[0m[95mofficial-afc-commons-compress[0m                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=161891;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=443805;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[12/23/25 16:34:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=953739;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=294929;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m37.57[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=937006;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=949510;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=188029;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=481758;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=160304;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=880690;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m37[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=229550;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=163863;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/23/25 16:34:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.57[0m        ]8;id=383807;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=709392;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[12/23/25 16:34:23][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=318814;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=153864;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=547368;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=861574;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=168374;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=385407;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=155036;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=803887;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/23/25 16:34:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.69[0m        ]8;id=620831;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=253158;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=223946;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993636;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.58[0m        ]8;id=861110;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=852073;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[12/23/25 16:34:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=770979;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=603847;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp12395161540364027894/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:440[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:406[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:332[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: e4b7789e52b89f9e                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp12395161540364027894/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:440[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:406[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:332[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: e4b7789e52b89f9e                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/23/25 16:34:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=452227;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=85293;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/23/25 16:35:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=474111;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=439672;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/23/25 16:36:50][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=357739;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=653737;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=898390;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=353335;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.54[0m        ]8;id=744644;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=190648;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=866764;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=713200;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2ce2q9fc[0m                                                 ]8;id=439825;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=78077;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/23/25 16:37:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m38.85[0m seconds;   ]8;id=667589;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=945441;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=994322;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360073;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/23/25 16:37:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m15.82[0m      ]8;id=896720;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=841601;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=66037;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=842702;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/23/25 16:37:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m4.56[0m seconds; ]8;id=964991;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=546206;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=323256;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=77193;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=729090;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=187411;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=358274;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=220368;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.52[0m        ]8;id=6552;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=642297;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[12/23/25 16:37:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=730017;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=289686;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.55[0m        ]8;id=813677;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=100799;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=966911;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=642661;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/23/25 16:37:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.57[0m        ]8;id=794222;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=777633;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=639075;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=269880;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-72[0m,[1;36m13[0m +[1;36m72[0m,[1;36m19[0m @@                                                                 [2m                [0m
[2;36m                    [0m               * @throws IOException if this method detects a Zip slip.                      [2m                [0m
[2;36m                    [0m               * @since [1;36m1.26[0m.[1;36m0[0m                                                               [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         -    default Path [1;35mresolveIn[0m[1m([0mfinal Path parentPath[1m)[0m throws IOException [1m{[0m             [2m                [0m
[2;36m                    [0m         -        final String name = [1;35mgetName[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mname[1m)[0m;                          [2m                [0m
[2;36m                    [0m         -        if [1m([0m![1;35moutputFile.startsWith[0m[1m([0mparentPath[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m         -            throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m,    [2m                [0m
[2;36m                    [0m         parentPath, name, outputFile[1m)[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        return outputFile;                                                         [2m                [0m
[2;36m                    [0m         +default Path [1;35mresolveIn[0m[1m([0mfinal Path parentPath[1m)[0m throws IOException [1m{[0m                 [2m                [0m
[2;36m                    [0m         +    Path normalizedParent = [1;35mparentPath.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;               [2m                [0m
[2;36m                    [0m         +    String name = [1;35mgetName[0m[1m([0m[1m)[0m;                                                       [2m                [0m
[2;36m                    [0m         +    if [1m([0m[1;35mname.startsWith[0m[1m([0m[32m"/"[0m[1m)[0m || [1;35mname.startsWith[0m[1m([0m"\\"[1m)[0m                              [2m                [0m
[2;36m                    [0m         +            || [1;35mname.contains[0m[1m([0m[32m"../"[0m[1m)[0m || [1;35mname.contains[0m[1m([0m"..\\"[1m)[0m[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         +        throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Invalid entry name '%s' leads to path[0m [2m                [0m
[2;36m                    [0m         [32mtraversal"[0m, name[1m)[0m[1m)[0m;                                                                 [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +    Path resolved = [1;35mnormalizedParent.resolve[0m[1m([0mname[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                    [2m                [0m
[2;36m                    [0m         +    if [1m([0m![1;35mresolved.startsWith[0m[1m([0mnormalizedParent[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m         +        throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m,        [2m                [0m
[2;36m                    [0m         +                normalizedParent, name, resolved[1m)[0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +    return resolved;                                                               [2m                [0m
[2;36m                    [0m         +[1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp12395161540364027894/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:440[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:406[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:332[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: e4b7789e52b89f9e                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical file path traversal issue was detected by Jazzer‚Äôs fuzzer harness when   [2m                [0m
[2;36m                    [0m         running the `ExpanderFuzzer` against the Apache Commons Compress example            [2m                [0m
[2;36m                    [0m         `Expander`. A specially crafted archive input caused the `Expander.expand` routines [2m                [0m
[2;36m                    [0m         to produce output file paths containing ‚Äú..[35m/[0m‚Äù segments that escape the intended     [2m                [0m
[2;36m                    [0m         output directory. Jazzer‚Äôs `FilePathTraversal` sanitizer triggered a                [2m                [0m
[2;36m                    [0m         `FuzzerSecurityIssueCritical` exception, flagging this as a security vulnerability. [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue Type: File path traversal                                                   [2m                [0m
[2;36m                    [0m         - Exception:                                                                        [2m                [0m
[2;36m                    [0m           com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: File path           [2m                [0m
[2;36m                    [0m         traversal:                                                                          [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp12395161540364027894/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m         - Stack Trace Highlights:                                                           [2m                [0m
[2;36m                    [0m           ‚Ä¢ [1;35mFilePathTraversal.check[0m[1m([0m[1m)[0m ‚Üí [1;35mpathFirstArgHook[0m[1m([0m[1m)[0m                                  [2m                [0m
[2;36m                    [0m           ‚Ä¢ [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0m[33m...[0m[1m)[0m             [2m                [0m
[2;36m                    [0m           ‚Ä¢ [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Important observations and findings                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m. The vulnerability is detected by Jazzer‚Äôs path‚Äêtraversal sanitizer, not by the   [2m                [0m
[2;36m                    [0m         fuzzer harness itself. The harness merely invokes the library‚Äôs example code        [2m                [0m
[2;36m                    [0m         [1m([0m`Expander`[1m)[0m with fuzzed inputs.                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m. The offending path [1m([0m`‚Ä¶[35m/../../[0m[95mjazzer-traversal[0m`[1m)[0m shows that entry names from the  [2m                [0m
[2;36m                    [0m         archive are used directly to form filesystem paths without proper normalization or  [2m                [0m
[2;36m                    [0m         restriction to the target directory.                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m. The exception occurs at every call site in `Expander.expand` where files or      [2m                [0m
[2;36m                    [0m         directories are created based on archive entries, indicating missing or inadequate  [2m                [0m
[2;36m                    [0m         sanitization in the extraction logic.                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Code areas to investigate for a holistic view                                       [2m                [0m
[2;36m                    [0m         - `org.apache.commons.compress.archivers.examples.Expander` [1m([0mall overloads of       [2m                [0m
[2;36m                    [0m         `expand`[1m)[0m, focusing on how entry names are combined with the output directory.      [2m                [0m
[2;36m                    [0m         - Any helper methods that resolve or normalize archive entry paths before file      [2m                [0m
[2;36m                    [0m         creation [1m([0me.g., a method responsible for canonicalizing or validating output        [2m                [0m
[2;36m                    [0m         paths[1m)[0m.                                                                             [2m                [0m
[2;36m                    [0m         - Sections of code that interact with the filesystem APIs [1m([0mcreating directories,    [2m                [0m
[2;36m                    [0m         writing files[1m)[0m to see where path traversal checks should be enforced.               [2m                [0m
[2;36m                    [0m         - Overall extraction workflow in the example code [1m([0mrecursive expand logic[1m)[0m to       [2m                [0m
[2;36m                    [0m         ensure consistent path validation at each recursion level.                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp12395161540364027894/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:86[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:440[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:406[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:332[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:204[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: e4b7789e52b89f9e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m30[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:78[0m[39m-[0m[1;36m120[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * @param archive         the file to expand[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m     [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final File [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            ArchiveEntry next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            while [0m[1;39m([0m[39mnext != null && ![0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mnext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            return next;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:190[0m[39m-[0m[1;36m240[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:     * Tries to auto-detect the archive's format.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:     * @param targetDirectory the target directory[0m                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:     * @throws ArchiveException if the archive cannot be read for other reasons[0m [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal Path archive, final Path targetDirectory[0m[1;39m)[0m[39m throws [0m  [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mInputStream inputStream = new [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[1;35mArchiveStreamFactory.detect[0m[1;39m([0m[39minputStream[0m[1;39m)[0m[39m, archive, [0m          [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive::getNextEntry, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m buffer = new byte[0m[1;39m[[0m[1;36m8192[0m[1;39m][0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            int n;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:            while [0m[1;39m([0m[1;36m-1[0m[39m != [0m[1;39m([0m[39mn = [0m[1;35marchive.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                if [0m[1;39m([0m[39mout != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbuffer, [0m[1;36m0[0m[39m, n[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:300[0m[39m-[0m[1;36m360[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:     * closeableConsumer[0m[1;39m}[0m[39m callback as soon as it is no longer needed by this [0m   [2m                [0m
[2;36m                    [0m         [39mclass.[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:     * @param archive           the file to expand[0m                              [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:     * @param targetDirectory   the target directory[0m                            [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:     * @param format            the archive format. This uses the same format [0m  [2m                [0m
[2;36m                    [0m         [39mas accepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:     * @param closeableConsumer is informed about the stream wrapped around the[0m [2m                [0m
[2;36m                    [0m         [39mpassed in stream[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:     * @throws ArchiveException if the archive cannot be read for other reasons[0m [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final InputStream archive, final [0m   [2m                [0m
[2;36m                    [0m         [39mPath targetDirectory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            final ArchiveInputStream<?> archiveInputStream = [0m                   [2m                [0m
[2;36m                    [0m         [1;35mArchiveStreamFactory.DEFAULT.createArchiveInputStream[0m[1;39m([0m[39mformat, archive[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39marchiveInputStream[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:     * @param targetDirectory the target directory[0m                              [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:     * @param format          the archive format. This uses the same format as [0m [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:     * @throws ArchiveException if the archive cannot be read for other reasons[0m [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final Path archive, final Path [0m     [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        if [0m[1;39m([0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:            try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39marchive, [0m       [2m                [0m
[2;36m                    [0m         [39mStandardOpenOption.READ[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[39mformat, channel, targetDirectory, [0m                       [2m                [0m
[2;36m                    [0m         [39mCloseableConsumer.CLOSING_CONSUMER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:        try [0m[1;39m([0m[39mInputStream inputStream = new [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[39mformat, inputStream, targetDirectory, [0m                       [2m                [0m
[2;36m                    [0m         [39mCloseableConsumer.CLOSING_CONSUMER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:     * This method creates a wrapper around the archive channel which is never [0m [2m                [0m
[2;36m                    [0m         [39mclosed and thus leaks resources, please use[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:     * [0m[1;39m{[0m[39m@link #[0m[1;35mexpand[0m[1;39m([0m[39mString,SeekableByteChannel,File,CloseableConsumer[0m[1;39m)[0m[1;39m}[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39minstead.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:     * @param targetDirectory the target directory[0m                              [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:     * @param format          the archive format. This uses the same format as [0m [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:     * @throws ArchiveException if the archive cannot be read for other reasons[0m [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:     * @deprecated this method leaks resources[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel archive, [0m [2m                [0m
[2;36m                    [0m         [39mfinal File targetDirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39mformat, archive, targetDirectory, [0m                               [2m                [0m
[2;36m                    [0m         [39mCloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:400[0m[39m-[0m[1;36m460[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel archive, [0m [2m                [0m
[2;36m                    [0m         [39mfinal Path targetDirectory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[39mformat, [0m[1;35mc.track[0m[1;39m([0m[1;35mChannels.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mtargetDirectory, CloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.TAR.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39mnew [0m[1;35mTarFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.ZIP.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mSevenZFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                [0m[35m/[0m[35m/[0m[39m never reached as prefersSeekableByteChannel only returns [0m    [2m                [0m
[2;36m                    [0m         [39mtrue for TAR, ZIP and 7z[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                throw new [0m[1;35mArchiveException[0m[1;39m([0m[32m"Don't know how to handle format "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mformat[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal TarFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal TarFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        final Iterator<TarArchiveEntry> entryIterator = [0m                        [2m                [0m
[2;36m                    [0m         [1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[1;35m.iterator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mentryIterator.hasNext[0m[1;39m([0m[1;39m)[0m[39m ? [0m[1;35mentryIterator.next[0m[1;39m([0m[1;39m)[0m[39m : null, [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            try [0m[1;39m([0m[39mInputStream in = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39min, out[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m76[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:850[0m[39m-[0m[1;36m86[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:     * @return the entry name[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:        return name == null ? [0m[1;35msuper.getName[0m[1;39m([0m[1;39m)[0m[39m : name;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:     * The source of the name field value.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:200[0m[39m-[0m[1;36m260[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal Path archive, final Path targetDirectory[0m[1;39m)[0m[39m throws [0m  [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mInputStream inputStream = new [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[1;35mArchiveStreamFactory.detect[0m[1;39m([0m[39minputStream[0m[1;39m)[0m[39m, archive, [0m          [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final File targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     * @param targetDirectory the target directory, may be null to simulate [0m    [2m                [0m
[2;36m                    [0m         [39moutput to dev/null on Linux and NUL on Windows.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @throws IOException if an I/O error occurs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     * @since [0m[1;36m1.22[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal SevenZFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39marchive::getNextEntry, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m buffer = new byte[0m[1;39m[[0m[1;36m8192[0m[1;39m][0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            int n;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:            while [0m[1;39m([0m[1;36m-1[0m[39m != [0m[1;39m([0m[39mn = [0m[1;35marchive.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                if [0m[1;39m([0m[39mout != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbuffer, [0m[1;36m0[0m[39m, n[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * @param targetDirectory the target directory[0m                              [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     * @param format          the archive format. This uses the same format as [0m [2m                [0m
[2;36m                    [0m         [39maccepted by [0m[1;39m{[0m[39m@link ArchiveStreamFactory[0m[1;39m}[0m[39m.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:     * @throws IOException      if an I/O error occurs[0m                          [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:     * @throws ArchiveException if the archive cannot be read for other reasons[0m [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final File archive, final File [0m     [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[39mformat, [0m[1;35marchive.toPath[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mtoPath[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     * Expands [0m[1;39m{[0m[39m@code archive[0m[1;39m}[0m[39m into [0m[1;39m{[0m[39m@code targetDirectory[0m[1;39m}[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:     * This method creates a wrapper around the archive stream which is never [0m  [2m                [0m
[2;36m                    [0m         [39mclosed and thus leaks resources, please use[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:     * [0m[1;39m{[0m[39m@link #[0m[1;35mexpand[0m[1;39m([0m[39mString,InputStream,File,CloseableConsumer[0m[1;39m)[0m[1;39m}[0m[39m instead.[0m      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     * @param archive         the file to expand[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:30[0m[39m-[0m[1;36m40[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Core Issue and Root Cause  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - The `Expander` example‚Äôs extraction logic relies on the default [0m               [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[39mPath parentPath[0m[1;39m)[0m[39m` implementation, which does:[0m               [2m                [0m
[2;36m                    [0m         [39m     ```java[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m         throw new [0m[1;35mIOException[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Because `startsWith` is applied before path normalization, an entry name like [0m [2m                [0m
[2;36m                    [0m         [39m`‚Äú..[0m[35m/[0m[95mevil.txt[0m[39m‚Äù` yields  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m     ``` [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mparentPath.resolve[0m[1;39m([0m[32m"../evil.txt"[0m[1;39m)[0m[39m            ‚Üí [0m[32m"‚Ä¶/output/dir/../evil.txt"[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39m     ```  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     and `[0m[32m"‚Ä¶/output/dir/../evil.txt"[0m[1;35m.startsWith[0m[1;39m([0m[32m"‚Ä¶/output/dir"[0m[1;39m)[0m[39m` still returns [0m     [2m                [0m
[2;36m                    [0m         [39mtrue, bypassing the check.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Strategic Fix Location  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Centralize the path‚Äêtraversal prevention in the single `resolveIn` method in [0m  [2m                [0m
[2;36m                    [0m         [39m`ArchiveEntry.java`. All extraction code in `Expander` calls `resolveIn`, so a [0m     [2m                [0m
[2;36m                    [0m         [39mone‚Äêline change here protects every overload and format.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Patch Outline  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   a. Modify `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[39mPath parentPath[0m[1;39m)[0m[39m` by normalizing both the [0m     [2m                [0m
[2;36m                    [0m         [39mparent directory and the resolved child path before doing the `startsWith` check:  [0m [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. Convert `parentPath` to an absolute, normalized form.  [0m                    [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. Resolve the raw entry name against that normalized parent.  [0m               [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m3[0m[39m. Normalize the result to collapse any ‚Äú..‚Äù segments.  [0m                      [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m4[0m[39m. Verify that the normalized child remains under the normalized parent.  [0m    [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m5[0m[39m. Return the normalized, safe child `Path`.  [0m                                [2m                [0m
[2;36m                    [0m         [39m   b. [0m[1;39m([0m[39mOptional hardening[0m[1;39m)[0m[39m Reject absolute entry names or those beginning with [0m     [2m                [0m
[2;36m                    [0m         [39mslashes [0m[1;39m([0m[39m`[0m[32m"/"[0m[39m` or `"\"`[0m[1;39m)[0m[39m outright, since they cannot safely be mapped under the [0m    [2m                [0m
[2;36m                    [0m         [39mtarget directory.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Detailed Steps to Apply  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - In `src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`, [0m   [2m                [0m
[2;36m                    [0m         [39mreplace the default `resolveIn` body with the following logic [0m[1;39m([0m[39mpseudocode[0m[1;39m)[0m[39m:[0m         [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m [0m[1;36m1[0m[39m. Normalize the parent directory[0m                                       [2m                [0m
[2;36m                    [0m         [39m         Path normalizedParent = [0m[1;35mparentPath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m [0m[1;36m2[0m[39m. Get the raw entry name[0m                                               [2m                [0m
[2;36m                    [0m         [39m         String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m. [0m[1;39m([0m[39mOptional[0m[1;39m)[0m[39m Reject absolute or back‚Äêreference names early[0m             [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mname.startsWith[0m[1;39m([0m[32m"/"[0m[1;39m)[0m[39m || [0m[1;35mname.startsWith[0m[1;39m([0m[39m"\\"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m             || [0m[1;35mname.contains[0m[1;39m([0m[32m".."[0m[39m+File.separator[0m[1;39m)[0m[39m || [0m[1;35mname.contains[0m[1;39m([0m[32m"/.."[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIOException[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [39m               [0m[1;35mString.format[0m[1;39m([0m[32m"Invalid entry name '%s' leads to path traversal"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mname[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m [0m[1;36m4[0m[39m. Resolve and normalize the output path[0m                                [2m                [0m
[2;36m                    [0m         [39m         Path resolved = [0m[1;35mnormalizedParent.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m [0m[1;36m5[0m[39m. Security check: ensure the result is still within the target [0m        [2m                [0m
[2;36m                    [0m         [39mdirectory[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39m![0m[1;35mresolved.startsWith[0m[1;39m([0m[39mnormalizedParent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIOException[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [39m               [0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m,[0m                        [2m                [0m
[2;36m                    [0m         [39m                             normalizedParent, name, resolved[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         return resolved;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Ensure `[0m[1;35mExpander.toPath[0m[1;39m([0m[39mFile[0m[1;39m)[0m[39m` returns an absolute, normalized `Path` so that [0m [2m                [0m
[2;36m                    [0m         [39m`parentPath` is never left un‚Äênormalized:[0m                                           [2m                [0m
[2;36m                    [0m         [39m     ```java[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     private static Path [0m[1;35mtoPath[0m[1;39m([0m[39mfinal File file[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [39m         return file == null[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             ? null[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             : [0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - No other parts of `Expander` require changes, as they all use `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` to[0m [2m                [0m
[2;36m                    [0m         [39mcompute `targetPath`.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Preserving Existing Functionality  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Valid archive entries without ‚Äú..‚Äù or leading slashes resolve exactly as [0m      [2m                [0m
[2;36m                    [0m         [39mbefore, since normalization of already‚Äêclean paths is a no‚Äêop.  [0m                    [2m                [0m
[2;36m                    [0m         [39m   - All existing recursion, directory creation, and file writing logic remains [0m    [2m                [0m
[2;36m                    [0m         [39muntouched, so example usage and tests pass unchanged.  [0m                             [2m                [0m
[2;36m                    [0m         [39m   - The new checks only reject or throw `IOException` on malicious ‚Äúzip‚Äêslip‚Äù [0m     [2m                [0m
[2;36m                    [0m         [39mnames, preventing filesystem escape.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Addressing the Evaluation Findings  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - The fuzzing harness triggers `FuzzerSecurityIssueCritical` because malicious [0m  [2m                [0m
[2;36m                    [0m         [39mentries produce `targetPath` with `‚Äú..[0m[35m/[0m[39m‚Äù` segments.  [0m                               [2m                [0m
[2;36m                    [0m         [39m   - By normalizing and strictly enforcing `[0m[1;35mresolved.startsWith[0m[1;39m([0m[39mnormalizedParent[0m[1;39m)[0m[39m`,[0m [2m                [0m
[2;36m                    [0m         [39mthose segments are collapsed before the check, blocking traversal.  [0m                [2m                [0m
[2;36m                    [0m         [39m   - This single‚Äêpoint fix in `resolveIn` closes all code paths in [0m                 [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mExpander.expand[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` that form output paths from entry names.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Potential Side Effects and Mitigation  [0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Edge cases: if `parentPath` contains symbolic links, `toAbsolutePath` + [0m       [2m                [0m
[2;36m                    [0m         [39m`normalize` does not resolve symlinks. For ultimate hardening, one could replace [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mtoAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m` with `[0m[1;35mtoRealPath[0m[1;39m([0m[39mLinkOption.NOFOLLOW_LINKS[0m[1;39m)[0m[39m`, but [0m   [2m                [0m
[2;36m                    [0m         [39mthis may fail on non‚Äêexistent files.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - If downstream users relied [0m[1;39m([0m[39munintentionally[0m[1;39m)[0m[39m on out‚Äêof‚Äêtree extraction, those [0m [2m                [0m
[2;36m                    [0m         [39marchives will now throw `IOException`. This is acceptable for an example tool with [0m [2m                [0m
[2;36m                    [0m         [39ma clear security contract and should be documented in the release notes.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. Similar Precedents  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Other Apache projects implement ‚Äúzip slip‚Äù mitigation by normalizing and [0m      [2m                [0m
[2;36m                    [0m         [39mcomparing prefixes prior to file creation.  [0m                                        [2m                [0m
[2;36m                    [0m         [39m   - This strategy aligns with best practices in OWASP guidance on archive [0m         [2m                [0m
[2;36m                    [0m         [39mextraction.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCode Range for Patch Context:  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m<code_range>src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:7[0m [2m                [0m
[2;36m                    [0m         [1;92m5[0m[39m-[0m[1;36m82[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m<code_range>src/main/java/org/apache/commons/compress/archivers/examples/Expander.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:30[0m[39m-[0m[1;36m40[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=269816;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=284456;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=900302;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=677667;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgwfyuhjp[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/reports/prism.prism_o4_mini/apache-commons-compress_cc-full-0[0m [2m               [0m
[2;36m                    [0m         [35m1_vuln_5/[0m[95magent-output-1766475472.9489584[0m                                             [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc/apache-commons-compress_cc-full-01_vuln_5.toml                 [2m               [0m
[2;36m                    [0m         - Challenge project directory:                                                       [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/.cache/[0m[95mofficial-afc-commons-compress[0m                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/23/25 16:37:55][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=396076;file:///home/user/aixcc/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=328722;file:///home/user/aixcc/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/user/aixcc/crete/.cache/environments/[0m[95mapache-commons-compress[0m                   [2m               [0m
