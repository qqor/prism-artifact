--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -636,9 +636,7 @@
 dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)
 {
-  if ( hf_telnet_naws_subopt_set )
-    wmem_free(pinfo->pool, hf_naws_data);
-
+  (void)pinfo;
   return;
 }
 
@@ -2095,8 +2093,12 @@
         /* Data is escaped, we have to unescape it. */
         unescaped_tvb = unescape_and_tvbuffify_telnet_option(pinfo, tvb, start_offset, subneg_len);
         (*opt->dissect)(pinfo, opt->name, unescaped_tvb, 0, subneg_len - iac_data, option_tree, option_item);
-      } else {
-        (*opt->dissect)(pinfo, opt->name, tvb, start_offset, subneg_len, option_tree, option_item);
+        if ( hf_telnet_naws_subopt_set ) {
+          /* Reset NAWS state; buffer will be freed by pool teardown */
+          hf_naws_data = NULL;
+          hf_telnet_naws_subopt_set = 0;
+          hf_telnet_line = 0;
+        }
       }
     } else {
       /* We don't have a dissector for them; just show them as data. */
