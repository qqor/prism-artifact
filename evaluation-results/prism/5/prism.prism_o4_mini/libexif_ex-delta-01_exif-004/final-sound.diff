--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -117,11 +117,14 @@
         } else {
             dofs = ofs + 8;
         }
-	if (dofs > buf_size) {
-		exif_log (md->log, EXIF_LOG_CODE_CORRUPT_DATA,
-                                  "ExifMnoteApplet", "Tag size overflow detected (%u vs size %u)", dofs, buf_size);
-		continue;
-	}
+    /* Reject any entry whose offset or length would exceed the buffer. */
+    if (dofs > buf_size || dofs + dsize > buf_size) {
+        exif_log (md->log, EXIF_LOG_CODE_CORRUPT_DATA,
+                                  "ExifMnoteApple",
+                                  "Tag data past end of buffer (offset %u + size %u > buffer %u)",
+                                  dofs, dsize, buf_size);
+        continue;
+    }
         ofs += 12;
         d->entries[i].data = exif_mem_alloc(md->mem, dsize);
         if (!d->entries[i].data) {
