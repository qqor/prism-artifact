{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-02_exif-001",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.1675729,
    "prompt_tokens": 85835,
    "completion_tokens": 16626
  },
  "variant": "sound",
  "diff": "--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -829,14 +829,20 @@\n \t/* \n \t * If we are able to interpret the maker note, do so.\n \t */\n-\tif (data->priv->md) {\n-\t\texif_mnote_data_log (data->priv->md, data->priv->log);\n-\t\texif_mnote_data_set_byte_order (data->priv->md,\n-\t\t\t\t\t\tdata->priv->order);\n-\t\texif_mnote_data_set_offset (data->priv->md,\n-\t\t\t\t\t    data->priv->offset_mnote);\n-\t\texif_mnote_data_load (data->priv->md, d, ds);\n-\t}\n+    if (data->priv->md) {\n+        exif_mnote_data_log(data->priv->md, data->priv->log);\n+        exif_mnote_data_set_byte_order(data->priv->md, data->priv->order);\n+        {\n+            ExifEntry *e = exif_data_get_entry(data, EXIF_TAG_MAKER_NOTE);\n+            if (!e || !e->data || e->size == 0) {\n+                exif_log(data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,\n+                         \"ExifData\", \"No MakerNote payload to parse\");\n+            } else {\n+                exif_mnote_data_set_offset(data->priv->md, 0);\n+                exif_mnote_data_load(data->priv->md, e->data, e->size);\n+            }\n+        }\n+    }\n }\n \n #define LOG_TOO_SMALL \\\n",
  "stdout": "",
  "stderr": ""
}