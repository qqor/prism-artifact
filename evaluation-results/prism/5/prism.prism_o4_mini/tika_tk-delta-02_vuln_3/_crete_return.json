{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-02_vuln_3",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.30201600000000006,
    "prompt_tokens": 162820,
    "completion_tokens": 27935
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n@@ -50,6 +50,29 @@\n  * Basic parser for m3u8 files\n  */\n public class M3U8Parser implements Parser {\n+\n+    /**\n+     * Configuration for M3U8Parser controlling remote fetching of HTTP links.\n+     * Default is false.\n+     */\n+    public static class M3U8ParserConfig implements java.io.Serializable {\n+        private boolean allowRemoteFetch = false;\n+\n+        /**\n+         * Returns whether remote HTTP(S) fetch is allowed. Default is false.\n+         */\n+        public boolean isAllowRemoteFetch() {\n+            return allowRemoteFetch;\n+        }\n+\n+        /**\n+         * Sets whether remote HTTP(S) fetch is allowed.\n+         */\n+        public void setAllowRemoteFetch(boolean allowRemoteFetch) {\n+            this.allowRemoteFetch = allowRemoteFetch;\n+        }\n+    }\n+\n     public static final String M3U8_PREFIX = \"m3u8:\";\n     public static final Property PLAY_LIST_LINK = Property.internalTextBag(M3U8_PREFIX + \"link\");\n     public static final Property M3U8_VERSION = Property.internalInteger(M3U8_PREFIX + \"version\");\n@@ -161,7 +184,9 @@\n         // split on , then the first value is the length (can be -1),\n         // the last value is the title; intermediate values are key=value format\n         metadata.add(PLAY_LIST_LINK, nextLine);\n-        if (! nextLine.startsWith(\"http\")) {\n+        M3U8ParserConfig config = context.get(M3U8ParserConfig.class, new M3U8ParserConfig());\n+        // Skip remote fetch if the link is not HTTP(S) or remote fetch is disabled\n+        if (!nextLine.startsWith(\"http\") || !config.isAllowRemoteFetch()) {\n             return;\n         }\n         EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n",
  "stdout": "",
  "stderr": ""
}