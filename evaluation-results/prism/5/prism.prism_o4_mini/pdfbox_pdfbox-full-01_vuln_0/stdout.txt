[2;36m[12/24/25 05:23:20][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=536457;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=521610;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp191k5j0o[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_0/[0m[95magen[0m [2m               [0m
[2;36m                    [0m         [95mt-output-1766521400.9679615[0m                                                          [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_0.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/aixcc/crete/.cache/[0m[95mofficial-afc-pdfbox[0m     [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=159688;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=543471;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:24:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=600562;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=480425;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m59.76[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=597844;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=49207;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=68797;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=113893;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=233512;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=277531;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m59[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=283933;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=161321;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:24:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.52[0m seconds;                ]8;id=21086;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=347385;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 05:24:22][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=66916;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=623368;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=224153;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=610265;file:///home/user/aixcc/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=301761;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=890455;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=277397;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=822031;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:24:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.51[0m seconds;                ]8;id=281242;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=120303;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 05:24:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=673695;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=23984;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.54[0m seconds;                ]8;id=126712;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=28004;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 05:24:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=197710;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=920823;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.xmpbox.xml.DomXmpParser.parse[0m[1;39m([0m[39mDomXmpParser.jav[0m[1;92ma:113[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXmpParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXmpParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 9e0307ad4945d0d0[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init[0m[1m>[0m[1m([0mHttpClient.jav[1;92ma:246[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:351[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:373[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1m([0mHttpURLConne [2m                [0m
[2;36m                    [0m         ction.jav[1;92ma:1309[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1m([0mHttpURLConnection.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1m([0mXMLEntityManager.jav[1;92ma:677[0m[1m)[0m                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1397[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1333[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:1859[0m[1m)[0m                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:3001[0m[1m)[0m                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1m([0mXMLDoc [2m                [0m
[2;36m                    [0m         umentScannerImpl.jav[1;92ma:605[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1m([0mXMLN [2m                [0m
[2;36m                    [0m         SDocumentScannerImpl.jav[1;92ma:112[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:542[0m[1m)[0m                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:889[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:825[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1m([0mXMLParser.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1m([0mDOMParser.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1m([0mDocument [2m                [0m
[2;36m                    [0m         BuilderImpl.jav[1;92ma:342[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1m([0mDocumentBuilder.jav[1;92ma:122[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.xmpbox.xml.DomXmpParser.parse[0m[1m([0mDomXmpParser.jav[1;92ma:113[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXmpParserFuzzer.fuzzerTestOneInput[0m[1m([0mDomXmpParserFuzzer.jav[1;92ma:57[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 9e0307ad4945d0d0                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/24/25 05:24:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=903304;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=901103;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 05:25:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=179988;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=118361;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/24/25 05:25:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=376296;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=203287;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=217778;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=776648;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.63[0m seconds;                ]8;id=719087;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=426780;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/24/25 05:25:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=94896;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=215877;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpem665inz[0m                                                 ]8;id=495170;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=58464;file:///home/user/aixcc/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/24/25 05:26:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m58.47[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=543633;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=871637;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=981839;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=704350;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:26:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m15.99[0m seconds;              ]8;id=931738;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=602940;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=876016;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=356630;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:27:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m5.85[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=280812;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=591428;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=92692;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=399903;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=318380;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=706334;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=890363;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=609597;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:27:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.59[0m seconds;                ]8;id=632982;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=210529;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=993018;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=574922;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:27:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.63[0m seconds;                ]8;id=964044;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=363694;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=726616;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586186;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/24/25 05:27:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.56[0m seconds;                ]8;id=44620;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=510232;file:///home/user/aixcc/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=665804;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=692857;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/xmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.java                  [2m                [0m
[2;36m                    [0m         +++ b/xmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.java                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-79[0m,[1;36m6[0m +[1;36m79[0m,[1;36m15[0m @@                                                                  [2m                [0m
[2;36m                    [0m                  try                                                                        [2m                [0m
[2;36m                    [0m                  [1m{[0m                                                                          [2m                [0m
[2;36m                    [0m                      DocumentBuilderFactory dbFactory =                                     [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1m([0m[1m)[0m;                                               [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mdbFactory.setFeature[0m[1m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m, true[1m)[0m; [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mdbFactory.setFeature[0m[1m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m,       [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mdbFactory.setFeature[0m[1m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mdbFactory.setFeature[0m[1m([0m[32m"http://apache.org/xml/features/nonvalidating/load-external-dt[0m [2m                [0m
[2;36m                    [0m         [32md"[0m, false[1m)[0m;                                                                         [2m                [0m
[2;36m                    [0m         +            [1;35mdbFactory.setXIncludeAware[0m[1m([0mfalse[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +            [1;35mdbFactory.setExpandEntityReferences[0m[1m([0mfalse[1m)[0m;                            [2m                [0m
[2;36m                    [0m         +            [1;35mdbFactory.setFeature[0m[1m([0mXMLConstants.FEATURE_SECURE_PROCESSING, true[1m)[0m;    [2m                [0m
[2;36m                    [0m         +            [1;35mdbFactory.setAttribute[0m[1m([0mXMLConstants.ACCESS_EXTERNAL_DTD, [32m""[0m[1m)[0m;          [2m                [0m
[2;36m                    [0m         +            [1;35mdbFactory.setAttribute[0m[1m([0mXMLConstants.ACCESS_EXTERNAL_SCHEMA, [32m""[0m[1m)[0m;       [2m                [0m
[2;36m                    [0m                      [1;35mdbFactory.setNamespaceAware[0m[1m([0mtrue[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                      dBuilder = [1;35mdbFactory.newDocumentBuilder[0m[1m([0m[1m)[0m;                             [2m                [0m
[2;36m                    [0m                      nsFinder = new [1;35mNamespaceFinder[0m[1m([0m[1m)[0m;                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.xmpbox.xml.DomXmpParser.parse[0m[1;39m([0m[39mDomXmpParser.jav[0m[1;92ma:113[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXmpParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXmpParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 9e0307ad4945d0d0[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Jazzer fuzzing run detected a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m attempt when [0m    [2m                [0m
[2;36m                    [0m         [39mparsing XML in the `DomXmpParser` component. The fuzzer triggered an outbound HTTP [0m [2m                [0m
[2;36m                    [0m         [39mconnection to `jazze.com:[0m[1;36m80[0m[39m`, which was flagged by the Jazzer [0m                      [2m                [0m
[2;36m                    [0m         [39m`ServerSideRequestForgery` sanitizer. This indicates that untrusted input can [0m      [2m                [0m
[2;36m                    [0m         [39minfluence network requests during XML parsing.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue Type  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  The issue is classified as a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability, as[0m [2m                [0m
[2;36m                    [0m         [39mreported by the Jazzer API [0m[1;39m([0m[39m`FuzzerSecurityIssueMedium: Server Side Request Forgery[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mSSRF[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- What Happened  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  During fuzz testing, an input caused the XML parser to resolve an external entity[0m [2m                [0m
[2;36m                    [0m         [39mor resource. In the process of parsing, the code invoked `java.net.Socket.connect` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mvia `HttpURLConnection`[0m[1;39m)[0m[39m, attempting to connect to `jazze.com:[0m[1;36m80[0m[39m`. The Jazzer [0m     [2m                [0m
[2;36m                    [0m         [39msanitizer intercepted this and raised an SSRF alert.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Key Observations  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. The stack trace shows the vulnerability arises deep in the standard Java XML [0m  [2m                [0m
[2;36m                    [0m         [39mparsing pipeline [0m[1;39m([0m[39mXerces[0m[1;39m)[0m[39m when resolving entities.  [0m                                [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. The sequence is:  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m     • `DomXmpParserFuzzer.fuzzerTestOneInput` →  [0m                                  [2m                [0m
[2;36m                    [0m         [39m     • `DomXmpParser.parse` →  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m     • `javax.xml.parsers.DocumentBuilder.parse` →  [0m                                [2m                [0m
[2;36m                    [0m         [39m     • Xerces’s `XMLEntityManager.setupCurrentEntity` →  [0m                           [2m                [0m
[2;36m                    [0m         [39m     • `HttpURLConnection.getInputStream` → outbound socket connect.  [0m              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. The fuzzer harness itself merely supplies XML data; it is not the root cause [0m  [2m                [0m
[2;36m                    [0m         [39mbut enables exploration of the XML parser’s behavior with untrusted input.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Affected Code Areas  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m  To understand the full impact, review the following components and their [0m         [2m                [0m
[2;36m                    [0m         [39minteractions:  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m  • `DomXmpParser` [0m[1;39m([0m[39mpart of the XMPBox library[0m[1;39m)[0m[39m and how it configures and invokes [0m  [2m                [0m
[2;36m                    [0m         [39mthe XML parser.  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  • XML parser configuration in the codebase, particularly entity resolution [0m       [2m                [0m
[2;36m                    [0m         [39msettings in `DocumentBuilderFactory` [0m[35m/[0m[39m `XMLParser` [0m[1;39m([0m[39me.g., use of [0m                   [2m                [0m
[2;36m                    [0m         [39m`setEntityResolver` or disabling external entities[0m[1;39m)[0m[39m.  [0m                              [2m                [0m
[2;36m                    [0m         [39m  • Any custom or default settings around external resource loading in Xerces [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`XML11Configuration`, `XMLDocumentFragmentScannerImpl`[0m[1;39m)[0m[39m.  [0m                         [2m                [0m
[2;36m                    [0m         [39m  • Networking code paths in `HttpURLConnection` and `Socket` as triggered by XML [0m  [2m                [0m
[2;36m                    [0m         [39mentity resolution.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Investigation Scope  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m  A holistic review should include:  [0m                                               [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. How `DomXmpParser` initializes the parser and whether external entity [0m         [2m                [0m
[2;36m                    [0m         [39mresolution is enabled by default.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Presence or absence of secure parser configurations [0m[1;39m([0m[39me.g., disabling [0m          [2m                [0m
[2;36m                    [0m         [39m`FEATURE_SECURE_PROCESSING`, setting limiting features[0m[1;39m)[0m[39m.  [0m                          [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Any wrappers or utility classes that may inadvertently allow untrusted URLs to[0m [2m                [0m
[2;36m                    [0m         [39mbe fetched.  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Comparison with known secure XML parsing practices to identify configuration [0m  [2m                [0m
[2;36m                    [0m         [39mgaps.[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m---[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.xmpbox.xml.DomXmpParser.parse[0m[1;39m([0m[39mDomXmpParser.jav[0m[1;92ma:113[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXmpParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXmpParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 9e0307ad4945d0d0[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*****************************************************************************[0m    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * [0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: ****************************************************************************[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:package org.apache.xmpbox.xml;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.ArrayDeque;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Deque;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.StringTokenizer;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import javax.xml.XMLConstants;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import javax.xml.namespace.QName;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.xmpbox.XMPMetadata;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.xmpbox.XmpConstants;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.xmpbox.schema.XMPSchema;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.xmpbox.schema.XmpSchemaException;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.xmpbox.type.AbstractField;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.xmpbox.type.AbstractSimpleProperty;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.xmpbox.type.AbstractStructuredType;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.xmpbox.type.ArrayProperty;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.xmpbox.type.Attribute;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.xmpbox.type.BadFieldValueException;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.xmpbox.type.Cardinality;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.xmpbox.type.ComplexPropertyContainer;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.xmpbox.type.PropertiesDescription;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.xmpbox.type.PropertyType;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.xmpbox.type.TypeMapping;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.xmpbox.type.Types;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.xmpbox.xml.XmpParsingException.ErrorType;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.w3c.dom.Attr;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.w3c.dom.Comment;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.w3c.dom.Element;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.w3c.dom.NamedNodeMap;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.w3c.dom.Node;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.w3c.dom.NodeList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.w3c.dom.ProcessingInstruction;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.w3c.dom.Text;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:public class DomXmpParser[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private DocumentBuilder dBuilder;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private NamespaceFinder nsFinder;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private boolean strictParsing = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public [0m[1;35mDomXmpParser[0m[1;39m([0m[1;39m)[0m[39m throws XmpParsingException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            DocumentBuilderFactory dbFactory = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mdbFactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            dBuilder = [0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            nsFinder = new [0m[1;35mNamespaceFinder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.Configuration, [0m[32m"Failed to [0m   [2m                [0m
[2;36m                    [0m         [32minitialize"[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public boolean [0m[1;35misStrictParsing[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return strictParsing;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    public void [0m[1;35msetStrictParsing[0m[1;39m([0m[39mboolean strictParsing[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        this.strictParsing = strictParsing;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    public XMPMetadata [0m[1;35mparse[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m xmp[0m[1;39m)[0m[39m throws XmpParsingException[0m             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        ByteArrayInputStream input = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mxmp[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        return [0m[1;35mparse[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    public XMPMetadata [0m[1;35mparse[0m[1;39m([0m[39mInputStream input[0m[1;39m)[0m[39m throws XmpParsingException[0m      [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        Document document = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            document = [0m[1;35mdBuilder.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        catch [0m[1;39m([0m[39mSAXException | IOException e[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.Undefined, [0m[32m"Failed to [0m      [2m                [0m
[2;36m                    [0m         [32mparse"[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        XMPMetadata xmp = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[35m/[0m[35m/[0m[39m Start reading[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;35mremoveComments[0m[1;39m([0m[39mdocument[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        Node node = [0m[1;35mdocument.getFirstChild[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        [0m[35m/[0m[35m/[0m[39m expect xpacket processing instruction[0m                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m![0m[1;39m([0m[39mnode instanceof ProcessingInstruction[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.XpacketBadStart, [0m[32m"xmp [0m      [2m                [0m
[2;36m                    [0m         [32mshould start with a processing instruction"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            xmp = [0m[1;35mparseInitialXpacket[0m[1;39m([0m[1;39m([0m[39mProcessingInstruction[0m[1;39m)[0m[39m node[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            node = [0m[1;35mnode.getNextSibling[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[35m/[0m[35m/[0m[39m forget other processing instruction[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        while [0m[1;39m([0m[39mnode instanceof ProcessingInstruction[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            node = [0m[1;35mnode.getNextSibling[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[35m/[0m[35m/[0m[39m expect root element[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        Element root = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39m![0m[1;39m([0m[39mnode instanceof Element[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.NoRootElement, [0m[32m"xmp should [0m [2m                [0m
[2;36m                    [0m         [32mcontain a root element"[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[35m/[0m[35m/[0m[39m use this element as root[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            root = [0m[1;39m([0m[39mElement[0m[1;39m)[0m[39m node;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            node = [0m[1;35mnode.getNextSibling[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[35m/[0m[35m/[0m[39m expect xpacket end[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        if [0m[1;39m([0m[39m![0m[1;39m([0m[39mnode instanceof ProcessingInstruction[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.XpacketBadEnd, [0m[32m"xmp should [0m [2m                [0m
[2;36m                    [0m         [32mend with a processing instruction"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mparseEndPacket[0m[1;39m([0m[39mxmp, [0m[1;39m([0m[39mProcessingInstruction[0m[1;39m)[0m[39m node[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            node = [0m[1;35mnode.getNextSibling[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[35m/[0m[35m/[0m[39m should be null[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39mnode != null[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.XpacketBadEnd,[0m              [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                    [0m[32m"xmp should end after xpacket end processing instruction"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[35m/[0m[35m/[0m[39m xpacket is OK and the is no more nodes[0m                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        [0m[35m/[0m[35m/[0m[39m Now, parse the content of root[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        Element rdfRdf = [0m[1;35mfindDescriptionsParent[0m[1;39m([0m[39mroot[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        List<Element> descriptions = [0m[1;35mDomHelper.getElementChildren[0m[1;39m([0m[39mrdfRdf[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        List<Element> dataDescriptions = new ArrayList<>[0m[1;39m([0m[1;35mdescriptions.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        for [0m[1;39m([0m[39mElement description : descriptions[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            Element first = [0m[1;35mDomHelper.getFirstChildElement[0m[1;39m([0m[39mdescription[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            if [0m[1;39m([0m[39mfirst != null && [0m[32m"pdfaExtension"[0m[1;35m.equals[0m[1;39m([0m[1;35mfirst.getPrefix[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                [0m[1;35mPdfaExtensionHelper.validateNaming[0m[1;39m([0m[39mxmp, description[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                [0m[1;35mparseDescriptionRoot[0m[1;39m([0m[39mxmp, description[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                [0m[1;35mdataDescriptions.add[0m[1;39m([0m[39mdescription[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        [0m[35m/[0m[35m/[0m[39m find schema description[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;35mPdfaExtensionHelper.populateSchemaMapping[0m[1;39m([0m[39mxmp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[35m/[0m[35m/[0m[39m parse data description[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        for [0m[1;39m([0m[39mElement description : dataDescriptions[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[1;35mparseDescriptionRoot[0m[1;39m([0m[39mxmp, description[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        return xmp;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    private void [0m[1;35mparseDescriptionRoot[0m[1;39m([0m[39mXMPMetadata xmp, Element description[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mthrows XmpParsingException[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mnsFinder.push[0m[1;39m([0m[39mdescription[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:69[0m[39m-[0m[1;36m78[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is, boolean nsAware[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.jav[0m[1;92ma:77[0m[39m-[0m[1;36m86[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public [0m[1;35mDomXmpParser[0m[1;39m([0m[1;39m)[0m[39m throws XmpParsingException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            DocumentBuilderFactory dbFactory = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mdbFactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            dBuilder = [0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            nsFinder = new [0m[1;35mNamespaceFinder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:73[0m[39m-[0m[1;36m83[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mbuilderFactory.setFeature[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m                                                             [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mbuilderFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mbuilderFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mbuilderFactory.setNamespaceAware[0m[1;39m([0m[39mnsAware[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.jav[0m[1;92ma:77[0m[39m-[0m[1;36m86[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public [0m[1;35mDomXmpParser[0m[1;39m([0m[1;39m)[0m[39m throws XmpParsingException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            DocumentBuilderFactory dbFactory = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mdbFactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            dBuilder = [0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            nsFinder = new [0m[1;35mNamespaceFinder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   The SSRF vulnerability arises because DomXmpParser uses a default [0m               [2m                [0m
[2;36m                    [0m         [39mDocumentBuilderFactory with external entity resolution enabled. Untrusted XML input[0m [2m                [0m
[2;36m                    [0m         [39mcan trigger HTTP connections via external entity fetching. To eliminate SSRF [0m       [2m                [0m
[2;36m                    [0m         [39mwithout altering the fuzzer harness or test code, we must harden the XML parser [0m    [2m                [0m
[2;36m                    [0m         [39mconfiguration in DomXmpParser’s constructor to disable all external resource [0m       [2m                [0m
[2;36m                    [0m         [39mloading and enable secure processing.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Location  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - File: xmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.java  [0m           [2m                [0m
[2;36m                    [0m         [39m   - Method: public [0m[1;35mDomXmpParser[0m[1;39m([0m[1;39m)[0m[39m throws XmpParsingException[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Detailed Steps  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   a. Immediately after instantiating the DocumentBuilderFactory [0m[1;39m([0m[39mafter [0m            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m` and before [0m                                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m, apply the following secure-parsing [0m              [2m                [0m
[2;36m                    [0m         [39mconfigurations:  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m      • Disallow DOCTYPE declarations:  [0m                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m [2m                [0m
[2;36m                    [0m         [39m, true[0m[1;39m)[0m[39m;  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m      • Disable external-general-entities:  [0m                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities[0m [2m                [0m
[2;36m                    [0m         [32m"[0m[39m, false[0m[1;39m)[0m[39m;  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      • Disable external-parameter-entities:  [0m                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entiti[0m [2m                [0m
[2;36m                    [0m         [32mes"[0m[39m, false[0m[1;39m)[0m[39m;  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m      • Disable loading external DTDs:  [0m                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/nonvalidating/load-ext[0m [2m                [0m
[2;36m                    [0m         [32mernal-dtd"[0m[39m, false[0m[1;39m)[0m[39m;  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m      • Disable XInclude processing:  [0m                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;  [0m                                        [2m                [0m
[2;36m                    [0m         [39m      • Prevent automatic entity expansion:  [0m                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;  [0m                               [2m                [0m
[2;36m                    [0m         [39m      • Enable secure processing:  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setFeature[0m[1;39m([0m[39mXMLConstants.FEATURE_SECURE_PROCESSING, true[0m[1;39m)[0m[39m;  [0m       [2m                [0m
[2;36m                    [0m         [39m      • Restrict external DTD/Schema access [0m[1;39m([0m[39mJAXP [0m[1;36m1.5[0m[39m+[0m[1;39m)[0m[39m:  [0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setAttribute[0m[1;39m([0m[39mXMLConstants.ACCESS_EXTERNAL_DTD, [0m[32m""[0m[1;39m)[0m[39m;  [0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mdbFactory.setAttribute[0m[1;39m([0m[39mXMLConstants.ACCESS_EXTERNAL_SCHEMA, [0m[32m""[0m[1;39m)[0m[39m;  [0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Exception Handling  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m      - Wrap any ParserConfigurationException thrown by these feature/attribute [0m    [2m                [0m
[2;36m                    [0m         [39mcalls in the existing XmpParsingException with ErrorType.Configuration.  [0m           [2m                [0m
[2;36m                    [0m         [39m      - This ensures unsupported-feature errors fail fast and propagate correctly.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   c. Preserve Existing Logic  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m      - Retain `[0m[1;35mdbFactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m` as before.  [0m                     [2m                [0m
[2;36m                    [0m         [39m      - Continue to initialize `dBuilder = [0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m` and [0m     [2m                [0m
[2;36m                    [0m         [39m`nsFinder` unchanged.  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m      - No changes to parsing flow, XMP model building, or exception semantics [0m     [2m                [0m
[2;36m                    [0m         [39mbeyond configuration errors.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - These JAXP features mirror the secure settings used in PDFBox’s XMLUtil [0m[1;39m([0m[39mwhich[0m [2m                [0m
[2;36m                    [0m         [39msuccessfully prevents external entity resolution[0m[1;39m)[0m[39m.  [0m                                [2m                [0m
[2;36m                    [0m         [39m   - Disabling DOCTYPE and external entities blocks both XXE and SSRF attack [0m       [2m                [0m
[2;36m                    [0m         [39mvectors stemming from external XML resources.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Enabling `FEATURE_SECURE_PROCESSING` limits overall resource consumption and [0m  [2m                [0m
[2;36m                    [0m         [39menforces parser-level safeguards.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Setting `ACCESS_EXTERNAL_DTD`[0m[35m/[0m[39m`SCHEMA` to empty strings further clamps down on[0m [2m                [0m
[2;36m                    [0m         [39many schema-based fetches in compliant JAXP implementations.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side Effects & Mitigation  [0m                                            [2m                [0m
[2;36m                    [0m         [39m   - XML documents relying on valid external DTDs or entity expansions will now [0m    [2m                [0m
[2;36m                    [0m         [39mfail parsing; this is an acceptable trade-off for hardening.  [0m                      [2m                [0m
[2;36m                    [0m         [39m   - Clients requiring DTD-based validation must switch to a dedicated, trusted [0m    [2m                [0m
[2;36m                    [0m         [39mpipeline. DomXmpParser is specifically for XMP metadata extraction and should not [0m  [2m                [0m
[2;36m                    [0m         [39mdepend on external DTDs.  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - All existing unit tests for XMP parsing [0m[1;39m([0m[39mwhich use inline XMP structures[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mremain unaffected as they do not reference external entities.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Similar secure XML parsing configuration in [0m                                   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.pdfbox.util.XMLUtil.parse[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m   - OWASP recommendations for secure JAXP usage: disable external entity [0m          [2m                [0m
[2;36m                    [0m         [39mprocessing and enable secure processing.  [0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=804166;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=312438;file:///home/user/aixcc/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=104562;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=830928;file:///home/user/aixcc/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp191k5j0o[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/aixcc/crete/reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_0/[0m[95magen[0m [2m               [0m
[2;36m                    [0m         [95mt-output-1766521624.5493026[0m                                                          [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc/pdfbox_pdfbox-full-01_vuln_0.toml       [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/aixcc/crete/.cache/[0m[95mofficial-afc-pdfbox[0m     [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/24/25 05:27:06][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/aixcc/crete/.cache/environments/[0m[95mpdfbox[0m   ]8;id=973169;file:///home/user/aixcc/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=834618;file:///home/user/aixcc/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
