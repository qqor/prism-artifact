--- a/lib/ftp.c
+++ b/lib/ftp.c
@@ -2094,17 +2094,34 @@
         if(result)
           return result;
 
+        /* clamp tm_wday to valid range [0..6] and normalize Sunday to index 6 */
+        int wdayidx = tm->tm_wday;
+        if(wdayidx < 1 || wdayidx > 6)
+          wdayidx = 6;
+        else
+          wdayidx -= 1;
+
+        /* clamp tm_mon to valid range [0..11] for Curl_month[] */
+        int monidx = tm->tm_mon;
+        if(monidx < 0 || monidx > 11)
+          monidx = 0;
+
+        /* clamp tm_sec to valid range [0..59] for Curl_seconds[] */
+        int secidx = tm->tm_sec;
+        if(secidx < 0 || secidx >= 60)
+          secidx = 0;
+
         /* format: "Tue, 15 Nov 1994 12:45 and twenty-six seconds" */
         headerbuflen =
           msnprintf(headerbuf, sizeof(headerbuf),
             "Last-Modified: %s, %02d %s %4d %02d:%02d and %s seconds GMT\r\n",
-                    Curl_wkday[tm->tm_wday ? tm->tm_wday-1 : 6],
+                    Curl_wkday[wdayidx],
                     tm->tm_mday,
-                    Curl_month[tm->tm_mon],
+                    Curl_month[monidx],
                     tm->tm_year + 1900,
                     tm->tm_hour,
                     tm->tm_min,
-                    Curl_seconds[tm->tm_sec]);
+                    Curl_seconds[secidx]);
         result = client_write_header(data, headerbuf, headerbuflen);
         if(result)
           return result;

--- a/lib/file.c
+++ b/lib/file.c
@@ -486,12 +486,24 @@
       return result;
 
     /* format: "Tue, 15 Nov 1994 12:45:26 GMT" */
+    /* clamp tm_wday to valid range [0..6] and normalize Sunday to index 6 */
+    int wdayidx = tm->tm_wday;
+    if(wdayidx < 1 || wdayidx > 6)
+      wdayidx = 6;
+    else
+      wdayidx -= 1;
+
+    /* clamp tm_mon to valid range [0..11] for Curl_month[] */
+    int monidx = tm->tm_mon;
+    if(monidx < 0 || monidx > 11)
+      monidx = 0;
+
     headerlen =
       msnprintf(header, sizeof(header),
                 "Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n",
-                Curl_wkday[tm->tm_wday ? tm->tm_wday-1 : 6],
+                Curl_wkday[wdayidx],
                 tm->tm_mday,
-                Curl_month[tm->tm_mon],
+                Curl_month[monidx],
                 tm->tm_year + 1900,
                 tm->tm_hour,
                 tm->tm_min,

--- a/lib/http.c
+++ b/lib/http.c
@@ -1442,12 +1442,24 @@
    */
 
   /* format: "Tue, 15 Nov 1994 12:45:26 GMT" */
+  /* clamp tm_wday to valid range [0..6] and normalize Sunday to index 6 */
+  int wdayidx = tm->tm_wday;
+  if(wdayidx < 1 || wdayidx > 6)
+    wdayidx = 6;
+  else
+    wdayidx -= 1;
+
+  /* clamp tm_mon to valid range [0..11] for Curl_month[] */
+  int monidx = tm->tm_mon;
+  if(monidx < 0 || monidx > 11)
+    monidx = 0;
+
   msnprintf(datestr, sizeof(datestr),
             "%s: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n",
             condp,
-            Curl_wkday[tm->tm_wday ? tm->tm_wday-1 : 6],
+            Curl_wkday[wdayidx],
             tm->tm_mday,
-            Curl_month[tm->tm_mon],
+            Curl_month[monidx],
             tm->tm_year + 1900,
             tm->tm_hour,
             tm->tm_min,

--- a/lib/vtls/gtls.c
+++ b/lib/vtls/gtls.c
@@ -190,13 +190,25 @@
   if(result)
     return;
 
+  /* clamp tm_wday to valid range [0..6] and normalize Sunday to index 6 */
+  int wdayidx = tm->tm_wday;
+  if(wdayidx < 1 || wdayidx > 6)
+    wdayidx = 6;
+  else
+    wdayidx -= 1;
+
+  /* clamp tm_mon to valid range [0..11] for Curl_month[] */
+  int monidx = tm->tm_mon;
+  if(monidx < 0 || monidx > 11)
+    monidx = 0;
+
   msnprintf(str,
             sizeof(str),
             "  %s: %s, %02d %s %4d %02d:%02d:%02d GMT",
             text,
-            Curl_wkday[tm->tm_wday ? tm->tm_wday-1 : 6],
+            Curl_wkday[wdayidx],
             tm->tm_mday,
-            Curl_month[tm->tm_mon],
+            Curl_month[monidx],
             tm->tm_year + 1900,
             tm->tm_hour,
             tm->tm_min,
