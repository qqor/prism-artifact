--- a/lib/doh.c
+++ b/lib/doh.c
@@ -1408,7 +1408,8 @@
     size_t slot;
     for(slot = 0; slot < DOH_SLOT_COUNT; slot++) {
       mid = doh->probe[slot].easy_mid;
-      if(mid < 0)
+      /* skip invalid or out-of-range mids */
+      if(mid < 0 || (size_t)mid >= data->multi->num_easy)
         continue;
       doh->probe[slot].easy_mid = -1;
       /* should have been called before data is removed from multi handle */
