{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-delta-05_curl-002",
  "source_directory": "/home/user/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.1230625,
    "prompt_tokens": 58363,
    "completion_tokens": 13378
  },
  "variant": "sound",
  "diff": "--- a/lib/ftp.c\n+++ b/lib/ftp.c\n@@ -2095,6 +2095,10 @@\n           return result;\n \n         /* format: \"Tue, 15 Nov 1994 12:45 and twenty-six seconds\" */\n+        /* clamp tm_sec to valid range 0â€“59 to avoid OOB on Curl_seconds */\n+        size_t secidx = (size_t)tm->tm_sec;\n+        if(secidx >= 60)\n+          secidx = 59;\n         headerbuflen =\n           msnprintf(headerbuf, sizeof(headerbuf),\n             \"Last-Modified: %s, %02d %s %4d %02d:%02d and %s seconds GMT\\r\\n\",\n@@ -2104,7 +2108,7 @@\n                     tm->tm_year + 1900,\n                     tm->tm_hour,\n                     tm->tm_min,\n-                    Curl_seconds[tm->tm_sec]);\n+                    Curl_seconds[secidx]);\n         result = client_write_header(data, headerbuf, headerbuflen);\n         if(result)\n           return result;\n",
  "stdout": "",
  "stderr": ""
}