--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -920,12 +920,21 @@
 		}
 		d++;
 		ds--;
+		/* Save original buffer size for later clamping */
+		unsigned int orig_ds = ds;
 		len = (((unsigned int)d[0]) << 8) | d[1];
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
-			  "We have to deal with %i byte(s) of EXIF data.",
-			  len);
+		          "We have to deal with %i byte(s) of EXIF data.",
+		          len);
 		d += 2;
+		if (len < 2) {
+			exif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, "ExifData",
+			          "Invalid EXIF segment length (%u)", len);
+			return;
+		}
 		ds = len - 2;	/* we do not want the full rest size, but only the size of the tag */
+		if (ds > orig_ds)
+			ds = orig_ds;
 	}
 
 	/*
