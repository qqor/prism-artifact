{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/qqor/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.18276280000000003,
    "prompt_tokens": 72200,
    "completion_tokens": 23487
  },
  "variant": "sound",
  "diff": "--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -920,12 +920,21 @@\n \t\t}\n \t\td++;\n \t\tds--;\n+\t\t/* Save original buffer size for later clamping */\n+\t\tunsigned int orig_ds = ds;\n \t\tlen = (((unsigned int)d[0]) << 8) | d[1];\n \t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n-\t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n-\t\t\t  len);\n+\t\t          \"We have to deal with %i byte(s) of EXIF data.\",\n+\t\t          len);\n \t\td += 2;\n+\t\tif (len < 2) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, \"ExifData\",\n+\t\t\t          \"Invalid EXIF segment length (%u)\", len);\n+\t\t\treturn;\n+\t\t}\n \t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n+\t\tif (ds > orig_ds)\n+\t\t\tds = orig_ds;\n \t}\n \n \t/*\n",
  "stdout": "",
  "stderr": ""
}