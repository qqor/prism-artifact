{
  "project_name": "tika",
  "vulnerability_identifier": "tika-tk-full-01-vuln_7",
  "source_directory": "/tasks/9e83d8ad-2b84-413b-b4e0-880916279678/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.292699,
    "prompt_tokens": 169698,
    "completion_tokens": 24098
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.java\n@@ -19,7 +19,7 @@\n import java.io.Serializable;\n import java.util.HashMap;\n import java.util.Map;\n-\n+import org.apache.tika.config.Field;\n public class TextAndCSVConfig implements Serializable {\n \n     private static final Map<Character, String> DELIMITER_TO_NAME_MAP = new HashMap<>();\n@@ -40,6 +40,16 @@\n \n     private Map<String, Character> nameToDelimiterMap = NAME_TO_DELIMITER_MAP;\n     private Map<Character, String> delimiterToNameMap = DELIMITER_TO_NAME_MAP;\n+    private boolean followHyperlinks = false;\n+\n+    public boolean isFollowHyperlinks() {\n+        return followHyperlinks;\n+    }\n+\n+    @Field\n+    public void setFollowHyperlinks(boolean followHyperlinks) {\n+        this.followHyperlinks = followHyperlinks;\n+    }\n \n     public Map<String, Character> getNameToDelimiterMap() {\n         return nameToDelimiterMap;\n\n--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -248,6 +248,7 @@\n                              Metadata metadata,\n                              ParseContext context) throws IOException, SAXException {\n         xhtml.startElement(TD);\n+        TextAndCSVConfig config = context.get(TextAndCSVConfig.class, defaultTextAndCSVConfig);\n         Matcher m = HYPERLINK_PATTERN.matcher(cellContent);\n         if (m.find()) {\n             String url = m.group(1);\n@@ -258,7 +259,9 @@\n             xhtml.startElement(\"a\", \"href\", url);\n             xhtml.characters(name);\n             xhtml.endElement(\"a\");\n-            processURL(url, name, xhtml, metadata, context);\n+            if (config.isFollowHyperlinks()) {\n+                processURL(url, name, xhtml, metadata, context);\n+            }\n         } else {\n             xhtml.characters(cellContent);\n         }\n",
  "stdout": "",
  "stderr": ""
}