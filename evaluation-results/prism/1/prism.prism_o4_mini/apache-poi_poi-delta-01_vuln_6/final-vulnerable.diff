--- a/poi-ooxml/src/main/java/org/apache/poi/openxml4j/opc/OPCPackage.java
+++ b/poi-ooxml/src/main/java/org/apache/poi/openxml4j/opc/OPCPackage.java
@@ -891,8 +891,14 @@
         Matcher matcher = namePattern.matcher("");
         ArrayList<PackagePart> result = new ArrayList<>();
         for (PackagePart part : partList.sortedValues()) {
-            PackagePartName partName = part.getPartName();
-            if (matcher.reset(partName.getName()).matches()) {
+            String name = part.getPartName().getName();
+            boolean matches;
+            try {
+                matches = matcher.reset(name).matches();
+            } catch (StackOverflowError e) {
+                throw new IllegalArgumentException("Regular expression too complex: " + namePattern.pattern(), e);
+            }
+            if (matches) {
                 result.add(part);
             }
         }
