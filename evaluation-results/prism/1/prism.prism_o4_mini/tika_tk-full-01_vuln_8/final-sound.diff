--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -18,6 +18,8 @@
 
 import java.io.EOFException;
 import java.io.IOException;
+import java.util.Arrays;
+import java.util.List;
 import java.io.InputStream;
 import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
@@ -97,7 +99,9 @@
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
         Path tmpFile = tmpDir.resolve(fileName);
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
+        String shell = "/bin/sh";
+        List<String> cmd = Arrays.asList(shell, "-n", tmpFile.toAbsolutePath().toString());
+        ProcessBuilder pb = new ProcessBuilder(cmd);
         pb.directory(tmpDir.toFile());
         try {
             FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
