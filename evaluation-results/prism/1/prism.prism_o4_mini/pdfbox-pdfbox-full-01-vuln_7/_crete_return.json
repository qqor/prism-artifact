{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox-pdfbox-full-01-vuln_7",
  "source_directory": "/tasks/759aa21d-110a-4c3e-b36e-d2217562425d/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.5059857,
    "prompt_tokens": 411007,
    "completion_tokens": 12245
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -180,7 +180,8 @@\n     private final class PageIterator implements Iterator<PDPage>\n     {\n         private final Queue<COSDictionary> queue = new ArrayDeque<>();\n-\n+        private final java.util.Set<COSDictionary> visitedNodes = new java.util.HashSet<>();\n+        \n         private PageIterator(COSDictionary node)\n         {\n             List<COSDictionary> kids = enqueueKids(node);\n@@ -205,6 +206,16 @@\n          */\n         private List<COSDictionary> enqueueKids(COSDictionary node)\n         {\n+            // guard against null and cycles\n+            if (node == null)\n+            {\n+                return java.util.Collections.emptyList();\n+            }\n+            // cycle detection: skip already visited nodes\n+            if (!visitedNodes.add(node))\n+            {\n+                return java.util.Collections.emptyList();\n+            }\n             if (isPageTreeNode(node))\n             {\n                 return getKids(node);\n",
  "stdout": "",
  "stderr": ""
}