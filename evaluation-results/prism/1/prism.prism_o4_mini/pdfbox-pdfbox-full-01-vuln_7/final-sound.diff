--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
@@ -180,7 +180,8 @@
     private final class PageIterator implements Iterator<PDPage>
     {
         private final Queue<COSDictionary> queue = new ArrayDeque<>();
-
+        private final java.util.Set<COSDictionary> visitedNodes = new java.util.HashSet<>();
+        
         private PageIterator(COSDictionary node)
         {
             List<COSDictionary> kids = enqueueKids(node);
@@ -205,6 +206,16 @@
          */
         private List<COSDictionary> enqueueKids(COSDictionary node)
         {
+            // guard against null and cycles
+            if (node == null)
+            {
+                return java.util.Collections.emptyList();
+            }
+            // cycle detection: skip already visited nodes
+            if (!visitedNodes.add(node))
+            {
+                return java.util.Collections.emptyList();
+            }
             if (isPageTreeNode(node))
             {
                 return getKids(node);
