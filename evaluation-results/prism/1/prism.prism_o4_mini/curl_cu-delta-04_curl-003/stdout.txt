[2;36m[12/27/25 10:40:26][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=168;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=205092;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpo7dogtuc[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/curl_cu-delta-04_curl-003/[0m[95magent-output-[0m [2m               [0m
[2;36m                    [0m         [95m1766832026.0456455[0m                                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/curl_cu-delta-04_curl-[1;36m003.[0mtoml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-curl[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=322816;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=657563;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:42:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Building Cached for CLEAN environment[1m)[0m Took [1;36m113.90[0m ]8;id=814963;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=34225;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=310798;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=872123;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=596882;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=418349;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=783507;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=260393;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m113[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=555644;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=479380;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:42:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=800301;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=240440;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:42:21][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=328864;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=727201;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=14299;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=743903;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=204967;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=960586;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=589554;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=105477;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:42:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.20[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=664437;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=811036;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=139182;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=429690;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:42:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=31842;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=937231;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:42:27][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=791586;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=661739;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                             [2m                [0m
[2;36m                    [0m         INFO: Seed: [1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561e75654218[0m,      [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1m)[0m,                                                                    [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561e7565b008[0m,[1;36m0x561e756c8ec8[0m[1m)[0m,        [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                           [2m                [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                       [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561e753d36fe[0m bp        [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m sp [1;36m0x7fffd6f9b4a0[0m T0[1m)[0m                                                [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                 [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee     [2m                [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was    [2m                [0m
[2;36m                    [0m         used.                                                                               [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                      [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561e753d36fe[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561e7529691a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561e75268df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561e75270a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561e7526e035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561e7521cace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                           [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561e7521a0ed[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561e750ce6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561e750b9915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561e750bf3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561e750ea652[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f65711e7082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x561e750b1afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                              [2m                [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                   [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v          [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                             [2m                [0m
[2;36m                    [0m         INFO: Seed: [1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561e75654218[0m,      [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1m)[0m,                                                                    [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561e7565b008[0m,[1;36m0x561e756c8ec8[0m[1m)[0m,        [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                           [2m                [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                       [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561e753d36fe[0m bp        [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m sp [1;36m0x7fffd6f9b4a0[0m T0[1m)[0m                                                [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                 [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee     [2m                [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was    [2m                [0m
[2;36m                    [0m         used.                                                                               [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                      [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561e753d36fe[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561e7529691a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561e75268df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561e75270a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561e7526e035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561e7521cace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                           [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561e7521a0ed[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561e750ce6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561e750b9915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561e750bf3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561e750ea652[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f65711e7082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x561e750b1afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                              [2m                [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                   [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v          [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 10:42:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=385786;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=738567;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:44:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=616424;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=772753;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:44:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=334361;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=646029;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=949931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=98666;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:44:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=535781;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=34066;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:44:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=414120;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=865698;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp4fus8syc[0m                                                 ]8;id=957420;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=826783;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 10:46:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m99.31[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=139243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=549720;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=765539;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=99811;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:46:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m12.91[0m seconds;                ]8;id=83128;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=700637;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=322311;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417109;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:46:23][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=155225;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=183977;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3096760872[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b527e218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d5b5285004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b5285008[0m,[1;36m0x55d5b52f2ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d5b4ffd6ee[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd71aab940[0m sp [1;36m0x7ffd71aab7e0[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d5b4ffd6ee[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d5b4ec091a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d5b4e92df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d5b4e9aa81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d5b4e98035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d5b4e46ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d5b4e440ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d5b4cf86a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d5b4ce3915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d5b4ce93af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d5b4d14652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f89ab044082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55d5b4cdbafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiwus4dxn[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=302533;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=638487;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3096760872[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b527e218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d5b5285004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b5285008[0m,[1;36m0x55d5b52f2ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d5b4ffd6ee[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd71aab940[0m sp [1;36m0x7ffd71aab7e0[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d5b4ffd6ee[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d5b4ec091a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d5b4e92df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d5b4e9aa81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d5b4e98035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d5b4e46ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d5b4e440ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d5b4cf86a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d5b4ce3915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d5b4ce93af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d5b4d14652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f89ab044082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55d5b4cdbafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiwus4dxn[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3096760872[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b527e218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d5b5285004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d5b5285008[0m,[1;36m0x55d5b52f2ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d5b4ffd6ee[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd71aab940[0m sp [1;36m0x7ffd71aab7e0[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d5b4ffd6ee[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d5b4ec091a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d5b4e92df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d5b4e9aa81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d5b4e98035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d5b4e46ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d5b4e440ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d5b4cf86a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d5b4ce3915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d5b4ce93af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d5b4d14652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f89ab044082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55d5b4cdbafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1409:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiwus4dxn[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.45[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=182043;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=278633;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=144133;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863616;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:46:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=970759;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=722170;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:46:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=758931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=344357;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:46:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=765331;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=594775;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=651651;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=72654;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         +++ b/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-1390[0m,[1;36m7[0m +[1;36m1390[0m,[1;36m6[0m @@                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m* All done *[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m              [1;35mde_cleanup[0m[1m([0m&de[1m)[0m;                                                               [2m                [0m
[2;36m                    [0m         -    [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m              return result;                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m            [1m}[0m [35m/[0m* !dohp->pending *[35m/[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3096760872[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d5b527e218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d5b5285004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d5b5285008[0m[39m,[0m[1;36m0x55d5b52f2ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55d5b4ffd6ee[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffd71aab940[0m[39m sp [0m[1;36m0x7ffd71aab7e0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d5b4ffd6ee[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1409:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d5b4ec091a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d5b4e92df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d5b4e9aa81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d5b4e98035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d5b4e46ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d5b4e440ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d5b4cf86a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d5b4ce3915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d5b4ce93af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d5b4d14652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f89ab044082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d5b4cdbafd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1409:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiwus4dxn[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA fuzzing run of the `curl_fuzzer_http` target triggered an AddressSanitizer crash [0m [2m                [0m
[2;36m                    [0m         [39min the function `Curl_doh_close` [0m[1;39m([0m[39min `lib/doh.[0m[1;92mc:1410[0m[39m`[0m[1;39m)[0m[39m. The fuzzer attempted to [0m    [2m                [0m
[2;36m                    [0m         [39mclose a DNS-over-HTTPS [0m[1;39m([0m[39mDoH[0m[1;39m)[0m[39m handle during a multi-handle transfer, causing a wild [0m [2m                [0m
[2;36m                    [0m         [39mpointer read and an out-of-bounds memory access that led to a segmentation fault.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue type  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  The crash is a memory-safety violation [0m[1;39m([0m[39mwild read[0m[1;39m)[0m[39m detected by AddressSanitizer. [0m [2m                [0m
[2;36m                    [0m         [39mIt manifests as a segmentation fault when `Curl_doh_close` attempts to read from an[0m [2m                [0m
[2;36m                    [0m         [39minvalid/high memory address.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Crash location  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m  The failing instruction is in `Curl_doh_close` at line [0m[1;36m1410[0m[39m of `lib/doh.c`. [0m      [2m                [0m
[2;36m                    [0m         [39mAccording to the stack trace, control flows through:[0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m1[0m[39m. `Curl_doh_close` [0m[1;39m([0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;36m1410[0m[1;39m)[0m[39m  [0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m2[0m[39m. `Curl_req_done` [0m[1;39m([0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;36m108[0m[1;39m)[0m[39m  [0m                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m3[0m[39m. `multi_done` [0m[1;39m([0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;36m754[0m[1;39m)[0m[39m  [0m                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m4[0m[39m. `multi_runsingle` [0m[1;39m([0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;36m2856[0m[1;39m)[0m[39m  [0m                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m5[0m[39m. `curl_multi_perform` [0m[1;39m([0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;36m3016[0m[1;39m)[0m[39m  [0m                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m6[0m[39m. `fuzz_handle_transfer` in the fuzzer harness [0m[1;39m([0m[39m`curl_fuzzer.[0m[1;92mcc:419[0m[39m`[0m[1;39m)[0m[39m  [0m        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;36m7[0m[39m. `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39m`curl_fuzzer.[0m[1;92mcc:97[0m[39m`[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Observations  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m  • AddressSanitizer reports “READ memory access” to an unknown/high address, [0m      [2m                [0m
[2;36m                    [0m         [39mindicating that an internal pointer or structure was not valid at the time of use. [0m [2m                [0m
[2;36m                    [0m         [39m  • The fuzzer invoked a single HTTP transfer [0m[1;36m100[0m[39m times on a crafted input file [0m    [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/[0m[95mtestcase[0m[39m`.  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  • No additional sanitizer metadata [0m[1;39m([0m[39me.g., allocation backtraces[0m[1;39m)[0m[39m was available [0m   [2m                [0m
[2;36m                    [0m         [39mfor the pointer.  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m  • The crash occurs consistently under the libFuzzer-based harness.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Code areas for investigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. `lib/doh.c`, especially the implementation of `Curl_doh_close` around line [0m    [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m: check the cleanup of DoH-related structures and pointer validity.  [0m           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. The request lifecycle in `lib/request.c` [0m[1;39m([0m[39m`Curl_req_done`[0m[1;39m)[0m[39m, to see how the DoH[0m [2m                [0m
[2;36m                    [0m         [39mhandle is passed and freed.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. The multi-handle state machine in `lib/multi.c` [0m[1;39m([0m[39m`multi_done`, [0m                [2m                [0m
[2;36m                    [0m         [39m`multi_runsingle`, `curl_multi_perform`[0m[1;39m)[0m[39m: verify how DoH transfers are interleaved [0m [2m                [0m
[2;36m                    [0m         [39mwith other requests and ensure proper reference counting.  [0m                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. The fuzzer harness code in `curl_fuzzer.cc`, specifically [0m                     [2m                [0m
[2;36m                    [0m         [39m`fuzz_handle_transfer`, to understand how the DoH path is exercised and whether any[0m [2m                [0m
[2;36m                    [0m         [39mpreconditions for `Curl_doh_close` are violated.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability classification  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  Memory safety violation leading to a crash [0m[1;39m([0m[39msegfault[0m[1;39m)[0m[39m due to a wild pointer read [0m [2m                [0m
[2;36m                    [0m         [39min the DoH cleanup routine.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1380[0m[39m-[0m[1;36m1440[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:        [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Failed to decode HTTPS RR"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:      [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Some HTTPS RR to process"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:# ifdef DEBUGBUILD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:      [0m[1;35mdoh_print_httpsrr[0m[1;39m([0m[39mdata, hrr[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:# endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:      [0m[1;39m([0m[39m*dnsp[0m[1;39m)[0m[39m->hinfo = hrr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:    [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:    return result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1396[0m[39m:  [0m[1;39m}[0m[39m [0m[35m/[0m[39m* !dohp->pending *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1397[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1398[0m[39m:  [0m[35m/[0m[39m* else wait for pending DoH transactions to complete *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1399[0m[39m:  return CURLE_OK;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1401[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1402[0m[39m:void [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1403[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1404[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1405[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh && data->multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1406[0m[39m:    struct Curl_easy *probe_data;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1407[0m[39m:    curl_off_t mid;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1408[0m[39m:    size_t slot;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1409[0m[39m:    [0m[1;35mfor[0m[1;39m([0m[39mslot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m:      mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1411[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1412[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1413[0m[39m:      doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1414[0m[39m:      [0m[35m/[0m[39m* should have been called before data is removed from multi handle *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1415[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata->multi[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1416[0m[39m:      probe_data = data->multi ? [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdata->multi, mid[0m[1;39m)[0m[39m :[0m     [2m                [0m
[2;36m                    [0m         [1;36m1417[0m[39m:        NULL;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1418[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1419[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:                     FMT_OFF_T [0m[32m" not found!"[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1421[0m[39m:                     doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:      [0m[35m/[0m[39m* data->multi might already be reset at this time *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m:      [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mdata->multi, probe_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m:      [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1428[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1429[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:    [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:    data->req.doh->req_hds = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"curl_addrinfo.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"doh.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"sendf.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"multiif.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"url.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"share.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include [0m[32m"curl_base64.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#include [0m[32m"connect.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"strdup.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"dynbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m[35m/[0m[39m* The last [0m[1;36m3[0m[39m #include files should be in this order *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include [0m[32m"curl_printf.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#include [0m[32m"curl_memory.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#include [0m[32m"memdebug.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#include [0m[32m"escape.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#define DNS_CLASS_IN [0m[1;36m0x01[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[35m/[0m[39m* doh_print_buf truncates if the hex string will be more than this *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#define LOCAL_PB_HEXMAX [0m[1;36m400[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#ifndef CURL_DISABLE_VERBOSE_STRINGS[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:static const char * const errors[0m[1;39m[[0m[1;39m][0m[39m=[0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  [0m[32m""[0m[39m,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  [0m[32m"Bad label"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  [0m[32m"Out of range"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  [0m[32m"Label loop"[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  [0m[32m"Too small"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  [0m[32m"Out of memory"[0m[39m,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[32m"RDATA length"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:  [0m[32m"Malformat"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  [0m[32m"Bad RCODE"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  [0m[32m"Unexpected TYPE"[0m[39m,[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  [0m[32m"Unexpected CLASS"[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  [0m[32m"No content"[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  [0m[32m"Bad ID"[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  [0m[32m"Name too long"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:static const char *[0m[1;35mdoh_strerror[0m[1;39m([0m[39mDOHcode code[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mcode >= DOH_OK[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mcode <= DOH_DNS_NAME_TOO_LONG[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    return errors[0m[1;39m[[0m[39mcode[0m[1;39m][0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  return [0m[32m"bad error code"[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:struct curl_trc_feat Curl_doh_trc = [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  [0m[32m"DoH"[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  CURL_LOG_LVL_NONE,[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:#endif [0m[35m/[0m[39m* !CURL_DISABLE_VERBOSE_STRINGS *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[35m/[0m[39m* @unittest [0m[1;36m1655[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:UNITTEST DOHcode [0m[1;35mdoh_req_encode[0m[1;39m([0m[39mconst char *host,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                                DNStype dnstype,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                                unsigned char *dnsp, [0m[35m/[0m[39m* buffer *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                size_t len,  [0m[35m/[0m[39m* buffer size *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                                size_t *olen[0m[1;39m)[0m[39m [0m[35m/[0m[39m* output length *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  const size_t hostlen = [0m[1;35mstrlen[0m[1;39m([0m[39mhost[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  unsigned char *orig = dnsp;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  const char *hostp = host;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  [0m[35m/[0m[39m* The expected output length is [0m[1;36m16[0m[39m bytes more than the length of[0m              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:   * the QNAME-encoding of the hostname.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:   *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:   * A valid DNS name may not contain a zero-length label, except at[0m             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:   * the end. For this reason, a name beginning with a dot, or[0m                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:   * containing a sequence of two or more consecutive dots, is invalid[0m          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:   * and cannot be encoded as a QNAME.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:   * If the hostname ends with a trailing dot, the corresponding[0m                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:   * QNAME-encoding is one byte longer than the hostname. If [0m[1;39m([0m[39mas is[0m             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   * also valid[0m[1;39m)[0m[39m the hostname is shortened by the omission of the[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:   * trailing dot, then its QNAME-encoding will be two bytes longer[0m             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   * than the hostname.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:   * Each [0m[1;39m[[0m[39m label, dot [0m[1;39m][0m[39m pair is encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:   * preserving overall length. A final [0m[1;39m[[0m[39m label [0m[1;39m][0m[39m without a dot is[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:   * also encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m, increasing overall length[0m               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:   * by one. The encoding is completed by appending a zero byte,[0m                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:   * representing the zero-length root label, again increasing[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:   * the overall length by one.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:   *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  size_t expected_len;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mhostlen[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  expected_len = [0m[1;36m12[0m[39m + [0m[1;36m1[0m[39m + hostlen + [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhost[0m[1;39m[[0m[39mhostlen-[0m[1;36m1[0m[1;39m][0m[39m!=[0m[32m'.'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    expected_len++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mexpected_len > [0m[1;39m([0m[1;36m256[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* RFCs [0m[1;36m1034[0m[39m, [0m[1;36m1035[0m[39m *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    return DOH_DNS_NAME_TOO_LONG;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mlen < expected_len[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    return DOH_TOO_SMALL_BUFFER;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* [0m[1;36m16[0m[39m bit id *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  *dnsp++ = [0m[1;36m0x01[0m[39m; [0m[35m/[0m[39m* |QR|   Opcode  |AA|TC|RD| Set the RD bit *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* |RA|   Z    |   RCODE   |                *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  *dnsp++ = [0m[1;36m1[0m[39m;    [0m[35m/[0m[39m* QDCOUNT [0m[1;39m([0m[39mnumber of entries in the question section[0m[1;39m)[0m[39m *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ANCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* NSCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ARCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:  [0m[35m/[0m[39m* encode each label and store it in the QNAME *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:  [0m[1;35mwhile[0m[1;39m([0m[39m*hostp[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    size_t labellen;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    char *dot = [0m[1;35mstrchr[0m[1;39m([0m[39mhostp, [0m[32m'.'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:      labellen = dot - hostp;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:      labellen = [0m[1;35mstrlen[0m[1;39m([0m[39mhostp[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mlabellen > [0m[1;36m63[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m!labellen[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[35m/[0m[39m* label is too long or too short, error out *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:      *olen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:      return DOH_DNS_BAD_LABEL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m* label is non-empty, process it *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39mlabellen;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mdnsp, hostp, labellen[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    dnsp += labellen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    hostp += labellen;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m* advance past dot, but only if there is one *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:      hostp++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  [0m[1;39m}[0m[39m [0m[35m/[0m[39m* next label *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* append zero-length label for root *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  [0m[35m/[0m[39m* There are assigned TYPE codes beyond [0m[1;36m255[0m[39m: use range [0m[1;39m[[0m[1;36m1[0m[39m..[0m[1;36m65535[0m[1;39m][0m[39m  *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & [0m[1;39m([0m[39mdnstype >> [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & dnstype[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* lower [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit CLASS *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  *dnsp++ = DNS_CLASS_IN; [0m[35m/[0m[39m* IN - [0m[32m"the Internet"[0m[39m *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  *olen = dnsp - orig;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:  [0m[35m/[0m[39m* verify that our estimation of length is valid, since[0m                       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:   * this has led to buffer overflows in this function *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m*olen == expected_len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:  return DOH_OK;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:static size_t[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m183:d[0m[1;35moh_write_cb[0m[1;39m([0m[39mchar *contents, size_t size, size_t nmemb, void *userp[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:  size_t realsize = size * nmemb;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:  struct dynbuf *mem = [0m[1;39m([0m[39mstruct dynbuf *[0m[1;39m)[0m[39muserp;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_dyn_addn[0m[1;39m([0m[39mmem, contents, realsize[0m[1;39m)[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:  return realsize;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mUSE_HTTPSRR[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39mDEBUGBUILD[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:static void [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                          const char *prefix,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                          unsigned char *buf, size_t len[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:  unsigned char hexstr[0m[1;39m[[0m[39mLOCAL_PB_HEXMAX[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  size_t hlen = LOCAL_PB_HEXMAX;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"cfilters.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"dynbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"doh.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"multiif.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#include [0m[32m"progress.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"request.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"sendf.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"transfer.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"url.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[35m/[0m[39m* The last [0m[1;36m3[0m[39m #include files should be in this order *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"curl_printf.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"curl_memory.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#include [0m[32m"memdebug.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:void [0m[1;35mCurl_req_init[0m[1;39m([0m[39mstruct SingleRequest *req[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39mreq, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*req[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m48:C[0m[39mURLcode [0m[1;35mCurl_req_soft_reset[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                             struct Curl_easy *data[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  CURLcode result;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:  req->done = FALSE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  req->upload_done = FALSE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  req->upload_aborted = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  req->download_done = FALSE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  req->eos_written = FALSE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  req->eos_read = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  req->eos_sent = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  req->ignorebody = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:  req->shutdown = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  req->bytecount = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  req->writebytecount = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  req->header = TRUE; [0m[35m/[0m[39m* assume header *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  req->headerline = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  req->headerbytecount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  req->allheadercount =  [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  req->deductheadercount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:  result = [0m[1;35mCurl_client_start[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    return result;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!req->sendbuf_init[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;35mCurl_bufq_init2[0m[1;39m([0m[39m&req->sendbuf, data->set.upload_buffer_size, [0m[1;36m1[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    BUFQ_OPT_SOFT_LIMIT[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    req->sendbuf_init = TRUE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdata->set.upload_buffer_size != req->sendbuf.chunk_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:      [0m[1;35mCurl_bufq_free[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      [0m[1;35mCurl_bufq_init2[0m[1;39m([0m[39m&req->sendbuf, data->set.upload_buffer_size, [0m[1;36m1[0m[39m,[0m            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                      BUFQ_OPT_SOFT_LIMIT[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  return CURLE_OK;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m91:C[0m[39mURLcode [0m[1;35mCurl_req_start[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                        struct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  req->start = [0m[1;35mCurl_now[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  return [0m[1;35mCurl_req_soft_reset[0m[1;39m([0m[39mreq, data[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static CURLcode [0m[1;35mreq_flush[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:void [0m[1;35mCurl_req_hard_reset[0m[1;39m([0m[39mstruct SingleRequest *req, struct Curl_easy *data[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:  struct curltime t0 = [0m[1;39m{[0m[1;36m0[0m[39m, [0m[1;36m0[0m[1;39m}[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  [0m[35m/[0m[39m* This is a bit ugly. `req->p` is a union and we assume we can[0m               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:   * free this safely without leaks. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->p.ftp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->newurl[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mreq->sendbuf_init[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:  [0m[35m/[0m[39m* Can no longer [0m[1;35mmemset[0m[1;39m([0m[1;39m)[0m[39m this struct as we need to keep some state *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:  req->size = [0m[1;36m-1[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  req->maxdownload = [0m[1;36m-1[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  req->bytecount = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  req->writebytecount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  req->start = t0;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  req->headerbytecount = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  req->allheadercount =  [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  req->deductheadercount = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  req->headerline = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  req->offset = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  req->httpcode = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  req->keepon = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:  req->upgr101 = UPGR101_INIT;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:  req->timeofdoc = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:  req->location = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  req->newurl = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:#ifndef CURL_DISABLE_COOKIES[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:  req->setcookies = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:  req->header = FALSE;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:  req->content_range = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  req->download_done = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:  req->eos_written = FALSE;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:  req->eos_read = FALSE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:  req->eos_sent = FALSE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:  req->upload_done = FALSE;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:  req->upload_aborted = FALSE;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:  req->ignorebody = FALSE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:  req->http_bodyless = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:  req->chunk = FALSE;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:  req->ignore_cl = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:  req->upload_chunky = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:  req->getheader = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:  req->no_body = data->set.opt_no_body;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  req->authneg = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:  req->shutdown = FALSE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:#ifdef USE_HYPER[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:  req->bodywritten = FALSE;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:void [0m[1;35mCurl_req_free[0m[1;39m([0m[39mstruct SingleRequest *req, struct Curl_easy *data[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  [0m[35m/[0m[39m* This is a bit ugly. `req->p` is a union and we assume we can[0m               [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:   * free this safely without leaks. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->p.ftp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->newurl[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mreq->sendbuf_init[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[1;35mCurl_bufq_free[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:  [0m[1;35mCurl_client_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:static CURLcode [0m[1;35mxfer_send[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                          const char *buf, size_t blen,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                          size_t hds_len, size_t *pnwritten[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:  bool eos = FALSE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:  *pnwritten = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mhds_len <= blen[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:#ifdef DEBUGBUILD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:  [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[35m/[0m[39m* Allow debug builds to override this logic to force short initial[0m         [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:       sends *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    size_t body_len = blen - hds_len;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    char *p = [0m[1;35mgetenv[0m[1;39m([0m[32m"CURL_SMALLREQSEND"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:740[0m[39m-[0m[1;36m800[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:      result = CURLE_ABORTED_BY_CALLBACK;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:  [0m[35m/[0m[39m* Make sure that transfer client writes are really done now. *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:  r2 = [0m[1;35mCurl_xfer_write_done[0m[1;39m([0m[39mdata, premature[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mr2 && !result[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:    result = r2;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:  [0m[35m/[0m[39m* Inform connection filters that this transfer is done *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:  [0m[1;35mCurl_conn_ev_data_done[0m[1;39m([0m[39mdata, premature[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:  [0m[1;35mprocess_pending_handles[0m[1;39m([0m[39mdata->multi[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* connection [0m[35m/[0m[39m multiplex *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!result[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:    result = [0m[1;35mCurl_req_done[0m[1;39m([0m[39m&data->req, data, premature[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:  [0m[35m/[0m[39m* Under the potential connection pool's share lock, decide what to[0m           [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:   * do with the transfer's connection. *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:  mdctx.premature = premature;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:  [0m[1;35mCurl_cpool_do_locked[0m[1;39m([0m[39mdata, data->conn, multi_done_locked, &mdctx[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:  [0m[35m/[0m[39m* flush the netrc cache *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:  [0m[1;35mCurl_netrc_cleanup[0m[1;39m([0m[39m&data->state.netrc[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:static void [0m[1;35mclose_connect_only[0m[1;39m([0m[39mstruct connectdata *conn,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                               struct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                               void *userdata[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39muserdata;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mdata;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mconn->connect_only[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:    [0m[1;35mconnclose[0m[1;39m([0m[39mconn, [0m[32m"Removing connect-only easy handle"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m776:C[0m[39mURLMcode [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mCURLM *m, CURL *d[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:  struct Curl_multi *multi = m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:  struct Curl_easy *data = d;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:  bool premature;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:  struct Curl_llist_node *e;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:  CURLMcode rc;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:  bool removed_timer = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:  [0m[35m/[0m[39m* First, make some basic checks that the CURLM handle is a good handle *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_MULTI_HANDLE[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:    return CURLM_BAD_HANDLE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:  [0m[35m/[0m[39m* Verify that we got a somewhat good easy handle too *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_EASY_HANDLE[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m || !multi->num_easy[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:    return CURLM_BAD_EASY_HANDLE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:  [0m[35m/[0m[39m* Prevent users from trying to remove same easy handle more than once *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!data->multi[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    return CURLM_OK; [0m[35m/[0m[39m* it is already removed so let's say it is fine! *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:  [0m[35m/[0m[39m* Prevent users from trying to remove an easy handle from the wrong multi *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->multi != multi[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    return CURLM_BAD_EASY_HANDLE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:2800[0m[39m-[0m[1;36m2860[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2800[0m[39m:          [0m[35m/[0m[39m* if positive, advance to DO_DONE[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2801[0m[39m:             if negative, go back to DOING *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2802[0m[39m:          [0m[1;35mmultistate[0m[1;39m([0m[39mdata, control == [0m[1;36m1[0m[39m ?[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2803[0m[39m:                     MSTATE_DID : MSTATE_DOING[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m2804[0m[39m:          rc = CURLM_CALL_MULTI_PERFORM;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2805[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2806[0m[39m:        [0m[35m/[0m[39m* else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2807[0m[39m:           stay in DO_MORE *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2808[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2809[0m[39m:      else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2810[0m[39m:        [0m[35m/[0m[39m* failure detected *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2811[0m[39m:        [0m[1;35mmulti_posttransfer[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2812[0m[39m:        [0m[1;35mmulti_done[0m[1;39m([0m[39mdata, result, FALSE[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2813[0m[39m:        stream_error = TRUE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2814[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2815[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2816[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2817[0m[39m:    case MSTATE_DID:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2818[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata->conn[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2819[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata->conn->bits.multiplex[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2820[0m[39m:        [0m[35m/[0m[39m* Check if we can move pending requests to send pipe *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m2821[0m[39m:        [0m[1;35mprocess_pending_handles[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[39m; [0m[35m/[0m[39m*  multiplexed *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2822[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2823[0m[39m:      [0m[35m/[0m[39m* Only perform the transfer if there is a good socket to work with.[0m     [2m                [0m
[2;36m                    [0m         [1;36m2824[0m[39m:         Having both BAD is a signal to skip immediately to DONE *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m2825[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mdata->conn->sockfd != CURL_SOCKET_BAD[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2826[0m[39m:         [0m[1;39m([0m[39mdata->conn->writesockfd != CURL_SOCKET_BAD[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m2827[0m[39m:        [0m[1;35mmultistate[0m[1;39m([0m[39mdata, MSTATE_PERFORMING[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2828[0m[39m:      else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2829[0m[39m:#ifndef CURL_DISABLE_FTP[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2830[0m[39m:        [0m[1;35mif[0m[1;39m([0m[39mdata->state.wildcardmatch &&[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2831[0m[39m:           [0m[1;39m([0m[1;39m([0m[39mdata->conn->handler->flags & PROTOPT_WILDCARD[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m2832[0m[39m:          data->wildcard->state = CURLWC_DONE;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2833[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2834[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2835[0m[39m:        [0m[1;35mmultistate[0m[1;39m([0m[39mdata, MSTATE_DONE[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2836[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2837[0m[39m:      rc = CURLM_CALL_MULTI_PERFORM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2838[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2839[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2840[0m[39m:    case MSTATE_RATELIMITING: [0m[35m/[0m[39m* limit-rate exceeded in either direction *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m2841[0m[39m:      rc = [0m[1;35mstate_ratelimiting[0m[1;39m([0m[39mdata, nowp, &result[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:    case MSTATE_PERFORMING:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:      rc = [0m[1;35mstate_performing[0m[1;39m([0m[39mdata, nowp, &stream_error, &result[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:      break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    case MSTATE_DONE:[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:      [0m[35m/[0m[39m* this state is highly transient, so run another loop after this *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:      rc = CURLM_CALL_MULTI_PERFORM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata->conn[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        CURLcode res;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:        [0m[35m/[0m[39m* post-transfer command *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:        res = [0m[1;35mmulti_done[0m[1;39m([0m[39mdata, result, FALSE[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        [0m[35m/[0m[39m* allow a previously set error code take precedence *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        [0m[1;35mif[0m[1;39m([0m[39m!result[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:          result = res;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.h:[0m[1;36m1[0m[39m-[0m[1;36m189[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#ifndef [0m[1;33mHEAD[0m[39mER_CURL_DOH_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#define [0m[1;33mHEAD[0m[39mER_CURL_DOH_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"curl_addrinfo.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#ifdef USE_HTTPSRR[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:# include <stdint.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  DOH_OK,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  DOH_DNS_BAD_LABEL,    [0m[35m/[0m[39m* [0m[1;36m1[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  DOH_DNS_OUT_OF_RANGE, [0m[35m/[0m[39m* [0m[1;36m2[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  DOH_DNS_LABEL_LOOP,   [0m[35m/[0m[39m* [0m[1;36m3[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  DOH_TOO_SMALL_BUFFER, [0m[35m/[0m[39m* [0m[1;36m4[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  DOH_OUT_OF_MEM,       [0m[35m/[0m[39m* [0m[1;36m5[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  DOH_DNS_RDATA_LEN,    [0m[35m/[0m[39m* [0m[1;36m6[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  DOH_DNS_MALFORMAT,    [0m[35m/[0m[39m* [0m[1;36m7[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  DOH_DNS_BAD_RCODE,    [0m[35m/[0m[39m* [0m[1;36m8[0m[39m - no such name *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  DOH_DNS_UNEXPECTED_TYPE,  [0m[35m/[0m[39m* [0m[1;36m9[0m[39m *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  DOH_DNS_UNEXPECTED_CLASS, [0m[35m/[0m[39m* [0m[1;36m10[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  DOH_NO_CONTENT,           [0m[35m/[0m[39m* [0m[1;36m11[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  DOH_DNS_BAD_ID,           [0m[35m/[0m[39m* [0m[1;36m12[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  DOH_DNS_NAME_TOO_LONG     [0m[35m/[0m[39m* [0m[1;36m13[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m}[0m[39m DOHcode;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:  DNS_TYPE_A = [0m[1;36m1[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  DNS_TYPE_NS = [0m[1;36m2[0m[39m,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  DNS_TYPE_CNAME = [0m[1;36m5[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  DNS_TYPE_AAAA = [0m[1;36m28[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  DNS_TYPE_DNAME = [0m[1;36m39[0m[39m,           [0m[35m/[0m[39m* RFC6672 *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  DNS_TYPE_HTTPS = [0m[1;36m65[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m[1;39m}[0m[39m DNStype;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m[35m/[0m[39m* one of these for each DoH request *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct doh_probe [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  curl_off_t easy_mid; [0m[35m/[0m[39m* multi id of easy handle doing the lookup *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  DNStype dnstype;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  unsigned char req_body[0m[1;39m[[0m[1;36m512[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  size_t req_body_len;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  struct dynbuf resp_body;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m70:e[0m[39mnum doh_slot_num [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[35m/[0m[39m* Explicit values for first two symbols so as to match hard-coded[0m             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:   * constants in existing code[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:   *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  DOH_SLOT_IPV4 = [0m[1;36m0[0m[39m, [0m[35m/[0m[39m* make [0m[32m'V4'[0m[39m stand out for readability *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  DOH_SLOT_IPV6 = [0m[1;36m1[0m[39m, [0m[35m/[0m[39m* [0m[32m'V6'[0m[39m likewise *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  [0m[35m/[0m[39m* Space here for [0m[1;39m([0m[39mpossibly build-specific[0m[1;39m)[0m[39m additional slot definitions *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:#ifdef USE_HTTPSRR[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  DOH_SLOT_HTTPS_RR = [0m[1;36m2[0m[39m,     [0m[35m/[0m[39m* for HTTPS RR *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  [0m[35m/[0m[39m* for example *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  [0m[35m/[0m[39m* #ifdef WANT_DOH_FOOBAR_TXT *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:  [0m[35m/[0m[39m*   DOH_PROBE_SLOT_FOOBAR_TXT, *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  [0m[35m/[0m[39m* #endif *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  [0m[35m/[0m[39m* AFTER all slot definitions, establish how many we have *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  DOH_SLOT_COUNT[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:struct doh_probes [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  struct curl_slist *req_hds;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  struct doh_probe probe[0m[1;39m[[0m[39mDOH_SLOT_COUNT[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  unsigned int pending; [0m[35m/[0m[39m* still outstanding probes *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  int port;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  const char *host;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[35m/[0m[39m*[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * [0m[1;35mCurl_doh[0m[1;39m([0m[1;39m)[0m[39m resolve a name using DoH [0m[1;39m([0m[39mDNS-over-HTTPS[0m[1;39m)[0m[39m. It resolves a name[0m     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m: * and returns a [0m[32m'Curl_addrinfo *'[0m[39m with the address information.[0m                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                               int *waitp[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m109:C[0m[39mURLcode [0m[1;35mCurl_doh_is_resolved[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                              struct Curl_dns_entry **dns[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:#define DOH_MAX_ADDR [0m[1;36m24[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:#define DOH_MAX_CNAME [0m[1;36m4[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:#define DOH_MAX_HTTPS [0m[1;36m4[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:struct dohaddr [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  int type;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  union [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    unsigned char v4[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m; [0m[35m/[0m[39m* network byte order *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    unsigned char v6[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:  [0m[1;39m}[0m[39m ip;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m: * These are the code points for DNS wire format SvcParams as[0m                   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m: * per draft-ietf-dnsop-svcb-https[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m: * Not all are supported now, and even those that are may need[0m                  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m: * more work in future to fully support the spec.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:#define HTTPS_RR_CODE_ALPN            [0m[1;36m0x01[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:#define HTTPS_RR_CODE_NO_DEF_ALPN     [0m[1;36m0x02[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:#define HTTPS_RR_CODE_PORT            [0m[1;36m0x03[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:#define HTTPS_RR_CODE_IPV4            [0m[1;36m0x04[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:#define HTTPS_RR_CODE_ECH             [0m[1;36m0x05[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:#define HTTPS_RR_CODE_IPV6            [0m[1;36m0x06[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m: * These may need escaping when found within an ALPN string[0m                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m: * value.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:#define COMMA_CHAR                    [0m[32m','[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:#define BACKSLASH_CHAR                '\\'[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:struct dohhttps_rr [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:  uint16_t len; [0m[35m/[0m[39m* raw encoded length *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:  unsigned char *val; [0m[35m/[0m[39m* raw encoded octets *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:struct dohentry [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:  struct dynbuf cname[0m[1;39m[[0m[39mDOH_MAX_CNAME[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:  struct dohaddr addr[0m[1;39m[[0m[39mDOH_MAX_ADDR[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:  int numaddr;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:  unsigned int ttl;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:  int numcname;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:  struct dohhttps_rr https_rrs[0m[1;39m[[0m[39mDOH_MAX_HTTPS[0m[1;39m][0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:  int numhttps_rrs;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:void [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:#ifdef UNITTESTS[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:UNITTEST DOHcode [0m[1;35mdoh_req_encode[0m[1;39m([0m[39mconst char *host,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                                DNStype dnstype,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                                unsigned char *dnsp,  [0m[35m/[0m[39m* buffer *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                                size_t len,  [0m[35m/[0m[39m* buffer size *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                                size_t *olen[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* output length *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:UNITTEST DOHcode [0m[1;35mdoh_resp_decode[0m[1;39m([0m[39mconst unsigned char *doh,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                                 size_t dohlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                                 DNStype dnstype,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                                 struct dohentry *d[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:UNITTEST void [0m[1;35mde_init[0m[1;39m([0m[39mstruct dohentry *d[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:UNITTEST void [0m[1;35mde_cleanup[0m[1;39m([0m[39mstruct dohentry *d[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m182:e[0m[39mxtern struct curl_trc_feat Curl_doh_trc;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:#else [0m[35m/[0m[39m* if DoH is disabled *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:#define [0m[1;35mCurl_doh[0m[1;39m([0m[39ma,b,c,d[0m[1;39m)[0m[39m NULL[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:#define [0m[1;35mCurl_doh_is_resolved[0m[1;39m([0m[39mx,y[0m[1;39m)[0m[39m CURLE_COULDNT_RESOLVE_HOST[0m                    [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:#endif [0m[35m/[0m[39m* [0m[1;33mHEAD[0m[39mER_CURL_DOH_H *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:200[0m[39m-[0m[1;36m260[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  size_t hlen = LOCAL_PB_HEXMAX;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:  bool truncated = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mlen > [0m[1;39m([0m[39mLOCAL_PB_HEXMAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    truncated = TRUE;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:  [0m[1;35mCurl_hexencode[0m[1;39m([0m[39mbuf, len, hexstr, hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!truncated[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"%s: [0m[32mlen[0m[32m=%d, [0m[32mval[0m[32m=%s"[0m[39m, prefix, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlen, hexstr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:  else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"%s: [0m[32mlen[0m[32m=%d [0m[32m([0m[32mtruncated[0m[32m)[0m[32mval[0m[32m=%s"[0m[39m, prefix, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlen, hexstr[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:  return;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m[35m/[0m[39m* called from multi.c when this DoH transfer is complete *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:static int [0m[1;35mdoh_done[0m[1;39m([0m[39mstruct Curl_easy *doh, CURLcode result[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:  struct Curl_easy *data; [0m[35m/[0m[39m* the transfer that asked for the DoH probe *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:  data = [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdoh->multi, doh->set.dohfor_mid[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdoh, [0m[32m"doh_done: xfer for [0m[32mmid[0m[32m=%"[0m[39m FMT_OFF_T[0m                      [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                 [0m[32m" not found"[0m[39m, doh->set.dohfor_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[1;35mDEBUGASSERT[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:  else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    struct doh_probes *dohp = data->req.doh;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* one of the DoH request done for the [0m[32m'data'[0m[39m transfer is now complete! *[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    dohp->pending--;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdoh, [0m[32m"a DoH request is completed, %u to go"[0m[39m, dohp->pending[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:      [0m[1;35minfof[0m[1;39m([0m[39mdoh, [0m[32m"DoH request %s"[0m[39m, [0m[1;35mcurl_easy_strerror[0m[1;39m([0m[39mresult[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m!dohp->pending[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:      [0m[35m/[0m[39m* DoH completed, run the transfer picking up the results *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:      [0m[1;35mCurl_expire[0m[1;39m([0m[39mdata, [0m[1;36m0[0m[39m, EXPIRE_RUN_NOW[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:  return [0m[1;36m0[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:#define [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mx,y[0m[1;39m)[0m[39m                         \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:  do [0m[1;39m{[0m[39m                                                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    result = [0m[1;35mcurl_easy_setopt[0m[1;39m([0m[1;39m([0m[39mCURL *[0m[1;39m)[0m[39mdoh, x, y[0m[1;39m)[0m[39m;       \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult &&                                        \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:       result != CURLE_NOT_BUILT_IN &&                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:       result != CURLE_UNKNOWN_OPTION[0m[1;39m)[0m[39m                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:      goto error;                                       \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:  [0m[1;39m}[0m[39m [0m[1;35mwhile[0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:static CURLcode [0m[1;35mdoh_run_probe[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                              struct doh_probe *p, DNStype dnstype,[0m             [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                              const char *host,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                              const char *url, CURLM *multi,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                              struct curl_slist *headers[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:  struct Curl_easy *doh = NULL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:  timediff_t timeout_ms;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:  DOHcode d = [0m[1;35mdoh_req_encode[0m[1;39m([0m[39mhost, dnstype, p->req_body, [0m[1;35msizeof[0m[1;39m([0m[39mp->req_body[0m[1;39m)[0m[39m,[0m   [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:                             &p->req_body_len[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:1[0m[39m-[0m[1;36m80[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"cfilters.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"dynbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"doh.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"multiif.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#include [0m[32m"progress.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"request.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"sendf.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"transfer.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"url.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[35m/[0m[39m* The last [0m[1;36m3[0m[39m #include files should be in this order *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"curl_printf.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"curl_memory.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#include [0m[32m"memdebug.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:void [0m[1;35mCurl_req_init[0m[1;39m([0m[39mstruct SingleRequest *req[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39mreq, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*req[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m48:C[0m[39mURLcode [0m[1;35mCurl_req_soft_reset[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                             struct Curl_easy *data[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  CURLcode result;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:  req->done = FALSE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  req->upload_done = FALSE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  req->upload_aborted = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  req->download_done = FALSE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  req->eos_written = FALSE;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  req->eos_read = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  req->eos_sent = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  req->ignorebody = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:  req->shutdown = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  req->bytecount = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  req->writebytecount = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  req->header = TRUE; [0m[35m/[0m[39m* assume header *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  req->headerline = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  req->headerbytecount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  req->allheadercount =  [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  req->deductheadercount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:  result = [0m[1;35mCurl_client_start[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    return result;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!req->sendbuf_init[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;35mCurl_bufq_init2[0m[1;39m([0m[39m&req->sendbuf, data->set.upload_buffer_size, [0m[1;36m1[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    BUFQ_OPT_SOFT_LIMIT[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    req->sendbuf_init = TRUE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:1500[0m[39m-[0m[1;36m1560[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:                    FALSE[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1503:C[0m[39mURLMcode [0m[1;35mcurl_multi_poll[0m[1;39m([0m[39mCURLM *multi,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:                          struct curl_waitfd extra_fds[0m[1;39m[[0m[1;39m][0m[39m,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:                          unsigned int extra_nfds,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:                          int timeout_ms,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:                          int *ret[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:  return [0m[1;35mmulti_wait[0m[1;39m([0m[39mmulti, extra_fds, extra_nfds, timeout_ms, ret, TRUE,[0m       [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:                    TRUE[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1513:C[0m[39mURLMcode [0m[1;35mcurl_multi_wakeup[0m[1;39m([0m[39mCURLM *m[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:  [0m[35m/[0m[39m* this function is usually called from another thread,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:     it has to be careful only to access parts of the[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:     Curl_multi struct that are constant *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:  struct Curl_multi *multi = m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mENABLE_WAKEUP[0m[1;39m)[0m[39m && ![0m[1;35mdefined[0m[1;39m([0m[39mUSE_WINSOCK[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:  const void *buf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:  const uint64_t val = [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:  char buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:  [0m[35m/[0m[39m* GOOD_MULTI_HANDLE can be safely called *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_MULTI_HANDLE[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:    return CURLM_BAD_HANDLE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:#ifdef ENABLE_WAKEUP[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:#ifdef USE_WINSOCK[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mWSASetEvent[0m[1;39m([0m[39mmulti->wsa_event[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:    return CURLM_OK;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:  [0m[35m/[0m[39m* the wakeup_pair variable is only written during init and cleanup,[0m         [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:     making it safe to access from another thread after the init part[0m          [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:     and before cleanup *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != CURL_SOCKET_BAD[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:    buf = &val;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:    [0m[35m/[0m[39m* eventfd has a stringent rule of requiring the [0m[1;36m8[0m[39m-byte buffer when[0m        [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:       calling [0m[1;35mwrite[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m on it, which makes the [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m below fine since[0m    [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:       this is only used on [0m[1;36m64[0m[39m-bit systems and then the pointer is [0m[1;36m64[0m[39m-bit *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:    buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m1[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:    [0m[1;35mwhile[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:      [0m[35m/[0m[39m* [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m is not thread-safe in general, because concurrent calls[0m      [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:         can have their messages interleaved, but in this case the content[0m     [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:         of the messages does not matter, which makes it ok to call.[0m           [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:         The write socket is set to non-blocking, this way this function[0m       [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:         cannot block, making it safe to call even from the same thread[0m        [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:         that will call [0m[1;35mcurl_multi_wait[0m[1;39m([0m[1;39m)[0m[39m. If [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m returns that it[0m         [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:         would block, it is considered successful because it means that[0m        [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:         previous calls to this function will wake up the [0m[1;35mpoll[0m[1;39m([0m[1;39m)[0m[39m. *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mwakeup_write[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"curl_addrinfo.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"doh.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"sendf.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"multiif.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"url.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"share.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include [0m[32m"curl_base64.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#include [0m[32m"connect.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"strdup.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"dynbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m[35m/[0m[39m* The last [0m[1;36m3[0m[39m #include files should be in this order *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include [0m[32m"curl_printf.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#include [0m[32m"curl_memory.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#include [0m[32m"memdebug.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#include [0m[32m"escape.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#define DNS_CLASS_IN [0m[1;36m0x01[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[35m/[0m[39m* doh_print_buf truncates if the hex string will be more than this *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#define LOCAL_PB_HEXMAX [0m[1;36m400[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#ifndef CURL_DISABLE_VERBOSE_STRINGS[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:static const char * const errors[0m[1;39m[[0m[1;39m][0m[39m=[0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  [0m[32m""[0m[39m,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  [0m[32m"Bad label"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  [0m[32m"Out of range"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  [0m[32m"Label loop"[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  [0m[32m"Too small"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  [0m[32m"Out of memory"[0m[39m,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[32m"RDATA length"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:  [0m[32m"Malformat"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:  [0m[32m"Bad RCODE"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  [0m[32m"Unexpected TYPE"[0m[39m,[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  [0m[32m"Unexpected CLASS"[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  [0m[32m"No content"[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  [0m[32m"Bad ID"[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  [0m[32m"Name too long"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:static const char *[0m[1;35mdoh_strerror[0m[1;39m([0m[39mDOHcode code[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mcode >= DOH_OK[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mcode <= DOH_DNS_NAME_TOO_LONG[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    return errors[0m[1;39m[[0m[39mcode[0m[1;39m][0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  return [0m[32m"bad error code"[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:struct curl_trc_feat Curl_doh_trc = [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  [0m[32m"DoH"[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  CURL_LOG_LVL_NONE,[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:#endif [0m[35m/[0m[39m* !CURL_DISABLE_VERBOSE_STRINGS *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[35m/[0m[39m* @unittest [0m[1;36m1655[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:UNITTEST DOHcode [0m[1;35mdoh_req_encode[0m[1;39m([0m[39mconst char *host,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                                DNStype dnstype,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                                unsigned char *dnsp, [0m[35m/[0m[39m* buffer *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                size_t len,  [0m[35m/[0m[39m* buffer size *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                                size_t *olen[0m[1;39m)[0m[39m [0m[35m/[0m[39m* output length *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  const size_t hostlen = [0m[1;35mstrlen[0m[1;39m([0m[39mhost[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  unsigned char *orig = dnsp;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  const char *hostp = host;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  [0m[35m/[0m[39m* The expected output length is [0m[1;36m16[0m[39m bytes more than the length of[0m              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:   * the QNAME-encoding of the hostname.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:   *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:   * A valid DNS name may not contain a zero-length label, except at[0m             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:   * the end. For this reason, a name beginning with a dot, or[0m                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:   * containing a sequence of two or more consecutive dots, is invalid[0m          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:   * and cannot be encoded as a QNAME.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:   * If the hostname ends with a trailing dot, the corresponding[0m                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:   * QNAME-encoding is one byte longer than the hostname. If [0m[1;39m([0m[39mas is[0m             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   * also valid[0m[1;39m)[0m[39m the hostname is shortened by the omission of the[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:   * trailing dot, then its QNAME-encoding will be two bytes longer[0m             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   * than the hostname.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:   * Each [0m[1;39m[[0m[39m label, dot [0m[1;39m][0m[39m pair is encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:   * preserving overall length. A final [0m[1;39m[[0m[39m label [0m[1;39m][0m[39m without a dot is[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:   * also encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m, increasing overall length[0m               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:   * by one. The encoding is completed by appending a zero byte,[0m                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:   * representing the zero-length root label, again increasing[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:   * the overall length by one.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:   *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  size_t expected_len;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mhostlen[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  expected_len = [0m[1;36m12[0m[39m + [0m[1;36m1[0m[39m + hostlen + [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhost[0m[1;39m[[0m[39mhostlen-[0m[1;36m1[0m[1;39m][0m[39m!=[0m[32m'.'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    expected_len++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mexpected_len > [0m[1;39m([0m[1;36m256[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* RFCs [0m[1;36m1034[0m[39m, [0m[1;36m1035[0m[39m *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    return DOH_DNS_NAME_TOO_LONG;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mlen < expected_len[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    return DOH_TOO_SMALL_BUFFER;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* [0m[1;36m16[0m[39m bit id *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  *dnsp++ = [0m[1;36m0x01[0m[39m; [0m[35m/[0m[39m* |QR|   Opcode  |AA|TC|RD| Set the RD bit *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* |RA|   Z    |   RCODE   |                *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  *dnsp++ = [0m[1;36m1[0m[39m;    [0m[35m/[0m[39m* QDCOUNT [0m[1;39m([0m[39mnumber of entries in the question section[0m[1;39m)[0m[39m *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ANCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* NSCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ARCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:  [0m[35m/[0m[39m* encode each label and store it in the QNAME *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:  [0m[1;35mwhile[0m[1;39m([0m[39m*hostp[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    size_t labellen;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    char *dot = [0m[1;35mstrchr[0m[1;39m([0m[39mhostp, [0m[32m'.'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:      labellen = dot - hostp;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:      labellen = [0m[1;35mstrlen[0m[1;39m([0m[39mhostp[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mlabellen > [0m[1;36m63[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m!labellen[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[35m/[0m[39m* label is too long or too short, error out *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:      *olen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:      return DOH_DNS_BAD_LABEL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m* label is non-empty, process it *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39mlabellen;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mdnsp, hostp, labellen[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    dnsp += labellen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    hostp += labellen;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m* advance past dot, but only if there is one *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:      hostp++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  [0m[1;39m}[0m[39m [0m[35m/[0m[39m* next label *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* append zero-length label for root *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  [0m[35m/[0m[39m* There are assigned TYPE codes beyond [0m[1;36m255[0m[39m: use range [0m[1;39m[[0m[1;36m1[0m[39m..[0m[1;36m65535[0m[1;39m][0m[39m  *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & [0m[1;39m([0m[39mdnstype >> [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & dnstype[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* lower [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit CLASS *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  *dnsp++ = DNS_CLASS_IN; [0m[35m/[0m[39m* IN - [0m[32m"the Internet"[0m[39m *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  *olen = dnsp - orig;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:  [0m[35m/[0m[39m* verify that our estimation of length is valid, since[0m                       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:   * this has led to buffer overflows in this function *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m*olen == expected_len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:  return DOH_OK;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:static size_t[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m183:d[0m[1;35moh_write_cb[0m[1;39m([0m[39mchar *contents, size_t size, size_t nmemb, void *userp[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:  size_t realsize = size * nmemb;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:  struct dynbuf *mem = [0m[1;39m([0m[39mstruct dynbuf *[0m[1;39m)[0m[39muserp;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_dyn_addn[0m[1;39m([0m[39mmem, contents, realsize[0m[1;39m)[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:  return realsize;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mUSE_HTTPSRR[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39mDEBUGBUILD[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:static void [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                          const char *prefix,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                          unsigned char *buf, size_t len[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:  unsigned char hexstr[0m[1;39m[[0m[39mLOCAL_PB_HEXMAX[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  size_t hlen = LOCAL_PB_HEXMAX;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:1500[0m[39m-[0m[1;36m1560[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:                    FALSE[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1503:C[0m[39mURLMcode [0m[1;35mcurl_multi_poll[0m[1;39m([0m[39mCURLM *multi,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:                          struct curl_waitfd extra_fds[0m[1;39m[[0m[1;39m][0m[39m,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:                          unsigned int extra_nfds,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:                          int timeout_ms,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:                          int *ret[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:  return [0m[1;35mmulti_wait[0m[1;39m([0m[39mmulti, extra_fds, extra_nfds, timeout_ms, ret, TRUE,[0m       [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:                    TRUE[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1513:C[0m[39mURLMcode [0m[1;35mcurl_multi_wakeup[0m[1;39m([0m[39mCURLM *m[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:  [0m[35m/[0m[39m* this function is usually called from another thread,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:     it has to be careful only to access parts of the[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:     Curl_multi struct that are constant *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:  struct Curl_multi *multi = m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mENABLE_WAKEUP[0m[1;39m)[0m[39m && ![0m[1;35mdefined[0m[1;39m([0m[39mUSE_WINSOCK[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:  const void *buf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:  const uint64_t val = [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:  char buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:  [0m[35m/[0m[39m* GOOD_MULTI_HANDLE can be safely called *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_MULTI_HANDLE[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:    return CURLM_BAD_HANDLE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:#ifdef ENABLE_WAKEUP[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:#ifdef USE_WINSOCK[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mWSASetEvent[0m[1;39m([0m[39mmulti->wsa_event[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:    return CURLM_OK;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:  [0m[35m/[0m[39m* the wakeup_pair variable is only written during init and cleanup,[0m         [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:     making it safe to access from another thread after the init part[0m          [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:     and before cleanup *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != CURL_SOCKET_BAD[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:    buf = &val;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:    [0m[35m/[0m[39m* eventfd has a stringent rule of requiring the [0m[1;36m8[0m[39m-byte buffer when[0m        [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:       calling [0m[1;35mwrite[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m on it, which makes the [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m below fine since[0m    [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:       this is only used on [0m[1;36m64[0m[39m-bit systems and then the pointer is [0m[1;36m64[0m[39m-bit *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:    buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m1[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:    [0m[1;35mwhile[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:      [0m[35m/[0m[39m* [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m is not thread-safe in general, because concurrent calls[0m      [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:         can have their messages interleaved, but in this case the content[0m     [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:         of the messages does not matter, which makes it ok to call.[0m           [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:         The write socket is set to non-blocking, this way this function[0m       [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:         cannot block, making it safe to call even from the same thread[0m        [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:         that will call [0m[1;35mcurl_multi_wait[0m[1;39m([0m[1;39m)[0m[39m. If [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m returns that it[0m         [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:         would block, it is considered successful because it means that[0m        [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:         previous calls to this function will wake up the [0m[1;35mpoll[0m[1;39m([0m[1;39m)[0m[39m. *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mwakeup_write[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:350[0m[39m-[0m[1;36m430[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_CTX_DATA, data->set.ssl.fsslctxp[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.fdebug[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_DEBUGFUNCTION, data->set.fdebug[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.debugdata[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_DEBUGDATA, data->set.debugdata[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.str[0m[1;39m[[0m[39mSTRING_SSL_EC_CURVES[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_EC_CURVES,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                       data->set.str[0m[1;39m[[0m[39mSTRING_SSL_EC_CURVES[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:  [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    long mask =[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.enable_beast ?[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:       CURLSSLOPT_ALLOW_BEAST : [0m[1;36m0[0m[1;39m)[0m[39m |[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.no_revoke ?[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:       CURLSSLOPT_NO_REVOKE : [0m[1;36m0[0m[1;39m)[0m[39m |[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.no_partialchain ?[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:       CURLSSLOPT_NO_PARTIALCHAIN : [0m[1;36m0[0m[1;39m)[0m[39m |[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.revoke_best_effort ?[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:       CURLSSLOPT_REVOKE_BEST_EFFORT : [0m[1;36m0[0m[1;39m)[0m[39m |[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.native_ca_store ?[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:       CURLSSLOPT_NATIVE_CA : [0m[1;36m0[0m[1;39m)[0m[39m |[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:      [0m[1;39m([0m[39mdata->set.ssl.auto_client_cert ?[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:       CURLSSLOPT_AUTO_CLIENT_CERT : [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mcurl_easy_setopt[0m[1;39m([0m[39mdoh, CURLOPT_SSL_[0m[1;33mOPTIONS[0m[39m, mask[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:  doh->set.fmultidone = doh_done;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:  doh->set.dohfor_mid = data->mid; [0m[35m/[0m[39m* for which transfer this is done *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:  [0m[35m/[0m[39m* DoH handles must not inherit private_data. The handles may be passed to[0m    [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:     the user via callbacks and the user will be able to identify them as[0m       [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:     internal handles because private data is not set. The user can then set[0m    [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:     private_data via CURLOPT_PRIVATE if they so choose. *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!doh->set.private_data[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mcurl_multi_add_handle[0m[1;39m([0m[39mmulti, doh[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    goto error;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:  p->easy_mid = doh->mid;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m393:e[0m[39mrror:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:  [0m[1;35mCurl_close[0m[1;39m([0m[39m&doh[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  p->easy_mid = [0m[1;36m-1[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m: * [0m[1;35mCurl_doh[0m[1;39m([0m[1;39m)[0m[39m resolves a name using DoH. It resolves a name and returns a[0m       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m: * [0m[32m'Curl_addrinfo *'[0m[39m with the address information.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                               int *waitp[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:  struct doh_probes *dohp;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:  struct connectdata *conn = data->conn;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:  [0m[35m/[0m[39m* for now, this is only used when ECH is enabled *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:# ifdef USE_ECH[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:  char *qname = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:# endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:  *waitp = FALSE;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mhostname;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mport;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->req.doh[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:1500[0m[39m-[0m[1;36m1560[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:                    FALSE[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1503:C[0m[39mURLMcode [0m[1;35mcurl_multi_poll[0m[1;39m([0m[39mCURLM *multi,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:                          struct curl_waitfd extra_fds[0m[1;39m[[0m[1;39m][0m[39m,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:                          unsigned int extra_nfds,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:                          int timeout_ms,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:                          int *ret[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:  return [0m[1;35mmulti_wait[0m[1;39m([0m[39mmulti, extra_fds, extra_nfds, timeout_ms, ret, TRUE,[0m       [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:                    TRUE[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1513:C[0m[39mURLMcode [0m[1;35mcurl_multi_wakeup[0m[1;39m([0m[39mCURLM *m[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:  [0m[35m/[0m[39m* this function is usually called from another thread,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:     it has to be careful only to access parts of the[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:     Curl_multi struct that are constant *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:  struct Curl_multi *multi = m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mENABLE_WAKEUP[0m[1;39m)[0m[39m && ![0m[1;35mdefined[0m[1;39m([0m[39mUSE_WINSOCK[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:  const void *buf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:  const uint64_t val = [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:  char buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:  [0m[35m/[0m[39m* GOOD_MULTI_HANDLE can be safely called *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_MULTI_HANDLE[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:    return CURLM_BAD_HANDLE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:#ifdef ENABLE_WAKEUP[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:#ifdef USE_WINSOCK[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mWSASetEvent[0m[1;39m([0m[39mmulti->wsa_event[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:    return CURLM_OK;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:  [0m[35m/[0m[39m* the wakeup_pair variable is only written during init and cleanup,[0m         [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:     making it safe to access from another thread after the init part[0m          [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:     and before cleanup *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != CURL_SOCKET_BAD[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:#ifdef USE_EVENTFD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:    buf = &val;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:    [0m[35m/[0m[39m* eventfd has a stringent rule of requiring the [0m[1;36m8[0m[39m-byte buffer when[0m        [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:       calling [0m[1;35mwrite[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m on it, which makes the [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m below fine since[0m    [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:       this is only used on [0m[1;36m64[0m[39m-bit systems and then the pointer is [0m[1;36m64[0m[39m-bit *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:    buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m1[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:    [0m[1;35mwhile[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:      [0m[35m/[0m[39m* [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m is not thread-safe in general, because concurrent calls[0m      [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:         can have their messages interleaved, but in this case the content[0m     [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:         of the messages does not matter, which makes it ok to call.[0m           [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:         The write socket is set to non-blocking, this way this function[0m       [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:         cannot block, making it safe to call even from the same thread[0m        [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:         that will call [0m[1;35mcurl_multi_wait[0m[1;39m([0m[1;39m)[0m[39m. If [0m[1;35mswrite[0m[1;39m([0m[1;39m)[0m[39m returns that it[0m         [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:         would block, it is considered successful because it means that[0m        [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:         previous calls to this function will wake up the [0m[1;35mpoll[0m[1;39m([0m[1;39m)[0m[39m. *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mwakeup_write[0m[1;39m([0m[39mmulti->wakeup_pair[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:423[0m[39m-[0m[1;36m430[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->req.doh[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1431[0m[39m-[0m[1;36m1440[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:    [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:    data->req.doh->req_hds = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root-cause analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The DoH resolver [0m[1;39m([0m[39m`Curl_doh`[0m[1;39m)[0m[39m calls `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` immediately after[0m [2m                [0m
[2;36m                    [0m         [39mdecoding the DNS-over-HTTPS response [0m[1;39m([0m[39maround line [0m[1;36m1393[0m[39m in lib/doh.c[0m[1;39m)[0m[39m.  [0m             [2m                [0m
[2;36m                    [0m         [39m   - That early cleanup frees the `data->req.doh` structure [0m[1;39m([0m[39mthe `doh_probes`[0m[1;39m)[0m[39m, but[0m [2m                [0m
[2;36m                    [0m         [39mdoes _not_ clear or reset the pointer before returning from `Curl_doh`.  [0m           [2m                [0m
[2;36m                    [0m         [39m   - Later, at request teardown in `Curl_req_done`, curl calls [0m                     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` unconditionally on the [0m[1;39m([0m[39mnow-freed[0m[1;39m)[0m[39m `data->req.doh` pointer, [0m [2m                [0m
[2;36m                    [0m         [39mleading to a wild memory read in `Curl_doh_close` [0m[1;39m([0m[39mthe ASan crash[0m[1;39m)[0m[39m.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Strategy to fix[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   A. Remove the premature free of `doh_probes` in `Curl_doh` so that the struct [0m   [2m                [0m
[2;36m                    [0m         [39mremains valid until the normal cleanup path at request destruction.  [0m               [2m                [0m
[2;36m                    [0m         [39m      - In lib/doh.c, locate the snippet:[0m                                           [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        return result;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      - Remove the call to `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mand keep the `[0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mand `return result;`[0m[1;39m)[0m[39m.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m      - This ensures that `data->req.doh` remains allocated [0m[1;39m([0m[39mand non-NULL[0m[1;39m)[0m[39m for the [0m [2m                [0m
[2;36m                    [0m         [39mduration of the transfer.[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   B. Rely on the existing cleanup in `Curl_req_free` [0m[1;39m([0m[39mor other finalization [0m       [2m                [0m
[2;36m                    [0m         [39mroutines[0m[1;39m)[0m[39m to invoke `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` exactly once, freeing `doh_probes` at [0m [2m                [0m
[2;36m                    [0m         [39mthe end of the easy-handle’s life.  [0m                                                [2m                [0m
[2;36m                    [0m         [39m      - `Curl_req_free` already calls `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` under the [0m           [2m                [0m
[2;36m                    [0m         [39m`!CURL_DISABLE_DOH` guard.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m      - This change preserves the intended single cleanup of DoH state and prevents[0m [2m                [0m
[2;36m                    [0m         [39mdouble-free/use-after-free.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of existing logic and side-effects[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - The DoH resolution path still enqueues and handles all DoH probes; only the [0m   [2m                [0m
[2;36m                    [0m         [39m_timing_ of freeing the `doh_probes` struct shifts from mid-resolution to the final[0m [2m                [0m
[2;36m                    [0m         [39measy-handle cleanup.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - `Curl_req_done` will continue to call `[0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` to tear down [0m     [2m                [0m
[2;36m                    [0m         [39mindividual DoH probe handles [0m[1;39m([0m[39mmulti-handle removals[0m[1;39m)[0m[39m, but the underlying [0m           [2m                [0m
[2;36m                    [0m         [39m`doh_probes` struct remains intact until `Curl_req_free`.  [0m                         [2m                [0m
[2;36m                    [0m         [39m   - No changes are made to the multi or harness code; all existing tests and [0m      [2m                [0m
[2;36m                    [0m         [39mrequest lifecycles [0m[1;39m([0m[39mincluding error and abort paths[0m[1;39m)[0m[39m will drive the single cleanup [0m [2m                [0m
[2;36m                    [0m         [39min `Curl_req_free`, keeping memory management consistent.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Potential side-effects and mitigation[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - The only behavioral change is that the memory for `doh_probes` lives slightly [0m [2m                [0m
[2;36m                    [0m         [39mlonger [0m[1;39m([0m[39muntil the easy handle is freed[0m[1;39m)[0m[39m. This overhead is minimal and bounded by [0m   [2m                [0m
[2;36m                    [0m         [39mone small struct per easy handle.  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Tests that might have observed the `doh_probes` struct prematurely freed now [0m  [2m                [0m
[2;36m                    [0m         [39msee it persist, but since it is internal state, no public API is affected.  [0m        [2m                [0m
[2;36m                    [0m         [39m   - Fuzzer harnesses and multi-handle state machines remain untouched, preserving [0m [2m                [0m
[2;36m                    [0m         [39mall existing coverage and behavior.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. References to similar patterns[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Other resolver backends in libcurl [0m[1;39m([0m[39me.g., c-ares integration[0m[1;39m)[0m[39m allocate [0m        [2m                [0m
[2;36m                    [0m         [39mper-request state in their init functions and only free that state in the final [0m    [2m                [0m
[2;36m                    [0m         [39m`Curl_easy_cleanup` or `Curl_req_free`.  [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Aligning DoH’s lifecycle with these patterns ensures consistency and avoids [0m   [2m                [0m
[2;36m                    [0m         [39mmid-stream free before the final request teardown.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 10:46:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=434694;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=164893;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:47:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=77379;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=247719;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:48:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=498483;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=786985;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=417872;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=737636;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:48:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.01[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=845335;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=299793;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=343619;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=42865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp1qlf9y6l[0m                                                 ]8;id=180783;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=375146;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 10:49:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m97.79[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=63445;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586710;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=482990;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=339388;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:49:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m12.93[0m seconds;                ]8;id=815239;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=464029;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=149540;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=472308;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:50:00][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=687909;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=770420;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3313924361[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28142[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2a9c258[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55e7b2aa3046[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28142[0m PCs[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2aa3048[0m,[1;36m0x55e7b2b10f28[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55e7b281b711[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7fff38e135c0[0m sp [1;36m0x7fff38e13460[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55e7b281b711[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55e7b26de91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55e7b26b0df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55e7b26b8a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55e7b26b6035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55e7b2664ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55e7b26620ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55e7b25166a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55e7b2501915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55e7b25073af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55e7b2532652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f2da6e6e082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55e7b24f9afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpsicibb89[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/27/25 10:50:01][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=574042;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=603827;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3313924361[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28142[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2a9c258[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55e7b2aa3046[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28142[0m PCs[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2aa3048[0m,[1;36m0x55e7b2b10f28[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55e7b281b711[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7fff38e135c0[0m sp [1;36m0x7fff38e13460[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55e7b281b711[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55e7b26de91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55e7b26b0df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55e7b26b8a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55e7b26b6035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55e7b2664ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55e7b26620ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55e7b25166a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55e7b2501915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55e7b25073af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55e7b2532652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f2da6e6e082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55e7b24f9afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpsicibb89[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3313924361[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28142[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2a9c258[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55e7b2aa3046[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28142[0m PCs[1m)[0m: [1;36m28142[0m [1m[[0m[1;36m0x55e7b2aa3048[0m,[1;36m0x55e7b2b10f28[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55e7b281b711[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7fff38e135c0[0m sp [1;36m0x7fff38e13460[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55e7b281b711[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55e7b26de91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55e7b26b0df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55e7b26b8a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55e7b26b6035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55e7b2664ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55e7b26620ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55e7b25166a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55e7b2501915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55e7b25073af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55e7b2532652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f2da6e6e082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x55e7b24f9afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done                               [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1414:39[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpsicibb89[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.45[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=652279;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=914167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=722568;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222705;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=535260;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51413;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:50:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=292521;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=549595;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:50:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.03[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=689718;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=76329;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:50:04][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=863314;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=12071;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         +++ b/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-1390[0m,[1;36m7[0m +[1;36m1390[0m,[1;36m6[0m @@                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m* All done *[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m              [1;35mde_cleanup[0m[1m([0m&de[1m)[0m;                                                               [2m                [0m
[2;36m                    [0m         -    [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m              return result;                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m            [1m}[0m [35m/[0m* !dohp->pending *[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         @@ [1;36m-1402[0m,[1;36m30[0m +[1;36m1401[0m,[1;36m32[0m @@                                                             [2m                [0m
[2;36m                    [0m          void [1;35mCurl_doh_close[0m[1m([0mstruct Curl_easy *data[1m)[0m                                        [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m            struct doh_probes *doh = data->req.doh;                                          [2m                [0m
[2;36m                    [0m         -  [1;35mif[0m[1m([0mdoh && data->multi[1m)[0m [1m{[0m                                                         [2m                [0m
[2;36m                    [0m         -    struct Curl_easy *probe_data;                                                  [2m                [0m
[2;36m                    [0m         -    curl_off_t mid;                                                                [2m                [0m
[2;36m                    [0m         -    size_t slot;                                                                   [2m                [0m
[2;36m                    [0m         -    [1;35mfor[0m[1m([0mslot = [1;36m0[0m; slot [1m<[0m[39m DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [39m-      mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                             [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-        continue;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-      doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-      [0m[35m/[0m[39m* should have been called before data is removed from multi handle *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata->multi[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m-      probe_data = data->multi ? [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdata->multi, mid[0m[1;39m)[0m[39m :[0m         [2m                [0m
[2;36m                    [0m         [39m-        NULL;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m                        [2m                [0m
[2;36m                    [0m         [39m-                     FMT_OFF_T [0m[32m" not found!"[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [39m-                     doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-        continue;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m-      [0m[35m/[0m[39m* data->multi might already be reset at this time *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mdata->multi, probe_data[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m-      [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mif[0m[1;39m([0m[39m!doh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+    return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  CURLM *multi = data->multi;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mif[0m[1;39m([0m[39m!multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+    return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  size_t slot;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mfor[0m[1;39m([0m[39mslot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m+    curl_off_t mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+      continue;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* should have been called before data is removed from multi handle *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+    struct Curl_easy *probe_data = [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mmulti, mid[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m[39m FMT_OFF_T[0m                [2m                [0m
[2;36m                    [0m         [39m+                   [0m[32m" not found!"[0m[39m, doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+      continue;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mmulti, probe_data[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3313924361[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28142[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28142[0m[39m [0m[1;39m[[0m[1;36m0x55e7b2a9c258[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55e7b2aa3046[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28142[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28142[0m[39m [0m[1;39m[[0m[1;36m0x55e7b2aa3048[0m[39m,[0m[1;36m0x55e7b2b10f28[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55e7b281b711[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fff38e135c0[0m[39m sp [0m[1;36m0x7fff38e13460[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55e7b281b711[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1414:39[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55e7b26de91a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55e7b26b0df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55e7b26b8a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55e7b26b6035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55e7b2664ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55e7b26620ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55e7b25166a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55e7b2501915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55e7b25073af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55e7b2532652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f2da6e6e082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55e7b24f9afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1414:39[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpsicibb89[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn AddressSanitizer crash was discovered when running the `curl_fuzzer_http` fuzz [0m  [2m                [0m
[2;36m                    [0m         [39mtarget under libFuzzer. The fuzzer hit a SEGV in `Curl_doh_close` [0m[1;39m([0m[39min [0m              [2m                [0m
[2;36m                    [0m         [39m`lib/doh.[0m[1;92mc:1410:30[0m[39m`[0m[1;39m)[0m[39m, indicating a wild read of memory during DNS-over-HTTPS [0m       [2m                [0m
[2;36m                    [0m         [39mcleanup. A patch attempt commented out a call to `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` at the [0m   [2m                [0m
[2;36m                    [0m         [39mend of a cleanup block in `lib/doh.c`. After applying that change, the same SEGV [0m   [2m                [0m
[2;36m                    [0m         [39mstill occurred, now reported one line earlier [0m[1;39m([0m[39m`lib/doh.[0m[1;92mc:1409:30[0m[39m`[0m[1;39m)[0m[39m in the same [0m    [2m                [0m
[2;36m                    [0m         [39mfunction and call stack. The patch did not resolve the crash.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInitial Issue  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The fuzzer was executed in “interactive” mode with libFuzzer, targeting [0m          [2m                [0m
[2;36m                    [0m         [39m`curl_fuzzer_http` and supplying a single testcase [0m[1;36m100[0m[39m times.  [0m                     [2m                [0m
[2;36m                    [0m         [39m- AddressSanitizer reported a SEGV triggered by a READ of an invalid [0m[1;39m([0m[39m“high value”[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39maddress.  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- The crash occurred in `Curl_doh_close` at `lib/doh.[0m[1;92mc:1410:30[0m[39m`.  [0m                  [2m                [0m
[2;36m                    [0m         [39m- The in-memory stack trace:  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Curl_doh_close [0m[1;39m([0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;36m1410[0m[1;39m)[0m[39m  [0m                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Curl_req_done [0m[1;39m([0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;36m108[0m[1;39m)[0m[39m  [0m                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. multi_done [0m[1;39m([0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;36m754[0m[1;39m)[0m[39m  [0m                                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. multi_runsingle and curl_multi_perform in multi.c  [0m                            [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. fuzz_handle_transfer in curl_fuzzer.cc  [0m                                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m6[0m[39m. LLVMFuzzerTestOneInput in curl_fuzzer.cc  [0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mImportant Observations  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m- The fault is a “wild-addr-read” in the DOH cleanup routine.  [0m                     [2m                [0m
[2;36m                    [0m         [39m- The failure consistently reproduces on the same code path under libFuzzer.  [0m      [2m                [0m
[2;36m                    [0m         [39m- No other sanitizers [0m[1;39m([0m[39mUBSan, MSan[0m[1;39m)[0m[39m were triggered; AddressSanitizer only flags the[0m [2m                [0m
[2;36m                    [0m         [39millegal memory access.  [0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch Attempt  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- In `lib/doh.c`, at around line [0m[1;36m1390[0m[39m in the function containing `dohp->pending` [0m   [2m                [0m
[2;36m                    [0m         [39mhandling, the call  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m      [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m  was removed [0m[1;39m([0m[39mcommented out[0m[1;39m)[0m[39m immediately after `[0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;` and before [0m      [2m                [0m
[2;36m                    [0m         [39m`return result;`.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- This edit intended to avoid double-cleanup or invalid state in the DOH cleanup [0m   [2m                [0m
[2;36m                    [0m         [39mpath.[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mResult After Patch  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m- The fuzzer was rerun under identical conditions.  [0m                                [2m                [0m
[2;36m                    [0m         [39m- The same SEGV occurred, now at `lib/doh.[0m[1;92mc:1409:30[0m[39m`, again in `Curl_doh_close`.  [0m  [2m                [0m
[2;36m                    [0m         [39m- The stack trace remained unchanged, indicating the patch did not prevent the [0m     [2m                [0m
[2;36m                    [0m         [39minvalid memory access in `Curl_doh_close`.  [0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for Further Investigation  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- The implementation of `Curl_doh_close` in `lib/doh.c`, including pointer validity[0m [2m                [0m
[2;36m                    [0m         [39mand state assumptions.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m- The relationship between `Curl_doh_close` and `Curl_doh_cleanup`.  [0m               [2m                [0m
[2;36m                    [0m         [39m- How `dohp->pending` and related data structures are initialized, used, and freed.[0m [2m                [0m
[2;36m                    [0m         [39m- Upstream calls in `Curl_req_done` and `multi_done` that lead into the DOH cleanup[0m [2m                [0m
[2;36m                    [0m         [39mpath.  [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- Any code paths in the DOH module that may trigger cleanup on uninitialized or [0m    [2m                [0m
[2;36m                    [0m         [39malready-freed memory.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3096760872[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d5b527e218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d5b5285004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d5b5285008[0m[39m,[0m[1;36m0x55d5b52f2ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55d5b4ffd6ee[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffd71aab940[0m[39m sp [0m[1;36m0x7ffd71aab7e0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d5b4ffd6ee[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1409:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d5b4ec091a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d5b4e92df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d5b4e9aa81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d5b4e98035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d5b4e46ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d5b4e440ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d5b4cf86a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d5b4ce3915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d5b4ce93af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d5b4d14652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f89ab044082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d5b4cdbafd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1409:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiwus4dxn[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:404[0m[39m-[0m[1;36m438[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                               int *waitp[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:  struct doh_probes *dohp;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:  struct connectdata *conn = data->conn;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:  [0m[35m/[0m[39m* for now, this is only used when ECH is enabled *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:# ifdef USE_ECH[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:  char *qname = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:# endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:  *waitp = FALSE;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mhostname;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mport;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->req.doh[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:  [0m[1;35mfor[0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < DOH_SLOT_COUNT; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    dohp->probe[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:  conn->bits.doh = TRUE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:  dohp->host = hostname;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:  dohp->port = port;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:  dohp->req_hds =[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1402[0m[39m-[0m[1;36m1429[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1402[0m[39m:void [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1403[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1404[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1405[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh && data->multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1406[0m[39m:    struct Curl_easy *probe_data;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1407[0m[39m:    curl_off_t mid;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1408[0m[39m:    size_t slot;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1409[0m[39m:    [0m[1;35mfor[0m[1;39m([0m[39mslot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m:      mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1411[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1412[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1413[0m[39m:      doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1414[0m[39m:      [0m[35m/[0m[39m* should have been called before data is removed from multi handle *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1415[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata->multi[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1416[0m[39m:      probe_data = data->multi ? [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdata->multi, mid[0m[1;39m)[0m[39m :[0m     [2m                [0m
[2;36m                    [0m         [1;36m1417[0m[39m:        NULL;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1418[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1419[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:                     FMT_OFF_T [0m[32m" not found!"[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1421[0m[39m:                     doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:      [0m[35m/[0m[39m* data->multi might already be reset at this time *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m:      [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mdata->multi, probe_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m:      [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1428[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1429[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:100[0m[39m-[0m[1;36m110[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:123[0m[39m-[0m[1;36m128[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:  [0m[35m/[0m[39m* Can no longer [0m[1;35mmemset[0m[1;39m([0m[1;39m)[0m[39m this struct as we need to keep some state *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/multi.[0m[1;92mc:776[0m[39m-[0m[1;36m800[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m776:C[0m[39mURLMcode [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mCURLM *m, CURL *d[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:  struct Curl_multi *multi = m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:  struct Curl_easy *data = d;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:  bool premature;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:  struct Curl_llist_node *e;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:  CURLMcode rc;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:  bool removed_timer = FALSE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:  [0m[35m/[0m[39m* First, make some basic checks that the CURLM handle is a good handle *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_MULTI_HANDLE[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:    return CURLM_BAD_HANDLE;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:  [0m[35m/[0m[39m* Verify that we got a somewhat good easy handle too *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mGOOD_EASY_HANDLE[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m || !multi->num_easy[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:    return CURLM_BAD_EASY_HANDLE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:  [0m[35m/[0m[39m* Prevent users from trying to remove same easy handle more than once *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!data->multi[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    return CURLM_OK; [0m[35m/[0m[39m* it is already removed so let's say it is fine! *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:  [0m[35m/[0m[39m* Prevent users from trying to remove an easy handle from the wrong multi *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->multi != multi[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    return CURLM_BAD_EASY_HANDLE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1389[0m[39m-[0m[1;36m1395[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:    [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:    return result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1389[0m[39m-[0m[1;36m1395[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:    [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:    return result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code paths and the AddressSanitizer crash, the root cause is [0m   [2m                [0m
[2;36m                    [0m         [39mclear: the DOH “cleanup” function [0m[1;39m([0m[39m`Curl_doh_cleanup`[0m[1;39m)[0m[39m is being invoked twice on [0m   [2m                [0m
[2;36m                    [0m         [39mthe same `data->req.doh` structure, once inside `Curl_doh` when all probes finish, [0m [2m                [0m
[2;36m                    [0m         [39mand again later during request teardown [0m[1;39m([0m[39m`Curl_req_done` or `Curl_req_hard_reset`[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mvia `Curl_doh_close`→`Curl_multi_remove_handle`→`Curl_close`. The first invocation [0m [2m                [0m
[2;36m                    [0m         [39mfrees `data->req.doh`; the second invocation then dereferences freed memory, [0m       [2m                [0m
[2;36m                    [0m         [39mcausing the wild read crash.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo fix this, we must ensure that `Curl_doh_cleanup` is called exactly once per DOH [0m [2m                [0m
[2;36m                    [0m         [39mrequest, and that any later callers of `Curl_doh_close` or `Curl_doh_cleanup` see [0m  [2m                [0m
[2;36m                    [0m         [39mthat no allocation remains. Concretely:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Remove the premature call to `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` inside `Curl_doh` when [0m    [2m                [0m
[2;36m                    [0m         [39m`dohp->pending` drops to zero. This was already attempted, but patching only that [0m  [2m                [0m
[2;36m                    [0m         [39msite leaves the same crash because the structure is still freed elsewhere—or [0m       [2m                [0m
[2;36m                    [0m         [39mconversely, still gets freed here and then closed again. We must coordinate cleanup[0m [2m                [0m
[2;36m                    [0m         [39mto a single location.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Instead, leave the DOH probes data [0m[1;39m([0m[39m`data->req.doh`[0m[1;39m)[0m[39m intact until the request [0m   [2m                [0m
[2;36m                    [0m         [39mteardown path, where `Curl_doh_close` is always called. Let `Curl_doh_close` both [0m  [2m                [0m
[2;36m                    [0m         [39mclose outstanding probes and then free the `dohp` data itself. That ensures a [0m      [2m                [0m
[2;36m                    [0m         [39msingle cleanup.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Implement the following detailed changes in `lib/doh.c`:[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   a. In `Curl_doh`, change the “all done” branch so that it does **not** call [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m`; it simply returns `CURLE_OK` and leaves `data->req.doh` [0m  [2m                [0m
[2;36m                    [0m         [39min place. [0m[1;39m([0m[39mThis prevents a double-free, as the teardown code will handle freeing.[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   b. Augment `Curl_doh_close` to perform the free of `data->req.doh` **after** [0m    [2m                [0m
[2;36m                    [0m         [39mclosing any live probes. That is, at the very end of `Curl_doh_close`, once all [0m    [2m                [0m
[2;36m                    [0m         [39mslots have been iterated and multi handles removed, call `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m`. [0m [2m                [0m
[2;36m                    [0m         [39mEnsure this call happens whether or not any probes were pending—so that if [0m         [2m                [0m
[2;36m                    [0m         [39m`Curl_doh` returned early [0m[1;39m([0m[39mno probes started[0m[1;39m)[0m[39m, there is still a cleanup.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   c. Guard against racing `data->multi` being set to NULL mid-loop. In [0m            [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_close`, copy `CURLM *multi = data->multi;` into a local variable [0m         [2m                [0m
[2;36m                    [0m         [39m**before** entering the slot loop. Then check `[0m[1;35mif[0m[1;39m([0m[39m!doh || !multi[0m[1;39m)[0m[39m` at top; and [0m     [2m                [0m
[2;36m                    [0m         [39minside the loop always use the local `multi`. This prevents reading from a stale [0m   [2m                [0m
[2;36m                    [0m         [39m`data->multi` pointer if the structure is being torn down concurrently.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   d. Ensure idempotence: after freeing `data->req.doh`, set `data->req.doh = NULL`[0m [2m                [0m
[2;36m                    [0m         [39mso that any further calls [0m[1;39m([0m[39mif any stray ones occur[0m[1;39m)[0m[39m early-exit in `Curl_doh_close` [0m [2m                [0m
[2;36m                    [0m         [39mwithout dereferencing.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Verify that no other code paths call `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` or free [0m           [2m                [0m
[2;36m                    [0m         [39m`data->req.doh` elsewhere. If so, remove or guard those calls.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. After these edits, rerun the fuzzer. We should see no double-free and [0m           [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_close` always operates on a valid `dohp` [0m[1;39m([0m[39muntil it frees it exactly [0m      [2m                [0m
[2;36m                    [0m         [39monce[0m[1;39m)[0m[39m.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhy this works:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- We maintain the existing handshake: `Curl_doh` sets up and starts DNS-over-HTTPS [0m [2m                [0m
[2;36m                    [0m         [39mprobes; `Curl_req_done`[0m[35m/[0m[39m`Curl_req_hard_reset` always invoke `Curl_doh_close` on [0m    [2m                [0m
[2;36m                    [0m         [39mrequest teardown. That remains unchanged, so no harness or test breakage.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Cleanup of DOH state now occurs in one place [0m[1;39m([0m[39m`Curl_doh_close`[0m[1;39m)[0m[39m, removing the [0m    [2m                [0m
[2;36m                    [0m         [39mpremature cleanup inside `Curl_doh`. This eliminates the double-free/wild-read [0m     [2m                [0m
[2;36m                    [0m         [39msequence that AddressSanitizer flagged.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- By copying `data->multi` into a local variable before the loop, we avoid [0m         [2m                [0m
[2;36m                    [0m         [39mdereferencing a potentially stale or NULLed `data->multi` mid-loop.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPotential side effects and mitigation:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- If any code expected `data->req.doh` to be NULL immediately after DNS resolution [0m [2m                [0m
[2;36m                    [0m         [39mreturns, that no longer happens; instead, it persists until teardown. Test for any [0m [2m                [0m
[2;36m                    [0m         [39mcode that peeks at `data->req.doh` after a `Curl_doh` call. However, because DOH is[0m [2m                [0m
[2;36m                    [0m         [39man asynchronous mechanism and `Curl_doh` only informs “not done” by returning a [0m    [2m                [0m
[2;36m                    [0m         [39mhandle, we expect no component to access `data->req.doh` until teardown; existing [0m  [2m                [0m
[2;36m                    [0m         [39mcode uses only `data->req.doh->pending` to decide whether to call channels.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- If any code path calls `Curl_doh_cleanup` explicitly [0m[1;39m([0m[39moutside of teardown[0m[1;39m)[0m[39m, those[0m [2m                [0m
[2;36m                    [0m         [39mcalls should be examined to avoid clobbering the single-cleanup strategy. Search [0m   [2m                [0m
[2;36m                    [0m         [39mfor all uses of `Curl_doh_cleanup` and ensure they’re removed or guarded.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCodebase consistency:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Similar modules [0m[1;39m([0m[39me.g., asynchronous name resolutions via c-ares or threaded DNS[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39moften delay freeing until close. We model DOH on that pattern.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- We preserve the multi-handle removal logic and do not alter harness or test code,[0m [2m                [0m
[2;36m                    [0m         [39mrespecting the fuzzer entrypoint.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mImplementation steps:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. In lib/doh.c, locate the “all done” branch in `Curl_doh` around line [0m[1;36m1390[0m[39m. [0m      [2m                [0m
[2;36m                    [0m         [39mRemove or comment out the call to `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m`. Leave only [0m             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m; return result;`.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. In Curl_doh_close [0m[1;39m([0m[39maround lines [0m[1;36m1402[0m[39m–[0m[1;36m1429[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - At the top, add:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m         struct Curl_easy *data_local = data;[0m                                       [2m                [0m
[2;36m                    [0m         [39m         CURLM *multi = data_local->multi;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     Then test `[0m[1;35mif[0m[1;39m([0m[39m!doh || !multi[0m[1;39m)[0m[39m return;`.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Change all uses of `data->multi` in the function body to use the local [0m        [2m                [0m
[2;36m                    [0m         [39m`multi`.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   - After the loop over slots, call:[0m                                               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     This frees `data->req.doh` and sets it NULL.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Ensure after that that `data->req.doh` is NULL, and exit.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Ensure Curl_doh_cleanup sets `data->req.doh = NULL` to prevent stale pointers.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Build and rerun AddressSanitizer fuzzing. Confirm the wild read is gone.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis strategy addresses the double-cleanup root cause, preserves existing logic, [0m   [2m                [0m
[2;36m                    [0m         [39mand harmonizes cleanup to a single function called on teardown. [0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 10:50:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=684577;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=337894;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:51:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=867113;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=56372;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:54:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=658086;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=339502;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=150344;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=764890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:54:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=648019;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=752228;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=521867;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=797031;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpwy4lihn0[0m                                                 ]8;id=191453;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=59776;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 10:55:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m97.55[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=157839;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=127260;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=103651;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=89599;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:55:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m12.93[0m seconds;                ]8;id=965356;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=19268;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=880493;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=280512;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:55:57][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=136258;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=263063;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3670103254[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d02304b218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d023052004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d023052008[0m,[1;36m0x55d0230bfec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d022dca6fe[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffdcab6d4e0[0m sp [1;36m0x7ffdcab6d380[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d022dca6fe[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d022dc8ccb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d022c8d91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d022c5fdf4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d022c67a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d022c65035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d022c13ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d022c110ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d022ac56a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d022ab0915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d022ab63af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55d022ae1652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7fd8c3a41082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55d022aa8afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpka7xxy1y[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=97648;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=949266;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3670103254[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d02304b218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d023052004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d023052008[0m,[1;36m0x55d0230bfec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d022dca6fe[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffdcab6d4e0[0m sp [1;36m0x7ffdcab6d380[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d022dca6fe[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d022dc8ccb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d022c8d91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d022c5fdf4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d022c67a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d022c65035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d022c13ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d022c110ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d022ac56a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d022ab0915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d022ab63af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55d022ae1652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7fd8c3a41082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55d022aa8afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpka7xxy1y[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m3670103254[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d02304b218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x55d023052004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x55d023052008[0m,[1;36m0x55d0230bfec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x55d022dca6fe[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffdcab6d4e0[0m sp [1;36m0x7ffdcab6d380[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55d022dca6fe[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55d022dc8ccb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55d022c8d91a[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m108:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55d022c5fdf4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55d022c67a81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55d022c65035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55d022c13ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55d022c110ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55d022ac56a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55d022ab0915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x55d022ab63af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x55d022ae1652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7fd8c3a41082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x55d022aa8afd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpka7xxy1y[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.48[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=838810;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=45886;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=268394;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=185159;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 10:55:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.91[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=269327;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=48956;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:55:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=459014;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=720498;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=449280;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=981449;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 10:56:00][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=230596;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=68884;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         +++ b/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-105[0m,[1;36m7[0m +[1;36m105[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m              [1m([0mvoid[1m)[0m[1;35mreq_flush[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m            [1;35mCurl_client_reset[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m          #ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         -  [1;35mCurl_doh_close[0m[1m([0mdata[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         +  [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m          #endif                                                                             [2m                [0m
[2;36m                    [0m            return CURLE_OK;                                                                 [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-123[0m,[1;36m7[0m +[1;36m123[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m              [1;35mCurl_bufq_reset[0m[1m([0m&req->sendbuf[1m)[0m;                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          #ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         -  [1;35mCurl_doh_close[0m[1m([0mdata[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         +  [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m          #endif                                                                             [2m                [0m
[2;36m                    [0m            [35m/[0m* Can no longer [1;35mmemset[0m[1m([0m[1m)[0m this struct as we need to keep some state *[35m/[0m           [2m                [0m
[2;36m                    [0m            req->size = [1;36m-1[0m;                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3670103254[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d02304b218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d023052004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d023052008[0m[39m,[0m[1;36m0x55d0230bfec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55d022dca6fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffdcab6d4e0[0m[39m sp [0m[1;36m0x7ffdcab6d380[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d022dca6fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d022dc8ccb[0m[39m in Curl_doh_cleanup [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1435:5[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d022c8d91a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d022c5fdf4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d022c67a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d022c65035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d022c13ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d022c110ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d022ac56a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d022ab0915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d022ab63af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d022ae1652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7fd8c3a41082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d022aa8afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done[0m                        [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpka7xxy1y[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is an AddressSanitizer SEGV in Curl_doh_close [0m[1;39m([0m[39min lib/doh.c[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mtriggered by a wild read of a high address during a libFuzzer session. The patch [0m   [2m                [0m
[2;36m                    [0m         [39mattempt changes the control flow in Curl_doh_close by:[0m                              [2m                [0m
[2;36m                    [0m         [39m- Returning early if `data->req.doh` is NULL.[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Deferring cleanup to the end of Curl_doh_close.[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Consolidating the multi‐handle check and cleanup calls.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzer still reproduces a SEGV at a nearby location [0m  [2m                [0m
[2;36m                    [0m         [39min Curl_doh_close [0m[1;39m([0m[39mline [0m[1;36m1414[0m[1;39m)[0m[39m, indicating that the change did not eliminate the [0m    [2m                [0m
[2;36m                    [0m         [39minvalid memory access.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInitial Issue  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- During fuzzing of curl_fuzzer_http [0m[1;39m([0m[39mlibFuzzer[0m[1;39m)[0m[39m, AddressSanitizer reports a SEGV [0m  [2m                [0m
[2;36m                    [0m         [39mon an unknown [0m[1;39m([0m[39mhigh[0m[1;39m)[0m[39m address in `Curl_doh_close` at lib/doh.[0m[1;92mc:1410:30[0m[39m.  [0m            [2m                [0m
[2;36m                    [0m         [39m- The crash stack trace shows the call sequence:[0m                                    [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Curl_doh_close[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Curl_req_done[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. multi_done[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. multi_runsingle[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. curl_multi_perform[0m                                                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m6[0m[39m. fuzz_handle_transfer[0m                                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m7[0m[39m. LLVMFuzzerTestOneInput[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- The signal is a READ access to an invalid address [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m[39m, suggesting [0m   [2m                [0m
[2;36m                    [0m         [39mthe code is dereferencing uninitialized or freed pointers in the doh context.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations in the initial issue log  [0m                                         [2m                [0m
[2;36m                    [0m         [39m- `doh = data->req.doh` likely points to garbage when Curl_doh_close runs.[0m          [2m                [0m
[2;36m                    [0m         [39m- The loop over `doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid` and calls to `curl_multi_get_handle`, [0m  [2m                [0m
[2;36m                    [0m         [39m`curl_multi_remove_handle`, `Curl_close` may reference invalid `doh` or invalid [0m    [2m                [0m
[2;36m                    [0m         [39m`mid`.[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- No null checks guard the entire block, so `doh` can be NULL or partially [0m         [2m                [0m
[2;36m                    [0m         [39minitialized.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch Attempt  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe patch modifies lib/doh.c in two locations. In `[0m[1;35mdoh_perform[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39maround line [0m     [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[1;39m)[0m[39m it removes an early call to Curl_doh_cleanup:[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```diff[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/lib/doh.c[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+++ b/lib/doh.c[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-1390[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m1390[0m[39m,[0m[1;36m6[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m     return result;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `Curl_doh_close` the logic is reordered and guarded:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```diff[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/lib/doh.c[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+++ b/lib/doh.c[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-1402[0m[39m,[0m[1;36m30[0m[39m +[0m[1;36m1401[0m[39m,[0m[1;36m32[0m[39m @@[0m                                                             [2m                [0m
[2;36m                    [0m         [39m void [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m{[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m   struct doh_probes *doh = data->req.doh;[0m                                          [2m                [0m
[2;36m                    [0m         [39m-  [0m[1;35mif[0m[1;39m([0m[39mdoh && data->multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m-    [0m[35m/[0m[39m* original loop over doh->probe[0m[1;39m[[0m[1;39m][0m[39m and cleanup *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [39m-  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mif[0m[1;39m([0m[39m!doh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+    return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  CURLM *multi = data->multi;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mif[0m[1;39m([0m[39m!multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+    return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mfor[0m[1;39m([0m[39msize_t slot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m+    curl_off_t mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+      continue;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mmulti[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+    struct Curl_easy *probe_data = [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mmulti, mid[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m[39m FMT_OFF_T[0m                [2m                [0m
[2;36m                    [0m         [39m+                   [0m[32m" not found!"[0m[39m, doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+      continue;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mmulti, probe_data[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m+  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mResult After Patch  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m- The fuzzer run still crashes with an ASan SEGV in `Curl_doh_close`, now at [0m       [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1414:39[0m[39m.  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m- The stack trace remains similar, indicating the invalid memory access is still in[0m [2m                [0m
[2;36m                    [0m         [39mthe same function, likely in the loop or cleanup calls.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for Further Investigation  [0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The lifetime and initialization of `data->req.doh` and its `probe[0m[1;39m[[0m[1;39m][0m[39m` array. [0m     [2m                [0m
[2;36m                    [0m         [39mEnsure that `doh` is allocated and zeroed before use.  [0m                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Whether `doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid` values can be out of sync or stale, leading [0m [2m                [0m
[2;36m                    [0m         [39mto invalid mids passed to `Curl_multi_get_handle`.  [0m                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Interactions between `Curl_req_done`, multi handle removal, and cleanup [0m         [2m                [0m
[2;36m                    [0m         [39mordering—especially in error or early‐exit paths.  [0m                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Whether `Curl_doh_cleanup` and `Curl_doh_close` overlap or double‐free any [0m      [2m                [0m
[2;36m                    [0m         [39mshared resources.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The conditions under which Curl_doh_close is invoked: verify `data->multi` and [0m  [2m                [0m
[2;36m                    [0m         [39m`data->req.doh` states across all code paths.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA holistic review should cover the doh module’s allocation, state transitions [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpending vs. complete[0m[1;39m)[0m[39m, and multi‐handle bookkeeping to identify where invalid [0m     [2m                [0m
[2;36m                    [0m         [39mpointers or mids are introduced.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3313924361[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28142[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28142[0m[39m [0m[1;39m[[0m[1;36m0x55e7b2a9c258[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55e7b2aa3046[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28142[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28142[0m[39m [0m[1;39m[[0m[1;36m0x55e7b2aa3048[0m[39m,[0m[1;36m0x55e7b2b10f28[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55e7b281b711[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fff38e135c0[0m[39m sp [0m[1;36m0x7fff38e13460[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55e7b281b711[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1414:39[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55e7b26de91a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55e7b26b0df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55e7b26b8a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55e7b26b6035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55e7b2664ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55e7b26620ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55e7b25166a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55e7b2501915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55e7b25073af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55e7b2532652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f2da6e6e082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55e7b24f9afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1414:39[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpsicibb89[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:100[0m[39m-[0m[1;36m160[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:   * containing a sequence of two or more consecutive dots, is invalid[0m          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:   * and cannot be encoded as a QNAME.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:   * If the hostname ends with a trailing dot, the corresponding[0m                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:   * QNAME-encoding is one byte longer than the hostname. If [0m[1;39m([0m[39mas is[0m             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   * also valid[0m[1;39m)[0m[39m the hostname is shortened by the omission of the[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:   * trailing dot, then its QNAME-encoding will be two bytes longer[0m             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   * than the hostname.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:   *[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:   * Each [0m[1;39m[[0m[39m label, dot [0m[1;39m][0m[39m pair is encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:   * preserving overall length. A final [0m[1;39m[[0m[39m label [0m[1;39m][0m[39m without a dot is[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:   * also encoded as [0m[1;39m[[0m[39m length, label [0m[1;39m][0m[39m, increasing overall length[0m               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:   * by one. The encoding is completed by appending a zero byte,[0m                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:   * representing the zero-length root label, again increasing[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:   * the overall length by one.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:   *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  size_t expected_len;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mhostlen[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  expected_len = [0m[1;36m12[0m[39m + [0m[1;36m1[0m[39m + hostlen + [0m[1;36m4[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhost[0m[1;39m[[0m[39mhostlen-[0m[1;36m1[0m[1;39m][0m[39m!=[0m[32m'.'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    expected_len++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mexpected_len > [0m[1;39m([0m[1;36m256[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* RFCs [0m[1;36m1034[0m[39m, [0m[1;36m1035[0m[39m *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    return DOH_DNS_NAME_TOO_LONG;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mlen < expected_len[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    return DOH_TOO_SMALL_BUFFER;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* [0m[1;36m16[0m[39m bit id *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  *dnsp++ = [0m[1;36m0x01[0m[39m; [0m[35m/[0m[39m* |QR|   Opcode  |AA|TC|RD| Set the RD bit *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* |RA|   Z    |   RCODE   |                *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  *dnsp++ = [0m[1;36m1[0m[39m;    [0m[35m/[0m[39m* QDCOUNT [0m[1;39m([0m[39mnumber of entries in the question section[0m[1;39m)[0m[39m *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ANCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* NSCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* ARCOUNT *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:  [0m[35m/[0m[39m* encode each label and store it in the QNAME *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:  [0m[1;35mwhile[0m[1;39m([0m[39m*hostp[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    size_t labellen;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    char *dot = [0m[1;35mstrchr[0m[1;39m([0m[39mhostp, [0m[32m'.'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:      labellen = dot - hostp;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:      labellen = [0m[1;35mstrlen[0m[1;39m([0m[39mhostp[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mlabellen > [0m[1;36m63[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m!labellen[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[35m/[0m[39m* label is too long or too short, error out *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:      *olen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:      return DOH_DNS_BAD_LABEL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m* label is non-empty, process it *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39mlabellen;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mdnsp, hostp, labellen[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    dnsp += labellen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    hostp += labellen;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m* advance past dot, but only if there is one *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:160[0m[39m-[0m[1;36m220[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m* advance past dot, but only if there is one *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mdot[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:      hostp++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  [0m[1;39m}[0m[39m [0m[35m/[0m[39m* next label *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:  *dnsp++ = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* append zero-length label for root *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  [0m[35m/[0m[39m* There are assigned TYPE codes beyond [0m[1;36m255[0m[39m: use range [0m[1;39m[[0m[1;36m1[0m[39m..[0m[1;36m65535[0m[1;39m][0m[39m  *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & [0m[1;39m([0m[39mdnstype >> [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:  *dnsp++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[1;39m([0m[1;36m255[0m[39m & dnstype[0m[1;39m)[0m[39m;      [0m[35m/[0m[39m* lower [0m[1;36m8[0m[39m bit TYPE *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:  *dnsp++ = [0m[32m'\0'[0m[39m; [0m[35m/[0m[39m* upper [0m[1;36m8[0m[39m bit CLASS *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  *dnsp++ = DNS_CLASS_IN; [0m[35m/[0m[39m* IN - [0m[32m"the Internet"[0m[39m *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  *olen = dnsp - orig;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:  [0m[35m/[0m[39m* verify that our estimation of length is valid, since[0m                       [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:   * this has led to buffer overflows in this function *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m*olen == expected_len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:  return DOH_OK;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:static size_t[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;92m183:d[0m[1;35moh_write_cb[0m[1;39m([0m[39mchar *contents, size_t size, size_t nmemb, void *userp[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:  size_t realsize = size * nmemb;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:  struct dynbuf *mem = [0m[1;39m([0m[39mstruct dynbuf *[0m[1;39m)[0m[39muserp;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_dyn_addn[0m[1;39m([0m[39mmem, contents, realsize[0m[1;39m)[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    return [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:  return realsize;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mUSE_HTTPSRR[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39mDEBUGBUILD[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:static void [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                          const char *prefix,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                          unsigned char *buf, size_t len[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:  unsigned char hexstr[0m[1;39m[[0m[39mLOCAL_PB_HEXMAX[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  size_t hlen = LOCAL_PB_HEXMAX;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:  bool truncated = FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mlen > [0m[1;39m([0m[39mLOCAL_PB_HEXMAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    truncated = TRUE;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:  [0m[1;35mCurl_hexencode[0m[1;39m([0m[39mbuf, len, hexstr, hlen[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!truncated[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"%s: [0m[32mlen[0m[32m=%d, [0m[32mval[0m[32m=%s"[0m[39m, prefix, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlen, hexstr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:  else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"%s: [0m[32mlen[0m[32m=%d [0m[32m([0m[32mtruncated[0m[32m)[0m[32mval[0m[32m=%s"[0m[39m, prefix, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlen, hexstr[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:  return;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m[35m/[0m[39m* called from multi.c when this DoH transfer is complete *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:static int [0m[1;35mdoh_done[0m[1;39m([0m[39mstruct Curl_easy *doh, CURLcode result[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:  struct Curl_easy *data; [0m[35m/[0m[39m* the transfer that asked for the DoH probe *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:  data = [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdoh->multi, doh->set.dohfor_mid[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:50[0m[39m-[0m[1;36m60[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#define LOCAL_PB_HEXMAX [0m[1;36m400[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#ifndef CURL_DISABLE_VERBOSE_STRINGS[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:static const char * const errors[0m[1;39m[[0m[1;39m][0m[39m=[0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  [0m[32m""[0m[39m,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  [0m[32m"Bad label"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  [0m[32m"Out of range"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  [0m[32m"Label loop"[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  [0m[32m"Too small"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  [0m[32m"Out of memory"[0m[39m,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  [0m[32m"RDATA length"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:400[0m[39m-[0m[1;36m440[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m: * [0m[1;35mCurl_doh[0m[1;39m([0m[1;39m)[0m[39m resolves a name using DoH. It resolves a name and returns a[0m       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m: * [0m[32m'Curl_addrinfo *'[0m[39m with the address information.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                               int *waitp[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:  struct doh_probes *dohp;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:  struct connectdata *conn = data->conn;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:  [0m[35m/[0m[39m* for now, this is only used when ECH is enabled *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:# ifdef USE_ECH[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:  char *qname = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:# endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:  *waitp = FALSE;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mhostname;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mport;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->req.doh[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:  [0m[1;35mfor[0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < DOH_SLOT_COUNT; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    dohp->probe[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:  conn->bits.doh = TRUE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:  dohp->host = hostname;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:  dohp->port = port;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:  dohp->req_hds =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[1;35mcurl_slist_append[0m[1;39m([0m[39mNULL,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:                      [0m[32m"Content-Type: application/dns-message"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1250[0m[39m-[0m[1;36m1350[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1250[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mlhrr->alpns[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1251[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mlhrr[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1252[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1253[0m[39m:  return CURLE_OUT_OF_MEMORY;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1254[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1255[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1256[0m[39m:# ifdef DEBUGBUILD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1257[0m[39m:static void [0m[1;35mdoh_print_httpsrr[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1258[0m[39m:                              struct Curl_https_rrinfo *hrr[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1259[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1260[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mhrr[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1261[0m[39m:  [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: priority %d, target: %s"[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1262[0m[39m:        hrr->priority, hrr->target[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1263[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhrr->alpns[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1264[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: alpns %s"[0m[39m, hrr->alpns[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1265[0m[39m:  else[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1266[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no alpns"[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1267[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhrr->no_def_alpn[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1268[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no_def_alpn set"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1269[0m[39m:  else[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1270[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no_def_alpn not set"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1271[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhrr->ipv4hints[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1272[0m[39m:    [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: ipv4hints"[0m[39m,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1273[0m[39m:                  hrr->ipv4hints, hrr->ipv4hints_len[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:  else[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no ipv4hints"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1277[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhrr->echconfiglist[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1278[0m[39m:    [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: ECHConfigList"[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1279[0m[39m:                  hrr->echconfiglist, hrr->echconfiglist_len[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1280[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1281[0m[39m:  else[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1282[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no ECHConfigList"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1283[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mhrr->ipv6hints[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:    [0m[1;35mdoh_print_buf[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: ipv6hint"[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:                  hrr->ipv6hints, hrr->ipv6hints_len[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:  else[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"HTTPS RR: no ipv6hints"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1289[0m[39m:  return;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1290[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1291[0m[39m:# endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1292[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1293[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1294:C[0m[39mURLcode [0m[1;35mCurl_doh_is_resolved[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1295[0m[39m:                              struct Curl_dns_entry **dnsp[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1296[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1297[0m[39m:  CURLcode result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1298[0m[39m:  struct doh_probes *dohp = data->req.doh;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1299[0m[39m:  *dnsp = NULL; [0m[35m/[0m[39m* defaults to no response *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1300[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1301[0m[39m:    return CURLE_OUT_OF_MEMORY;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1302[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1303[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdohp->probe[0m[1;39m[[0m[39mDOH_SLOT_IPV4[0m[1;39m][0m[39m.easy_mid < [0m[1;36m0[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1304[0m[39m:     dohp->probe[0m[1;39m[[0m[39mDOH_SLOT_IPV6[0m[1;39m][0m[39m.easy_mid < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1305[0m[39m:    [0m[1;35mfailf[0m[1;39m([0m[39mdata, [0m[32m"Could not DoH-resolve: %s"[0m[39m, data->state.async.hostname[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m1306[0m[39m:    return [0m[1;35mCONN_IS_PROXIED[0m[1;39m([0m[39mdata->conn[0m[1;39m)[0m[39m ? CURLE_COULDNT_RESOLVE_PROXY :[0m         [2m                [0m
[2;36m                    [0m         [1;36m1307[0m[39m:      CURLE_COULDNT_RESOLVE_HOST;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1308[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1309[0m[39m:  else [0m[1;35mif[0m[1;39m([0m[39m!dohp->pending[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1310[0m[39m:    DOHcode rc[0m[1;39m[[0m[39mDOH_SLOT_COUNT[0m[1;39m][0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1311[0m[39m:    struct dohentry de;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1312[0m[39m:    int slot;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1313[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1314[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mrc, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrc[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1315[0m[39m:    [0m[35m/[0m[39m* remove DoH handles from multi handle and close them *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1316[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1317[0m[39m:    [0m[35m/[0m[39m* parse the responses, create the struct and return it! *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1318[0m[39m:    [0m[1;35mde_init[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1319[0m[39m:    [0m[1;35mfor[0m[1;39m([0m[39mslot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1320[0m[39m:      struct doh_probe *p = &dohp->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1321[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39m!p->dnstype[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1322[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1323[0m[39m:      rc[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m = [0m[1;35mdoh_resp_decode[0m[1;39m([0m[1;35mCurl_dyn_uptr[0m[1;39m([0m[39m&p->resp_body[0m[1;39m)[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1324[0m[39m:                                 [0m[1;35mCurl_dyn_len[0m[1;39m([0m[39m&p->resp_body[0m[1;39m)[0m[39m,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1325[0m[39m:                                 p->dnstype, &de[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:      [0m[1;35mCurl_dyn_free[0m[1;39m([0m[39m&p->resp_body[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:#ifndef CURL_DISABLE_VERBOSE_STRINGS[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mrc[0m[1;39m[[0m[39mslot[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"DoH: %s type %s for %s"[0m[39m, [0m[1;35mdoh_strerror[0m[1;39m([0m[39mrc[0m[1;39m[[0m[39mslot[0m[1;39m][0m[1;39m)[0m[39m,[0m          [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:              [0m[1;35mdoh_type2name[0m[1;39m([0m[39mp->dnstype[0m[1;39m)[0m[39m, dohp->host[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:    [0m[1;39m}[0m[39m [0m[35m/[0m[39m* next slot *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:    result = CURLE_COULDNT_RESOLVE_HOST; [0m[35m/[0m[39m* until we know better *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m!rc[0m[1;39m[[0m[39mDOH_SLOT_IPV4[0m[1;39m][0m[39m || !rc[0m[1;39m[[0m[39mDOH_SLOT_IPV6[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:      [0m[35m/[0m[39m* we have an address, of one kind or other *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:      struct Curl_dns_entry *dns;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:      struct Curl_addrinfo *ai;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mCurl_trc_ft_is_verbose[0m[1;39m([0m[39mdata, &Curl_doh_trc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"[0m[32m[[0m[32mDoH[0m[32m][0m[32m hostname: %s"[0m[39m, dohp->host[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        [0m[1;35mdoh_show[0m[1;39m([0m[39mdata, &de[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:      result = [0m[1;35mdoh2ai[0m[1;39m([0m[39m&de, dohp->host, dohp->port, &ai[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:        [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1431[0m[39m-[0m[1;36m1440[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:    [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:    data->req.doh->req_hds = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:100[0m[39m-[0m[1;36m110[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:123[0m[39m-[0m[1;36m128[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:  [0m[35m/[0m[39m* Can no longer [0m[1;35mmemset[0m[1;39m([0m[1;39m)[0m[39m this struct as we need to keep some state *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 10:56:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=799525;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=833444;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 10:59:44][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=883226;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=755581;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 11:03:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=312277;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=425089;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=352101;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=665115;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:03:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=932956;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=406775;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 11:03:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=990786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=889965;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp9kc8q0vf[0m                                                 ]8;id=721038;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=816059;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 11:04:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m100.01[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=724571;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=876762;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=101150;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445805;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:05:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m12.84[0m seconds;                ]8;id=139276;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=71880;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=94379;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=153096;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:05:03][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=900938;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=937117;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m4216351726[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28145[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f0238[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a073f7029[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28145[0m PCs[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f7030[0m,[1;36m0x561a07464f40[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a0716dd0f[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffddb6026a0[0m sp [1;36m0x7ffddb602620[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a0716dd0f[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m                [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a07032911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a07004df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a0700ca81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a0700a035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a06fb8ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a06fb60ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a06e6a6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a06e55915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a06e5b3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a06e86652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f1f0d6e0082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x561a06e4dafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_cleanup--Curl_req_done--multi_done                             [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m in Curl_doh_cleanup      [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpusw7mt8n[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=152619;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=508324;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m4216351726[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28145[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f0238[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a073f7029[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28145[0m PCs[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f7030[0m,[1;36m0x561a07464f40[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a0716dd0f[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffddb6026a0[0m sp [1;36m0x7ffddb602620[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a0716dd0f[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m                [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a07032911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a07004df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a0700ca81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a0700a035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a06fb8ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a06fb60ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a06e6a6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a06e55915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a06e5b3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a06e86652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f1f0d6e0082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x561a06e4dafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_cleanup--Curl_req_done--multi_done                             [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m in Curl_doh_cleanup      [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpusw7mt8n[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m4216351726[0m                                                               [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28145[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f0238[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a073f7029[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28145[0m PCs[1m)[0m: [1;36m28145[0m [1m[[0m[1;36m0x561a073f7030[0m,[1;36m0x561a07464f40[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a0716dd0f[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffddb6026a0[0m sp [1;36m0x7ffddb602620[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a0716dd0f[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m                [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a07032911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a07004df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a0700ca81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a0700a035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a06fb8ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a06fb60ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a06e6a6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a06e55915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a06e5b3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char   [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a06e86652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x7f1f0d6e0082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x561a06e4dafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_cleanup--Curl_req_done--multi_done                             [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1437:11[0m in Curl_doh_cleanup      [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpusw7mt8n[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.55[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=567;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=820168;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=107233;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=33531;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:05:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=95664;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=581164;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 11:05:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=586053;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=511807;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:05:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=677354;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=324668;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=950285;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=80777;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         +++ b/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-1431[0m,[1;36m12[0m +[1;36m1431[0m,[1;36m15[0m @@                                                             [2m                [0m
[2;36m                    [0m          void [1;35mCurl_doh_cleanup[0m[1m([0mstruct Curl_easy *data[1m)[0m                                      [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m            struct doh_probes *doh = data->req.doh;                                          [2m                [0m
[2;36m                    [0m         -  [1;35mif[0m[1m([0mdoh[1m)[0m [1m{[0m                                                                        [2m                [0m
[2;36m                    [0m         +  [1;35mif[0m[1m([0m!doh[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m         +    return;                                                                        [2m                [0m
[2;36m                    [0m         +  [35m/[0m* Only close active probes if any are pending *[35m/[0m                                [2m                [0m
[2;36m                    [0m         +  [1;35mif[0m[1m([0mdoh->pending && data->multi[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m              [1;35mCurl_doh_close[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         -    [1;35mcurl_slist_free_all[0m[1m([0mdoh->req_hds[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -    data->req.doh->req_hds = NULL;                                                 [2m                [0m
[2;36m                    [0m         -    [1;35mCurl_safefree[0m[1m([0mdata->req.doh[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         -  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m         +  [1;35mcurl_slist_free_all[0m[1m([0mdoh->req_hds[1m)[0m;                                               [2m                [0m
[2;36m                    [0m         +  doh->req_hds = NULL;                                                             [2m                [0m
[2;36m                    [0m         +  [1;35mCurl_safefree[0m[1m([0mdata->req.doh[1m)[0m;                                                    [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          #endif [35m/[0m* CURL_DISABLE_DOH *[35m/[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         +++ b/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-103[0m,[1;36m10[0m +[1;36m103[0m,[1;36m11[0m @@                                                               [2m                [0m
[2;36m                    [0m            [1m([0mvoid[1m)[0mreq;                                                                       [2m                [0m
[2;36m                    [0m            [1;35mif[0m[1m([0m!aborted[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m              [1m([0mvoid[1m)[0m[1;35mreq_flush[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m         +#ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         +  [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         +#endif                                                                             [2m                [0m
[2;36m                    [0m            [1;35mCurl_client_reset[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m         -#ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         -  [1;35mCurl_doh_close[0m[1m([0mdata[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         -#endif                                                                             [2m                [0m
[2;36m                    [0m         +  data->req.doh = NULL;                                                            [2m                [0m
[2;36m                    [0m            return CURLE_OK;                                                                 [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4216351726[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28145[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28145[0m[39m [0m[1;39m[[0m[1;36m0x561a073f0238[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561a073f7029[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28145[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28145[0m[39m [0m[1;39m[[0m[1;36m0x561a073f7030[0m[39m,[0m[1;36m0x561a07464f40[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561a0716dd0f[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffddb6026a0[0m[39m sp [0m[1;36m0x7ffddb602620[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561a0716dd0f[0m[39m in Curl_doh_cleanup [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1437:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561a07032911[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m107:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561a07004df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561a0700ca81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561a0700a035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561a06fb8ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561a06fb60ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561a06e6a6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561a06e55915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561a06e5b3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561a06e86652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f1f0d6e0082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561a06e4dafd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_cleanup--Curl_req_done--multi_done[0m                            [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1437:11[0m[39m in Curl_doh_cleanup[0m     [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpusw7mt8n[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mA libcurl-based fuzzer [0m[1;39m([0m[39m`curl_fuzzer_http`[0m[1;39m)[0m[39m consistently crashes with a [0m            [2m                [0m
[2;36m                    [0m         [39msegmentation fault in `Curl_doh_close` when running a simple input [0m[1;36m100[0m[39m times. The [0m  [2m                [0m
[2;36m                    [0m         [39minitial issue log shows an AddressSanitizer report pointing to a wild read in [0m      [2m                [0m
[2;36m                    [0m         [39m`doh.[0m[1;92mc:1410[0m[39m`. To work around this, a patch replaced calls to `[0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mwith `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` in two spots within `lib/request.c`. After rebuilding[0m [2m                [0m
[2;36m                    [0m         [39mand re-running the fuzzer, the crash still occurs in `Curl_doh_close`, now being [0m   [2m                [0m
[2;36m                    [0m         [39minvoked from within `Curl_doh_cleanup`, indicating the patch did not prevent the [0m   [2m                [0m
[2;36m                    [0m         [39mfaulty dereference.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description  [0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Initial Issue  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer runs `curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m` under AddressSanitizer.[0m [2m                [0m
[2;36m                    [0m         [39m   - It triggers a SEGV on a high memory address during a read, labeled [0m            [2m                [0m
[2;36m                    [0m         [39m“wild-addr-read.”  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Stack trace frames:  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;36m1[0m[39m. `Curl_doh_close` at `lib/doh.[0m[1;92mc:1410:30[0m[39m`  [0m                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;36m2[0m[39m. `Curl_req_done` in `lib/request.[0m[1;92mc:108[0m[39m`  [0m                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;36m3[0m[39m. Then through `multi_done`, `multi_runsingle`, `curl_multi_perform`, into [0m   [2m                [0m
[2;36m                    [0m         [39mthe fuzzer harness.  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Summary message:  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     ERROR: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m    [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer harness itself simply calls the multi interface, so focus lies in [0m  [2m                [0m
[2;36m                    [0m         [39mthe doh module and request teardown logic.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Attempt  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - Two call sites in `lib/request.c` were modified:  [0m                             [2m                [0m
[2;36m                    [0m         [39m     ```diff[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     --- a/lib/request.c[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     +++ b/lib/request.c[0m                                                            [2m                [0m
[2;36m                    [0m         [39m      [0m[33m...[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      #ifndef CURL_DISABLE_DOH[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     -  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     +  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      #endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m      [0m[33m...[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      #ifndef CURL_DISABLE_DOH[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     -  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     +  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m      #endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Intended to replace the direct close with a cleanup wrapper, presumably to [0m    [2m                [0m
[2;36m                    [0m         [39malter the order or scope of resource teardown.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Result After Patch  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Rebuilding and fuzzing again immediately reproduces a SEGV in the same code [0m   [2m                [0m
[2;36m                    [0m         [39marea:  [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     #[0m[1;36m0[0m[39m  Curl_doh_close at lib/doh.[0m[1;92mc:1410:30[0m                                        [2m                [0m
[2;36m                    [0m         [39m     #[0m[1;36m1[0m[39m  Curl_doh_cleanup at lib/doh.[0m[1;92mc:1435:5[0m                                       [2m                [0m
[2;36m                    [0m         [39m     #[0m[1;36m2[0m[39m  Curl_req_done at lib/request.[0m[1;92mc:108:3[0m                                       [2m                [0m
[2;36m                    [0m         [39m     [0m[33m...[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     SUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m  [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - The crash still originates in `Curl_doh_close`, now called from inside [0m        [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_cleanup`, indicating that the faulty code path remains active.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Areas for Further Investigation  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - **lib/doh.c around line [0m[1;36m1410[0m[39m**: inspect what data structures or pointers [0m      [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_close` dereferences, and their initialization state.  [0m                    [2m                [0m
[2;36m                    [0m         [39m   - **Curl_doh_cleanup implementation**: understand how it calls into [0m             [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_close` and whether it exercises additional code paths that leave pointers[0m [2m                [0m
[2;36m                    [0m         [39minvalid.  [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - **Request teardown in lib/request.c**: confirm the lifecycle of the `data` [0m    [2m                [0m
[2;36m                    [0m         [39mobject, particularly the state of the DOH [0m[1;39m([0m[39mDNS-over-HTTPS[0m[1;39m)[0m[39m structures at the two [0m   [2m                [0m
[2;36m                    [0m         [39mpatched call sites.  [0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - **Multi interface flow** [0m[1;39m([0m[39m`multi_done`, `multi_runsingle`[0m[1;39m)[0m[39m: verify no double [0m  [2m                [0m
[2;36m                    [0m         [39mteardown or missing initialization that could lead to uninitialized pointers being [0m [2m                [0m
[2;36m                    [0m         [39mcleaned up.  [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - **Fuzzer harness initialization**: though not root cause, ensure that any [0m     [2m                [0m
[2;36m                    [0m         [39msetup of CURL handles or DOH configurations isn’t leaving data in an unexpected [0m    [2m                [0m
[2;36m                    [0m         [39mstate when teardown routines run.  [0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo root-cause analysis or fixes are offered here; this report documents the [0m        [2m                [0m
[2;36m                    [0m         [39mobserved behavior before and after the patch and identifies code areas that should [0m [2m                [0m
[2;36m                    [0m         [39mbe examined next to gain a complete understanding of the fault.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3670103254[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d02304b218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d023052004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x55d023052008[0m[39m,[0m[1;36m0x55d0230bfec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x55d022dca6fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffdcab6d4e0[0m[39m sp [0m[1;36m0x7ffdcab6d380[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d022dca6fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d022dc8ccb[0m[39m in Curl_doh_cleanup [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1435:5[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d022c8d91a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d022c5fdf4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d022c67a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d022c65035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d022c13ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d022c110ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d022ac56a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d022ab0915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d022ab63af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d022ae1652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7fd8c3a41082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d022aa8afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done[0m                        [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpka7xxy1y[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1370[0m[39m-[0m[1;36m1442[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:    [0m[1;39m}[0m[39m [0m[35m/[0m[39m* address processing done *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:    [0m[35m/[0m[39m* Now process any build-specific attributes retrieved from DNS *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:#ifdef USE_HTTPSRR[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mde.numhttps_rrs > [0m[1;36m0[0m[39m && result == CURLE_OK && *dnsp[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:      struct Curl_https_rrinfo *hrr = NULL;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:      result = [0m[1;35mdoh_resp_decode_httpsrr[0m[1;39m([0m[39mde.https_rrs->val, de.https_rrs->len,[0m   [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:                                       &hrr[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:        [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Failed to decode HTTPS RR"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:      [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Some HTTPS RR to process"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:# ifdef DEBUGBUILD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:      [0m[1;35mdoh_print_httpsrr[0m[1;39m([0m[39mdata, hrr[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:# endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:      [0m[1;39m([0m[39m*dnsp[0m[1;39m)[0m[39m->hinfo = hrr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:    [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:    return result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1396[0m[39m:  [0m[1;39m}[0m[39m [0m[35m/[0m[39m* !dohp->pending *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1397[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1398[0m[39m:  [0m[35m/[0m[39m* else wait for pending DoH transactions to complete *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1399[0m[39m:  return CURLE_OK;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1401[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1402[0m[39m:void [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1403[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1404[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1405[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh && data->multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1406[0m[39m:    struct Curl_easy *probe_data;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1407[0m[39m:    curl_off_t mid;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1408[0m[39m:    size_t slot;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1409[0m[39m:    [0m[1;35mfor[0m[1;39m([0m[39mslot = [0m[1;36m0[0m[39m; slot < DOH_SLOT_COUNT; slot++[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m:      mid = doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1411[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mmid < [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1412[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1413[0m[39m:      doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1414[0m[39m:      [0m[35m/[0m[39m* should have been called before data is removed from multi handle *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1415[0m[39m:      [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata->multi[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1416[0m[39m:      probe_data = data->multi ? [0m[1;35mCurl_multi_get_handle[0m[1;39m([0m[39mdata->multi, mid[0m[1;39m)[0m[39m :[0m     [2m                [0m
[2;36m                    [0m         [1;36m1417[0m[39m:        NULL;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1418[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39m!probe_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1419[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_doh_close: xfer for [0m[32mmid[0m[32m=%"[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:                     FMT_OFF_T [0m[32m" not found!"[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1421[0m[39m:                     doh->probe[0m[1;39m[[0m[39mslot[0m[1;39m][0m[39m.easy_mid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:        continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:      [0m[35m/[0m[39m* data->multi might already be reset at this time *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m:      [0m[1;35mcurl_multi_remove_handle[0m[1;39m([0m[39mdata->multi, probe_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m:      [0m[1;35mCurl_close[0m[1;39m([0m[39m&probe_data[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1428[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1429[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:    [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:    data->req.doh->req_hds = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:#endif [0m[35m/[0m[39m* CURL_DISABLE_DOH *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:400[0m[39m-[0m[1;36m450[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m: * [0m[1;35mCurl_doh[0m[1;39m([0m[1;39m)[0m[39m resolves a name using DoH. It resolves a name and returns a[0m       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m: * [0m[32m'Curl_addrinfo *'[0m[39m with the address information.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                               int *waitp[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:  struct doh_probes *dohp;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:  struct connectdata *conn = data->conn;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:#ifdef USE_HTTPSRR[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:  [0m[35m/[0m[39m* for now, this is only used when ECH is enabled *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:# ifdef USE_ECH[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:  char *qname = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:# endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:  *waitp = FALSE;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mhostname;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mport;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->req.doh[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:  [0m[1;35mfor[0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < DOH_SLOT_COUNT; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    dohp->probe[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:  conn->bits.doh = TRUE;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:  dohp->host = hostname;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:  dohp->port = port;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:  dohp->req_hds =[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[1;35mcurl_slist_append[0m[1;39m([0m[39mNULL,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:                      [0m[32m"Content-Type: application/dns-message"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp->req_hds[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    goto error;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:  [0m[35m/[0m[39m* create IPv4 DoH request *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:  result = [0m[1;35mdoh_run_probe[0m[1;39m([0m[39mdata, &dohp->probe[0m[1;39m[[0m[39mDOH_SLOT_IPV4[0m[1;39m][0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                         DNS_TYPE_A, hostname, data->set.str[0m[1;39m[[0m[39mSTRING_DOH[0m[1;39m][0m[39m,[0m       [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                         data->multi, dohp->req_hds[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:    goto error;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:  dohp->pending++;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1431[0m[39m-[0m[1;36m1440[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:  struct doh_probes *doh = data->req.doh;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdoh[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:    [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:    [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:    data->req.doh->req_hds = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:    [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:100[0m[39m-[0m[1;36m110[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/easy.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"curl_setup.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#ifdef HAVE_NETINET_IN_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <netinet/in.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#ifdef HAVE_NETDB_H[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include <netdb.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifdef HAVE_ARPA_INET_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include <arpa/inet.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#ifdef HAVE_NET_IF_H[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include <net/if.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#ifdef HAVE_SYS_IOCTL_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include <sys/ioctl.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#ifdef HAVE_SYS_PARAM_H[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#include <sys/param.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#include <curl/curl.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#include [0m[32m"transfer.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#include [0m[32m"vtls/vtls.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"url.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"getinfo.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"hostip.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"share.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"strdup.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"progress.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"easyif.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"multiif.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"select.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"cfilters.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"sendf.h"[0m[39m [0m[35m/[0m[39m* for failf function prototype *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"connect.h"[0m[39m [0m[35m/[0m[39m* for Curl_getconnectinfo *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"slist.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"mime.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"amigaos.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"macos.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"warnless.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"sigpipe.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"vssh/ssh.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:#include [0m[32m"setopt.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#include [0m[32m"http_digest.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:#include [0m[32m"system_win32.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#include [0m[32m"http2.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:#include [0m[32m"dynbuf.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:#include [0m[32m"altsvc.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:#include [0m[32m"hsts.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:#include [0m[32m"easy_lock.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m[35m/[0m[39m* The last [0m[1;36m3[0m[39m #include files should be in this order *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:#include [0m[32m"curl_printf.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:#include [0m[32m"curl_memory.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:#include [0m[32m"memdebug.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m[35m/[0m[39m* true globals -- for [0m[1;35mcurl_global_init[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mcurl_global_cleanup[0m[1;39m([0m[1;39m)[0m[39m *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:static unsigned int  initialized;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:static long          easy_init_flags;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:#ifdef GLOBAL_INIT_IS_THREADSAFE[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:static curl_simple_lock s_lock = CURL_SIMPLE_LOCK_INIT;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:#define [0m[1;35mglobal_init_lock[0m[1;39m([0m[1;39m)[0m[39m [0m[1;35mcurl_simple_lock_lock[0m[1;39m([0m[39m&s_lock[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:#define [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m [0m[1;35mcurl_simple_lock_unlock[0m[1;39m([0m[39m&s_lock[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define [0m[1;35mglobal_init_lock[0m[1;39m([0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m: * strdup [0m[1;39m([0m[39mand other memory functions[0m[1;39m)[0m[39m is redefined in complicated[0m              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m: * ways, but at this point it must be defined as the system-supplied strdup[0m     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m: * so the callback pointer is initialized correctly.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39m_WIN32_WCE[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:#define system_strdup _strdup[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#elif ![0m[1;35mdefined[0m[1;39m([0m[39mHAVE_STRDUP[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:#define system_strdup Curl_strdup[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:#define system_strdup strdup[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39m_MSC_VER[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39m_DLL[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:#  pragma [0m[1;35mwarning[0m[1;39m([0m[39mpush[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:#  pragma [0m[1;35mwarning[0m[1;39m([0m[39mdisabl[0m[1;92me:4232[0m[1;39m)[0m[39m [0m[35m/[0m[39m* MSVC extension, dllimport identity *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m: * If a memory-using function [0m[1;39m([0m[39mlike curl_getenv[0m[1;39m)[0m[39m is used before[0m                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m: * [0m[1;35mcurl_global_init[0m[1;39m([0m[1;39m)[0m[39m is called, we need to have these pointers set already.[0m    [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m124:c[0m[39murl_malloc_callback Curl_cmalloc = [0m[1;39m([0m[39mcurl_malloc_callback[0m[1;39m)[0m[39mmalloc;[0m               [2m                [0m
[2;36m                    [0m         [1;92m125:c[0m[39murl_free_callback Curl_cfree = [0m[1;39m([0m[39mcurl_free_callback[0m[1;39m)[0m[39mfree;[0m                       [2m                [0m
[2;36m                    [0m         [1;92m126:c[0m[39murl_realloc_callback Curl_crealloc = [0m[1;39m([0m[39mcurl_realloc_callback[0m[1;39m)[0m[39mrealloc;[0m           [2m                [0m
[2;36m                    [0m         [1;92m127:c[0m[39murl_strdup_callback Curl_cstrdup = [0m[1;39m([0m[39mcurl_strdup_callback[0m[1;39m)[0m[39msystem_strdup;[0m        [2m                [0m
[2;36m                    [0m         [1;92m128:c[0m[39murl_calloc_callback Curl_ccalloc = [0m[1;39m([0m[39mcurl_calloc_callback[0m[1;39m)[0m[39mcalloc;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39m_WIN32[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39mUNICODE[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;92m130:c[0m[39murl_wcsdup_callback Curl_cwcsdup = Curl_wcsdup;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39m_MSC_VER[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39m_DLL[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:#  pragma [0m[1;35mwarning[0m[1;39m([0m[39mpop[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:#ifdef DEBUGBUILD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:static char *leakpointer;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m: * [0m[1;35mcurl_global_init[0m[1;39m([0m[1;39m)[0m[39m globally initializes curl given a bitwise set of the[0m      [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m: * different features of what to initialize.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:static CURLcode [0m[1;35mglobal_init[0m[1;39m([0m[39mlong flags, bool memoryfuncs[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minitialized++[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    return CURLE_OK;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mmemoryfuncs[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[35m/[0m[39m* Setup the default memory functions here [0m[1;39m([0m[39magain[0m[1;39m)[0m[39m *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    Curl_cmalloc = [0m[1;39m([0m[39mcurl_malloc_callback[0m[1;39m)[0m[39mmalloc;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    Curl_cfree = [0m[1;39m([0m[39mcurl_free_callback[0m[1;39m)[0m[39mfree;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    Curl_crealloc = [0m[1;39m([0m[39mcurl_realloc_callback[0m[1;39m)[0m[39mrealloc;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    Curl_cstrdup = [0m[1;39m([0m[39mcurl_strdup_callback[0m[1;39m)[0m[39msystem_strdup;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    Curl_ccalloc = [0m[1;39m([0m[39mcurl_calloc_callback[0m[1;39m)[0m[39mcalloc;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39m_WIN32[0m[1;39m)[0m[39m && [0m[1;35mdefined[0m[1;39m([0m[39mUNICODE[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    Curl_cwcsdup = [0m[1;39m([0m[39mcurl_wcsdup_callback[0m[1;39m)[0m[39m_wcsdup;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_trc_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: Curl_trc_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mCurl_ssl_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: Curl_ssl_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_win32_init[0m[1;39m([0m[39mflags[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: win32_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_amiga_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: Curl_amiga_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_macos_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: Curl_macos_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_resolver_global_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: resolver_global_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_ssh_init[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35mfprintf[0m[1;39m([0m[39mstderr, [0m[32m"Error: Curl_ssh_init failed\n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    goto fail;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:  easy_init_flags = flags;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:#ifdef DEBUGBUILD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mgetenv[0m[1;39m([0m[32m"CURL_GLOBAL_INIT"[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/transfer.[0m[1;92mc:300[0m[39m-[0m[1;36m380[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata->set.max_recv_speed < [0m[1;39m([0m[39mcurl_off_t[0m[1;39m)[0m[39mbytestoread[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        bytestoread = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mdata->set.max_recv_speed;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    nread = [0m[1;35mxfer_recv_resp[0m[1;39m([0m[39mdata, buf, bytestoread, is_multiplex, &result[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mnread < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mCURLE_AGAIN != result[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        goto out; [0m[35m/[0m[39m* real error *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:      result = CURLE_OK;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mdata->req.download_done && data->req.no_body &&[0m                        [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:         !data->req.resp_trailer[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"EAGAIN, download done, no trailer announced, "[0m      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:               [0m[32m"not waiting for EOS"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        nread = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[35m/[0m[39m* continue as if we read the EOS *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:      else[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        break; [0m[35m/[0m[39m* get out of loop *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:    [0m[35m/[0m[39m* We only get a [0m[1;36m0[0m[39m-length read on EndOfStream *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:    blen = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mnread;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:    is_eos = [0m[1;39m([0m[39mblen == [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:    *didwhat |= KEEP_RECV;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39m!blen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:      [0m[35m/[0m[39m* if we receive [0m[1;36m0[0m[39m or less here, either the data transfer is done or the[0m  [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:         server closed the connection and we bail out from this! *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mis_multiplex[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"nread == 0, stream closed, bailing"[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:      else[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"nread <= 0, server closed connection, bailing"[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:      result = [0m[1;35mCurl_req_stop_send_recv[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:        goto out;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mk->eos_written[0m[1;39m)[0m[39m [0m[35m/[0m[39m* already did write this to client, leave *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:        break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    total_received += blen;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:    result = [0m[1;35mCurl_xfer_write_resp[0m[1;39m([0m[39mdata, buf, blen, is_eos[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult || data->req.done[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:      goto out;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[35m/[0m[39m* if we are done, we stop receiving. On multiplexed connections,[0m           [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:     * we should read the EOS. Which may arrive as meta data after[0m              [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:     * the bytes. Not taking it in might lead to RST of streams. *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39m!is_multiplex && data->req.download_done[0m[1;39m)[0m[39m || is_eos[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:      data->req.keepon &= ~KEEP_RECV;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:    [0m[35m/[0m[39m* if we are PAUSEd or stopped receiving, leave the loop *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mk->keepon & KEEP_RECV_PAUSE[0m[1;39m)[0m[39m || ![0m[1;39m([0m[39mk->keepon & KEEP_RECV[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:      break;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:  [0m[1;39m}[0m[39m [0m[1;35mwhile[0m[1;39m([0m[39mmaxloops--[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mmaxloops <= [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;35mdata_pending[0m[1;39m([0m[39mdata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:    [0m[35m/[0m[39m* did not read until EAGAIN or there is still pending data, mark as[0m        [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:       read-again-please *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    data->state.select_bits = CURL_CSELECT_IN;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    [0m[1;35mif[0m[1;39m([0m[1;39m([0m[39mk->keepon & KEEP_SENDBITS[0m[1;39m)[0m[39m == KEEP_SEND[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:      data->state.select_bits |= CURL_CSELECT_OUT;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;39m([0m[1;39m([0m[39mk->keepon & [0m[1;39m([0m[39mKEEP_RECV|KEEP_SEND[0m[1;39m)[0m[1;39m)[0m[39m == KEEP_SEND[0m[1;39m)[0m[39m &&[0m                      [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:     [0m[1;39m([0m[39mconn->bits.close || is_multiplex[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:    [0m[35m/[0m[39m* When we have read the entire thing and the close bit is set, the server[0m  [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:       may now close the connection. If there is now any kind of sending going[0m  [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:       on from our side, we need to stop that immediately. *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:    [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"we are done reading and this is set to close, stop send"[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    [0m[1;35mCurl_req_abort_sending[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:out:[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:  [0m[1;35mCurl_multi_xfer_buf_release[0m[1;39m([0m[39mdata, xfer_buf[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"sendrecv_dl[0m[32m([0m[32m)[0m[32m -> %d"[0m[39m, result[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.h:[0m[1;36m1[0m[39m-[0m[1;36m120[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#ifndef [0m[1;33mHEAD[0m[39mER_CURL_DOH_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#define [0m[1;33mHEAD[0m[39mER_CURL_DOH_H[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"urldata.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"curl_addrinfo.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#ifdef USE_HTTPSRR[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:# include <stdint.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:  DOH_OK,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:  DOH_DNS_BAD_LABEL,    [0m[35m/[0m[39m* [0m[1;36m1[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  DOH_DNS_OUT_OF_RANGE, [0m[35m/[0m[39m* [0m[1;36m2[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  DOH_DNS_LABEL_LOOP,   [0m[35m/[0m[39m* [0m[1;36m3[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  DOH_TOO_SMALL_BUFFER, [0m[35m/[0m[39m* [0m[1;36m4[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  DOH_OUT_OF_MEM,       [0m[35m/[0m[39m* [0m[1;36m5[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  DOH_DNS_RDATA_LEN,    [0m[35m/[0m[39m* [0m[1;36m6[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  DOH_DNS_MALFORMAT,    [0m[35m/[0m[39m* [0m[1;36m7[0m[39m *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  DOH_DNS_BAD_RCODE,    [0m[35m/[0m[39m* [0m[1;36m8[0m[39m - no such name *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  DOH_DNS_UNEXPECTED_TYPE,  [0m[35m/[0m[39m* [0m[1;36m9[0m[39m *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  DOH_DNS_UNEXPECTED_CLASS, [0m[35m/[0m[39m* [0m[1;36m10[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  DOH_NO_CONTENT,           [0m[35m/[0m[39m* [0m[1;36m11[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  DOH_DNS_BAD_ID,           [0m[35m/[0m[39m* [0m[1;36m12[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  DOH_DNS_NAME_TOO_LONG     [0m[35m/[0m[39m* [0m[1;36m13[0m[39m *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m}[0m[39m DOHcode;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:  DNS_TYPE_A = [0m[1;36m1[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:  DNS_TYPE_NS = [0m[1;36m2[0m[39m,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  DNS_TYPE_CNAME = [0m[1;36m5[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  DNS_TYPE_AAAA = [0m[1;36m28[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  DNS_TYPE_DNAME = [0m[1;36m39[0m[39m,           [0m[35m/[0m[39m* RFC6672 *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  DNS_TYPE_HTTPS = [0m[1;36m65[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m[1;39m}[0m[39m DNStype;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m[35m/[0m[39m* one of these for each DoH request *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct doh_probe [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  curl_off_t easy_mid; [0m[35m/[0m[39m* multi id of easy handle doing the lookup *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  DNStype dnstype;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  unsigned char req_body[0m[1;39m[[0m[1;36m512[0m[1;39m][0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  size_t req_body_len;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  struct dynbuf resp_body;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m70:e[0m[39mnum doh_slot_num [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[35m/[0m[39m* Explicit values for first two symbols so as to match hard-coded[0m             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:   * constants in existing code[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:   *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  DOH_SLOT_IPV4 = [0m[1;36m0[0m[39m, [0m[35m/[0m[39m* make [0m[32m'V4'[0m[39m stand out for readability *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  DOH_SLOT_IPV6 = [0m[1;36m1[0m[39m, [0m[35m/[0m[39m* [0m[32m'V6'[0m[39m likewise *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  [0m[35m/[0m[39m* Space here for [0m[1;39m([0m[39mpossibly build-specific[0m[1;39m)[0m[39m additional slot definitions *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:#ifdef USE_HTTPSRR[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  DOH_SLOT_HTTPS_RR = [0m[1;36m2[0m[39m,     [0m[35m/[0m[39m* for HTTPS RR *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  [0m[35m/[0m[39m* for example *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  [0m[35m/[0m[39m* #ifdef WANT_DOH_FOOBAR_TXT *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:  [0m[35m/[0m[39m*   DOH_PROBE_SLOT_FOOBAR_TXT, *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  [0m[35m/[0m[39m* #endif *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  [0m[35m/[0m[39m* AFTER all slot definitions, establish how many we have *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  DOH_SLOT_COUNT[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:struct doh_probes [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  struct curl_slist *req_hds;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  struct doh_probe probe[0m[1;39m[[0m[39mDOH_SLOT_COUNT[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  unsigned int pending; [0m[35m/[0m[39m* still outstanding probes *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  int port;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  const char *host;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[35m/[0m[39m*[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * [0m[1;35mCurl_doh[0m[1;39m([0m[1;39m)[0m[39m resolve a name using DoH [0m[1;39m([0m[39mDNS-over-HTTPS[0m[1;39m)[0m[39m. It resolves a name[0m     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m: * and returns a [0m[32m'Curl_addrinfo *'[0m[39m with the address information.[0m                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:struct Curl_addrinfo *[0m[1;35mCurl_doh[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                               const char *hostname,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                               int port,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                               int *waitp[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m109:C[0m[39mURLcode [0m[1;35mCurl_doh_is_resolved[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                              struct Curl_dns_entry **dns[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:#define DOH_MAX_ADDR [0m[1;36m24[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:#define DOH_MAX_CNAME [0m[1;36m4[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:#define DOH_MAX_HTTPS [0m[1;36m4[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:struct dohaddr [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  int type;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  union [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    unsigned char v4[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m; [0m[35m/[0m[39m* network byte order *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    unsigned char v6[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/easyif.h:[0m[1;36m1[0m[39m-[0m[1;36m41[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#ifndef [0m[1;33mHEAD[0m[39mER_CURL_EASYIF_H[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#define [0m[1;33mHEAD[0m[39mER_CURL_EASYIF_H[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m[35m/[0m[39m***************************************************************************[0m      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *                                  _   _ ____  _[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: *  Project                     ___| | | |  _ \| |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: *                             [0m[35m/[0m[39m __| | | | |_[0m[1;39m)[0m[39m | |[0m                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: *                            | [0m[1;39m([0m[39m__| |_| |  _ <| |___[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *                             \___|\___/|_| \_\_____|[0m                            [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * Copyright [0m[1;39m([0m[39mC[0m[1;39m)[0m[39m Daniel Stenberg, <daniel@haxx.se>, et al.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * This software is licensed as described in the file COPYING, which[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * you should have received as part of this distribution. The terms[0m              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * are also available at [0m[4;94mhttps://curl.se/docs/copyright.html.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * You may opt to use, copy, modify, merge, publish, distribute and/or sell[0m      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * copies of the Software, and permit persons to whom the Software is[0m            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * furnished to do so, under the terms of the COPYING file.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m: * This software is distributed on an [0m[32m"AS IS"[0m[39m basis, WITHOUT WARRANTY OF ANY[0m     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * KIND, either express or implied.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * SPDX-License-Identifier: curl[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: ***************************************************************************[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m*[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * Prototypes for library-wide functions provided by easy.c[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m30:C[0m[39mURLcode [0m[1;35mCurl_senddata[0m[1;39m([0m[39mstruct Curl_easy *data, const void *buffer,[0m               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                       size_t buflen, size_t *n[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifndef CURL_DISABLE_WEBSOCKETS[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m34:C[0m[39mURLcode [0m[1;35mCurl_connect_only_attach[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#ifdef DEBUGBUILD[0m                                                                [2m                [0m
[2;36m                    [0m         [1;92m38:C[0m[39mURL_EXTERN CURLcode [0m[1;35mcurl_easy_perform_ev[0m[1;39m([0m[39mstruct Curl_easy *easy[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#endif [0m[35m/[0m[39m* [0m[1;33mHEAD[0m[39mER_CURL_EASYIF_H *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/easy.[0m[1;92mc:200[0m[39m-[0m[1;36m300[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mgetenv[0m[1;39m([0m[32m"CURL_GLOBAL_INIT"[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[35m/[0m[39m* alloc data that will leak if *[0m[1;35mcleanup[0m[1;39m([0m[1;39m)[0m[39m is not called! *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    leakpointer = [0m[1;35mmalloc[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m207:fa[0m[39mil:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:  initialized--; [0m[35m/[0m[39m* undo the increase *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:  return CURLE_FAILED_INIT;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m: * [0m[1;35mcurl_global_init[0m[1;39m([0m[1;39m)[0m[39m globally initializes curl given a bitwise set of the[0m      [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m: * different features of what to initialize.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m217:C[0m[39mURLcode [0m[1;35mcurl_global_init[0m[1;39m([0m[39mlong flags[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:  CURLcode result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:  [0m[1;35mglobal_init_lock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:  result = [0m[1;35mglobal_init[0m[1;39m([0m[39mflags, TRUE[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:  [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m: * [0m[1;35mcurl_global_init_mem[0m[1;39m([0m[1;39m)[0m[39m globally initializes curl and also registers the[0m      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m: * user provided callback routines.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m233:C[0m[39mURLcode [0m[1;35mcurl_global_init_mem[0m[1;39m([0m[39mlong flags, curl_malloc_callback m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                              curl_free_callback f, curl_realloc_callback r,[0m    [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                              curl_strdup_callback s, curl_calloc_callback c[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:  CURLcode result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:  [0m[35m/[0m[39m* Invalid input, return immediately *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!m || !f || !r || !s || !c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    return CURLE_FAILED_INIT;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:  [0m[1;35mglobal_init_lock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39minitialized[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[35m/[0m[39m* Already initialized, do not do it again, but bump the variable anyway to[0m [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:       work like [0m[1;35mcurl_global_init[0m[1;39m([0m[1;39m)[0m[39m and require the same amount of cleanup[0m      [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:       calls. *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    initialized++;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    return CURLE_OK;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:  [0m[35m/[0m[39m* set memory functions before [0m[1;35mglobal_init[0m[1;39m([0m[1;39m)[0m[39m in case it wants memory[0m          [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:     functions *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:  Curl_cmalloc = m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:  Curl_cfree = f;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:  Curl_cstrdup = s;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:  Curl_crealloc = r;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:  Curl_ccalloc = c;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:  [0m[35m/[0m[39m* Call the actual init function, but without setting *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:  result = [0m[1;35mglobal_init[0m[1;39m([0m[39mflags, FALSE[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:  [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m[35m/[0m[39m**[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m: * [0m[1;35mcurl_global_cleanup[0m[1;39m([0m[1;39m)[0m[39m globally cleanups curl, uses the value of[0m              [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m: * [0m[32m"easy_init_flags"[0m[39m to determine what needs to be cleaned up and what does[0m     [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m: * not.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:void [0m[1;35mcurl_global_cleanup[0m[1;39m([0m[39mvoid[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:  [0m[1;35mglobal_init_lock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!initialized[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m--initialized[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;35mglobal_init_unlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:  [0m[1;35mCurl_ssl_cleanup[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:  [0m[1;35mCurl_resolver_global_cleanup[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:#ifdef _WIN32[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:  [0m[1;35mCurl_win32_cleanup[0m[1;39m([0m[39measy_init_flags[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:  [0m[1;35mCurl_amiga_cleanup[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:  [0m[1;35mCurl_ssh_cleanup[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:#ifdef DEBUGBUILD[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:240[0m[39m-[0m[1;36m340[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:#define [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mx,y[0m[1;39m)[0m[39m                         \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:  do [0m[1;39m{[0m[39m                                                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    result = [0m[1;35mcurl_easy_setopt[0m[1;39m([0m[1;39m([0m[39mCURL *[0m[1;39m)[0m[39mdoh, x, y[0m[1;39m)[0m[39m;       \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mresult &&                                        \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:       result != CURLE_NOT_BUILT_IN &&                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:       result != CURLE_UNKNOWN_OPTION[0m[1;39m)[0m[39m                  \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:      goto error;                                       \[0m                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:  [0m[1;39m}[0m[39m [0m[1;35mwhile[0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:static CURLcode [0m[1;35mdoh_run_probe[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                              struct doh_probe *p, DNStype dnstype,[0m             [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                              const char *host,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                              const char *url, CURLM *multi,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                              struct curl_slist *headers[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:  struct Curl_easy *doh = NULL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:  CURLcode result = CURLE_OK;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:  timediff_t timeout_ms;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:  DOHcode d = [0m[1;35mdoh_req_encode[0m[1;39m([0m[39mhost, dnstype, p->req_body, [0m[1;35msizeof[0m[1;39m([0m[39mp->req_body[0m[1;39m)[0m[39m,[0m   [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:                             &p->req_body_len[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[1;35mfailf[0m[1;39m([0m[39mdata, [0m[32m"Failed to encode DoH packet [0m[32m[[0m[32m%d[0m[32m][0m[32m"[0m[39m, d[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    return CURLE_OUT_OF_MEMORY;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:  p->dnstype = dnstype;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:  [0m[1;35mCurl_dyn_init[0m[1;39m([0m[39m&p->resp_body, DYN_DOH_RESPONSE[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:  timeout_ms = [0m[1;35mCurl_timeleft[0m[1;39m([0m[39mdata, NULL, TRUE[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mtimeout_ms <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    result = CURLE_OPERATION_TIMEDOUT;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    goto error;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:  [0m[35m/[0m[39m* [0m[1;35mCurl_open[0m[1;39m([0m[1;39m)[0m[39m is the internal version of [0m[1;35mcurl_easy_init[0m[1;39m([0m[1;39m)[0m[39m *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:  result = [0m[1;35mCurl_open[0m[1;39m([0m[39m&doh[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:    goto error;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:  [0m[35m/[0m[39m* pass in the struct pointer via a local variable to please coverity and[0m     [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:     the gcc typecheck helpers *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:  doh->state.internal = TRUE;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:#ifndef CURL_DISABLE_VERBOSE_STRINGS[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:  doh->state.feat = &Curl_doh_trc;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_URL, url[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_DEFAULT_PROTOCOL, [0m[32m"https"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_WRITEFUNCTION, doh_write_cb[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_WRITEDATA, &p->resp_body[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_[0m[1;33mPOST[0m[39mFIELDS, p->req_body[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_[0m[1;33mPOST[0m[39mFIELDSIZE, [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mp->req_body_len[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_HTTP[0m[1;33mHEAD[0m[39mER, headers[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:#ifdef USE_HTTP2[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_2TLS[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_PIPEWAIT, 1L[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:#ifndef DEBUGBUILD[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:  [0m[35m/[0m[39m* enforce HTTPS if not debug *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_PROTOCOLS, CURLPROTO_HTTPS[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:#else[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:  [0m[35m/[0m[39m* in debug mode, also allow http *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_PROTOCOLS, CURLPROTO_HTTP|CURLPROTO_HTTPS[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_TIMEOUT_MS, [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtimeout_ms[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SHARE, [0m[1;39m([0m[39mCURLSH *[0m[1;39m)[0m[39mdata->share[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.err && data->set.err != stderr[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_STDERR, data->set.err[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:  [0m[1;35mif[0m[1;39m([0m[1;35mCurl_trc_ft_is_verbose[0m[1;39m([0m[39mdata, &Curl_doh_trc[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_VERBOSE, 1L[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.no_signal[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_NOSIGNAL, 1L[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_VERIFYHOST,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    data->set.doh_verifyhost ? 2L : 0L[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_VERIFYPEER,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:    data->set.doh_verifypeer ? 1L : 0L[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:  [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_VERIFYSTATUS,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    data->set.doh_verifystatus ? 1L : 0L[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:  [0m[35m/[0m[39m* Inherit *some* SSL options from the user's transfer. This is a[0m             [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:     best-guess as to which options are needed for compatibility. #[0m[1;36m3661[0m         [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:     Note DoH does not inherit the user's proxy server so proxy SSL settings[0m    [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:     have no effect and are not inherited. If that changes then two new[0m         [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:     options should be added to check doh proxy insecure separately,[0m            [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:     CURLOPT_DOH_PROXY_SSL_VERIFYHOST and CURLOPT_DOH_PROXY_SSL_VERIFYPEER.[0m     [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.ssl.falsestart[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_SSL_FALSESTART, 1L[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.str[0m[1;39m[[0m[39mSTRING_SSL_CAFILE[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_CAINFO,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                       data->set.str[0m[1;39m[[0m[39mSTRING_SSL_CAFILE[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.blobs[0m[1;39m[[0m[39mBLOB_CAINFO[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_CAINFO_BLOB,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                       data->set.blobs[0m[1;39m[[0m[39mBLOB_CAINFO[0m[1;39m][0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mdata->set.str[0m[1;39m[[0m[39mSTRING_SSL_CAPATH[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:    [0m[1;35mERROR_CHECK_SETOPT[0m[1;39m([0m[39mCURLOPT_CAPATH,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                       data->set.str[0m[1;39m[[0m[39mSTRING_SSL_CAPATH[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/url.[0m[1;92mc:550[0m[39m-[0m[1;36m650[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:    [0m[1;35mCurl_netrc_init[0m[1;39m([0m[39m&data->state.netrc[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:    [0m[1;35mCurl_resolver_cleanup[0m[1;39m([0m[39mdata->state.async.resolver[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:    [0m[1;35mCurl_dyn_free[0m[1;39m([0m[39m&data->state.headerb[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:    [0m[1;35mCurl_freeset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:    [0m[1;35mCurl_req_free[0m[1;39m([0m[39m&data->req, data[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:    data = NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:  else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:    *curl = data;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:  return result;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:void [0m[1;35mCurl_conn_free[0m[1;39m([0m[39mstruct Curl_easy *data, struct connectdata *conn[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:  [0m[1;35mfor[0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < [0m[1;35mARRAYSIZE[0m[1;39m([0m[39mconn->cfilter[0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:    [0m[1;35mCurl_conn_cf_discard_all[0m[1;39m([0m[39mdata, conn, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mi[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:  [0m[1;35mCurl_free_idnconverted_hostname[0m[1;39m([0m[39m&conn->host[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:  [0m[1;35mCurl_free_idnconverted_hostname[0m[1;39m([0m[39m&conn->conn_to_host[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:#ifndef CURL_DISABLE_PROXY[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:  [0m[1;35mCurl_free_idnconverted_hostname[0m[1;39m([0m[39m&conn->http_proxy.host[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:  [0m[1;35mCurl_free_idnconverted_hostname[0m[1;39m([0m[39m&conn->socks_proxy.host[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->http_proxy.user[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->socks_proxy.user[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->http_proxy.passwd[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->socks_proxy.passwd[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->http_proxy.host.rawalloc[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* http proxy name buffer *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->socks_proxy.host.rawalloc[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* socks proxy name buffer *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->user[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->passwd[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->sasl_authzid[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->options[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->oauth_bearer[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->host.rawalloc[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* hostname buffer *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->conn_to_host.rawalloc[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* hostname buffer *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->hostname_resolve[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->secondaryhostname[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->localdev[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:  [0m[1;35mCurl_ssl_conn_config_cleanup[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:#ifdef USE_UNIX_SOCKETS[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->unix_domain_socket[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mconn->destination[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:  [0m[1;35mfree[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* free all the connection oriented data *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m: * Disconnects the given connection. Note the connection may not be the[0m         [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m: * primary connection, like when freeing room in the connection pool or[0m         [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m: * killing of a dead old connection.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m: * A connection needs an easy handle when closing down. We support this passed[0m  [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m: * in separately since the connection to get closed here is often already[0m       [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m: * disassociated from an easy handle.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m: * This function MUST NOT reset state in the Curl_easy struct if that[0m           [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m: * is not strictly bound to the life-time of *this* particular connection.[0m      [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m620:b[0m[39mool [0m[1;35mCurl_on_disconnect[0m[1;39m([0m[39mstruct Curl_easy *data,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:                        struct connectdata *conn, bool aborted[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:  [0m[35m/[0m[39m* there must be a connection to close *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:  [0m[35m/[0m[39m* it must be removed from the connection pool *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!conn->bits.in_cpool[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:  [0m[35m/[0m[39m* there must be an associated transfer *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:  [0m[35m/[0m[39m* the transfer must be detached from the connection *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:  [0m[1;35mDEBUGASSERT[0m[1;39m([0m[39m!data->conn[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:  [0m[1;35mDEBUGF[0m[1;39m([0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Curl_disconnect[0m[32m([0m[32mconn #%"[0m[39m FMT_OFF_T [0m[32m", [0m[32maborted[0m[32m=%d[0m[32m)[0m[32m"[0m[39m,[0m       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:         conn->connection_id, aborted[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mconn->dns_entry[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[1;35mCurl_resolv_unlink[0m[1;39m([0m[39mdata, &conn->dns_entry[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:  [0m[35m/[0m[39m* Cleanup NTLM connection-related data *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:  [0m[1;35mCurl_http_auth_cleanup_ntlm[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:  [0m[35m/[0m[39m* Cleanup NEGOTIATE connection-related data *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:  [0m[1;35mCurl_http_auth_cleanup_negotiate[0m[1;39m([0m[39mconn[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mconn->connect_only[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:    [0m[35m/[0m[39m* treat the connection as aborted in CONNECT_ONLY situations *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    aborted = TRUE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:426[0m[39m-[0m[1;36m433[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:  [0m[35m/[0m[39m* start clean, consider allocating this struct on demand *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:  dohp = data->req.doh = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mstruct doh_probes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!dohp[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    return NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:  [0m[1;35mfor[0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < DOH_SLOT_COUNT; ++i[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    dohp->probe[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.easy_mid = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:100[0m[39m-[0m[1;36m110[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:123[0m[39m-[0m[1;36m128[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mCurl_bufq_reset[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:  [0m[35m/[0m[39m* Can no longer [0m[1;35mmemset[0m[1;39m([0m[1;39m)[0m[39m this struct as we need to keep some state *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root-cause analysis  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - The ASan crash always happens in Curl_doh_close reading from a stale or [0m       [2m                [0m
[2;36m                    [0m         [39mcorrupted `data->req.doh` pointer.  On a multi-handle keep-alive, an easy handle’s [0m [2m                [0m
[2;36m                    [0m         [39m`data->req` state gets reset but its `req.doh` pointer is neither cleared nor [0m      [2m                [0m
[2;36m                    [0m         [39mconsistently re-initialized.  This leaves behind a dangling or uninitialized [0m       [2m                [0m
[2;36m                    [0m         [39mpointer that later calls into `Curl_doh_close`, causing a wild read.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - The prior “replace close with cleanup” patch in `lib/request.c` did not [0m       [2m                [0m
[2;36m                    [0m         [39mprevent the crash because `Curl_doh_cleanup` itself calls `Curl_doh_close` [0m         [2m                [0m
[2;36m                    [0m         [39munconditionally, and the pointer was still invalid at that point.  [0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Preservation of existing logic  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - We must still perform DNS-over-HTTPS cleanup when a DOH context was actually [0m  [2m                [0m
[2;36m                    [0m         [39mcreated and registered with the multi handle.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m   - We must not modify any fuzzer harness, multi logic, or public API surface.  [0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Key changes  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   A. Always null out `data->req.doh` when resetting or freeing the request state, [0m [2m                [0m
[2;36m                    [0m         [39mso that later teardown calls see a NULL pointer and skip DOH close entirely.  [0m      [2m                [0m
[2;36m                    [0m         [39m   B. Adjust the two DOH-teardown sites in `lib/request.c` to use [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` [0m[1;39m([0m[39malready done[0m[1;39m)[0m[39m but rely on the NULL pointer guard inside [0m  [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_cleanup` rather than unconditionally invoking `Curl_doh_close`.  [0m         [2m                [0m
[2;36m                    [0m         [39m   C. [0m[1;39m([0m[39mOptional hardening[0m[1;39m)[0m[39m In `Curl_doh_cleanup`, only call `Curl_doh_close` if [0m    [2m                [0m
[2;36m                    [0m         [39mthere are actual pending multi transfers [0m[1;39m([0m[39mi.e. `doh->pending>[0m[1;36m0[0m[39m`[0m[1;39m)[0m[39m, to further guard [0m [2m                [0m
[2;36m                    [0m         [39magainst spurious close calls on a context that was freed synchronously inside [0m      [2m                [0m
[2;36m                    [0m         [39m`Curl_doh`.  [0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Detailed patch steps  [0m                                                           [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m1[0m[39m. In `lib/transfer.c`, find `[0m[1;35mCurl_client_reset[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m[39m` and [0m    [2m                [0m
[2;36m                    [0m         [39madd, near the top or bottom of that function:  [0m                                     [2m                [0m
[2;36m                    [0m         [39m      ```c[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m      [0m[35m/[0m[39m*[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       * Ensure any previous DOH context is forgotten on a new HTTP request start.[0m  [2m                [0m
[2;36m                    [0m         [39m       * This prevents stale/dangling pointers from surviving a client reset.[0m       [2m                [0m
[2;36m                    [0m         [39m       *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      data->req.doh = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m      ```  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      This guarantees that after the client state is reset for a new transfer, [0m     [2m                [0m
[2;36m                    [0m         [39m`data->req.doh` cannot reference a previous or freed context.  [0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m2[0m[39m. In `lib/request.c`, at both call sites where DOH teardown is requested [0m[1;39m([0m[39mlines[0m [2m                [0m
[2;36m                    [0m         [39m~[0m[1;36m108[0m[39m and ~[0m[1;36m126[0m[1;39m)[0m[39m, continue to call `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` as previously patched.  [0m  [2m                [0m
[2;36m                    [0m         [39mDo not revert to direct `Curl_doh_close`.  The guard inside `Curl_doh_cleanup` now [0m [2m                [0m
[2;36m                    [0m         [39mrelies on `data->req.doh` being NULL if no DOH context exists.  [0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m3[0m[39m. [0m[1;39m([0m[39mOptional safety improvement[0m[1;39m)[0m[39m In `lib/doh.c`, adjust `Curl_doh_cleanup` to [0m   [2m                [0m
[2;36m                    [0m         [39monly invoke `Curl_doh_close` if `doh->pending` is non-zero.  Example:  [0m             [2m                [0m
[2;36m                    [0m         [39m      ```c[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m      void [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mstruct Curl_easy *data[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m{[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        struct doh_probes *doh = data->req.doh;[0m                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mif[0m[1;39m([0m[39m!doh[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m          return;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[39m* only remove multi handles if we actually scheduled any *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mif[0m[1;39m([0m[39mdoh->pending && data->multi[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m          [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m        doh->req_hds = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* frees and NULLs data->req.doh *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      ```  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m      This prevents a call into `Curl_doh_close` when no probes were ever enqueued.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Justification  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - Clearing `data->req.doh` on each client reset prevents stale pointers from [0m    [2m                [0m
[2;36m                    [0m         [39msurviving between requests.  Any subsequent teardown that still runs through [0m       [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_cleanup` will see `doh == NULL` and skip cleanup entirely.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - We preserve the existing DOH cleanup logic when a real DOH lookup was in [0m      [2m                [0m
[2;36m                    [0m         [39mflight [0m[1;39m([0m[39mbecause `doh` is non-NULL and `pending>[0m[1;36m0[0m[39m`[0m[1;39m)[0m[39m.  Thus we still remove handles [0m  [2m                [0m
[2;36m                    [0m         [39mand free resources exactly once.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - We do not alter any fuzzing harness, multi interface, or public APIs, so [0m      [2m                [0m
[2;36m                    [0m         [39mexisting tests and user-visible behavior remain unchanged.  [0m                        [2m                [0m
[2;36m                    [0m         [39m   - By optionally guarding `Curl_doh_close` in `Curl_doh_cleanup` on `pending>[0m[1;36m0[0m[39m`, [0m [2m                [0m
[2;36m                    [0m         [39mwe provide an extra safety net against spurious or double-close scenarios, without [0m [2m                [0m
[2;36m                    [0m         [39mdisabling the intended cleanup when it is needed.  [0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Side-effects and mitigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - There is no impact on non-DOH code paths because `data->req.doh` is initially [0m [2m                [0m
[2;36m                    [0m         [39mNULL after easy handle creation [0m[1;39m([0m[39mcalloc or memset[0m[1;39m)[0m[39m.  Clearing it in [0m                [2m                [0m
[2;36m                    [0m         [39m`Curl_client_reset` simply reaffirms the intended invariant.  [0m                      [2m                [0m
[2;36m                    [0m         [39m   - The optional `pending` check in `Curl_doh_cleanup` only tightens the condition[0m [2m                [0m
[2;36m                    [0m         [39munder which handles are removed; any case where probes were enqueued will still [0m    [2m                [0m
[2;36m                    [0m         [39mhave `pending>[0m[1;36m0[0m[39m`.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Existing unit tests and functional tests for DOH will continue to exercise the[0m [2m                [0m
[2;36m                    [0m         [39msame cleanup code when they set up DOH lookups.  [0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Validation  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Rebuild libcurl with these changes and rerun `curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m`.  The segmentation fault in `Curl_doh_close` should no longer be [0m        [2m                [0m
[2;36m                    [0m         [39mreproducible under AddressSanitizer.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Run existing DOH integration tests to confirm no regressions.  [0m                [2m                [0m
[2;36m                    [0m         [39m   - Confirm via ASan that no wild reads or stale pointer dereferences remain.  [0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 11:05:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=522391;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=882431;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 11:06:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=598503;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=245435;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 11:08:57][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=961430;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=289851;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=281795;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=192565;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:08:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.95[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=890250;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=639173;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Started[33m...[0m                                ]8;id=465409;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=809768;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2kn_thqf[0m                                                 ]8;id=100962;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=427376;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 11:10:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Patching[1m)[0m Took [1;36m98.52[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=227111;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=986084;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Started[33m...[0m                          ]8;id=686290;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=817506;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:10:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Checking build[1m)[0m Took [1;36m12.91[0m seconds;                ]8;id=117529;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=195740;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Started[33m...[0m                             ]8;id=333972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=792707;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:10:52][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=796197;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=14827;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m270757777[0m                                                                [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b1218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a631b8004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b8008[0m,[1;36m0x561a63225ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a62f306de[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd0bd4a2e0[0m sp [1;36m0x7ffd0bd4a180[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a62f306de[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a62f2ecbb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a62df3911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a62dc5df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a62dcda81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a62dcb035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a62d79ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a62d770ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a62c2b6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a62c16915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a62c1c3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x561a62c47652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7ff3c97f3082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x561a62c0eafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5g8naa5v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=437319;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=565943;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m270757777[0m                                                                [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b1218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a631b8004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b8008[0m,[1;36m0x561a63225ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a62f306de[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd0bd4a2e0[0m sp [1;36m0x7ffd0bd4a180[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a62f306de[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a62f2ecbb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a62df3911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a62dc5df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a62dcda81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a62dcb035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a62d79ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a62d770ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a62c2b6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a62c16915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a62c1c3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x561a62c47652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7ff3c97f3082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x561a62c0eafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5g8naa5v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                            [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                    [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m             [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                              [2m               [0m
[2;36m                    [0m         INFO: Seed: [1;36m270757777[0m                                                                [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m modules   [1m([0m[1;36m28140[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b1218[0m,       [2m               [0m
[2;36m                    [0m         [1;36m0x561a631b8004[0m[1m)[0m,                                                                     [2m               [0m
[2;36m                    [0m         INFO: Loaded [1;36m1[0m PC tables [1m([0m[1;36m28140[0m PCs[1m)[0m: [1;36m28140[0m [1m[[0m[1;36m0x561a631b8008[0m,[1;36m0x561a63225ec8[0m[1m)[0m,         [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                            [2m               [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         AddressSanitizer:DEADLYSIGNAL                                                        [2m               [0m
[2;36m                    [0m         =================================================================                    [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: SEGV on unknown address [1m([0mpc [1;36m0x561a62f306de[0m bp         [2m               [0m
[2;36m                    [0m         [1;36m0x7ffd0bd4a2e0[0m sp [1;36m0x7ffd0bd4a180[0m T0[1m)[0m                                                 [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==The signal is caused by a READ memory access.                                  [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==Hint: this fault was caused by a dereference of a high value address [1m([0msee      [2m               [0m
[2;36m                    [0m         register values below[1m)[0m.  Disassemble the provided pc to learn which register was     [2m               [0m
[2;36m                    [0m         used.                                                                                [2m               [0m
[2;36m                    [0m         SCARINESS: [1;36m20[0m [1m([0mwild-addr-read[1m)[0m                                                       [2m               [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x561a62f306de[0m in Curl_doh_close [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m                  [2m               [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x561a62f2ecbb[0m in Curl_doh_cleanup [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1435:5[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x561a62df3911[0m in Curl_req_done [35m/src/curl/lib/[0m[95mrequest.c[0m:[1;92m107:3[0m                 [2m               [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x561a62dc5df4[0m in multi_done [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m754:14[0m                     [2m               [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x561a62dcda81[0m in multi_runsingle [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m2856:15[0m               [2m               [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x561a62dcb035[0m in curl_multi_perform [35m/src/curl/lib/[0m[95mmulti.c[0m:[1;92m3016:16[0m            [2m               [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x561a62d79ace[0m in [1;35mfuzz_handle_transfer[0m[1m([0mfuzz_data*[1m)[0m                            [2m               [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m419:5[0m                                                [2m               [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x561a62d770ed[0m in LLVMFuzzerTestOneInput [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m:[1;92m97:3[0m [2m               [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x561a62c2b6a0[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,       [2m               [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x561a62c16915[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned   [2m               [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x561a62c1c3af[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m               [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                              [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x561a62c47652[0m in main                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7ff3c97f3082[0m in __libc_start_main                                          [2m               [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                  [2m               [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                            [2m               [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x561a62c0eafd[0m in _start [1m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1m)[0m                    [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         DEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done                         [2m               [0m
[2;36m                    [0m         AddressSanitizer can not provide additional info.                                    [2m               [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: SEGV [35m/src/curl/lib/[0m[95mdoh.c[0m:[1;92m1410:30[0m in Curl_doh_close        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m:[35m/[0m[95mout[0m -v           [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5g8naa5v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         curl_fuzzer_http -[33mruns[0m=[1;36m100[0m.                                                          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Running PoV[1m)[0m Took [1;36m2.46[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=848266;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=379551;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=336285;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=762043;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:10:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.90[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=517295;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=763052;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 11:10:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Started[33m...[0m                           ]8;id=234226;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=423422;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 11:10:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mcurl Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=374685;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=909738;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=792908;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=591809;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         +++ b/lib/doh.c                                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-1390[0m,[1;36m7[0m +[1;36m1390[0m,[1;36m7[0m @@                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m* All done *[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m              [1;35mde_cleanup[0m[1m([0m&de[1m)[0m;                                                               [2m                [0m
[2;36m                    [0m         -    [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m         +    [35m/[0m* DOH state will be cleaned up in Curl_req_done *[35m/[0m                            [2m                [0m
[2;36m                    [0m              return result;                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m            [1m}[0m [35m/[0m* !dohp->pending *[35m/[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         +++ b/lib/request.c                                                                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-103[0m,[1;36m10[0m +[1;36m103[0m,[1;36m10[0m @@                                                               [2m                [0m
[2;36m                    [0m            [1m([0mvoid[1m)[0mreq;                                                                       [2m                [0m
[2;36m                    [0m            [1;35mif[0m[1m([0m!aborted[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m              [1m([0mvoid[1m)[0m[1;35mreq_flush[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m         +#ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         +  [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         +#endif                                                                             [2m                [0m
[2;36m                    [0m            [1;35mCurl_client_reset[0m[1m([0mdata[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m         -#ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         -  [1;35mCurl_doh_close[0m[1m([0mdata[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         -#endif                                                                             [2m                [0m
[2;36m                    [0m            return CURLE_OK;                                                                 [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-178[0m,[1;36m7[0m +[1;36m178[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m            [1;35mCurl_client_cleanup[0m[1m([0mdata[1m)[0m;                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          #ifndef CURL_DISABLE_DOH                                                           [2m                [0m
[2;36m                    [0m         -  [1;35mCurl_doh_cleanup[0m[1m([0mdata[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m         +  [35m/[0m* DOH cleanup performed in Curl_req_done *[35m/[0m                                     [2m                [0m
[2;36m                    [0m          #endif                                                                             [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer curl_fuzzer_http -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m            [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m270757777[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561a631b1218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561a631b8004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561a631b8008[0m[39m,[0m[1;36m0x561a63225ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561a62f306de[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffd0bd4a2e0[0m[39m sp [0m[1;36m0x7ffd0bd4a180[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561a62f306de[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561a62f2ecbb[0m[39m in Curl_doh_cleanup [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1435:5[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561a62df3911[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m107:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561a62dc5df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561a62dcda81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561a62dcb035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561a62d79ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561a62d770ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561a62c2b6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561a62c16915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561a62c1c3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x561a62c47652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7ff3c97f3082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x561a62c0eafd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_doh_cleanup--Curl_req_done[0m                        [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5g8naa5v[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a AddressSanitizer SEGV triggered by the fuzzing harness when [0m [2m                [0m
[2;36m                    [0m         [39mexercising curl’s DNS-over-HTTPS [0m[1;39m([0m[39mDOH[0m[1;39m)[0m[39m code. The crash occurs in Curl_doh_close [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlib/doh.c[0m[1;39m)[0m[39m due to a wild-read of an invalid pointer. A patch was attempted that [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;36m1[0m[1;39m)[0m[39m adds a null check and a pending-and-multi guard in Curl_doh_cleanup, moves [0m     [2m                [0m
[2;36m                    [0m         [39mfreeing logic there, and [0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m adjusts request teardown in request.c to call [0m         [2m                [0m
[2;36m                    [0m         [39mCurl_doh_cleanup earlier and null out data->req.doh. After applying the patch, the [0m [2m                [0m
[2;36m                    [0m         [39mfuzzer still crashes—this time in Curl_doh_cleanup at the newly modified [0m           [2m                [0m
[2;36m                    [0m         [39mline—indicating the patch did not eliminate the invalid access.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInitial Issue[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- The fuzz target `curl_fuzzer_http` is run with a single input [0m[1;36m100[0m[39m times under [0m    [2m                [0m
[2;36m                    [0m         [39mlibFuzzer.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- AddressSanitizer reports a SEGV on an unknown address in `Curl_doh_close` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlib/doh.[0m[1;92mc:1410[0m[1;39m)[0m[39m.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The backtrace shows the crash originates from `Curl_req_done` → `multi_done` → [0m   [2m                [0m
[2;36m                    [0m         [39m`curl_multi_perform` → `fuzz_handle_transfer` → `LLVMFuzzerTestOneInput`.[0m           [2m                [0m
[2;36m                    [0m         [39m- The fault is a wild address read [0m[1;39m([0m[39m“SCARINESS: [0m[1;36m20[0m[39m”[0m[1;39m)[0m[39m, suggesting the code [0m          [2m                [0m
[2;36m                    [0m         [39mdereferenced a bogus or freed `doh` pointer.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch Attempt[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- In `lib/doh.c`, the developer:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  • Renamed and expanded `Curl_doh_cleanup` [0m[1;39m([0m[39mline ~[0m[1;36m1431[0m[1;39m)[0m[39m, adding:[0m                   [2m                [0m
[2;36m                    [0m         [39m    – A guard `[0m[1;35mif[0m[1;39m([0m[39m!doh[0m[1;39m)[0m[39m return;`[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    – A condition `[0m[1;35mif[0m[1;39m([0m[39mdoh->pending && data->multi[0m[1;39m)[0m[39m [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;`[0m           [2m                [0m
[2;36m                    [0m         [39m    – Moved `[0m[1;35mcurl_slist_free_all[0m[1;39m([0m[39mdoh->req_hds[0m[1;39m)[0m[39m` and `[0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [39mafter the conditional block.[0m                                                        [2m                [0m
[2;36m                    [0m         [39m  • Removed the direct call to `Curl_doh_close` and free logic from elsewhere.[0m      [2m                [0m
[2;36m                    [0m         [39m- In `lib/request.c`, moved the call to `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` immediately after [0m [2m                [0m
[2;36m                    [0m         [39mflushing, and replaced the old `Curl_doh_close` call with `data->req.doh = NULL;`.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mResult of Patch[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Upon rerunning the fuzz target, AddressSanitizer reports another SEGV, now at [0m    [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_cleanup` [0m[1;39m([0m[39mlib/doh.[0m[1;92mc:1437[0m[1;39m)[0m[39m on the line `[0m[1;35mif[0m[1;39m([0m[39mdoh->pending && data->multi[0m[1;39m)[0m[39m`.[0m  [2m                [0m
[2;36m                    [0m         [39m- The new crash again indicates a wild-read, likely from an invalid `doh` pointer [0m  [2m                [0m
[2;36m                    [0m         [39mor corrupted structure.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for Further Investigation[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Allocation and ownership of `data->req.doh`:[0m                                      [2m                [0m
[2;36m                    [0m         [39m  • Where and how is `data->req.doh` initialized?[0m                                   [2m                [0m
[2;36m                    [0m         [39m  • Under what conditions can it become invalid or double-freed?[0m                    [2m                [0m
[2;36m                    [0m         [39m- The interaction between `Curl_doh_close` and `Curl_doh_cleanup`:[0m                  [2m                [0m
[2;36m                    [0m         [39m  • Do both functions assume mutually exclusive lifetimes?[0m                          [2m                [0m
[2;36m                    [0m         [39m  • Is the `pending` flag and `data->multi` state reliable at teardown?[0m             [2m                [0m
[2;36m                    [0m         [39m- The multi-handle cleanup path in `multi_done`[0m[35m/[0m[39m`multi_runsingle`:[0m                  [2m                [0m
[2;36m                    [0m         [39m  • How are callbacks sequenced when a transfer ends?[0m                               [2m                [0m
[2;36m                    [0m         [39m  • Could `Curl_doh_cleanup` be invoked on a partially constructed or already freed[0m [2m                [0m
[2;36m                    [0m         [39m`doh`?[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- Related list freeing [0m[1;39m([0m[39m`curl_slist_free_all`[0m[1;39m)[0m[39m and safe-free invocations:[0m           [2m                [0m
[2;36m                    [0m         [39m  • Are there other code paths that free or reset `req_hds` or `doh`?[0m               [2m                [0m
[2;36m                    [0m         [39m  • Is there any risk of freeing the same list twice?[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo speculative root causes or fixes are proposed; this report is intended to guide [0m [2m                [0m
[2;36m                    [0m         [39mfurther code review and debugging of the DOH cleanup and multi-handle teardown [0m     [2m                [0m
[2;36m                    [0m         [39mlogic.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2859921986[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28140[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e75654218[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561e7565b004[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28140[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28140[0m[39m [0m[1;39m[[0m[1;36m0x561e7565b008[0m[39m,[0m[1;36m0x561e756c8ec8[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561e753d36fe[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7fffd6f9b600[0m[39m sp [0m[1;36m0x7fffd6f9b4a0[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561e753d36fe[0m[39m in Curl_doh_close [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561e7529691a[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m108:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561e75268df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561e75270a81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561e7526e035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561e7521cace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561e7521a0ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561e750ce6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561e750b9915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561e750bf3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561e750ea652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f65711e7082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561e750b1afd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_close--Curl_req_done--multi_done[0m                              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1410:30[0m[39m in Curl_doh_close[0m       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpo882g4zd[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mcurl_fuzzer_http[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer curl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                   [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4216351726[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m28145[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m28145[0m[39m [0m[1;39m[[0m[1;36m0x561a073f0238[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x561a073f7029[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m28145[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m28145[0m[39m [0m[1;39m[[0m[1;36m0x561a073f7030[0m[39m,[0m[1;36m0x561a07464f40[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mcurl_fuzzer_http[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                           [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer:DEADLYSIGNAL[0m                                                       [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: SEGV on unknown address [0m[1;39m([0m[39mpc [0m[1;36m0x561a0716dd0f[0m[39m bp [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x7ffddb6026a0[0m[39m sp [0m[1;36m0x7ffddb602620[0m[39m T0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==The signal is caused by a READ memory access.[0m                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==Hint: this fault was caused by a dereference of a high value address [0m[1;39m([0m[39msee [0m    [2m                [0m
[2;36m                    [0m         [39mregister values below[0m[1;39m)[0m[39m.  Disassemble the provided pc to learn which register was [0m   [2m                [0m
[2;36m                    [0m         [39mused.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m20[0m[39m [0m[1;39m([0m[39mwild-addr-read[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x561a0716dd0f[0m[39m in Curl_doh_cleanup [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1437:11[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x561a07032911[0m[39m in Curl_req_done [0m[35m/src/curl/lib/[0m[95mrequest.c[0m[39m:[0m[1;92m107:3[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x561a07004df4[0m[39m in multi_done [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m754:14[0m                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x561a0700ca81[0m[39m in multi_runsingle [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m2856:15[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x561a0700a035[0m[39m in curl_multi_perform [0m[35m/src/curl/lib/[0m[95mmulti.c[0m[39m:[0m[1;92m3016:16[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x561a06fb8ace[0m[39m in [0m[1;35mfuzz_handle_transfer[0m[1;39m([0m[39mfuzz_data*[0m[1;39m)[0m[39m [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m419:5[0m                                               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x561a06fb60ed[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/curl_fuzzer/[0m[95mcurl_fuzzer.cc[0m[39m:[0m[1;92m97:3[0m                                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x561a06e6a6a0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x561a06e55915[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x561a06e5b3af[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x561a06e86652[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x7f1f0d6e0082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x561a06e4dafd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mcurl_fuzzer_http+0x136afd[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Curl_doh_cleanup--Curl_req_done--multi_done[0m                            [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer can not provide additional info.[0m                                   [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: SEGV [0m[35m/src/curl/lib/[0m[95mdoh.c[0m[39m:[0m[1;92m1437:11[0m[39m in Curl_doh_cleanup[0m     [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m         [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpusw7mt8n[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mcurl_fuzzer_http -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/doh.[0m[1;92mc:1370[0m[39m-[0m[1;36m1395[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:    [0m[1;39m}[0m[39m [0m[35m/[0m[39m* address processing done *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:    [0m[35m/[0m[39m* Now process any build-specific attributes retrieved from DNS *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:#ifdef USE_HTTPSRR[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;35mif[0m[1;39m([0m[39mde.numhttps_rrs > [0m[1;36m0[0m[39m && result == CURLE_OK && *dnsp[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:      struct Curl_https_rrinfo *hrr = NULL;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:      result = [0m[1;35mdoh_resp_decode_httpsrr[0m[1;39m([0m[39mde.https_rrs->val, de.https_rrs->len,[0m   [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:                                       &hrr[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:        [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Failed to decode HTTPS RR"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:      [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:      [0m[1;35minfof[0m[1;39m([0m[39mdata, [0m[32m"Some HTTPS RR to process"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:# ifdef DEBUGBUILD[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:      [0m[1;35mdoh_print_httpsrr[0m[1;39m([0m[39mdata, hrr[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:# endif[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:      [0m[1;39m([0m[39m*dnsp[0m[1;39m)[0m[39m->hinfo = hrr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[35m/[0m[39m* All done *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:    [0m[1;35mde_cleanup[0m[1;39m([0m[39m&de[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:    [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:    return result;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:170[0m[39m-[0m[1;36m183[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:void [0m[1;35mCurl_req_free[0m[1;39m([0m[39mstruct SingleRequest *req, struct Curl_easy *data[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  [0m[35m/[0m[39m* This is a bit ugly. `req->p` is a union and we assume we can[0m               [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:   * free this safely without leaks. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->p.ftp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:  [0m[1;35mCurl_safefree[0m[1;39m([0m[39mreq->newurl[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39mreq->sendbuf_init[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[1;35mCurl_bufq_free[0m[1;39m([0m[39m&req->sendbuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:  [0m[1;35mCurl_client_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:  [0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlib/request.[0m[1;92mc:100[0m[39m-[0m[1;36m110[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m100:C[0m[39mURLcode [0m[1;35mCurl_req_done[0m[1;39m([0m[39mstruct SingleRequest *req,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                       struct Curl_easy *data, bool aborted[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39mreq;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:  [0m[1;35mif[0m[1;39m([0m[39m!aborted[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mreq_flush[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  [0m[1;35mCurl_client_reset[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#ifndef CURL_DISABLE_DOH[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:  [0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:  return CURLE_OK;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Refactor Curl_doh_cleanup to be the sole “close + free” entrypoint and prevent [0m  [2m                [0m
[2;36m                    [0m         [39many use-after-free:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   a. At the top, grab the doh pointer via `struct doh_probes *doh = [0m               [2m                [0m
[2;36m                    [0m         [39mdata->req.doh;` and return immediately if NULL.[0m                                     [2m                [0m
[2;36m                    [0m         [39m   b. If the probe is still pending under a multi handle [0m[1;39m([0m[39m`doh->pending && [0m         [2m                [0m
[2;36m                    [0m         [39mdata->multi`[0m[1;39m)[0m[39m, invoke only `[0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` and then return—do not touch [0m     [2m                [0m
[2;36m                    [0m         [39m`doh` thereafter. This avoids dereferencing a freed pointer if `Curl_doh_close` [0m    [2m                [0m
[2;36m                    [0m         [39mitself frees or mutates the doh struct.[0m                                             [2m                [0m
[2;36m                    [0m         [39m   c. In the “no-pending” case, unconditionally free `doh->req_hds`, set it to [0m     [2m                [0m
[2;36m                    [0m         [39mNULL, then `[0m[1;35mCurl_safefree[0m[1;39m([0m[39mdata->req.doh[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mwhich also zeroes `data->req.doh`[0m[1;39m)[0m[39m. Do [0m  [2m                [0m
[2;36m                    [0m         [39mNOT call `Curl_doh_close` here.[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   d. This design ensures:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m      - All memory and list freeing happens exactly once.[0m                           [2m                [0m
[2;36m                    [0m         [39m      - No code path continues to use a stale `doh` pointer after a call to [0m        [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_close`.[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Harden Curl_doh_close so that if it does free the doh struct [0m[1;39m([0m[39mor its internals[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mit also NULLs out `data->req.doh` to prevent dangling pointers. If Curl_doh_close [0m  [2m                [0m
[2;36m                    [0m         [39mis only meant to “close” but not free, document that behavior clearly and leave all[0m [2m                [0m
[2;36m                    [0m         [39mfreeing to Curl_doh_cleanup.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Remove all direct calls to Curl_doh_close in request tear-down functions:[0m        [2m                [0m
[2;36m                    [0m         [39m   a. In `lib/request.c`:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m      - In `Curl_req_done`, replace the `#ifndef CURL_DISABLE_DOH` invocation of [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCurl_doh_close[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` by a single `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` call [0m[1;39m([0m[39munder the same [0m   [2m                [0m
[2;36m                    [0m         [39m`#ifndef` guard[0m[1;39m)[0m[39m. Do not subsequently set `data->req.doh = NULL;`, as [0m              [2m                [0m
[2;36m                    [0m         [39m`Curl_doh_cleanup` will already null it when freeing.[0m                               [2m                [0m
[2;36m                    [0m         [39m      - In `Curl_req_free`, remove its `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` invocation [0m[1;39m([0m[39mor [0m     [2m                [0m
[2;36m                    [0m         [39mleave it as a no-op since data->req.doh will already be NULL post-cleanup[0m[1;39m)[0m[39m. Ensure [0m [2m                [0m
[2;36m                    [0m         [39mit does not call `Curl_doh_close` or free again.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Eliminate the early cleanup in the synchronous resolution path in `lib/doh.c`:[0m   [2m                [0m
[2;36m                    [0m         [39m   – At the end of the internal `Curl_doh` function [0m[1;39m([0m[39maround line [0m[1;36m1393[0m[1;39m)[0m[39m, remove the [0m [2m                [0m
[2;36m                    [0m         [39munconditional `[0m[1;35mCurl_doh_cleanup[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` invocation. Postpone all cleanup to the [0m     [2m                [0m
[2;36m                    [0m         [39mrequest teardown phase. This avoids freeing DOH state mid-transfer, which a later [0m  [2m                [0m
[2;36m                    [0m         [39mrequest tear-down then tries to re-cleanup.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Audit all code paths that allocate or reset `data->req.doh` to guarantee that:[0m   [2m                [0m
[2;36m                    [0m         [39m   – Every allocation is paired with exactly one call to `Curl_doh_cleanup`.[0m        [2m                [0m
[2;36m                    [0m         [39m   – No code path calls both `Curl_doh_close` and a separate free on the same [0m      [2m                [0m
[2;36m                    [0m         [39mrequest.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Add a new debug assertion [0m[1;39m([0m[39minside `Curl_doh_cleanup`[0m[1;39m)[0m[39m to verify that after [0m      [2m                [0m
[2;36m                    [0m         [39mfreeing, `data->req.doh` is NULL, so that any subsequent misuse is detected early [0m  [2m                [0m
[2;36m                    [0m         [39min development builds.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Regression test plan:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   – Rebuild with AddressSanitizer and run `curl_fuzzer_http` for ≥[0m[1;36m1000[0m[39m iterations.[0m [2m                [0m
[2;36m                    [0m         [39mConfirm that:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m     • No SEGV in lib/doh.c [0m[1;39m([0m[39mcleanup or close[0m[1;39m)[0m[39m.[0m                                     [2m                [0m
[2;36m                    [0m         [39m     • No double-free or invalid-read reports.[0m                                      [2m                [0m
[2;36m                    [0m         [39m   – Add a minimal unit test that drives a synchronous DOH resolve through the [0m     [2m                [0m
[2;36m                    [0m         [39msynchronous `Curl_doh` path and verifies that after `Curl_req_done`, the [0m           [2m                [0m
[2;36m                    [0m         [39m`data->req.doh` pointer is NULL and no leaks occur.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mJustification:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- By centralizing both close and free logic in `Curl_doh_cleanup` and ensuring it [0m  [2m                [0m
[2;36m                    [0m         [39meither does “close-only” or “free-only,” we eliminate the previous interleaving and[0m [2m                [0m
[2;36m                    [0m         [39mdouble-free/wild-pointer scenarios.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Removing the early cleanup in the sync path prevents struct free in the middle of[0m [2m                [0m
[2;36m                    [0m         [39ma request, so that request tear-down is the single point of cleanup.[0m                [2m                [0m
[2;36m                    [0m         [39m- This preserves the intended multi-handle support [0m[1;39m([0m[39mstill calls `Curl_doh_close` [0m   [2m                [0m
[2;36m                    [0m         [39mwhen pending under a multi[0m[1;39m)[0m[39m, but bails out before any free or list operations.[0m      [2m                [0m
[2;36m                    [0m         [39m- All existing functionality [0m[1;39m([0m[39msync and async DOH resolution, multi-handle [0m          [2m                [0m
[2;36m                    [0m         [39msequencing[0m[1;39m)[0m[39m remains intact. We only reorder cleanup to avoid use-after-free.[0m        [2m                [0m
[2;36m                    [0m         [39m- Setting `data->req.doh = NULL` in both `Curl_doh_cleanup` and `Curl_doh_close` [0m   [2m                [0m
[2;36m                    [0m         [39mprevents dangling pointers on all code paths.[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Narrow, well-scoped changes affect only `lib/doh.c` and the two request teardown [0m [2m                [0m
[2;36m                    [0m         [39mfunctions, avoiding broader impact on utility code or test harnesses.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 11:11:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=739955;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=275376;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=235013;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=146932;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpo7dogtuc[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/curl_cu-delta-04_curl-003/[0m[95magent-output-[0m [2m               [0m
[2;36m                    [0m         [95m1766833863.6586254[0m                                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/curl_cu-delta-04_curl-[1;36m003.[0mtoml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-curl[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/27/25 11:11:04][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mcurl[0m           ]8;id=933055;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=876836;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=581816;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=512942;file:///home/user/crete/scripts/benchmark/__main__.py#309\[2m309[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mcurl[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=446129;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=601436;file:///home/user/crete/scripts/benchmark/__main__.py#312\[2m312[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mcurl[0m                   [2m               [0m
