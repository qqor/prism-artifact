--- a/lib/doh.c
+++ b/lib/doh.c
@@ -1390,7 +1390,7 @@
 
     /* All done */
     de_cleanup(&de);
-    Curl_doh_cleanup(data);
+    /* DOH state will be cleaned up in Curl_req_done */
     return result;
 
   } /* !dohp->pending */

--- a/lib/request.c
+++ b/lib/request.c
@@ -103,10 +103,10 @@
   (void)req;
   if(!aborted)
     (void)req_flush(data);
+#ifndef CURL_DISABLE_DOH
+  Curl_doh_cleanup(data);
+#endif
   Curl_client_reset(data);
-#ifndef CURL_DISABLE_DOH
-  Curl_doh_close(data);
-#endif
   return CURLE_OK;
 }
 
@@ -178,7 +178,7 @@
   Curl_client_cleanup(data);
 
 #ifndef CURL_DISABLE_DOH
-  Curl_doh_cleanup(data);
+  /* DOH cleanup performed in Curl_req_done */
 #endif
 }
 
