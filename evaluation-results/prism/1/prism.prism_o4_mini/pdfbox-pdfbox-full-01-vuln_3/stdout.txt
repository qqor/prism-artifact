[10/08/25 14:10:11] INFO     Building environment                                                                                                                __init__.py:132
                             - Cache directory: /tmp/tmpsqu52uri                                                                                                                
                             - Max timeout: 1800                                                                                                                                
                             - Output directory: reports/prism.prism_o4_mini/pdfbox-pdfbox-full-01-vuln_3/agent-output-1759932611.974517                                        
                             - Detection toml file: /tasks/759aa21d-110a-4c3e-b36e-d2217562425d/detection/pdfbox-pdfbox-full-01-vuln_3.toml                                     
                             - Challenge project directory: /tasks/759aa21d-110a-4c3e-b36e-d2217562425d/official-afc-pdfbox                                                     
                                                                                                                                                                                
                    INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Started...                                                context_managers.py:9
[10/08/25 14:11:49] INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Took 97.08 seconds; exception=False                      context_managers.py:23
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Started...                                       context_managers.py:9
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False              context_managers.py:23
                    INFO     Setting timeouts                                                                                                                      default.py:85
                               - build: 600 (original: 97)                                                                                                                      
                               - run tests: 600 (original: 0)                                                                                                                   
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
                    INFO     [logging_performance](pdfbox Setting owner) Took 0.86 seconds; exception=False                                               context_managers.py:23
[10/08/25 14:11:50] INFO     Successfully created Cached for CLEAN environment                                                                                   oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                           oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                   __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:11:52] INFO     [logging_performance](pdfbox Setting owner) Took 1.07 seconds; exception=False                                               context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:11:53] INFO     [logging_performance](pdfbox Setting owner) Took 0.87 seconds; exception=False                                               context_managers.py:23
[10/08/25 14:12:24] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:12:25] INFO     [logging_performance](pdfbox Setting owner) Took 0.78 seconds; exception=False                                               context_managers.py:23
                    INFO     [logging_performance](pdfbox Running a pov) Started...                                                                        context_managers.py:9
[10/08/25 14:12:56] INFO     [logging_performance](pdfbox Running a pov) Took 30.53 seconds; exception=True                                               context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                             __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
                    INFO     [logging_performance](pdfbox Setting owner) Took 0.82 seconds; exception=False                                               context_managers.py:23
[10/08/25 14:13:27] INFO     Found jstack output at /tasks/759aa21d-110a-4c3e-b36e-d2217562425d/fuzz-tooling/build/out/pdfbox/jstack.txt                          __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                             evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                             
                             ===Evaluator Diff===                                                                                                                               
                                                                                                                                                                                
                             ===Patch Result===                                                                                                                                 
                             ERROR: libFuzzer: timeout                                                                                                                          
                             2025-10-08 14:13:26                                                                                                                                
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                       
                                                                                                                                                                                
                             Threads class SMR info:                                                                                                                            
                             _java_thread_list=0x00007f137825f520, length=14, elements={                                                                                        
                             0x0000564705dd8b70, 0x0000564705ee3bf0, 0x0000564705ee5000, 0x0000564705eee090,                                                                    
                             0x0000564705eef410, 0x0000564705ef07f0, 0x0000564705ef21f0, 0x0000564705ef36f0,                                                                    
                             0x0000564705ef4b30, 0x0000564705f31960, 0x0000564705f34ed0, 0x00005647060f2960,                                                                    
                             0x00007f13a8000e70, 0x00005647066f8840                                                                                                             
                             }                                                                                                                                                  
                                                                                                                                                                                
                             "main" #1 prio=5 os_prio=0 cpu=26460.52ms elapsed=28.65s tid=0x0000564705dd8b70 nid=0x13 runnable  [0x00007ffcdb573000]                            
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                       
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                      
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                       
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                 
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                         
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                     
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                 
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                         
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                     
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                            
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                               
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                        
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                 
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                   
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                           
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                              
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                       
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                    
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                             
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                  
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                          
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                          
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                       
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                              
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                
                                                                                                                                                                                
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.75ms elapsed=28.61s tid=0x0000564705ee3bf0 nid=0x16 waiting on condition                     
                             [0x00007f13be1ab000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                     
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                   
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                       
                                                                                                                                                                                
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.51ms elapsed=28.61s tid=0x0000564705ee5000 nid=0x17 in Object.wait()                                  
                             [0x00007f13bd7fe000]                                                                                                                               
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                             
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                           
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                        
                                                                                                                                                                                
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.42ms elapsed=28.60s tid=0x0000564705eee090 nid=0x18 waiting on condition                      
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.70ms elapsed=28.60s tid=0x0000564705eef410 nid=0x19 runnable                                     
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.64ms elapsed=28.60s tid=0x0000564705ef07f0 nid=0x1a runnable                           
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1953.98ms elapsed=28.60s tid=0x0000564705ef21f0 nid=0x1b waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=770.38ms elapsed=28.60s tid=0x0000564705ef36f0 nid=0x1c waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=49.37ms elapsed=28.60s tid=0x0000564705ef4b30 nid=0x1d runnable                                   
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.59s tid=0x0000564705f31960 nid=0x21 runnable                               
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.90ms elapsed=28.58s tid=0x0000564705f34ed0 nid=0x23 in Object.wait()                            
                             [0x00007f13bcb3e000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.55ms elapsed=28.46s tid=0x00005647060f2960 nid=0x27 waiting on condition                       
                             [0x00007f13be04b000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                 
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                           
                                     - parking to wait for  <0x000000008941b4e8> (a java.util.concurrent.SynchronousQueue$TransferStack)                                        
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                 
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                  
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                          
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                        
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                        
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                                                                                                                                                                
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.67ms elapsed=28.34s tid=0x00007f13a8000e70 nid=0x3d waiting on condition                       
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.24s tid=0x00005647066f8840 nid=0x29e in Object.wait()                               
                             [0x00007f13bc2d1000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "VM Thread" os_prio=0 cpu=55.28ms elapsed=28.61s tid=0x0000564705edf400 nid=0x15 runnable                                                          
                                                                                                                                                                                
                             "GC Thread#0" os_prio=0 cpu=50.56ms elapsed=28.63s tid=0x0000564705defda0 nid=0x14 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#1" os_prio=0 cpu=46.55ms elapsed=27.57s tid=0x00007f13b8001570 nid=0x5e runnable                                                        
                                                                                                                                                                                
                             "GC Thread#2" os_prio=0 cpu=50.22ms elapsed=27.57s tid=0x00007f13b8001f70 nid=0x5f runnable                                                        
                                                                                                                                                                                
                             "GC Thread#3" os_prio=0 cpu=50.65ms elapsed=27.57s tid=0x00007f13b8002970 nid=0x60 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#4" os_prio=0 cpu=39.19ms elapsed=27.57s tid=0x00007f13b8003370 nid=0x61 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#5" os_prio=0 cpu=43.76ms elapsed=27.57s tid=0x00007f13b8003d70 nid=0x62 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#6" os_prio=0 cpu=36.10ms elapsed=27.57s tid=0x00007f13b8004770 nid=0x63 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#7" os_prio=0 cpu=43.29ms elapsed=27.57s tid=0x00007f13b8005170 nid=0x64 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#8" os_prio=0 cpu=46.68ms elapsed=27.57s tid=0x00007f13b8005b70 nid=0x65 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#9" os_prio=0 cpu=49.54ms elapsed=27.57s tid=0x00007f13b8006570 nid=0x66 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#10" os_prio=0 cpu=46.36ms elapsed=27.57s tid=0x00007f13b8007360 nid=0x67 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#11" os_prio=0 cpu=50.18ms elapsed=27.57s tid=0x00007f13b8008150 nid=0x68 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#12" os_prio=0 cpu=50.19ms elapsed=27.57s tid=0x00007f13b8008f40 nid=0x69 runnable                                                       
                                                                                                                                                                                
                             "VM Periodic Task Thread" os_prio=0 cpu=11.35ms elapsed=28.59s tid=0x0000564705f33300 nid=0x22 waiting on condition                                
                                                                                                                                                                                
                             JNI global refs: 20, weak refs: 0                                                                                                                  
                                                                                                                                                                                
                                                                                                                                                                                
                             ===Issue===                                                                                                                                        
                             ERROR: libFuzzer: timeout                                                                                                                          
                             2025-10-08 14:13:26                                                                                                                                
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                       
                                                                                                                                                                                
                             Threads class SMR info:                                                                                                                            
                             _java_thread_list=0x00007f137825f520, length=14, elements={                                                                                        
                             0x0000564705dd8b70, 0x0000564705ee3bf0, 0x0000564705ee5000, 0x0000564705eee090,                                                                    
                             0x0000564705eef410, 0x0000564705ef07f0, 0x0000564705ef21f0, 0x0000564705ef36f0,                                                                    
                             0x0000564705ef4b30, 0x0000564705f31960, 0x0000564705f34ed0, 0x00005647060f2960,                                                                    
                             0x00007f13a8000e70, 0x00005647066f8840                                                                                                             
                             }                                                                                                                                                  
                                                                                                                                                                                
                             "main" #1 prio=5 os_prio=0 cpu=26460.52ms elapsed=28.65s tid=0x0000564705dd8b70 nid=0x13 runnable  [0x00007ffcdb573000]                            
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                       
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                      
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                       
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                 
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                         
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                     
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                 
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                         
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                     
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                            
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                               
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                        
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                 
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                   
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                           
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                              
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                       
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                    
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                             
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                  
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                          
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                          
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                       
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                              
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                
                                                                                                                                                                                
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.75ms elapsed=28.61s tid=0x0000564705ee3bf0 nid=0x16 waiting on condition                     
                             [0x00007f13be1ab000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                     
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                   
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                       
                                                                                                                                                                                
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.51ms elapsed=28.61s tid=0x0000564705ee5000 nid=0x17 in Object.wait()                                  
                             [0x00007f13bd7fe000]                                                                                                                               
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                             
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                           
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                        
                                                                                                                                                                                
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.42ms elapsed=28.60s tid=0x0000564705eee090 nid=0x18 waiting on condition                      
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.70ms elapsed=28.60s tid=0x0000564705eef410 nid=0x19 runnable                                     
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.64ms elapsed=28.60s tid=0x0000564705ef07f0 nid=0x1a runnable                           
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1953.98ms elapsed=28.60s tid=0x0000564705ef21f0 nid=0x1b waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=770.38ms elapsed=28.60s tid=0x0000564705ef36f0 nid=0x1c waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=49.37ms elapsed=28.60s tid=0x0000564705ef4b30 nid=0x1d runnable                                   
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.59s tid=0x0000564705f31960 nid=0x21 runnable                               
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.90ms elapsed=28.58s tid=0x0000564705f34ed0 nid=0x23 in Object.wait()                            
                             [0x00007f13bcb3e000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.55ms elapsed=28.46s tid=0x00005647060f2960 nid=0x27 waiting on condition                       
                             [0x00007f13be04b000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                 
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                           
                                     - parking to wait for  <0x000000008941b4e8> (a java.util.concurrent.SynchronousQueue$TransferStack)                                        
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                 
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                  
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                          
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                        
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                        
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                                                                                                                                                                
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.67ms elapsed=28.34s tid=0x00007f13a8000e70 nid=0x3d waiting on condition                       
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.24s tid=0x00005647066f8840 nid=0x29e in Object.wait()                               
                             [0x00007f13bc2d1000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "VM Thread" os_prio=0 cpu=55.28ms elapsed=28.61s tid=0x0000564705edf400 nid=0x15 runnable                                                          
                                                                                                                                                                                
                             "GC Thread#0" os_prio=0 cpu=50.56ms elapsed=28.63s tid=0x0000564705defda0 nid=0x14 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#1" os_prio=0 cpu=46.55ms elapsed=27.57s tid=0x00007f13b8001570 nid=0x5e runnable                                                        
                                                                                                                                                                                
                             "GC Thread#2" os_prio=0 cpu=50.22ms elapsed=27.57s tid=0x00007f13b8001f70 nid=0x5f runnable                                                        
                                                                                                                                                                                
                             "GC Thread#3" os_prio=0 cpu=50.65ms elapsed=27.57s tid=0x00007f13b8002970 nid=0x60 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#4" os_prio=0 cpu=39.19ms elapsed=27.57s tid=0x00007f13b8003370 nid=0x61 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#5" os_prio=0 cpu=43.76ms elapsed=27.57s tid=0x00007f13b8003d70 nid=0x62 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#6" os_prio=0 cpu=36.10ms elapsed=27.57s tid=0x00007f13b8004770 nid=0x63 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#7" os_prio=0 cpu=43.29ms elapsed=27.57s tid=0x00007f13b8005170 nid=0x64 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#8" os_prio=0 cpu=46.68ms elapsed=27.57s tid=0x00007f13b8005b70 nid=0x65 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#9" os_prio=0 cpu=49.54ms elapsed=27.57s tid=0x00007f13b8006570 nid=0x66 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#10" os_prio=0 cpu=46.36ms elapsed=27.57s tid=0x00007f13b8007360 nid=0x67 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#11" os_prio=0 cpu=50.18ms elapsed=27.57s tid=0x00007f13b8008150 nid=0x68 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#12" os_prio=0 cpu=50.19ms elapsed=27.57s tid=0x00007f13b8008f40 nid=0x69 runnable                                                       
                                                                                                                                                                                
                             "VM Periodic Task Thread" os_prio=0 cpu=11.35ms elapsed=28.59s tid=0x0000564705f33300 nid=0x22 waiting on condition                                
                                                                                                                                                                                
                             JNI global refs: 20, weak refs: 0                                                                                                                  
                                                                                                                                                                                
                                                                                                                                                                                
                             ===Evaluation Report===                                                                                                                            
                                                                                                                                                                                
                             ===Analysis Report===                                                                                                                              
                                                                                                                                                                                
                             ===Evaluation End===                                                                                                                               
[10/08/25 14:13:43] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                 __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                 
[10/08/25 14:15:18] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                 
[10/08/25 14:16:10] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                   __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                 
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:16:11] INFO     [logging_performance](pdfbox Setting owner) Took 0.90 seconds; exception=False                                               context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                             context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpf4xmt033                                                                                                default.py:173
[10/08/25 14:17:21] INFO     [logging_performance](pdfbox Patching) Took 69.72 seconds; exception=False                                                   context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                                                                       context_managers.py:9
[10/08/25 14:17:35] INFO     [logging_performance](pdfbox Checking build) Took 14.10 seconds; exception=False                                             context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                                                                          context_managers.py:9
[10/08/25 14:17:41] INFO     [logging_performance](pdfbox Running PoV) Took 5.89 seconds; exception=False                                                 context_managers.py:23
                    INFO     [logging_performance](pdfbox Testing) Started...                                                                              context_managers.py:9
                    INFO     [logging_performance](pdfbox Testing) Took 0.00 seconds; exception=False                                                     context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:17:42] INFO     [logging_performance](pdfbox Setting owner) Took 0.79 seconds; exception=False                                               context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:17:43] INFO     [logging_performance](pdfbox Setting owner) Took 0.81 seconds; exception=False                                               context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                        context_managers.py:9
[10/08/25 14:17:44] INFO     [logging_performance](pdfbox Setting owner) Took 0.88 seconds; exception=False                                               context_managers.py:23
[10/08/25 14:17:45] INFO     ===Evaluator Result===                                                                                                             evaluator.py:204
                             PatchStatus.SOUND                                                                                                                                  
                             ===Evaluator Diff===                                                                                                                               
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                              
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                              
                             @@ -214,12 +214,24 @@                                                                                                                              
                                          // 0 1 255 {1 index exch /.notdef put } for                                                                                           
                                          // we have to check "readonly" and "def" too                                                                                          
                                          // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                        
                             -            while (!(lexer.peekKind(Token.NAME)                                                                                                   
                             -                    && (lexer.peekToken().getText().equals("dup")                                                                                 
                             -                            || lexer.peekToken().getText().equals("readonly")                                                                     
                             -                            || lexer.peekToken().getText().equals("def"))))                                                                       
                             -            {                                                                                                                                     
                             +            // Skip tokens until we reach "dup", "readonly", or "def", or EOF                                                                     
                             +            Token token;                                                                                                                          
                             +            while ((token = lexer.peekToken()) != null)                                                                                           
                             +            {                                                                                                                                     
                             +                if (token.getKind() == Token.NAME)                                                                                                
                             +                {                                                                                                                                 
                             +                    String t = token.getText();                                                                                                   
                             +                    if ("dup".equals(t) || "readonly".equals(t) || "def".equals(t))                                                               
                             +                    {                                                                                                                             
                             +                        break;                                                                                                                    
                             +                    }                                                                                                                             
                             +                }                                                                                                                                 
                                              lexer.nextToken();                                                                                                                
                             +            }                                                                                                                                     
                             +            if (token == null)                                                                                                                    
                             +            {                                                                                                                                     
                             +                // Premature end of encoding definition; abort parsing                                                                            
                             +                throw new IOException("Unexpected end of encoding data");                                                                         
                                          }                                                                                                                                     
                                                                                                                                                                                
                                          Map<Integer, String> codeToName = new HashMap<>();                                                                                    
                                                                                                                                                                                
                             ===Patch Result===                                                                                                                                 
                                                                                                                                                                                
                             ===Issue===                                                                                                                                        
                             ERROR: libFuzzer: timeout                                                                                                                          
                             2025-10-08 14:13:26                                                                                                                                
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                       
                                                                                                                                                                                
                             Threads class SMR info:                                                                                                                            
                             _java_thread_list=0x00007f137825f520, length=14, elements={                                                                                        
                             0x0000564705dd8b70, 0x0000564705ee3bf0, 0x0000564705ee5000, 0x0000564705eee090,                                                                    
                             0x0000564705eef410, 0x0000564705ef07f0, 0x0000564705ef21f0, 0x0000564705ef36f0,                                                                    
                             0x0000564705ef4b30, 0x0000564705f31960, 0x0000564705f34ed0, 0x00005647060f2960,                                                                    
                             0x00007f13a8000e70, 0x00005647066f8840                                                                                                             
                             }                                                                                                                                                  
                                                                                                                                                                                
                             "main" #1 prio=5 os_prio=0 cpu=26460.52ms elapsed=28.65s tid=0x0000564705dd8b70 nid=0x13 runnable  [0x00007ffcdb573000]                            
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                       
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                      
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                       
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                 
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                         
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                     
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                 
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                         
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                     
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                            
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                               
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                        
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                 
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                   
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                           
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                              
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                       
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                    
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                             
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                  
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                          
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                          
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                       
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                              
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                
                                                                                                                                                                                
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.75ms elapsed=28.61s tid=0x0000564705ee3bf0 nid=0x16 waiting on condition                     
                             [0x00007f13be1ab000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                     
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                   
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                       
                                                                                                                                                                                
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.51ms elapsed=28.61s tid=0x0000564705ee5000 nid=0x17 in Object.wait()                                  
                             [0x00007f13bd7fe000]                                                                                                                               
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                             
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                           
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                        
                                                                                                                                                                                
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.42ms elapsed=28.60s tid=0x0000564705eee090 nid=0x18 waiting on condition                      
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.70ms elapsed=28.60s tid=0x0000564705eef410 nid=0x19 runnable                                     
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.64ms elapsed=28.60s tid=0x0000564705ef07f0 nid=0x1a runnable                           
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1953.98ms elapsed=28.60s tid=0x0000564705ef21f0 nid=0x1b waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=770.38ms elapsed=28.60s tid=0x0000564705ef36f0 nid=0x1c waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=49.37ms elapsed=28.60s tid=0x0000564705ef4b30 nid=0x1d runnable                                   
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.59s tid=0x0000564705f31960 nid=0x21 runnable                               
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.90ms elapsed=28.58s tid=0x0000564705f34ed0 nid=0x23 in Object.wait()                            
                             [0x00007f13bcb3e000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.55ms elapsed=28.46s tid=0x00005647060f2960 nid=0x27 waiting on condition                       
                             [0x00007f13be04b000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                 
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                           
                                     - parking to wait for  <0x000000008941b4e8> (a java.util.concurrent.SynchronousQueue$TransferStack)                                        
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                 
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                  
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                          
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                        
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                        
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                                                                                                                                                                
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.67ms elapsed=28.34s tid=0x00007f13a8000e70 nid=0x3d waiting on condition                       
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.24s tid=0x00005647066f8840 nid=0x29e in Object.wait()                               
                             [0x00007f13bc2d1000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "VM Thread" os_prio=0 cpu=55.28ms elapsed=28.61s tid=0x0000564705edf400 nid=0x15 runnable                                                          
                                                                                                                                                                                
                             "GC Thread#0" os_prio=0 cpu=50.56ms elapsed=28.63s tid=0x0000564705defda0 nid=0x14 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#1" os_prio=0 cpu=46.55ms elapsed=27.57s tid=0x00007f13b8001570 nid=0x5e runnable                                                        
                                                                                                                                                                                
                             "GC Thread#2" os_prio=0 cpu=50.22ms elapsed=27.57s tid=0x00007f13b8001f70 nid=0x5f runnable                                                        
                                                                                                                                                                                
                             "GC Thread#3" os_prio=0 cpu=50.65ms elapsed=27.57s tid=0x00007f13b8002970 nid=0x60 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#4" os_prio=0 cpu=39.19ms elapsed=27.57s tid=0x00007f13b8003370 nid=0x61 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#5" os_prio=0 cpu=43.76ms elapsed=27.57s tid=0x00007f13b8003d70 nid=0x62 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#6" os_prio=0 cpu=36.10ms elapsed=27.57s tid=0x00007f13b8004770 nid=0x63 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#7" os_prio=0 cpu=43.29ms elapsed=27.57s tid=0x00007f13b8005170 nid=0x64 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#8" os_prio=0 cpu=46.68ms elapsed=27.57s tid=0x00007f13b8005b70 nid=0x65 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#9" os_prio=0 cpu=49.54ms elapsed=27.57s tid=0x00007f13b8006570 nid=0x66 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#10" os_prio=0 cpu=46.36ms elapsed=27.57s tid=0x00007f13b8007360 nid=0x67 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#11" os_prio=0 cpu=50.18ms elapsed=27.57s tid=0x00007f13b8008150 nid=0x68 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#12" os_prio=0 cpu=50.19ms elapsed=27.57s tid=0x00007f13b8008f40 nid=0x69 runnable                                                       
                                                                                                                                                                                
                             "VM Periodic Task Thread" os_prio=0 cpu=11.35ms elapsed=28.59s tid=0x0000564705f33300 nid=0x22 waiting on condition                                
                                                                                                                                                                                
                             JNI global refs: 20, weak refs: 0                                                                                                                  
                                                                                                                                                                                
                                                                                                                                                                                
                             ===Evaluation Report===                                                                                                                            
                             # Evaluation Report                                                                                                                                
                                                                                                                                                                                
                             ## Summary                                                                                                                                         
                                                                                                                                                                                
                             A libFuzzer run using Jazzer on the `PDFExtractTextFuzzer` harness timed out after ~28 seconds. The main thread remains runnable                   
                             and appears to be stuck in the Type1 font parsing logic of Apache PDFBox, specifically within `Type1Lexer.readToken` invoked                       
                             through instrumentation callbacks. No crash or exception is reportedonly a timeout.                                                               
                                                                                                                                                                                
                             ## Description                                                                                                                                     
                                                                                                                                                                                
                             - Issue type: Fuzzer timeout (hang), which may indicate an infinite loop or excessively long processing path rather than a crash.                  
                             - Fuzzer entry point:                                                                                                                              
                               - `com.example.PDFExtractTextFuzzer.fuzzerTestOneInput`                                                                                          
                               - Internally calls `PDFTextStripper.getText` on a PDF document.                                                                                  
                             - Thread dump highlights:                                                                                                                          
                               - **Main thread** (#1) is RUNNABLE and spending CPU time in                                                                                      
                                 `com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)`                                            
                                 then `org.apache.fontbox.type1.Type1Lexer.readToken`  `Type1Parser.readEncoding`  `Type1Parser.parseASCII`                                  
                             `Type1Font.createWithPFB`  font creation and PDF text extraction.                                                                                 
                               - The stack shows repeated calls through PDFBoxs font and textprocessing pipeline, suggesting the parser is not making forward                 
                             progress on the fuzzers input.                                                                                                                    
                             - No other threads are blocking the main thread; all background threads (GC, Finalizer, Cleaner, etc.) are in normal waiting or                    
                             runnable states.                                                                                                                                   
                             - The harness code itself simply feeds arbitrary input to PDFBox; it is not the root cause but the trigger for exercising the font                 
                             parsing logic.                                                                                                                                     
                             - Key observations:                                                                                                                                
                               - The hang occurs during Type1 font tokenization/parsing.                                                                                        
                               - Jazzer instrumentation (`traceConstCmpInt`) is active but likely only observing comparisons, not altering control flow.                        
                             - Areas to investigate for a complete picture:                                                                                                     
                               - `org.apache.fontbox.type1.Type1Lexer` and its `readToken`/`nextToken` methods.                                                                 
                               - `org.apache.fontbox.type1.Type1Parser` methods, especially `readEncoding`, `parseASCII`, and overall loop/control logic.                       
                               - PDFBox font factory and resource resolution (`PDType1Font`, `PDFontFactory`, `PDResources.getFont`).                                           
                               - PDFTextStrippers page and stream engine (`SetFontAndSize.process`, `PDFStreamEngine.processPage`).                                            
                               - Any dataflow or instrumentation hooks in Jazzer that might interact with tight loops or buffers in the font parser.                           
                                                                                                                                                                                
                             ## Initial Issue Log                                                                                                                               
                             Here is the initial issue log of the codebase:                                                                                                     
                             <issue>                                                                                                                                            
                             ERROR: libFuzzer: timeout                                                                                                                          
                             2025-10-08 14:13:26                                                                                                                                
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                       
                                                                                                                                                                                
                             Threads class SMR info:                                                                                                                            
                             _java_thread_list=0x00007f137825f520, length=14, elements={                                                                                        
                             0x0000564705dd8b70, 0x0000564705ee3bf0, 0x0000564705ee5000, 0x0000564705eee090,                                                                    
                             0x0000564705eef410, 0x0000564705ef07f0, 0x0000564705ef21f0, 0x0000564705ef36f0,                                                                    
                             0x0000564705ef4b30, 0x0000564705f31960, 0x0000564705f34ed0, 0x00005647060f2960,                                                                    
                             0x00007f13a8000e70, 0x00005647066f8840                                                                                                             
                             }                                                                                                                                                  
                                                                                                                                                                                
                             "main" #1 prio=5 os_prio=0 cpu=26460.52ms elapsed=28.65s tid=0x0000564705dd8b70 nid=0x13 runnable  [0x00007ffcdb573000]                            
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                       
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                      
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                       
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                 
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                   
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                         
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                     
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                 
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                         
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                     
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                            
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                               
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                        
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                 
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                   
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                           
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                              
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                       
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                    
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                             
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                  
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                          
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                          
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                       
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                              
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                
                                                                                                                                                                                
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.75ms elapsed=28.61s tid=0x0000564705ee3bf0 nid=0x16 waiting on condition                     
                             [0x00007f13be1ab000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                     
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                   
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                       
                                                                                                                                                                                
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.51ms elapsed=28.61s tid=0x0000564705ee5000 nid=0x17 in Object.wait()                                  
                             [0x00007f13bd7fe000]                                                                                                                               
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                             
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x000000008941b0b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                           
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                        
                                                                                                                                                                                
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.42ms elapsed=28.60s tid=0x0000564705eee090 nid=0x18 waiting on condition                      
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.70ms elapsed=28.60s tid=0x0000564705eef410 nid=0x19 runnable                                     
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.64ms elapsed=28.60s tid=0x0000564705ef07f0 nid=0x1a runnable                           
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1953.98ms elapsed=28.60s tid=0x0000564705ef21f0 nid=0x1b waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=770.38ms elapsed=28.60s tid=0x0000564705ef36f0 nid=0x1c waiting on condition                  
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                No compile task                                                                                                                                 
                                                                                                                                                                                
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=49.37ms elapsed=28.60s tid=0x0000564705ef4b30 nid=0x1d runnable                                   
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.16ms elapsed=28.59s tid=0x0000564705f31960 nid=0x21 runnable                               
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.90ms elapsed=28.58s tid=0x0000564705f34ed0 nid=0x23 in Object.wait()                            
                             [0x00007f13bcb3e000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000894250b0> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.55ms elapsed=28.46s tid=0x00005647060f2960 nid=0x27 waiting on condition                       
                             [0x00007f13be04b000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                 
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                           
                                     - parking to wait for  <0x000000008941b4e8> (a java.util.concurrent.SynchronousQueue$TransferStack)                                        
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                 
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                  
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                          
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                        
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                        
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                                                                                                                                                                
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.67ms elapsed=28.34s tid=0x00007f13a8000e70 nid=0x3d waiting on condition                       
                             [0x0000000000000000]                                                                                                                               
                                java.lang.Thread.State: RUNNABLE                                                                                                                
                                                                                                                                                                                
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.24s tid=0x00005647066f8840 nid=0x29e in Object.wait()                               
                             [0x00007f13bc2d1000]                                                                                                                               
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                       
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                   
                                     - waiting on <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                    
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                           
                                     - locked <0x00000000f6428178> (a java.lang.ref.ReferenceQueue$Lock)                                                                        
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                 
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                  
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                        
                                                                                                                                                                                
                             "VM Thread" os_prio=0 cpu=55.28ms elapsed=28.61s tid=0x0000564705edf400 nid=0x15 runnable                                                          
                                                                                                                                                                                
                             "GC Thread#0" os_prio=0 cpu=50.56ms elapsed=28.63s tid=0x0000564705defda0 nid=0x14 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#1" os_prio=0 cpu=46.55ms elapsed=27.57s tid=0x00007f13b8001570 nid=0x5e runnable                                                        
                                                                                                                                                                                
                             "GC Thread#2" os_prio=0 cpu=50.22ms elapsed=27.57s tid=0x00007f13b8001f70 nid=0x5f runnable                                                        
                                                                                                                                                                                
                             "GC Thread#3" os_prio=0 cpu=50.65ms elapsed=27.57s tid=0x00007f13b8002970 nid=0x60 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#4" os_prio=0 cpu=39.19ms elapsed=27.57s tid=0x00007f13b8003370 nid=0x61 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#5" os_prio=0 cpu=43.76ms elapsed=27.57s tid=0x00007f13b8003d70 nid=0x62 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#6" os_prio=0 cpu=36.10ms elapsed=27.57s tid=0x00007f13b8004770 nid=0x63 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#7" os_prio=0 cpu=43.29ms elapsed=27.57s tid=0x00007f13b8005170 nid=0x64 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#8" os_prio=0 cpu=46.68ms elapsed=27.57s tid=0x00007f13b8005b70 nid=0x65 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#9" os_prio=0 cpu=49.54ms elapsed=27.57s tid=0x00007f13b8006570 nid=0x66 runnable                                                        
                                                                                                                                                                                
                             "GC Thread#10" os_prio=0 cpu=46.36ms elapsed=27.57s tid=0x00007f13b8007360 nid=0x67 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#11" os_prio=0 cpu=50.18ms elapsed=27.57s tid=0x00007f13b8008150 nid=0x68 runnable                                                       
                                                                                                                                                                                
                             "GC Thread#12" os_prio=0 cpu=50.19ms elapsed=27.57s tid=0x00007f13b8008f40 nid=0x69 runnable                                                       
                                                                                                                                                                                
                             "VM Periodic Task Thread" os_prio=0 cpu=11.35ms elapsed=28.59s tid=0x0000564705f33300 nid=0x22 waiting on condition                                
                                                                                                                                                                                
                             JNI global refs: 20, weak refs: 0                                                                                                                  
                                                                                                                                                                                
                                                                                                                                                                                
                             </issue>                                                                                                                                           
                             ===Analysis Report===                                                                                                                              
                             # Analysis Report                                                                                                                                  
                                                                                                                                                                                
                             ## Relevant Code Snippets                                                                                                                          
                             <code_snippets>                                                                                                                                    
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-50                                                                                
                             ```                                                                                                                                                
                             1:/*                                                                                                                                               
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                                                                    
                             3: * or more contributor license agreements.  See the NOTICE file                                                                                  
                             4: * distributed with this work for additional information                                                                                         
                             5: * regarding copyright ownership.  The ASF licenses this file                                                                                    
                             6: * to you under the Apache License, Version 2.0 (the                                                                                             
                             7: * "License"); you may not use this file except in compliance                                                                                    
                             8: * with the License.  You may obtain a copy of the License at                                                                                    
                             9: *                                                                                                                                               
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                                                                   
                             11: *                                                                                                                                              
                             12: * Unless required by applicable law or agreed to in writing,                                                                                   
                             13: * software distributed under the License is distributed on an                                                                                  
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                                                                       
                             15: * KIND, either express or implied.  See the License for the                                                                                    
                             16: * specific language governing permissions and limitations                                                                                      
                             17: * under the License.                                                                                                                           
                             18: */                                                                                                                                             
                             19:                                                                                                                                                
                             20:package org.apache.fontbox.type1;                                                                                                               
                             21:                                                                                                                                                
                             22:import java.io.IOException;                                                                                                                     
                             23:import java.nio.BufferUnderflowException;                                                                                                       
                             24:import java.nio.ByteBuffer;                                                                                                                     
                             25:import org.apache.logging.log4j.Logger;                                                                                                         
                             26:import org.apache.logging.log4j.LogManager;                                                                                                     
                             27:/**                                                                                                                                             
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                                                                        
                             29: *                                                                                                                                              
                             30: * @see Type1Parser                                                                                                                             
                             31: *                                                                                                                                              
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                                                                           
                             33: * somewhat awkward lexical structure. It is neither regular nor                                                                                
                             34: * context-free, and the execution of the program can modify the                                                                                
                             35: * the behaviour of the lexer/parser.                                                                                                           
                             36: *                                                                                                                                              
                             37: * Nevertheless, this class represents an attempt to artificially separate                                                                      
                             38: * the PostScript parsing process into separate lexing and parsing phases                                                                       
                             39: * in order to reduce the complexity of the parsing phase.                                                                                      
                             40: *                                                                                                                                              
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                                                            
                             42: *                                                                                                                                              
                             43: * @author John Hewson                                                                                                                          
                             44: */                                                                                                                                             
                             45:class Type1Lexer                                                                                                                                
                             46:{                                                                                                                                               
                             47:    /**                                                                                                                                         
                             48:     * Log instance.                                                                                                                            
                             49:     */                                                                                                                                         
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                                                                   
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:100-160                                                                             
                             ```                                                                                                                                                
                             100:     */                                                                                                                                        
                             101:    private char getChar() throws IOException                                                                                                  
                             102:    {                                                                                                                                          
                             103:        try                                                                                                                                    
                             104:        {                                                                                                                                      
                             105:            return (char) buffer.get();                                                                                                        
                             106:        }                                                                                                                                      
                             107:        catch (BufferUnderflowException exception)                                                                                             
                             108:        {                                                                                                                                      
                             109:            throw new IOException("Premature end of buffer reached");                                                                          
                             110:        }                                                                                                                                      
                             111:    }                                                                                                                                          
                             112:                                                                                                                                               
                             113:    /**                                                                                                                                        
                             114:     * Reads a single token.                                                                                                                   
                             115:     * @param prevToken the previous token                                                                                                     
                             116:     */                                                                                                                                        
                             117:    private Token readToken(Token prevToken) throws IOException                                                                                
                             118:    {                                                                                                                                          
                             119:        boolean skip;                                                                                                                          
                             120:        do                                                                                                                                     
                             121:        {                                                                                                                                      
                             122:            skip = false;                                                                                                                      
                             123:            while (buffer.hasRemaining())                                                                                                      
                             124:            {                                                                                                                                  
                             125:                char c = getChar();                                                                                                            
                             126:                                                                                                                                               
                             127:                // delimiters                                                                                                                  
                             128:                if (c == '%')                                                                                                                  
                             129:                {                                                                                                                              
                             130:                    // comment                                                                                                                 
                             131:                    readComment();                                                                                                             
                             132:                }                                                                                                                              
                             133:                else if (c == '(')                                                                                                             
                             134:                {                                                                                                                              
                             135:                    return readString();                                                                                                       
                             136:                }                                                                                                                              
                             137:                else if (c == ')')                                                                                                             
                             138:                {                                                                                                                              
                             139:                    // not allowed outside a string context                                                                                    
                             140:                    throw new IOException("unexpected closing parenthesis");                                                                   
                             141:                }                                                                                                                              
                             142:                else if (c == '[')                                                                                                             
                             143:                {                                                                                                                              
                             144:                    return new Token(c, Token.START_ARRAY);                                                                                    
                             145:                }                                                                                                                              
                             146:                else if (c == '{')                                                                                                             
                             147:                {                                                                                                                              
                             148:                    return new Token(c, Token.START_PROC);                                                                                     
                             149:                }                                                                                                                              
                             150:                else if (c == ']')                                                                                                             
                             151:                {                                                                                                                              
                             152:                    return new Token(c, Token.END_ARRAY);                                                                                      
                             153:                }                                                                                                                              
                             154:                else if (c == '}')                                                                                                             
                             155:                {                                                                                                                              
                             156:                    return new Token(c, Token.END_PROC);                                                                                       
                             157:                }                                                                                                                              
                             158:                else if (c == '/')                                                                                                             
                             159:                {                                                                                                                              
                             160:                    String regular = readRegular();                                                                                            
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:160-240                                                                             
                             ```                                                                                                                                                
                             160:                    String regular = readRegular();                                                                                            
                             161:                    if (regular == null)                                                                                                       
                             162:                    {                                                                                                                          
                             163:                        // the stream is corrupt                                                                                               
                             164:                        throw new DamagedFontException("Could not read token at position " +                                                   
                             165:                                                        buffer.position());                                                                    
                             166:                    }                                                                                                                          
                             167:                    return new Token(regular, Token.LITERAL);                                                                                  
                             168:                }                                                                                                                              
                             169:                else if (c == '<')                                                                                                             
                             170:                {                                                                                                                              
                             171:                    char c2 = getChar();                                                                                                       
                             172:                    if (c2 == c)                                                                                                               
                             173:                    {                                                                                                                          
                             174:                        return new Token("<<", Token.START_DICT);                                                                              
                             175:                    }                                                                                                                          
                             176:                    else                                                                                                                       
                             177:                    {                                                                                                                          
                             178:                        // code may have to be changed in something better, maybe new token type                                               
                             179:                        buffer.position(buffer.position() - 1);                                                                                
                             180:                        return new Token(c, Token.NAME);                                                                                       
                             181:                    }                                                                                                                          
                             182:                }                                                                                                                              
                             183:                else if (c == '>')                                                                                                             
                             184:                {                                                                                                                              
                             185:                    char c2 = getChar();                                                                                                       
                             186:                    if (c2 == c)                                                                                                               
                             187:                    {                                                                                                                          
                             188:                        return new Token(">>", Token.END_DICT);                                                                                
                             189:                    }                                                                                                                          
                             190:                    else                                                                                                                       
                             191:                    {                                                                                                                          
                             192:                        // code may have to be changed in something better, maybe new token type                                               
                             193:                        buffer.position(buffer.position() - 1);                                                                                
                             194:                        return new Token(c, Token.NAME);                                                                                       
                             195:                    }                                                                                                                          
                             196:                }                                                                                                                              
                             197:                else if (Character.isWhitespace(c))                                                                                            
                             198:                {                                                                                                                              
                             199:                    skip = true;                                                                                                               
                             200:                }                                                                                                                              
                             201:                else if (c == 0)                                                                                                               
                             202:                {                                                                                                                              
                             203:                    LOG.warn("NULL byte in font, skipped");                                                                                    
                             204:                    skip = true;                                                                                                               
                             205:                }                                                                                                                              
                             206:                else                                                                                                                           
                             207:                {                                                                                                                              
                             208:                    buffer.position(buffer.position() -1);                                                                                     
                             209:                                                                                                                                               
                             210:                    // regular character: try parse as number                                                                                  
                             211:                    Token number = tryReadNumber();                                                                                            
                             212:                    if (number != null)                                                                                                        
                             213:                    {                                                                                                                          
                             214:                        return number;                                                                                                         
                             215:                    }                                                                                                                          
                             216:                    else                                                                                                                       
                             217:                    {                                                                                                                          
                             218:                        // otherwise this must be a name                                                                                       
                             219:                        String name = readRegular();                                                                                           
                             220:                        if (name == null)                                                                                                      
                             221:                        {                                                                                                                      
                             222:                            // the stream is corrupt                                                                                           
                             223:                            throw new DamagedFontException("Could not read token at position " +                                               
                             224:                                                           buffer.position());                                                                 
                             225:                        }                                                                                                                      
                             226:                                                                                                                                               
                             227:                        if (name.equals("RD") || name.equals("-|"))                                                                            
                             228:                        {                                                                                                                      
                             229:                            // return the next CharString instead                                                                              
                             230:                            if (prevToken != null && prevToken.getKind() == Token.INTEGER)                                                     
                             231:                            {                                                                                                                  
                             232:                                return readCharString(prevToken.intValue());                                                                   
                             233:                            }                                                                                                                  
                             234:                            else                                                                                                               
                             235:                            {                                                                                                                  
                             236:                                throw new IOException("expected INTEGER before -| or RD");                                                     
                             237:                            }                                                                                                                  
                             238:                        }                                                                                                                      
                             239:                        else                                                                                                                   
                             240:                        {                                                                                                                      
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:1-100                                                                              
                             ```                                                                                                                                                
                             1:/*                                                                                                                                               
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                            
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                         
                             4: * this work for additional information regarding copyright ownership.                                                                           
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                       
                             6: * (the "License"); you may not use this file except in compliance with                                                                          
                             7: * the License.  You may obtain a copy of the License at                                                                                         
                             8: *                                                                                                                                               
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                               
                             10: *                                                                                                                                              
                             11: * Unless required by applicable law or agreed to in writing, software                                                                          
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                            
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                     
                             14: * See the License for the specific language governing permissions and                                                                          
                             15: * limitations under the License.                                                                                                               
                             16: */                                                                                                                                             
                             17:                                                                                                                                                
                             18:package org.apache.fontbox.type1;                                                                                                               
                             19:                                                                                                                                                
                             20:import org.apache.fontbox.encoding.BuiltInEncoding;                                                                                             
                             21:import org.apache.fontbox.encoding.StandardEncoding;                                                                                            
                             22:                                                                                                                                                
                             23:import java.io.IOException;                                                                                                                     
                             24:import java.util.ArrayList;                                                                                                                     
                             25:import java.util.HashMap;                                                                                                                       
                             26:import java.util.List;                                                                                                                          
                             27:import java.util.Map;                                                                                                                           
                             28:                                                                                                                                                
                             29:/**                                                                                                                                             
                             30: * Parses an Adobe Type 1 (.pfb) font. It is used exclusively by Type1Font.                                                                     
                             31: *                                                                                                                                              
                             32: * The Type 1 font format is a free-text format which is somewhat difficult                                                                     
                             33: * to parse. This is made worse by the fact that many Type 1 font files do                                                                      
                             34: * not conform to the specification, especially those embedded in PDFs. This                                                                    
                             35: * parser therefore tries to be as forgiving as possible.                                                                                       
                             36: *                                                                                                                                              
                             37: * @see "Adobe Type 1 Font Format, Adobe Systems (1999)"                                                                                        
                             38: *                                                                                                                                              
                             39: * @author John Hewson                                                                                                                          
                             40: */                                                                                                                                             
                             41:final class Type1Parser                                                                                                                         
                             42:{                                                                                                                                               
                             43:    // constants for encryption                                                                                                                 
                             44:    private static final int EEXEC_KEY = 55665;                                                                                                 
                             45:    private static final int CHARSTRING_KEY = 4330;                                                                                             
                             46:                                                                                                                                                
                             47:    // state                                                                                                                                    
                             48:    private Type1Lexer lexer;                                                                                                                   
                             49:    private Type1Font font;                                                                                                                     
                             50:                                                                                                                                                
                             51:    /**                                                                                                                                         
                             52:     * Parses a Type 1 font and returns a Type1Font class which represents it.                                                                  
                             53:     *                                                                                                                                          
                             54:     * @param segment1 Segment 1: ASCII                                                                                                         
                             55:     * @param segment2 Segment 2: Binary                                                                                                        
                             56:     * @throws IOException                                                                                                                      
                             57:     */                                                                                                                                         
                             58:    public Type1Font parse(byte[] segment1, byte[] segment2) throws IOException                                                                 
                             59:    {                                                                                                                                           
                             60:        font = new Type1Font(segment1, segment2);                                                                                               
                             61:        try                                                                                                                                     
                             62:        {                                                                                                                                       
                             63:            parseASCII(segment1);                                                                                                               
                             64:        }                                                                                                                                       
                             65:        catch (NumberFormatException ex)                                                                                                        
                             66:        {                                                                                                                                       
                             67:            throw new IOException(ex);                                                                                                          
                             68:        }                                                                                                                                       
                             69:        if (segment2.length > 0)                                                                                                                
                             70:        {                                                                                                                                       
                             71:            parseBinary(segment2);                                                                                                              
                             72:        }                                                                                                                                       
                             73:        return font;                                                                                                                            
                             74:    }                                                                                                                                           
                             75:                                                                                                                                                
                             76:    /**                                                                                                                                         
                             77:     * Parses the ASCII portion of a Type 1 font.                                                                                               
                             78:     */                                                                                                                                         
                             79:    private void parseASCII(byte[] bytes) throws IOException                                                                                    
                             80:    {                                                                                                                                           
                             81:        if (bytes.length == 0)                                                                                                                  
                             82:        {                                                                                                                                       
                             83:            throw new IOException("ASCII segment of type 1 font is empty");                                                                     
                             84:        }                                                                                                                                       
                             85:                                                                                                                                                
                             86:        // %!FontType1-1.0                                                                                                                      
                             87:        // %!PS-AdobeFont-1.0                                                                                                                   
                             88:        if (bytes.length < 2 || (bytes[0] != '%' && bytes[1] != '!'))                                                                           
                             89:        {                                                                                                                                       
                             90:            throw new IOException("Invalid start of ASCII segment of type 1 font");                                                             
                             91:        }                                                                                                                                       
                             92:                                                                                                                                                
                             93:        lexer = new Type1Lexer(bytes);                                                                                                          
                             94:                                                                                                                                                
                             95:        // (corrupt?) synthetic font                                                                                                            
                             96:        if ("FontDirectory".equals(lexer.peekToken().getText()))                                                                                
                             97:        {                                                                                                                                       
                             98:            read(Token.NAME, "FontDirectory");                                                                                                  
                             99:            read(Token.LITERAL); // font name                                                                                                   
                             100:            read(Token.NAME, "known");                                                                                                         
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:100-200                                                                            
                             ```                                                                                                                                                
                             100:            read(Token.NAME, "known");                                                                                                         
                             101:            read(Token.START_PROC);                                                                                                            
                             102:            readProcVoid();                                                                                                                    
                             103:            read(Token.START_PROC);                                                                                                            
                             104:            readProcVoid();                                                                                                                    
                             105:            read(Token.NAME, "ifelse");                                                                                                        
                             106:        }                                                                                                                                      
                             107:                                                                                                                                               
                             108:        // font dict                                                                                                                           
                             109:        int length = read(Token.INTEGER).intValue();                                                                                           
                             110:        read(Token.NAME, "dict");                                                                                                              
                             111:        // found in some TeX fonts                                                                                                             
                             112:        readMaybe(Token.NAME, "dup");                                                                                                          
                             113:        // if present, the "currentdict" is not required                                                                                       
                             114:        read(Token.NAME, "begin");                                                                                                             
                             115:                                                                                                                                               
                             116:        for (int i = 0; i < length; i++)                                                                                                       
                             117:        {                                                                                                                                      
                             118:            // premature end                                                                                                                   
                             119:            Token token = lexer.peekToken();                                                                                                   
                             120:            if (token == null)                                                                                                                 
                             121:            {                                                                                                                                  
                             122:                break;                                                                                                                         
                             123:            }                                                                                                                                  
                             124:            if (token.getKind() == Token.NAME &&                                                                                               
                             125:                ("currentdict".equals(token.getText()) || "end".equals(token.getText())))                                                      
                             126:            {                                                                                                                                  
                             127:                break;                                                                                                                         
                             128:            }                                                                                                                                  
                             129:                                                                                                                                               
                             130:            // key/value                                                                                                                       
                             131:            String key = read(Token.LITERAL).getText();                                                                                        
                             132:            switch (key)                                                                                                                       
                             133:            {                                                                                                                                  
                             134:                case "FontInfo":                                                                                                               
                             135:                case "Fontinfo":                                                                                                               
                             136:                    readFontInfo(readSimpleDict());                                                                                            
                             137:                    break;                                                                                                                     
                             138:                case "Metrics":                                                                                                                
                             139:                    readSimpleDict();                                                                                                          
                             140:                    break;                                                                                                                     
                             141:                case "Encoding":                                                                                                               
                             142:                    readEncoding();                                                                                                            
                             143:                    break;                                                                                                                     
                             144:                default:                                                                                                                       
                             145:                    readSimpleValue(key);                                                                                                      
                             146:                    break;                                                                                                                     
                             147:            }                                                                                                                                  
                             148:        }                                                                                                                                      
                             149:                                                                                                                                               
                             150:        readMaybe(Token.NAME, "currentdict");                                                                                                  
                             151:        read(Token.NAME, "end");                                                                                                               
                             152:                                                                                                                                               
                             153:        read(Token.NAME, "currentfile");                                                                                                       
                             154:        read(Token.NAME, "eexec");                                                                                                             
                             155:    }                                                                                                                                          
                             156:                                                                                                                                               
                             157:    private void readSimpleValue(String key) throws IOException                                                                                
                             158:    {                                                                                                                                          
                             159:        List<Token> value = readDictValue();                                                                                                   
                             160:                                                                                                                                               
                             161:        switch (key)                                                                                                                           
                             162:        {                                                                                                                                      
                             163:            case "FontName":                                                                                                                   
                             164:                font.fontName = value.get(0).getText();                                                                                        
                             165:                break;                                                                                                                         
                             166:            case "PaintType":                                                                                                                  
                             167:                font.paintType = value.get(0).intValue();                                                                                      
                             168:                break;                                                                                                                         
                             169:            case "FontType":                                                                                                                   
                             170:                font.fontType = value.get(0).intValue();                                                                                       
                             171:                break;                                                                                                                         
                             172:            case "FontMatrix":                                                                                                                 
                             173:                font.fontMatrix = arrayToNumbers(value);                                                                                       
                             174:                break;                                                                                                                         
                             175:            case "FontBBox":                                                                                                                   
                             176:                font.fontBBox = arrayToNumbers(value);                                                                                         
                             177:                break;                                                                                                                         
                             178:            case "UniqueID":                                                                                                                   
                             179:                font.uniqueID = value.get(0).intValue();                                                                                       
                             180:                break;                                                                                                                         
                             181:            case "StrokeWidth":                                                                                                                
                             182:                font.strokeWidth = value.get(0).floatValue();                                                                                  
                             183:                break;                                                                                                                         
                             184:            case "FID":                                                                                                                        
                             185:                font.fontID = value.get(0).getText();                                                                                          
                             186:                break;                                                                                                                         
                             187:            default:                                                                                                                           
                             188:                break;                                                                                                                         
                             189:        }                                                                                                                                      
                             190:    }                                                                                                                                          
                             191:                                                                                                                                               
                             192:    private void readEncoding() throws IOException                                                                                             
                             193:    {                                                                                                                                          
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                        
                             195:        {                                                                                                                                      
                             196:            String name = lexer.nextToken().getText();                                                                                         
                             197:                                                                                                                                               
                             198:            if (name.equals("StandardEncoding"))                                                                                               
                             199:            {                                                                                                                                  
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                     
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-120                                                                               
                             ```                                                                                                                                                
                             1:/*                                                                                                                                               
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                                                                    
                             3: * or more contributor license agreements.  See the NOTICE file                                                                                  
                             4: * distributed with this work for additional information                                                                                         
                             5: * regarding copyright ownership.  The ASF licenses this file                                                                                    
                             6: * to you under the Apache License, Version 2.0 (the                                                                                             
                             7: * "License"); you may not use this file except in compliance                                                                                    
                             8: * with the License.  You may obtain a copy of the License at                                                                                    
                             9: *                                                                                                                                               
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                                                                   
                             11: *                                                                                                                                              
                             12: * Unless required by applicable law or agreed to in writing,                                                                                   
                             13: * software distributed under the License is distributed on an                                                                                  
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                                                                       
                             15: * KIND, either express or implied.  See the License for the                                                                                    
                             16: * specific language governing permissions and limitations                                                                                      
                             17: * under the License.                                                                                                                           
                             18: */                                                                                                                                             
                             19:                                                                                                                                                
                             20:package org.apache.fontbox.type1;                                                                                                               
                             21:                                                                                                                                                
                             22:import java.io.IOException;                                                                                                                     
                             23:import java.nio.BufferUnderflowException;                                                                                                       
                             24:import java.nio.ByteBuffer;                                                                                                                     
                             25:import org.apache.logging.log4j.Logger;                                                                                                         
                             26:import org.apache.logging.log4j.LogManager;                                                                                                     
                             27:/**                                                                                                                                             
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                                                                        
                             29: *                                                                                                                                              
                             30: * @see Type1Parser                                                                                                                             
                             31: *                                                                                                                                              
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                                                                           
                             33: * somewhat awkward lexical structure. It is neither regular nor                                                                                
                             34: * context-free, and the execution of the program can modify the                                                                                
                             35: * the behaviour of the lexer/parser.                                                                                                           
                             36: *                                                                                                                                              
                             37: * Nevertheless, this class represents an attempt to artificially separate                                                                      
                             38: * the PostScript parsing process into separate lexing and parsing phases                                                                       
                             39: * in order to reduce the complexity of the parsing phase.                                                                                      
                             40: *                                                                                                                                              
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                                                            
                             42: *                                                                                                                                              
                             43: * @author John Hewson                                                                                                                          
                             44: */                                                                                                                                             
                             45:class Type1Lexer                                                                                                                                
                             46:{                                                                                                                                               
                             47:    /**                                                                                                                                         
                             48:     * Log instance.                                                                                                                            
                             49:     */                                                                                                                                         
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                                                                   
                             51:                                                                                                                                                
                             52:    private final ByteBuffer buffer;                                                                                                            
                             53:    private Token aheadToken;                                                                                                                   
                             54:    private int openParens = 0;                                                                                                                 
                             55:                                                                                                                                                
                             56:    /**                                                                                                                                         
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                                                            
                             58:     * @param bytes Header-less .pfb segment                                                                                                    
                             59:     * @throws IOException                                                                                                                      
                             60:     */                                                                                                                                         
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                                                                 
                             62:    {                                                                                                                                           
                             63:        buffer = ByteBuffer.wrap(bytes);                                                                                                        
                             64:        aheadToken = readToken(null);                                                                                                           
                             65:    }                                                                                                                                           
                             66:                                                                                                                                                
                             67:    /**                                                                                                                                         
                             68:     * Returns the next token and consumes it.                                                                                                  
                             69:     * @return The next token.                                                                                                                  
                             70:     */                                                                                                                                         
                             71:    public Token nextToken() throws IOException                                                                                                 
                             72:    {                                                                                                                                           
                             73:        Token curToken = aheadToken;                                                                                                            
                             74:        //System.out.println(curToken); // for debugging                                                                                        
                             75:        aheadToken = readToken(curToken);                                                                                                       
                             76:        return curToken;                                                                                                                        
                             77:    }                                                                                                                                           
                             78:                                                                                                                                                
                             79:    /**                                                                                                                                         
                             80:     * Returns the next token without consuming it.                                                                                             
                             81:     * @return The next token                                                                                                                   
                             82:     */                                                                                                                                         
                             83:    public Token peekToken()                                                                                                                    
                             84:    {                                                                                                                                           
                             85:        return aheadToken;                                                                                                                      
                             86:    }                                                                                                                                           
                             87:                                                                                                                                                
                             88:    /**                                                                                                                                         
                             89:     * Checks if the kind of the next token equals the given one without consuming it.                                                          
                             90:     *                                                                                                                                          
                             91:     * @return true if the kind of the next token equals the given one                                                                          
                             92:     */                                                                                                                                         
                             93:    public boolean peekKind(Token.Kind kind)                                                                                                    
                             94:    {                                                                                                                                           
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                                                              
                             96:    }                                                                                                                                           
                             97:                                                                                                                                                
                             98:    /**                                                                                                                                         
                             99:     * Reads an ASCII char from the buffer.                                                                                                     
                             100:     */                                                                                                                                        
                             101:    private char getChar() throws IOException                                                                                                  
                             102:    {                                                                                                                                          
                             103:        try                                                                                                                                    
                             104:        {                                                                                                                                      
                             105:            return (char) buffer.get();                                                                                                        
                             106:        }                                                                                                                                      
                             107:        catch (BufferUnderflowException exception)                                                                                             
                             108:        {                                                                                                                                      
                             109:            throw new IOException("Premature end of buffer reached");                                                                          
                             110:        }                                                                                                                                      
                             111:    }                                                                                                                                          
                             112:                                                                                                                                               
                             113:    /**                                                                                                                                        
                             114:     * Reads a single token.                                                                                                                   
                             115:     * @param prevToken the previous token                                                                                                     
                             116:     */                                                                                                                                        
                             117:    private Token readToken(Token prevToken) throws IOException                                                                                
                             118:    {                                                                                                                                          
                             119:        boolean skip;                                                                                                                          
                             120:        do                                                                                                                                     
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Token.java:1-140                                                                                    
                             ```                                                                                                                                                
                             1:/*                                                                                                                                               
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                            
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                         
                             4: * this work for additional information regarding copyright ownership.                                                                           
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                       
                             6: * (the "License"); you may not use this file except in compliance with                                                                          
                             7: * the License.  You may obtain a copy of the License at                                                                                         
                             8: *                                                                                                                                               
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                               
                             10: *                                                                                                                                              
                             11: * Unless required by applicable law or agreed to in writing, software                                                                          
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                            
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                     
                             14: * See the License for the specific language governing permissions and                                                                          
                             15: * limitations under the License.                                                                                                               
                             16: */                                                                                                                                             
                             17:                                                                                                                                                
                             18:package org.apache.fontbox.type1;                                                                                                               
                             19:                                                                                                                                                
                             20:/**                                                                                                                                             
                             21: * A lexical token in an Adobe Type 1 font.                                                                                                     
                             22: *                                                                                                                                              
                             23: * @see Type1Lexer                                                                                                                              
                             24: *                                                                                                                                              
                             25: * @author John Hewson                                                                                                                          
                             26: */                                                                                                                                             
                             27:class Token                                                                                                                                     
                             28:{                                                                                                                                               
                             29:    /**                                                                                                                                         
                             30:     * All different types of tokens.                                                                                                           
                             31:     *                                                                                                                                          
                             32:     */                                                                                                                                         
                             33:    enum Kind                                                                                                                                   
                             34:    {                                                                                                                                           
                             35:        NONE, STRING, NAME, LITERAL, REAL, INTEGER,                                                                                             
                             36:        START_ARRAY, END_ARRAY,                                                                                                                 
                             37:        START_PROC, END_PROC,                                                                                                                   
                             38:        START_DICT, END_DICT,                                                                                                                   
                             39:        CHARSTRING                                                                                                                              
                             40:    }                                                                                                                                           
                             41:                                                                                                                                                
                             42:    // exposed statically for convenience                                                                                                       
                             43:    static final Kind STRING = Kind.STRING;                                                                                                     
                             44:    static final Kind NAME = Kind.NAME;                                                                                                         
                             45:    static final Kind LITERAL = Kind.LITERAL;                                                                                                   
                             46:    static final Kind REAL = Kind.REAL;                                                                                                         
                             47:    static final Kind INTEGER = Kind.INTEGER;                                                                                                   
                             48:    static final Kind START_ARRAY = Kind.START_ARRAY;                                                                                           
                             49:    static final Kind END_ARRAY = Kind.END_ARRAY;                                                                                               
                             50:    static final Kind START_PROC = Kind.START_PROC;                                                                                             
                             51:    static final Kind END_PROC = Kind.END_PROC;                                                                                                 
                             52:    static final Kind CHARSTRING = Kind.CHARSTRING;                                                                                             
                             53:    static final Kind START_DICT = Kind.START_DICT;                                                                                             
                             54:    static final Kind END_DICT = Kind.END_DICT;                                                                                                 
                             55:                                                                                                                                                
                             56:    private String text;                                                                                                                        
                             57:    private byte[] data;                                                                                                                        
                             58:    private final Kind kind;                                                                                                                    
                             59:                                                                                                                                                
                             60:    /**                                                                                                                                         
                             61:     * Constructs a new Token object given its text and kind.                                                                                   
                             62:     * @param text                                                                                                                              
                             63:     * @param type                                                                                                                              
                             64:     */                                                                                                                                         
                             65:    Token(String text, Kind type)                                                                                                               
                             66:    {                                                                                                                                           
                             67:        this.text = text;                                                                                                                       
                             68:        this.kind = type;                                                                                                                       
                             69:    }                                                                                                                                           
                             70:                                                                                                                                                
                             71:    /**                                                                                                                                         
                             72:     * Constructs a new Token object given its single-character text and kind.                                                                  
                             73:     * @param character                                                                                                                         
                             74:     * @param type                                                                                                                              
                             75:     */                                                                                                                                         
                             76:    Token(char character, Kind type)                                                                                                            
                             77:    {                                                                                                                                           
                             78:        this.text = Character.toString(character);                                                                                              
                             79:        this.kind = type;                                                                                                                       
                             80:    }                                                                                                                                           
                             81:                                                                                                                                                
                             82:    /**                                                                                                                                         
                             83:     * Constructs a new Token object given its raw data and kind.                                                                               
                             84:     * This is for CHARSTRING tokens only.                                                                                                      
                             85:     * @param data                                                                                                                              
                             86:     * @param type                                                                                                                              
                             87:     */                                                                                                                                         
                             88:    Token(byte[] data, Kind type)                                                                                                               
                             89:    {                                                                                                                                           
                             90:        this.data = data;                                                                                                                       
                             91:        this.kind = type;                                                                                                                       
                             92:    }                                                                                                                                           
                             93:                                                                                                                                                
                             94:    public String getText()                                                                                                                     
                             95:    {                                                                                                                                           
                             96:        return text;                                                                                                                            
                             97:    }                                                                                                                                           
                             98:                                                                                                                                                
                             99:    public Kind getKind()                                                                                                                       
                             100:    {                                                                                                                                          
                             101:        return kind;                                                                                                                           
                             102:    }                                                                                                                                          
                             103:                                                                                                                                               
                             104:    public int intValue()                                                                                                                      
                             105:    {                                                                                                                                          
                             106:        // some fonts have reals where integers should be, so we tolerate it                                                                   
                             107:        return (int)Float.parseFloat(text);                                                                                                    
                             108:    }                                                                                                                                          
                             109:                                                                                                                                               
                             110:    public float floatValue()                                                                                                                  
                             111:    {                                                                                                                                          
                             112:        return Float.parseFloat(text);                                                                                                         
                             113:    }                                                                                                                                          
                             114:                                                                                                                                               
                             115:    public boolean booleanValue()                                                                                                              
                             116:    {                                                                                                                                          
                             117:        return text.equals("true");                                                                                                            
                             118:    }                                                                                                                                          
                             119:                                                                                                                                               
                             120:    public byte[] getData()                                                                                                                    
                             121:    {                                                                                                                                          
                             122:        return data;                                                                                                                           
                             123:    }                                                                                                                                          
                             124:                                                                                                                                               
                             125:    /**                                                                                                                                        
                             126:     * {@inheritDoc}                                                                                                                           
                             127:     */                                                                                                                                        
                             128:    @Override                                                                                                                                  
                             129:    public String toString()                                                                                                                   
                             130:    {                                                                                                                                          
                             131:        if (kind == CHARSTRING)                                                                                                                
                             132:        {                                                                                                                                      
                             133:            return "Token[kind=CHARSTRING, data=" + data.length + " bytes]";                                                                   
                             134:        }                                                                                                                                      
                             135:        else                                                                                                                                   
                             136:        {                                                                                                                                      
                             137:            return "Token[kind=" + kind + ", text=" + text + "]";                                                                              
                             138:        }                                                                                                                                      
                             139:    }                                                                                                                                          
                             140:}                                                                                                                                              
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:190-260                                                                            
                             ```                                                                                                                                                
                             190:    }                                                                                                                                          
                             191:                                                                                                                                               
                             192:    private void readEncoding() throws IOException                                                                                             
                             193:    {                                                                                                                                          
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                        
                             195:        {                                                                                                                                      
                             196:            String name = lexer.nextToken().getText();                                                                                         
                             197:                                                                                                                                               
                             198:            if (name.equals("StandardEncoding"))                                                                                               
                             199:            {                                                                                                                                  
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                     
                             201:            }                                                                                                                                  
                             202:            else                                                                                                                               
                             203:            {                                                                                                                                  
                             204:                throw new IOException("Unknown encoding: " + name);                                                                            
                             205:            }                                                                                                                                  
                             206:            readMaybe(Token.NAME, "readonly");                                                                                                 
                             207:            read(Token.NAME, "def");                                                                                                           
                             208:        }                                                                                                                                      
                             209:        else                                                                                                                                   
                             210:        {                                                                                                                                      
                             211:            read(Token.INTEGER).intValue();                                                                                                    
                             212:            readMaybe(Token.NAME, "array");                                                                                                    
                             213:                                                                                                                                               
                             214:            // 0 1 255 {1 index exch /.notdef put } for                                                                                        
                             215:            // we have to check "readonly" and "def" too                                                                                       
                             216:            // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                     
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                              
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                  
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                    
                             221:            {                                                                                                                                  
                             222:                lexer.nextToken();                                                                                                             
                             223:            }                                                                                                                                  
                             224:                                                                                                                                               
                             225:            Map<Integer, String> codeToName = new HashMap<>();                                                                                 
                             226:            while (lexer.peekKind(Token.NAME) &&                                                                                               
                             227:                    lexer.peekToken().getText().equals("dup"))                                                                                 
                             228:            {                                                                                                                                  
                             229:                read(Token.NAME, "dup");                                                                                                       
                             230:                int code = read(Token.INTEGER).intValue();                                                                                     
                             231:                String name = read(Token.LITERAL).getText();                                                                                   
                             232:                read(Token.NAME, "put");                                                                                                       
                             233:                codeToName.put(code, name);                                                                                                    
                             234:            }                                                                                                                                  
                             235:            font.encoding = new BuiltInEncoding(codeToName);                                                                                   
                             236:            readMaybe(Token.NAME, "readonly");                                                                                                 
                             237:            read(Token.NAME, "def");                                                                                                           
                             238:        }                                                                                                                                      
                             239:    }                                                                                                                                          
                             240:                                                                                                                                               
                             241:    /**                                                                                                                                        
                             242:     * Extracts values from an array as numbers.                                                                                               
                             243:     */                                                                                                                                        
                             244:    private List<Number> arrayToNumbers(List<Token> value) throws IOException                                                                  
                             245:    {                                                                                                                                          
                             246:        List<Number> numbers = new ArrayList<>();                                                                                              
                             247:        for (int i = 1, size = value.size() - 1; i < size; i++)                                                                                
                             248:        {                                                                                                                                      
                             249:            Token token = value.get(i);                                                                                                        
                             250:            if (token.getKind() == Token.REAL)                                                                                                 
                             251:            {                                                                                                                                  
                             252:                numbers.add(token.floatValue());                                                                                               
                             253:            }                                                                                                                                  
                             254:            else if (token.getKind() == Token.INTEGER)                                                                                         
                             255:            {                                                                                                                                  
                             256:                numbers.add(token.intValue());                                                                                                 
                             257:            }                                                                                                                                  
                             258:            else                                                                                                                               
                             259:            {                                                                                                                                  
                             260:                throw new IOException("Expected INTEGER or REAL but got " + token +                                                            
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:240-249                                                                             
                             ```                                                                                                                                                
                             240:                        {                                                                                                                      
                             241:                            return new Token(name, Token.NAME);                                                                                
                             242:                        }                                                                                                                      
                             243:                    }                                                                                                                          
                             244:                }                                                                                                                              
                             245:            }                                                                                                                                  
                             246:        }                                                                                                                                      
                             247:        while (skip);                                                                                                                          
                             248:        return null;                                                                                                                           
                             249:    }                                                                                                                                          
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             <code>                                                                                                                                             
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:214-224                                                                            
                             ```                                                                                                                                                
                             214:            // 0 1 255 {1 index exch /.notdef put } for                                                                                        
                             215:            // we have to check "readonly" and "def" too                                                                                       
                             216:            // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                     
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                              
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                  
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                    
                             221:            {                                                                                                                                  
                             222:                lexer.nextToken();                                                                                                             
                             223:            }                                                                                                                                  
                             224:                                                                                                                                               
                             ```                                                                                                                                                
                             </code>                                                                                                                                            
                             </code_snippets>                                                                                                                                   
                                                                                                                                                                                
                             ## Fix Strategy                                                                                                                                    
                             <fix_strategy>                                                                                                                                     
                                                                                                                                                                                
                             1. Issue Analysis                                                                                                                                  
                                - The fuzzer hang originates from an infinite loop in the Type1Parser.readEncoding() method. Specifically, when the parser                      
                             encounters an arraystyle encoding (the else path), it uses                                                                                      
                                     while (!(lexer.peekKind(Token.NAME)                                                                                                        
                                            && (lexer.peekToken().getText().equals("dup")                                                                                       
                                                || lexer.peekToken().getText().equals("readonly")                                                                               
                                                || lexer.peekToken().getText().equals("def"))))                                                                                 
                                     {                                                                                                                                          
                                         lexer.nextToken();                                                                                                                     
                                     }                                                                                                                                          
                                  This loop never checks for endofstream (EOF). If none of the expected names (dup, readonly, def) appear before EOF,                   
                             peekKind() remains false, peekToken() remains null, and lexer.nextToken() keeps returning null, so the loop never terminates.                      
                                - This perfectly matches the 28s timeout in font parsing: the main thread is busy in readToken()/nextToken(), but never makes                   
                             forward progress in the parsers loop.                                                                                                             
                                                                                                                                                                                
                             2. RootCause and Preservation of Core Logic                                                                                                       
                                - Rootcause: missing EOF check in the loop that skips tokens until a reserved name appears.                                                    
                                - Core logic to preserve:                                                                                                                       
                                   Still skip over any number of tokens inside the encoding definition until hitting dup/readonly/def.                                   
                                   Once one of these names is found, the existing second loop (handling dup entries) and subsequent reads (readonly/def)                       
                             should proceed unchanged.                                                                                                                          
                                   For valid real fonts, these tokens will appear, so behavior is unaffected.                                                                  
                                   For malformed or fuzzergenerated inputs lacking these tokens, we must break out and throw an exception so processing                       
                             terminates rather than hang.                                                                                                                       
                                                                                                                                                                                
                             3. Patch Steps                                                                                                                                     
                                a. Open fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java.                                                                        
                                b. Locate the arraystyle encoding branch in readEncoding(), around lines 214223.                                                              
                                c. Replace the existing while loop with a nullaware loop and an explicit EOF check. Concretely:                                                
                                   - Replace:                                                                                                                                   
                                     ```                                                                                                                                        
                                     while (!(lexer.peekKind(Token.NAME)                                                                                                        
                                             && (lexer.peekToken().getText().equals("dup")                                                                                      
                                                 || lexer.peekToken().getText().equals("readonly")                                                                              
                                                 || lexer.peekToken().getText().equals("def"))))                                                                                
                                     {                                                                                                                                          
                                         lexer.nextToken();                                                                                                                     
                                     }                                                                                                                                          
                                     ```                                                                                                                                        
                                   - With:                                                                                                                                      
                                     ```                                                                                                                                        
                                     // Skip tokens until we reach "dup", "readonly", or "def", or EOF                                                                          
                                     Token token;                                                                                                                               
                                     while ((token = lexer.peekToken()) != null) {                                                                                              
                                         if (token.getKind() == Token.NAME) {                                                                                                   
                                             String t = token.getText();                                                                                                        
                                             if ("dup".equals(t) || "readonly".equals(t) || "def".equals(t)) {                                                                  
                                                 break;                                                                                                                         
                                             }                                                                                                                                  
                                         }                                                                                                                                      
                                         lexer.nextToken();                                                                                                                     
                                     }                                                                                                                                          
                                     if (token == null) {                                                                                                                       
                                         // Premature end of encoding definition; abort parsing                                                                                 
                                         throw new IOException("Unexpected end of encoding data");                                                                              
                                     }                                                                                                                                          
                                     ```                                                                                                                                        
                                d. Leave the subsequent logic (the loop over `while (lexer.peekKind(Token.NAME) && text.equals("dup"))` and the final                           
                             `readMaybe/read("def")`) untouched.                                                                                                                
                                                                                                                                                                                
                             4. Justification and SideEffect Mitigation                                                                                                        
                                - This fix directly addresses the infiniteloop symptom by introducing an EOF check. Upon exhausting the input without finding                  
                             a reserved token, the parser now aborts with an IOException rather than looping forever.                                                           
                                - Real, wellformed fonts supply dup/readonly/def in their encoding definitions, so normal functionality is preserved.                    
                                - For malformed or adversarial inputs, the parser will throw an exception early, allowing the fuzzer to record a fast,                          
                             deterministic error rather than a timeout.                                                                                                         
                                - No harness or fuzzing logic is altered; existing tests that use legitimate fonts will pass as before.                                         
                                - Potential side effect: a truly malformed font that previously might have been partially parsed (albeit indefinitely) will now                 
                             cause an IOException. In production use cases, this is preferable to a hang. If necessary, higherlevel callers can catch                          
                             IOException and handle it gracefully.                                                                                                              
                                                                                                                                                                                
                             5. No Additional Changes                                                                                                                           
                                - No other loops in the parser exhibit the same pattern in the immediate area. External libraries, harness, and tests remain                    
                             unmodified.                                                                                                                                        
                                - After applying this patch, rerun existing unit tests and the PDFExtractTextFuzzer to confirm that the hang is resolved and                   
                             no regressions occur.                                                                                                                              
                                                                                                                                                                                
                             </fix_strategy>                                                                                                                                    
                             ===Tests Result===                                                                                                                                 
                             No tests found                                                                                                                                     
                             ===Evaluation End===                                                                                                                               
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                     __init__.py:160
                             (n evals: 2, patch status: PatchStatus.SOUND)                                                                                                      
                    INFO     Building environment                                                                                                                __init__.py:132
                             - Cache directory: /tmp/tmpsqu52uri                                                                                                                
                             - Max timeout: 1800                                                                                                                                
                             - Output directory: reports/prism.prism_o4_mini/pdfbox-pdfbox-full-01-vuln_3/agent-output-1759933065.4805682                                       
                             - Detection toml file: /tasks/759aa21d-110a-4c3e-b36e-d2217562425d/detection/pdfbox-pdfbox-full-01-vuln_3.toml                                     
                             - Challenge project directory: /tasks/759aa21d-110a-4c3e-b36e-d2217562425d/official-afc-pdfbox                                                     
                                                                                                                                                                                
