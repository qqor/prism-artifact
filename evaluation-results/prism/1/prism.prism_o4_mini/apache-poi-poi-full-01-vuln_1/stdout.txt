[10/20/25 13:19:54] INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpiahldc5z                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/apache-poi-poi-full-01-vuln_1/agent-output-1760966394.777015                                                                        
                             - Detection toml file: /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/detection/apache-poi-poi-full-01-vuln_1.toml                                                                     
                             - Challenge project directory: /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/official-afc-poi                                                                                         
                                                                                                                                                                                                                 
                    INFO     [logging_performance](apache-poi Building Cached for CLEAN environment) Started...                                                                             context_managers.py:9
[10/20/25 13:22:52] INFO     [logging_performance](apache-poi Building Cached for CLEAN environment) Took 177.72 seconds; exception=False                                                  context_managers.py:23
                    INFO     [logging_performance](apache-poi Running tests for Cached for CLEAN environment) Started...                                                                    context_managers.py:9
                    INFO     [logging_performance](apache-poi Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False                                           context_managers.py:23
                    INFO     Setting timeouts                                                                                                                                                       default.py:85
                               - build: 600 (original: 177)                                                                                                                                                      
                               - run tests: 600 (original: 0)                                                                                                                                                    
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:22:53] INFO     [logging_performance](apache-poi Setting owner) Took 0.88 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:22:54] INFO     Successfully created Cached for CLEAN environment                                                                                                                    oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                                                            oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                                                 
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:22:56] INFO     [logging_performance](apache-poi Setting owner) Took 1.21 seconds; exception=False                                                                            context_managers.py:23
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:22:57] INFO     [logging_performance](apache-poi Setting owner) Took 0.79 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:23:03] INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             ===Issue===                                                                                                                                                                         
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             ===Evaluation Report===                                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Analysis Report===                                                                                                                                                               
                                                                                                                                                                                                                 
                             ===Evaluation End===                                                                                                                                                                
[10/20/25 13:23:14] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/20/25 13:25:26] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/20/25 13:26:45] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:26:46] INFO     [logging_performance](apache-poi Setting owner) Took 0.90 seconds; exception=False                                                                            context_managers.py:23
                    INFO     [logging_performance](apache-poi Patching) Started...                                                                                                          context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpaaql4o5r                                                                                                                                 default.py:173
[10/20/25 13:29:04] ERROR    Failed to build the challenge                                                                                                                                         __init__.py:53
                    INFO     reports/prism.prism_o4_mini/apache-poi-poi-full-01-vuln_1/agent-output-1760966394.777015/build_failed_stdout.txt: /src /src/poi                                      functions.py:17
                             /src/poi                                                                                                                                                                            
                             ---------------------------------------------------------------                                                                                                                     
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             ---------------------------------------------------------------                                                                                                                     
                             CC=clang                                                                                                                                                                            
                             CXX=clang++                                                                                                                                                                         
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                   
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak                                       
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                 
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak                        
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                                                                                                    
                             ---------------------------------------------------------------                                                                                                                     
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                                                                                                            
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                                                                                              
                             + '[' '!' -L /root/.m2/repository ']'                                                                                                                                               
                             + unset __REAL_MAVEN_REPO                                                                                                                                                           
                             + unset __SHARED_MAVEN_REPO                                                                                                                                                         
                             + MVN_FLAGS='--no-transfer-progress -DskipTests'                                                                                                                                    
                             + ALL_JARS=                                                                                                                                                                         
                             + LIBRARY_NAME=poi                                                                                                                                                                  
                             + GRADLE_FLAGS='-x javadoc -x test -Dfile.encoding=UTF-8 -Porg.gradle.java.installations.fromEnv=JAVA_HOME_8,JAVA_HOME_11 --console=plain'                                          
                             + echo Copy libraries for java.awt in place                                                                                                                                         
                             Copy libraries for java.awt in place                                                                                                                                                
                             + ls /usr/lib/x86_64-linux-gnu/                                                                                                                                                     
                             Mcrt1.o                    liblzma.so.5.2.4                                                                                                                                         
                             Scrt1.o                    libm-2.31.a                                                                                                                                              
                             apr-util-1                 libm-2.31.so                                                                                                                                             
                             audit                      libm.a                                                                                                                                                   
                             coreutils                  libm.so                                                                                                                                                  
                             crt1.o                     libm.so.6                                                                                                                                                
                             crti.o                     libmcheck.a                                                                                                                                              
                             crtn.o                     libmemusage.so                                                                                                                                           
                             e2fsprogs                  libmenu.so.6                                                                                                                                             
                             engines-1.1                libmenu.so.6.2                                                                                                                                           
                             gconv                      libmenuw.so.6                                                                                                                                            
                             gcrt1.o                    libmenuw.so.6.2                                                                                                                                          
                             grcrt1.o                   libmount.so.1                                                                                                                                            
                             krb5                       libmount.so.1.1.0                                                                                                                                        
                             ld-2.31.so                 libmpc.so.3                                                                                                                                              
                             ld-linux-x86-64.so.2       libmpc.so.3.1.0                                                                                                                                          
                             ldscripts                  libmpfr.so.6                                                                                                                                             
                             libBrokenLocale-2.31.so    libmpfr.so.6.0.2                                                                                                                                         
                             libBrokenLocale.a          libmvec-2.31.so                                                                                                                                          
                             libBrokenLocale.so         libmvec.a                                                                                                                                                
                             libBrokenLocale.so.1       libmvec.so                                                                                                                                               
                             libSegFault.so             libmvec.so.1                                                                                                                                             
                             libX11.so.6                libncurses.so.6                                                                                                                                          
                             libX11.so.6.3.0            libncurses.so.6.2                                                                                                                                        
                             libXau.so.6                libncursesw.so.6                                                                                                                                         
                             libXau.so.6.0.0            libncursesw.so.6.2                                                                                                                                       
                             libXdmcp.so.6              libnettle.so.7                                                                                                                                           
                             libXdmcp.so.6.0.0          libnettle.so.7.0                                                                                                                                         
                             libXext.so.6               libnghttp2.so.14                                                                                                                                         
                             libXext.so.6.4.0           libnghttp2.so.14.19.0                                                                                                                                    
                             libXi.so.6                 libnpth.so.0                                                                                                                                             
                             libXi.so.6.1.0             libnpth.so.0.1.2                                                                                                                                         
                             libXmuu.so.1               libnsl-2.31.so                                                                                                                                           
                             libXmuu.so.1.0.0           libnsl.a                                                                                                                                                 
                             libXrender.so.1            libnsl.so                                                                                                                                                
                             libXrender.so.1.3.0        libnsl.so.1                                                                                                                                              
                             libXtst.so.6               libnss_compat-2.31.so                                                                                                                                    
                             libXtst.so.6.1.0           libnss_compat.so                                                                                                                                         
                             libacl.so.1                libnss_compat.so.2                                                                                                                                       
                             libacl.so.1.1.2253         libnss_dns-2.31.so                                                                                                                                       
                             libanl-2.31.so             libnss_dns.so                                                                                                                                            
                             libanl.a                   libnss_dns.so.2                                                                                                                                          
                             libanl.so                  libnss_files-2.31.so                                                                                                                                     
                             libanl.so.1                libnss_files.so                                                                                                                                          
                             libapr-1.so.0              libnss_files.so.2                                                                                                                                        
                             libapr-1.so.0.6.5          libnss_hesiod-2.31.so                                                                                                                                    
                             libaprutil-1.so.0          libnss_hesiod.so                                                                                                                                         
                             libaprutil-1.so.0.6.1      libnss_hesiod.so.2                                                                                                                                       
                             libapt-pkg.so.6.0          libnss_nis-2.31.so                                                                                                                                       
                             libapt-pkg.so.6.0.0        libnss_nis.so                                                                                                                                            
                             libapt-private.so.0.0      libnss_nis.so.2                                                                                                                                          
                             libapt-private.so.0.0.0    libnss_nisplus-2.31.so                                                                                                                                   
                             libasan.so.5               libnss_nisplus.so                                                                                                                                        
                             libasan.so.5.0.0           libnss_nisplus.so.2                                                                                                                                      
                             libasn1.so.8               libonig.so.5                                                                                                                                             
                             libasn1.so.8.0.0           libonig.so.5.0.0                                                                                                                                         
                             libassuan.so.0             libopcodes-2.34-system.so                                                                                                                                
                             libassuan.so.0.8.3         libopcodes.a                                                                                                                                             
                             libatomic.so.1             libopcodes.so                                                                                                                                            
                             libatomic.so.1.2.0         libp11-kit.so.0                                                                                                                                          
                             libattr.so.1               libp11-kit.so.0.3.0                                                                                                                                      
                             libattr.so.1.1.2448        libpam.so.0                                                                                                                                              
                             libaudit.so.1              libpam.so.0.84.2                                                                                                                                         
                             libaudit.so.1.0.0          libpam_misc.so.0                                                                                                                                         
                             libbfd-2.34-system.so      libpam_misc.so.0.82.1                                                                                                                                    
                             libbfd.a                   libpamc.so.0                                                                                                                                             
                             libbfd.so                  libpamc.so.0.82.1                                                                                                                                        
                             libblkid.so.1              libpanel.so.6                                                                                                                                            
                             libblkid.so.1.1.0          libpanel.so.6.2                                                                                                                                          
                             libbrotlicommon.so.1       libpanelw.so.6                                                                                                                                           
                             libbrotlicommon.so.1.0.7   libpanelw.so.6.2                                                                                                                                         
                             libbrotlidec.so.1          libpcprofile.so                                                                                                                                          
                             libbrotlidec.so.1.0.7      libpcre.so.3                                                                                                                                             
                             libbrotlienc.so.1          libpcre.so.3.13.3                                                                                                                                        
                             libbrotlienc.so.1.0.7      libpcre2-8.so.0                                                                                                                                          
                             libbsd.so.0                libpcre2-8.so.0.9.0                                                                                                                                      
                             libbsd.so.0.10.0           libpcreposix.so.3                                                                                                                                        
                             libbz2.so.1                libpcreposix.so.3.13.3                                                                                                                                   
                             libbz2.so.1.0              libperl.so.5.30                                                                                                                                          
                             libbz2.so.1.0.4            libperl.so.5.30.0                                                                                                                                        
                             libc-2.31.so               libpng16.so.16                                                                                                                                           
                             libc.a                     libpng16.so.16.37.0                                                                                                                                      
                             libc.so                    libpopt.so.0                                                                                                                                             
                             libc.so.6                  libpopt.so.0.0.0                                                                                                                                         
                             libc_nonshared.a           libprocps.so.8                                                                                                                                           
                             libcap-ng.so.0             libprocps.so.8.0.2                                                                                                                                       
                             libcap-ng.so.0.0.0         libpsl.so.5                                                                                                                                              
                             libcbor.so.0.6             libpsl.so.5.3.2                                                                                                                                          
                             libcbor.so.0.6.0           libpthread-2.31.so                                                                                                                                       
                             libcc1.so.0                libpthread.a                                                                                                                                             
                             libcc1.so.0.0.0            libpthread.so                                                                                                                                            
                             libcom_err.so.2            libpthread.so.0                                                                                                                                          
                             libcom_err.so.2.1          libquadmath.so.0                                                                                                                                         
                             libcrypt.a                 libquadmath.so.0.0.0                                                                                                                                     
                             libcrypt.so                libreadline.so.8                                                                                                                                         
                             libcrypt.so.1              libreadline.so.8.0                                                                                                                                       
                             libcrypt.so.1.1.0          libresolv-2.31.so                                                                                                                                        
                             libcrypto.a                libresolv.a                                                                                                                                              
                             libcrypto.so               libresolv.so                                                                                                                                             
                             libcrypto.so.1.1           libresolv.so.2                                                                                                                                           
                             libctf-nobfd.a             libroken.so.18                                                                                                                                           
                             libctf-nobfd.so            libroken.so.18.1.0                                                                                                                                       
                             libctf-nobfd.so.0          librpcsvc.a                                                                                                                                              
                             libctf-nobfd.so.0.0.0      librt-2.31.so                                                                                                                                            
                             libctf.a                   librt.a                                                                                                                                                  
                             libctf.so                  librt.so                                                                                                                                                 
                             libctf.so.0                librt.so.1                                                                                                                                               
                             libctf.so.0.0.0            librtmp.so.1                                                                                                                                             
                             libcurl-gnutls.so.3        libsasl2.so.2                                                                                                                                            
                             libcurl-gnutls.so.4        libsasl2.so.2.0.25                                                                                                                                       
                             libcurl-gnutls.so.4.6.0    libseccomp.so.2                                                                                                                                          
                             libcurl.so.4               libseccomp.so.2.5.1                                                                                                                                      
                             libcurl.so.4.6.0           libselinux.so.1                                                                                                                                          
                             libdb-5.3.so               libsemanage.so.1                                                                                                                                         
                             libdebconfclient.so.0      libsepol.so.1                                                                                                                                            
                             libdebconfclient.so.0.0.0  libserf-1.so.1                                                                                                                                           
                             libdl-2.31.so              libserf-1.so.1.3.0                                                                                                                                       
                             libdl.a                    libsmartcols.so.1                                                                                                                                        
                             libdl.so                   libsmartcols.so.1.1.0                                                                                                                                    
                             libdl.so.2                 libsqlite3.so.0                                                                                                                                          
                             libe2p.so.2                libsqlite3.so.0.8.6                                                                                                                                      
                             libe2p.so.2.3              libss.so.2                                                                                                                                               
                             libedit.so.2               libss.so.2.0                                                                                                                                             
                             libedit.so.2.0.63          libssh.so.4                                                                                                                                              
                             libexpat.so.1              libssh.so.4.8.4                                                                                                                                          
                             libexpat.so.1.6.11         libssl.a                                                                                                                                                 
                             libexpatw.so.1             libssl.so                                                                                                                                                
                             libexpatw.so.1.6.11        libssl.so.1.1                                                                                                                                            
                             libext2fs.so.2             libstdc++.so.6                                                                                                                                           
                             libext2fs.so.2.4           libstdc++.so.6.0.28                                                                                                                                      
                             libfakeroot                libsvn_auth_gnome_keyring-1.so.1                                                                                                                         
                             libfdisk.so.1              libsvn_auth_gnome_keyring-1.so.1.0.0                                                                                                                     
                             libfdisk.so.1.1.0          libsvn_auth_kwallet-1.so.1                                                                                                                               
                             libffi.so.7                libsvn_auth_kwallet-1.so.1.0.0                                                                                                                           
                             libffi.so.7.1.0            libsvn_client-1.so.1                                                                                                                                     
                             libfido2.so.1              libsvn_client-1.so.1.0.0                                                                                                                                 
                             libfido2.so.1.3.1          libsvn_delta-1.so.1                                                                                                                                      
                             libfontconfig.so.1         libsvn_delta-1.so.1.0.0                                                                                                                                  
                             libfontconfig.so.1.12.0    libsvn_diff-1.so.1                                                                                                                                       
                             libform.so.6               libsvn_diff-1.so.1.0.0                                                                                                                                   
                             libform.so.6.2             libsvn_fs-1.so.1                                                                                                                                         
                             libformw.so.6              libsvn_fs-1.so.1.0.0                                                                                                                                     
                             libformw.so.6.2            libsvn_fs_base-1.so.1                                                                                                                                    
                             libfreetype.so.6           libsvn_fs_base-1.so.1.0.0                                                                                                                                
                             libfreetype.so.6.17.1      libsvn_fs_fs-1.so.1                                                                                                                                      
                             libg.a                     libsvn_fs_fs-1.so.1.0.0                                                                                                                                  
                             libgcc_s.so.1              libsvn_fs_util-1.so.1                                                                                                                                    
                             libgcrypt.so.20            libsvn_fs_util-1.so.1.0.0                                                                                                                                
                             libgcrypt.so.20.2.5        libsvn_fs_x-1.so.1                                                                                                                                       
                             libgdbm.so.6               libsvn_fs_x-1.so.1.0.0                                                                                                                                   
                             libgdbm.so.6.0.0           libsvn_ra-1.so.1                                                                                                                                         
                             libgdbm_compat.so.4        libsvn_ra-1.so.1.0.0                                                                                                                                     
                             libgdbm_compat.so.4.0.0    libsvn_ra_local-1.so.1                                                                                                                                   
                             libgmp.so.10               libsvn_ra_local-1.so.1.0.0                                                                                                                               
                             libgmp.so.10.4.0           libsvn_ra_serf-1.so.1                                                                                                                                    
                             libgnutls.so.30            libsvn_ra_serf-1.so.1.0.0                                                                                                                                
                             libgnutls.so.30.27.0       libsvn_ra_svn-1.so.1                                                                                                                                     
                             libgomp.so.1               libsvn_ra_svn-1.so.1.0.0                                                                                                                                 
                             libgomp.so.1.0.0           libsvn_repos-1.so.1                                                                                                                                      
                             libgpg-error.so.0          libsvn_repos-1.so.1.0.0                                                                                                                                  
                             libgpg-error.so.0.28.0     libsvn_subr-1.so.1                                                                                                                                       
                             libgssapi.so.3             libsvn_subr-1.so.1.0.0                                                                                                                                   
                             libgssapi.so.3.0.0         libsvn_wc-1.so.1                                                                                                                                         
                             libgssapi_krb5.so.2        libsvn_wc-1.so.1.0.0                                                                                                                                     
                             libgssapi_krb5.so.2.2      libsystemd.so.0                                                                                                                                          
                             libhcrypto.so.4            libsystemd.so.0.28.0                                                                                                                                     
                             libhcrypto.so.4.1.0        libtasn1.so.6                                                                                                                                            
                             libheimbase.so.1           libtasn1.so.6.6.0                                                                                                                                        
                             libheimbase.so.1.0.0       libthread_db-1.0.so                                                                                                                                      
                             libheimntlm.so.0           libthread_db.so                                                                                                                                          
                             libheimntlm.so.0.1.0       libthread_db.so.1                                                                                                                                        
                             libhistory.so.8            libtic.so.6                                                                                                                                              
                             libhistory.so.8.0          libtic.so.6.2                                                                                                                                            
                             libhogweed.so.5            libtinfo.so.6                                                                                                                                            
                             libhogweed.so.5.0          libtinfo.so.6.2                                                                                                                                          
                             libhx509.so.5              libtsan.so.0                                                                                                                                             
                             libhx509.so.5.0.0          libtsan.so.0.0.0                                                                                                                                         
                             libidn2.so.0               libubsan.so.1                                                                                                                                            
                             libidn2.so.0.3.6           libubsan.so.1.0.0                                                                                                                                        
                             libisl.so.22               libudev.so.1                                                                                                                                             
                             libisl.so.22.0.1           libudev.so.1.6.17                                                                                                                                        
                             libitm.so.1                libunistring.so.2                                                                                                                                        
                             libitm.so.1.0.0            libunistring.so.2.1.0                                                                                                                                    
                             libjq.so.1                 libutf8proc.so.2                                                                                                                                         
                             libjq.so.1.0.4             libutf8proc.so.2.3.2                                                                                                                                     
                             libk5crypto.so.3           libutil-2.31.so                                                                                                                                          
                             libk5crypto.so.3.1         libutil.a                                                                                                                                                
                             libkeyutils.so.1           libutil.so                                                                                                                                               
                             libkeyutils.so.1.8         libutil.so.1                                                                                                                                             
                             libkrb5.so.26              libuuid.so.1                                                                                                                                             
                             libkrb5.so.26.0.0          libuuid.so.1.3.0                                                                                                                                         
                             libkrb5.so.3               libwind.so.0                                                                                                                                             
                             libkrb5.so.3.3             libwind.so.0.0.0                                                                                                                                         
                             libkrb5support.so.0        libxcb.so.1                                                                                                                                              
                             libkrb5support.so.0.1      libxcb.so.1.1.0                                                                                                                                          
                             libksba.so.8               libz.so.1                                                                                                                                                
                             libksba.so.8.11.6          libz.so.1.2.11                                                                                                                                           
                             liblber-2.4.so.2           libzstd.so.1                                                                                                                                             
                             liblber-2.4.so.2.10.12     libzstd.so.1.4.4                                                                                                                                         
                             libldap-2.4.so.2           perl                                                                                                                                                     
                             libldap_r-2.4.so.2         perl-base                                                                                                                                                
                             libldap_r-2.4.so.2.10.12   perl5                                                                                                                                                    
                             liblsan.so.0               pkgconfig                                                                                                                                                
                             liblsan.so.0.0.0           rcrt1.o                                                                                                                                                  
                             liblz4.so.1                sasl2                                                                                                                                                    
                             liblz4.so.1.9.2            security                                                                                                                                                 
                             liblzma.so.5                                                                                                                                                                        
                             + cp /usr/lib/x86_64-linux-gnu/libXext.so.6 /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0 /usr/lib/x86_64-linux-gnu/libX11.so.6                                                        
                             /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0 /usr/lib/x86_64-linux-gnu/libXrender.so.1 /usr/lib/x86_64-linux-gnu/libXrender.so.1.3.0                                                   
                             /usr/lib/x86_64-linux-gnu/libXtst.so.6 /usr/lib/x86_64-linux-gnu/libXtst.so.6.1.0 /usr/lib/x86_64-linux-gnu/libXi.so.6 /usr/lib/x86_64-linux-gnu/libXi.so.6.1.0                     
                             /usr/lib/x86_64-linux-gnu/libxcb.so.1 /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0 /usr/lib/x86_64-linux-gnu/libXau.so.6 /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0                     
                             /usr/lib/x86_64-linux-gnu/libXdmcp.so.6 /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0 /out/                                                                                           
                             + echo Main Java                                                                                                                                                                    
                             Main Java                                                                                                                                                                           
                             + /usr/lib/jvm/java-17-openjdk-amd64/bin/java -version                                                                                                                              
                             openjdk version "17.0.2" 2022-01-18                                                                                                                                                 
                             OpenJDK Runtime Environment (build 17.0.2+8-86)                                                                                                                                     
                             OpenJDK 64-Bit Server VM (build 17.0.2+8-86, mixed mode, sharing)                                                                                                                   
                             + echo Java 8                                                                                                                                                                       
                             Java 8                                                                                                                                                                              
                             + /src/jdk8u432-b06/bin/java -version                                                                                                                                               
                             openjdk version "1.8.0_432"                                                                                                                                                         
                             OpenJDK Runtime Environment (Temurin)(build 1.8.0_432-b06)                                                                                                                          
                             OpenJDK 64-Bit Server VM (Temurin)(build 25.432-b06, mixed mode)                                                                                                                    
                             + echo Java 11                                                                                                                                                                      
                             Java 11                                                                                                                                                                             
                             + /src/jdk-11.0.25+9/bin/java -version                                                                                                                                              
                             openjdk version "11.0.25" 2024-10-15                                                                                                                                                
                             OpenJDK Runtime Environment Temurin-11.0.25+9 (build 11.0.25+9)                                                                                                                     
                             OpenJDK 64-Bit Server VM Temurin-11.0.25+9 (build 11.0.25+9, mixed mode)                                                                                                            
                             + pushd /tmp                                                                                                                                                                        
                             /tmp /src/poi                                                                                                                                                                       
                             + /src/maven-3.6.3/apache-maven-3.6.3/bin/mvn install:install-file -Dfile=/usr/local/lib/jazzer_api_deploy.jar -DgroupId=com.code-intelligence                                      
                             -DartifactId=jazzer-api -Dversion=0.12.0 -Dpackaging=jar --no-transfer-progress -DskipTests                                                                                         
                             [INFO] Scanning for projects...                                                                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ------------------< org.apache.maven:standalone-pom >-------------------                                                                                                     
                             [INFO] Building Maven Stub Project (No POM) 1                                                                                                                                       
                             [INFO] --------------------------------[ pom ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom ---                                                                                                 
                             [INFO] Installing /usr/local/lib/jazzer_api_deploy.jar to /work/mavencache/com/code-intelligence/jazzer-api/0.12.0/jazzer-api-0.12.0.jar                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD SUCCESS                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  0.201 s                                                                                                                                                         
                             [INFO] Finished at: 2025-10-20T13:26:51Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             + popd                                                                                                                                                                              
                             /src/poi                                                                                                                                                                            
                             + pushd /src/poi                                                                                                                                                                    
                             /src/poi /src/poi                                                                                                                                                                   
                             + ./gradlew publishToMavenLocal -x javadoc -x test -Dfile.encoding=UTF-8 -Porg.gradle.java.installations.fromEnv=JAVA_HOME_8,JAVA_HOME_11 --console=plain                           
                             Downloading https://services.gradle.org/distributions/gradle-8.14.2-bin.zip                                                                                                         
                             .............10%.............20%.............30%.............40%.............50%.............60%.............70%.............80%.............90%..............100%                  
                                                                                                                                                                                                                 
                             Welcome to Gradle 8.14.2!                                                                                                                                                           
                                                                                                                                                                                                                 
                             Here are the highlights of this release:                                                                                                                                            
                              - Java 24 support                                                                                                                                                                  
                              - GraalVM Native Image toolchain selection                                                                                                                                         
                              - Enhancements to test reporting                                                                                                                                                   
                              - Build Authoring improvements                                                                                                                                                     
                                                                                                                                                                                                                 
                             For more details see https://docs.gradle.org/8.14.2/release-notes.html                                                                                                              
                                                                                                                                                                                                                 
                             Starting a Gradle Daemon (subsequent builds will be faster)                                                                                                                         
                             Configuration on demand is an incubating feature.                                                                                                                                   
                                                                                                                                                                                                                 
                             > Configure project :                                                                                                                                                               
                             Trying to override old definition of datatype junit                                                                                                                                 
                                                                                                                                                                                                                 
                             > Task :poi-integration:compileJava NO-SOURCE                                                                                                                                       
                             > Task :poi-examples:processResources NO-SOURCE                                                                                                                                     
                             > Task :poi-ooxml:cleanupBatik UP-TO-DATE                                                                                                                                           
                             > Task :poi-integration:processResources NO-SOURCE                                                                                                                                  
                             > Task :poi-integration:classes UP-TO-DATE                                                                                                                                          
                             > Task :poi-excelant:processResources                                                                                                                                               
                             > Task :poi-scratchpad:processResources                                                                                                                                             
                             > Task :poi:generateVersionJava                                                                                                                                                     
                             > Task :poi-ooxml:fixBatik                                                                                                                                                          
                             > Task :poi-ooxml:processResources                                                                                                                                                  
                             > Task :poi-ooxml-full:copy_xsds                                                                                                                                                    
                             > Task :poi-ooxml-lite:generateModuleInfo                                                                                                                                           
                             > Task :poi-ooxml-lite:javadocJar SKIPPED                                                                                                                                           
                             > Task :poi-examples:javadocJar                                                                                                                                                     
                             > Task :poi-integration:jar                                                                                                                                                         
                             > Task :poi-excelant:javadocJar                                                                                                                                                     
                             > Task :poi-integration:javadocJar                                                                                                                                                  
                             > Task :poi-integration:sourcesJar SKIPPED                                                                                                                                          
                             > Task :poi-integration:generateMetadataFileForPOIPublication SKIPPED                                                                                                               
                             > Task :poi-scratchpad:javadocJar                                                                                                                                                   
                             > Task :poi-excelant:sourcesJar                                                                                                                                                     
                             > Task :poi-examples:sourcesJar                                                                                                                                                     
                             > Task :poi-ooxml-lite:generatePomFileForPOIPublication                                                                                                                             
                             > Task :poi-integration:generatePomFileForPOIPublication                                                                                                                            
                             > Task :poi-integration:signPOIPublication SKIPPED                                                                                                                                  
                             > Task :poi-integration:publishPOIPublicationToMavenLocal SKIPPED                                                                                                                   
                             > Task :poi-integration:publishToMavenLocal UP-TO-DATE                                                                                                                              
                             > Task :poi-ooxml:javadocJar                                                                                                                                                        
                             > Task :poi-scratchpad:sourcesJar                                                                                                                                                   
                             > Task :poi-ooxml:sourcesJar                                                                                                                                                        
                             > Task :poi-excelant:generatePomFileForPOIPublication                                                                                                                               
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-full:generate_beans                                                                                                                                               
                             SchemaCompiler  Metadata LOAD:org/apache/xmlbeans/metadata GEN:org/apache/poi/schemas/ooxml                                                                                         
                             2025-10-20T13:28:36.865492627Z Execution worker Thread 6 ERROR Log4j API could not find a logging provider.                                                                         
                             Time to build schema type system: 0.859 seconds                                                                                                                                     
                             Time to generate code: 2.164 seconds                                                                                                                                                
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava                                                                                                                                            
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/util/GenericRecordUtil.java:132: warning: [unchecked] unchecked cast                                                                      
                                             m.putAll((Map<String,Supplier<?>>)baseMap);                                                                                                                         
                                                                               ^                                                                                                                                 
                               required: java.util.Map<java.lang.String,java.util.function.Supplier<?>>                                                                                                          
                               found:    java.lang.Object                                                                                                                                                        
                             /src/poi/poi/src/main/java/org/apache/poi/ss/formula/BaseFormulaEvaluator.java:225: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                     
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                     cell.setCellType(cellType);                                                                                                                                                 
                                         ^                                                                                                                                                                       
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava9                                                                                                                                           
                             > Task :poi-ooxml-lite-agent:processResources NO-SOURCE                                                                                                                             
                             > Task :poi-ooxml-lite-agent:classes                                                                                                                                                
                             > Task :poi-ooxml-lite-agent:jar                                                                                                                                                    
                             > Task :poi-ooxml-lite-agent:javadocJar SKIPPED                                                                                                                                     
                             > Task :poi-ooxml-lite-agent:sourcesJar                                                                                                                                             
                             > Task :poi-ooxml-lite-agent:generateMetadataFileForPOIPublication SKIPPED                                                                                                          
                             > Task :poi-ooxml-lite-agent:generatePomFileForPOIPublication                                                                                                                       
                             > Task :poi-ooxml-lite-agent:signPOIPublication SKIPPED                                                                                                                             
                             > Task :poi-ooxml-lite-agent:publishPOIPublicationToMavenLocal                                                                                                                      
                             > Task :poi-ooxml-lite-agent:publishToMavenLocal                                                                                                                                    
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/ss/usermodel/CellBase.java:39: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                                
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                 public final void setCellType(CellType cellType) {                                                                                                                              
                                                   ^                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/model/InternalWorkbook.java:351: warning: [unchecked] unchecked call to                                                              
                             getMethod(java.lang.String,java.lang.Class<?>...) as a member of the raw type java.lang.Class                                                                                       
                                         Method m = clazz.getMethod(d("70757441646472657373"), long.class, long.class);                                                                                          
                                                                   ^                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/NameRecord.java:466: warning: [deprecation] readAllContinuedRemainder() in                                                    
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                     byte[] remainder = ris.readAllContinuedRemainder();                                                                                                                         
                                                           ^                                                                                                                                                     
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/AbstractEscherHolderRecord.java:62: warning: [deprecation] readAllContinuedRemainder() in                                     
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                         byte[] data = in.readAllContinuedRemainder();                                                                                                                           
                                                         ^                                                                                                                                                       
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/RecordFactoryInputStream.java:335: warning: [deprecation] processContinueRecord(byte[]) in                                    
                             org.apache.poi.hssf.record.DrawingRecord has been deprecated                                                                                                                        
                                             _lastDrawingRecord.processContinueRecord(contRec.getData());                                                                                                        
                                                               ^                                                                                                                                                 
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:541: warning: [deprecation] <R>exit(R) in org.apache.logging.log4j.Logger has been deprecated                     
                                 public <R> R exit(R result) {                                                                                                                                                   
                                              ^                                                                                                                                                                  
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:536: warning: [deprecation] exit() in org.apache.logging.log4j.Logger has been deprecated                         
                                 public void exit() {                                                                                                                                                            
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:291: warning: [deprecation] entry(java.lang.Object...) in org.apache.logging.log4j.Logger has been                
                             deprecated                                                                                                                                                                          
                                 public void entry(Object... params) {                                                                                                                                           
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:286: warning: [deprecation] entry() in org.apache.logging.log4j.Logger has been deprecated                        
                                 public void entry() {                                                                                                                                                           
                                             ^                                                                                                                                                                   
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:generatePomFileForPOIPublication                                                                                                                             
                             > Task :poi-examples:generatePomFileForPOIPublication                                                                                                                               
                             > Task :poi:compileJava9                                                                                                                                                            
                             > Task :poi:processResources                                                                                                                                                        
                             > Task :poi:classes                                                                                                                                                                 
                             > Task :poi:jar                                                                                                                                                                     
                             > Task :poi:javadocJar                                                                                                                                                              
                             > Task :poi:sourcesJar                                                                                                                                                              
                             > Task :poi:generateMetadataFileForPOIPublication SKIPPED                                                                                                                           
                             > Task :poi:generatePomFileForPOIPublication                                                                                                                                        
                             > Task :poi:signPOIPublication SKIPPED                                                                                                                                              
                             > Task :poi:publishPOIPublicationToMavenLocal                                                                                                                                       
                             > Task :poi:publishToMavenLocal                                                                                                                                                     
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava                                                                                                                                                  
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                          
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                  
                                                                                                           ^                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFDocument.java:337: warning: [deprecation]                                                                             
                             PicturesTable(org.apache.poi.hwpf.HWPFDocument,byte[],byte[],org.apache.poi.hwpf.model.FSPATable,org.apache.poi.hwpf.model.OfficeArtContent) in                                     
                             org.apache.poi.hwpf.model.PicturesTable has been deprecated                                                                                                                         
                                     _pictures = new PicturesTable(this, _dataStream, _mainStream, _fspaMain, officeArtContent);                                                                                 
                                                 ^                                                                                                                                                               
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:225: warning: [deprecation] getCharacterStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     CharacterProperties base = _styleSheet.getCharacterStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:243: warning: [deprecation] getParagraphStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     ParagraphProperties base = _styleSheet.getParagraphStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked method invocation: constructor <init> in                   
                             class org.apache.poi.hwpf.model.PropertyNode is applied to given types                                                                                                              
                                     super(other);                                                                                                                                                               
                                          ^                                                                                                                                                                      
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found: org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                                 
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked conversion                                                 
                                     super(other);                                                                                                                                                               
                                           ^                                                                                                                                                                     
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found:    org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                              
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Table.java:89: warning: [deprecation] TYPE_TABLE in org.apache.poi.hwpf.usermodel.Range has been                
                             deprecated                                                                                                                                                                          
                                     return TYPE_TABLE;                                                                                                                                                          
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Section.java:238: warning: [deprecation] TYPE_SECTION in org.apache.poi.hwpf.usermodel.Range has                
                             been deprecated                                                                                                                                                                     
                                     return TYPE_SECTION;                                                                                                                                                        
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/ListFormatOverrideLevel.java:44: warning: [deprecation] ListLevel(byte[],int) in                                    
                             org.apache.poi.hwpf.model.ListLevel has been deprecated                                                                                                                             
                                         _lvl = new ListLevel( buf, offset );                                                                                                                                    
                                                ^                                                                                                                                                                
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFOldDocument.java:147: warning: [deprecation]                                                                          
                             OldSectionTable(byte[],int,int,int,org.apache.poi.hwpf.model.TextPieceTable) in org.apache.poi.hwpf.model.OldSectionTable has been deprecated                                       
                                     _st = new OldSectionTable(                                                                                                                                                  
                                           ^                                                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/SinglentonTextPiece.java:39: warning: [deprecation] characterLength() in                                            
                             org.apache.poi.hwpf.model.TextPiece has been deprecated                                                                                                                             
                                 public int characterLength()                                                                                                                                                    
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hslf/usermodel/HSLFSlide.java:492: warning: [deprecation]                                                                      
                             getDisplayPlaceholder(org.apache.poi.sl.usermodel.Placeholder) in org.apache.poi.sl.usermodel.Slide has been deprecated                                                             
                                 public boolean getDisplayPlaceholder(final Placeholder placeholder) {                                                                                                           
                                                ^                                                                                                                                                                
                             1 error                                                                                                                                                                             
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava FAILED                                                                                                                                           
                             > Task :poi-ooxml:generatePomFileForPOIPublication                                                                                                                                  
                             > Task :poi-ooxml-full:compileJava                                                                                                                                                  
                                                                                                                                                                                                                 
                             [Incubating] Problems report is available at: file:///src/poi/build/reports/problems/problems-report.html                                                                           
                                                                                                                                                                                                                 
                             FAILURE: Build failed with an exception.                                                                                                                                            
                                                                                                                                                                                                                 
                             * What went wrong:                                                                                                                                                                  
                             Execution failed for task ':poi-scratchpad:compileJava'.                                                                                                                            
                             > Compilation failed; see the compiler output below.                                                                                                                                
                               /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                        
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                  byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                
                                                                                                             ^                                                                                                   
                               1 error                                                                                                                                                                           
                               11 warnings                                                                                                                                                                       
                                                                                                                                                                                                                 
                             * Try:                                                                                                                                                                              
                             > Check your code and dependencies to fix the compilation error(s)                                                                                                                  
                             > Run with --scan to get full insights.                                                                                                                                             
                                                                                                                                                                                                                 
                             Deprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.                                                                                         
                                                                                                                                                                                                                 
                             You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.                                           
                                                                                                                                                                                                                 
                             For more on this, please refer to https://docs.gradle.org/8.14.2/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.                       
                                                                                                                                                                                                                 
                             BUILD FAILED in 2m 11s                                                                                                                                                              
                             41 actionable tasks: 40 executed, 1 up-to-date                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                                                                                                                                                                                                                 
                    INFO     reports/prism.prism_o4_mini/apache-poi-poi-full-01-vuln_1/agent-output-1760966394.777015/build_failed_stderr.txt: INFO:__main__:Running: docker build -t             functions.py:17
                             aixcc-afc/apache-poi:latest --file /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi/Dockerfile                                                          
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi.                                                                                                       
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.43kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/14] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 2.48kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [11/14] RUN apt-get update     && apt-get install -y      fontconfig=2.13.1-2ubuntu3     libfreetype6=2.10.1-2ubuntu0.4      libxext6=2:1.3.4-0ubuntu1                           
                             libx11-6=2:1.6.9-2ubuntu1.6     libxrender1=1:0.9.10-1      libxtst6=2:1.2.3-1     libxi6=2:1.7.10-0ubuntu1     libxcb1=1.14-2     libxau6=1:1.0.9-0ubuntu1                         
                             libxdmcp6=1:1.1.3-0ubuntu1 --no-install-recommends && apt-get clean autoclean && apt-get autoremove --yes && rm -rf /var/lib/apt && rm -rf var/lib/dpkg && rm -rf                   
                             /var/lib/cache && rm -rf /var/lib/log                                                                                                                                               
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [ 7/14] COPY pkgs/OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz /src/                                                                                                        
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [10/14] RUN tar -xzvf apache-poi.tar.gz &&     mv apache-poi poi && rm apache-poi.tar.gz                                                                                         
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 8/14] RUN tar xvf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz &&   rm -rf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz                                              
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 3/14] COPY pkgs/maven.zip /src/                                                                                                                                               
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 6/14] RUN tar xvf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz &&   rm -rf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz                                                 
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 4/14] RUN unzip maven.zip -d "/src/maven-3.6.3" && rm -rf maven.zip                                                                                                           
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [13/14] COPY src/ /src/src/                                                                                                                                                     
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [ 2/14] WORKDIR /src                                                                                                                                                            
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [12/14] COPY pom.xml build.sh *.options /src/                                                                                                                                   
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 5/14] COPY pkgs/OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz /src/                                                                                                         
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [ 9/14] COPY pkgs/apache-poi.tar.gz /src/                                                                                                                                       
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 [14/14] WORKDIR /src/poi                                                                                                                                                        
                             #18 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #19 exporting to image                                                                                                                                                              
                             #19 exporting layers done                                                                                                                                                           
                             #19 writing image sha256:db2ab0499c70ef777ccf115c8ad7c7e3bc5dc5b80d30b537f5e32a24bff67e22 done                                                                                      
                             #19 naming to docker.io/aixcc-afc/apache-poi:latest done                                                                                                                            
                             #19 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=apache-poi -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                    
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/official-afc-poi:/local-source-mount:ro -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/out/apache-poi/:/out -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/work/apache-poi:/work -t aixcc-afc/apache-poi:latest /bin/bash -c 'pushd $SRC && rm -rf /src/poi &&                  
                             cp -r /local-source-mount /src/poi && popd && compile'.                                                                                                                             
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                    INFO     [logging_performance](apache-poi Patching) Took 137.91 seconds; exception=False                                                                               context_managers.py:23
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:29:05] INFO     [logging_performance](apache-poi Setting owner) Took 0.89 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:29:06] INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:29:07] INFO     [logging_performance](apache-poi Setting owner) Took 0.97 seconds; exception=False                                                                            context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                                                                                                            
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java                                                                                                 
                             +++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java                                                                                                 
                             @@ -164,16 +164,23 @@                                                                                                                                                               
                                                name = base.name;                                                                                                                                                
                                             } else {                                                                                                                                                            
                                                // Custom name was stored                                                                                                                                        
                             -                  int mplen = LittleEndian.readInt(inp);                                                                                                                           
                             -                  if (mplen < 0) {                                                                                                                                                 
                             -                     throw new IOException("Did not expect negative value: " + mplen);                                                                                             
                             -                  }                                                                                                                                                                
                             -                  byte[] mpdata = new byte[mplen];                                                                                                                                 
                             -                  if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                        
                             -                     throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                      
                             -                  }                                                                                                                                                                
                             -                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);                                                                                                      
                             -                  skipToBoundary(mplen, inp);                                                                                                                                      
                             +                   int mplen = LittleEndian.readInt(inp);                                                                                                                          
                             +                   if (mplen < 0) {                                                                                                                                                
                             +                      throw new IOException("Did not expect negative property name length: " + mplen);                                                                             
                             +                   }                                                                                                                                                               
                             +                   if (mplen < 2 || (mplen & 1) != 0) {                                                                                                                            
                             +                      throw new IOException("Invalid or odd property name length: " + mplen);                                                                                      
                             +                   }                                                                                                                                                               
                             +                   byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                 
                             +                   if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                       
                             +                      throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                     
                             +                   }                                                                                                                                                               
                             +                   try {                                                                                                                                                           
                             +                      name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2) - 1);                                                                                                
                             +                   } catch (IllegalArgumentException e) {                                                                                                                          
                             +                      throw new IOException("Invalid property name data for length " + mplen, e);                                                                                  
                             +                   }                                                                                                                                                               
                             +                   skipToBoundary(mplen, inp);                                                                                                                                     
                                             }                                                                                                                                                                   
                                                                                                                                                                                                                 
                                             // Now create                                                                                                                                                       
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             2025-10-20T13:28:36.865492627Z Execution worker Thread 6 ERROR Log4j API could not find a logging provider.                                                                         
                             Time to build schema type system: 0.859 seconds                                                                                                                                     
                             Time to generate code: 2.164 seconds                                                                                                                                                
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava                                                                                                                                            
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/util/GenericRecordUtil.java:132: warning: [unchecked] unchecked cast                                                                      
                                             m.putAll((Map<String,Supplier<?>>)baseMap);                                                                                                                         
                                                                               ^                                                                                                                                 
                               required: java.util.Map<java.lang.String,java.util.function.Supplier<?>>                                                                                                          
                               found:    java.lang.Object                                                                                                                                                        
                             /src/poi/poi/src/main/java/org/apache/poi/ss/formula/BaseFormulaEvaluator.java:225: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                     
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                     cell.setCellType(cellType);                                                                                                                                                 
                                         ^                                                                                                                                                                       
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava9                                                                                                                                           
                             > Task :poi-ooxml-lite-agent:processResources NO-SOURCE                                                                                                                             
                             > Task :poi-ooxml-lite-agent:classes                                                                                                                                                
                             > Task :poi-ooxml-lite-agent:jar                                                                                                                                                    
                             > Task :poi-ooxml-lite-agent:javadocJar SKIPPED                                                                                                                                     
                             > Task :poi-ooxml-lite-agent:sourcesJar                                                                                                                                             
                             > Task :poi-ooxml-lite-agent:generateMetadataFileForPOIPublication SKIPPED                                                                                                          
                             > Task :poi-ooxml-lite-agent:generatePomFileForPOIPublication                                                                                                                       
                             > Task :poi-ooxml-lite-agent:signPOIPublication SKIPPED                                                                                                                             
                             > Task :poi-ooxml-lite-agent:publishPOIPublicationToMavenLocal                                                                                                                      
                             > Task :poi-ooxml-lite-agent:publishToMavenLocal                                                                                                                                    
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/ss/usermodel/CellBase.java:39: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                                
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                 public final void setCellType(CellType cellType) {                                                                                                                              
                                                   ^                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/model/InternalWorkbook.java:351: warning: [unchecked] unchecked call to                                                              
                             getMethod(java.lang.String,java.lang.Class<?>...) as a member of the raw type java.lang.Class                                                                                       
                                         Method m = clazz.getMethod(d("70757441646472657373"), long.class, long.class);                                                                                          
                                                                   ^                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/NameRecord.java:466: warning: [deprecation] readAllContinuedRemainder() in                                                    
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                     byte[] remainder = ris.readAllContinuedRemainder();                                                                                                                         
                                                           ^                                                                                                                                                     
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/AbstractEscherHolderRecord.java:62: warning: [deprecation] readAllContinuedRemainder() in                                     
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                         byte[] data = in.readAllContinuedRemainder();                                                                                                                           
                                                         ^                                                                                                                                                       
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/RecordFactoryInputStream.java:335: warning: [deprecation] processContinueRecord(byte[]) in                                    
                             org.apache.poi.hssf.record.DrawingRecord has been deprecated                                                                                                                        
                                             _lastDrawingRecord.processContinueRecord(contRec.getData());                                                                                                        
                                                               ^                                                                                                                                                 
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:541: warning: [deprecation] <R>exit(R) in org.apache.logging.log4j.Logger has been deprecated                     
                                 public <R> R exit(R result) {                                                                                                                                                   
                                              ^                                                                                                                                                                  
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:536: warning: [deprecation] exit() in org.apache.logging.log4j.Logger has been deprecated                         
                                 public void exit() {                                                                                                                                                            
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:291: warning: [deprecation] entry(java.lang.Object...) in org.apache.logging.log4j.Logger has                     
                             been deprecated                                                                                                                                                                     
                                 public void entry(Object... params) {                                                                                                                                           
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:286: warning: [deprecation] entry() in org.apache.logging.log4j.Logger has been deprecated                        
                                 public void entry() {                                                                                                                                                           
                                             ^                                                                                                                                                                   
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:generatePomFileForPOIPublication                                                                                                                             
                             > Task :poi-examples:generatePomFileForPOIPublication                                                                                                                               
                             > Task :poi:compileJava9                                                                                                                                                            
                             > Task :poi:processResources                                                                                                                                                        
                             > Task :poi:classes                                                                                                                                                                 
                             > Task :poi:jar                                                                                                                                                                     
                             > Task :poi:javadocJar                                                                                                                                                              
                             > Task :poi:sourcesJar                                                                                                                                                              
                             > Task :poi:generateMetadataFileForPOIPublication SKIPPED                                                                                                                           
                             > Task :poi:generatePomFileForPOIPublication                                                                                                                                        
                             > Task :poi:signPOIPublication SKIPPED                                                                                                                                              
                             > Task :poi:publishPOIPublicationToMavenLocal                                                                                                                                       
                             > Task :poi:publishToMavenLocal                                                                                                                                                     
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava                                                                                                                                                  
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                          
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                  
                                                                                                           ^                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFDocument.java:337: warning: [deprecation]                                                                             
                             PicturesTable(org.apache.poi.hwpf.HWPFDocument,byte[],byte[],org.apache.poi.hwpf.model.FSPATable,org.apache.poi.hwpf.model.OfficeArtContent) in                                     
                             org.apache.poi.hwpf.model.PicturesTable has been deprecated                                                                                                                         
                                     _pictures = new PicturesTable(this, _dataStream, _mainStream, _fspaMain, officeArtContent);                                                                                 
                                                 ^                                                                                                                                                               
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:225: warning: [deprecation] getCharacterStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     CharacterProperties base = _styleSheet.getCharacterStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:243: warning: [deprecation] getParagraphStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     ParagraphProperties base = _styleSheet.getParagraphStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked method invocation: constructor <init> in                   
                             class org.apache.poi.hwpf.model.PropertyNode is applied to given types                                                                                                              
                                     super(other);                                                                                                                                                               
                                          ^                                                                                                                                                                      
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found: org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                                 
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked conversion                                                 
                                     super(other);                                                                                                                                                               
                                           ^                                                                                                                                                                     
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found:    org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                              
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Table.java:89: warning: [deprecation] TYPE_TABLE in org.apache.poi.hwpf.usermodel.Range has                     
                             been deprecated                                                                                                                                                                     
                                     return TYPE_TABLE;                                                                                                                                                          
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Section.java:238: warning: [deprecation] TYPE_SECTION in org.apache.poi.hwpf.usermodel.Range                    
                             has been deprecated                                                                                                                                                                 
                                     return TYPE_SECTION;                                                                                                                                                        
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/ListFormatOverrideLevel.java:44: warning: [deprecation] ListLevel(byte[],int) in                                    
                             org.apache.poi.hwpf.model.ListLevel has been deprecated                                                                                                                             
                                         _lvl = new ListLevel( buf, offset );                                                                                                                                    
                                                ^                                                                                                                                                                
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFOldDocument.java:147: warning: [deprecation]                                                                          
                             OldSectionTable(byte[],int,int,int,org.apache.poi.hwpf.model.TextPieceTable) in org.apache.poi.hwpf.model.OldSectionTable has been deprecated                                       
                                     _st = new OldSectionTable(                                                                                                                                                  
                                           ^                                                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/SinglentonTextPiece.java:39: warning: [deprecation] characterLength() in                                            
                             org.apache.poi.hwpf.model.TextPiece has been deprecated                                                                                                                             
                                 public int characterLength()                                                                                                                                                    
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hslf/usermodel/HSLFSlide.java:492: warning: [deprecation]                                                                      
                             getDisplayPlaceholder(org.apache.poi.sl.usermodel.Placeholder) in org.apache.poi.sl.usermodel.Slide has been deprecated                                                             
                                 public boolean getDisplayPlaceholder(final Placeholder placeholder) {                                                                                                           
                                                ^                                                                                                                                                                
                             1 error                                                                                                                                                                             
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava FAILED                                                                                                                                           
                             > Task :poi-ooxml:generatePomFileForPOIPublication                                                                                                                                  
                             > Task :poi-ooxml-full:compileJava                                                                                                                                                  
                                                                                                                                                                                                                 
                             [Incubating] Problems report is available at: file:///src/poi/build/reports/problems/problems-report.html                                                                           
                                                                                                                                                                                                                 
                             FAILURE: Build failed with an exception.                                                                                                                                            
                                                                                                                                                                                                                 
                             * What went wrong:                                                                                                                                                                  
                             Execution failed for task ':poi-scratchpad:compileJava'.                                                                                                                            
                             > Compilation failed; see the compiler output below.                                                                                                                                
                               /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                        
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                  byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                
                                                                                                             ^                                                                                                   
                               1 error                                                                                                                                                                           
                               11 warnings                                                                                                                                                                       
                                                                                                                                                                                                                 
                             * Try:                                                                                                                                                                              
                             > Check your code and dependencies to fix the compilation error(s)                                                                                                                  
                             > Run with --scan to get full insights.                                                                                                                                             
                                                                                                                                                                                                                 
                             Deprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.                                                                                         
                                                                                                                                                                                                                 
                             You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.                                           
                                                                                                                                                                                                                 
                             For more on this, please refer to https://docs.gradle.org/8.14.2/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.                       
                                                                                                                                                                                                                 
                             BUILD FAILED in 2m 11s                                                                                                                                                              
                             41 actionable tasks: 40 executed, 1 up-to-date                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker build -t aixcc-afc/apache-poi:latest --file /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi/Dockerfile                   
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi.                                                                                                       
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.43kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/14] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 2.48kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [11/14] RUN apt-get update     && apt-get install -y      fontconfig=2.13.1-2ubuntu3     libfreetype6=2.10.1-2ubuntu0.4      libxext6=2:1.3.4-0ubuntu1                           
                             libx11-6=2:1.6.9-2ubuntu1.6     libxrender1=1:0.9.10-1      libxtst6=2:1.2.3-1     libxi6=2:1.7.10-0ubuntu1     libxcb1=1.14-2     libxau6=1:1.0.9-0ubuntu1                         
                             libxdmcp6=1:1.1.3-0ubuntu1 --no-install-recommends && apt-get clean autoclean && apt-get autoremove --yes && rm -rf /var/lib/apt && rm -rf var/lib/dpkg && rm -rf                   
                             /var/lib/cache && rm -rf /var/lib/log                                                                                                                                               
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [ 7/14] COPY pkgs/OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz /src/                                                                                                        
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [10/14] RUN tar -xzvf apache-poi.tar.gz &&     mv apache-poi poi && rm apache-poi.tar.gz                                                                                         
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 8/14] RUN tar xvf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz &&   rm -rf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz                                              
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 3/14] COPY pkgs/maven.zip /src/                                                                                                                                               
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 6/14] RUN tar xvf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz &&   rm -rf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz                                                 
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 4/14] RUN unzip maven.zip -d "/src/maven-3.6.3" && rm -rf maven.zip                                                                                                           
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [13/14] COPY src/ /src/src/                                                                                                                                                     
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [ 2/14] WORKDIR /src                                                                                                                                                            
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [12/14] COPY pom.xml build.sh *.options /src/                                                                                                                                   
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 5/14] COPY pkgs/OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz /src/                                                                                                         
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [ 9/14] COPY pkgs/apache-poi.tar.gz /src/                                                                                                                                       
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 [14/14] WORKDIR /src/poi                                                                                                                                                        
                             #18 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #19 exporting to image                                                                                                                                                              
                             #19 exporting layers done                                                                                                                                                           
                             #19 writing image sha256:db2ab0499c70ef777ccf115c8ad7c7e3bc5dc5b80d30b537f5e32a24bff67e22 done                                                                                      
                             #19 naming to docker.io/aixcc-afc/apache-poi:latest done                                                                                                                            
                             #19 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=apache-poi -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                    
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/official-afc-poi:/local-source-mount:ro -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/out/apache-poi/:/out -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/work/apache-poi:/work -t aixcc-afc/apache-poi:latest /bin/bash -c 'pushd $SRC && rm -rf /src/poi &&                  
                             cp -r /local-source-mount /src/poi && popd && compile'.                                                                                                                             
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A Jazzer fuzzing run against Apache POIs HMEF (Outlook TNEF) support triggered a lowseverity security finding: the JVM ran out of heap space while parsing a                      
                             crafted input. The exception stack trace shows an `OutOfMemoryError` in `java.lang.String.<init>` called from `org.apache.poi.util.StringUtil.getFromUnicodeLE`,                    
                             propagated through various HMEF attributeprocessing classes. The crash was classified as a FuzzerSecurityIssueLow: Out of memory.                                                
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             - Issue Nature                                                                                                                                                                      
                               The application consumed unbounded memory while decoding Unicode strings during TNEF/MAPI attribute processing, eventually exhausting the Java heap. The failure                  
                             manifests as a `java.lang.OutOfMemoryError: Java heap space`.                                                                                                                       
                                                                                                                                                                                                                 
                             - Vulnerability Type                                                                                                                                                                
                               This is a resource exhaustion (denialofservice) issue caused by unbounded or improperly limited memory allocation when handling potentially malicious or                        
                             malformed input.                                                                                                                                                                    
                                                                                                                                                                                                                 
                             - Key Observations                                                                                                                                                                  
                                The failure occurs in `StringUtil.getFromUnicodeLE`, indicating that string decoding from a byte buffer grew beyond available heap limits.                                      
                                The stack trace passes through `MAPIAttribute.create`, `TNEFMAPIAttribute`, `TNEFAttribute.create`, and then into `HMEFMessage.processMessage` and its                          
                             constructor.                                                                                                                                                                        
                                The fuzzing harness (`POIHMEFFuzzer.fuzzerTestOneInput`) drives the parsing logic but is not itself the root cause; it simply exposes how the parser behaves                    
                             under unexpected data.                                                                                                                                                              
                                                                                                                                                                                                                 
                             - Relevant Code Areas for Investigation                                                                                                                                             
                               1. `org.apache.poi.util.StringUtil.getFromUnicodeLE`  how it computes target string length and performs memory allocations.                                                      
                               2. `org.apache.poi.hmef.attribute.MAPIAttribute` and `TNEFMAPIAttribute`  handling of length fields and buffer slicing.                                                          
                               3. `org.apache.poi.hmef.attribute.TNEFAttribute`  creation logic that dispatches to various attribute types.                                                                     
                               4. `org.apache.poi.hmef.HMEFMessage`  overall orchestration of TNEF message parsing and any size validations performed.                                                          
                               5. The fuzzing entry point (`POIHMEFFuzzer`) for context on input feeding and any preparsing checks.                                                                             
                                                                                                                                                                                                                 
                             Investigating these areas will provide a holistic view of how oversized or malformed data can drive unbounded allocations, leading to heap exhaustion.                              
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             </issue>                                                                                                                                                                            
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:150-180                                                                                               
                             ```                                                                                                                                                                                 
                             150:            MAPIProperty prop = MAPIProperty.get(id);                                                                                                                           
                             151:            if(id >= 0x8000 && id <= 0xFFFF) {                                                                                                                                  
                             152:               byte[] guid = new byte[16];                                                                                                                                      
                             153:               if (IOUtils.readFully(inp, guid) < 0) {                                                                                                                          
                             154:                  throw new IOException("Not enough data to read guid");                                                                                                        
                             155:               }                                                                                                                                                                
                             156:               int mptype = LittleEndian.readInt(inp);                                                                                                                          
                             157:                                                                                                                                                                                
                             158:               // Get the name of it                                                                                                                                            
                             159:               String name;                                                                                                                                                     
                             160:               if(mptype == 0) {                                                                                                                                                
                             161:                  // It's based on a normal one                                                                                                                                 
                             162:                  int mpid = LittleEndian.readInt(inp);                                                                                                                         
                             163:                  MAPIProperty base = MAPIProperty.get(mpid);                                                                                                                   
                             164:                  name = base.name;                                                                                                                                             
                             165:               } else {                                                                                                                                                         
                             166:                  // Custom name was stored                                                                                                                                     
                             167:                  int mplen = LittleEndian.readInt(inp);                                                                                                                        
                             168:                  if (mplen < 0) {                                                                                                                                              
                             169:                     throw new IOException("Did not expect negative value: " + mplen);                                                                                          
                             170:                  }                                                                                                                                                             
                             171:                  byte[] mpdata = new byte[mplen];                                                                                                                              
                             172:                  if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                     
                             173:                     throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                   
                             174:                  }                                                                                                                                                             
                             175:                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);                                                                                                   
                             176:                  skipToBoundary(mplen, inp);                                                                                                                                   
                             177:               }                                                                                                                                                                
                             178:                                                                                                                                                                                
                             179:               // Now create                                                                                                                                                    
                             180:               prop = MAPIProperty.createCustom(id, type, name);                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             poi/src/main/java/org/apache/poi/util/StringUtil.java:79-95                                                                                                                         
                             ```                                                                                                                                                                                 
                             79:    public static String getFromUnicodeLE(                                                                                                                                       
                             80:            final byte[] string,                                                                                                                                                 
                             81:            final int offset,                                                                                                                                                    
                             82:            final int len)                                                                                                                                                       
                             83:            throws ArrayIndexOutOfBoundsException, IllegalArgumentException {                                                                                                    
                             84:        if (len == 0) {                                                                                                                                                          
                             85:            return "";                                                                                                                                                           
                             86:        }                                                                                                                                                                        
                             87:        if ((offset < 0) || (offset >= string.length)) {                                                                                                                         
                             88:            throw new ArrayIndexOutOfBoundsException("Illegal offset " + offset + " (String data is of length " + string.length + ")");                                          
                             89:        }                                                                                                                                                                        
                             90:        if ((len < 0) || (((string.length - offset) / 2) < len)) {                                                                                                               
                             91:            throw new IllegalArgumentException("Illegal length " + len);                                                                                                         
                             92:        }                                                                                                                                                                        
                             93:                                                                                                                                                                                 
                             94:        return new String(string, offset, len * 2, UTF16LE);                                                                                                                     
                             95:    }                                                                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.java:64-72                                                                                                 
                             ```                                                                                                                                                                                 
                             64:   protected TNEFAttribute(int id, int type, InputStream inp) throws IOException {                                                                                               
                             65:      this.type = type;                                                                                                                                                          
                             66:      int length = LittleEndian.readInt(inp);                                                                                                                                    
                             67:                                                                                                                                                                                 
                             68:      property = TNEFProperty.getBest(id, type);                                                                                                                                 
                             69:      data = IOUtils.safelyAllocate(length, MAX_RECORD_LENGTH);                                                                                                                  
                             70:      IOUtils.readFully(inp, data);                                                                                                                                              
                             71:                                                                                                                                                                                 
                             72:      checksum = LittleEndian.readUShort(inp);                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Issue Analysis and Core Insight                                                                                                                                                  
                                - The unbounded memory allocation takes place in MAPIAttribute.create when reading a customnamed property (id  0x8000):                                                        
                                  ```java                                                                                                                                                                        
                                    int mplen = LittleEndian.readInt(inp);                                                                                                                                       
                                    //  (mplen < 0 check)                                                                                                                                                       
                                    byte[] mpdata = new byte[mplen];       //  unbounded allocation                                                                                                             
                                    IOUtils.readFully(inp, mpdata);                                                                                                                                              
                                    name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);                                                                                                                  
                                  ```                                                                                                                                                                            
                                - Because there is no upper bound on `mplen`, a malicious or malformed input can request gigabytes of memory, causing an OutOfMemoryError in                                     
                             `StringUtil.getFromUnicodeLE` or when allocating `mpdata`.                                                                                                                          
                                                                                                                                                                                                                 
                             2. Fix Strategy                                                                                                                                                                     
                                A. Enforce a maximum allowed length for the custom name buffer, leveraging the existing `IOUtils.safelyAllocate` utility and its `MAX_RECORD_LENGTH` constant.                   
                             This avoids introducing new limits and keeps consistency with other TNEF fields.                                                                                                    
                                B. Replace the direct `new byte[mplen]` with a safe allocation call, which will throw an exception early if `mplen` exceeds the configured maximum.                              
                                C. (Optional but recommended) Add a sanity check for odd or toosmall lengths (e.g., `mplen < 2` or `mplen % 2 != 0`) to fail fast on obviously invalid                          
                             Unicode-LE data and avoid passing a negative length to `getFromUnicodeLE`.                                                                                                          
                                D. Catch invalidlength exceptions from `StringUtil.getFromUnicodeLE` and wrap them in an `IOException` with a clear message (Invalid property name length),                   
                             preserving the existing APIs exception style.                                                                                                                                      
                                                                                                                                                                                                                 
                             3. Implementation Steps                                                                                                                                                             
                                - In `poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java`, locate the customproperty branch around lines 167176.                                    
                                - Perform the following modifications:                                                                                                                                           
                                  a. After reading `mplen`, add:                                                                                                                                                 
                                     ```java                                                                                                                                                                     
                                     if (mplen < 0) {                                                                                                                                                            
                                        throw new IOException("Did not expect negative property name length: " + mplen);                                                                                         
                                     }                                                                                                                                                                           
                                     // Optional extra validation:                                                                                                                                               
                                     if (mplen < 2 || (mplen & 1) != 0) {                                                                                                                                        
                                        throw new IOException("Invalid or odd property name length: " + mplen);                                                                                                  
                                     }                                                                                                                                                                           
                                     ```                                                                                                                                                                         
                                  b. Replace:                                                                                                                                                                    
                                     ```java                                                                                                                                                                     
                                     byte[] mpdata = new byte[mplen];                                                                                                                                            
                                     ```                                                                                                                                                                         
                                     with:                                                                                                                                                                       
                                     ```java                                                                                                                                                                     
                                     byte[] mpdata = IOUtils.safelyAllocate(mplen, MAX_RECORD_LENGTH);                                                                                                           
                                     ```                                                                                                                                                                         
                                  c. Wrap the `getFromUnicodeLE` call to turn any IllegalArgumentException into an IOException:                                                                                  
                                     ```java                                                                                                                                                                     
                                     try {                                                                                                                                                                       
                                        name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2) - 1);                                                                                                            
                                     } catch (IllegalArgumentException e) {                                                                                                                                      
                                        throw new IOException("Invalid property name data for length " + mplen, e);                                                                                              
                                     }                                                                                                                                                                           
                                     ```                                                                                                                                                                         
                                  d. Leave the subsequent `skipToBoundary(mplen, inp);` call unchanged to preserve alignment logic.                                                                              
                                                                                                                                                                                                                 
                             4. Preservation of Existing Logic                                                                                                                                                   
                                - All current parsing steps remain identical: custom GUID read, length field parsed, data read, boundary skip.                                                                   
                                - The only change is enforcing an upper bound on how big `mpdata` can be. Legitimate files with reasonable property names will not exceed these limits.                          
                                - Error handling remains consistent (throwing IOException on malformed input).                                                                                                   
                                                                                                                                                                                                                 
                             5. Addressing the Evaluation Report                                                                                                                                                 
                                - The OutOfMemoryError is prevented because any `mplen` above `MAX_RECORD_LENGTH` now triggers a controlled exception instead of unbounded allocation.                           
                                - Fuzzer inputs trying to exhaust memory will now get an `IOException` early, classified as a normal parsing error rather than resource exhaustion.                              
                                                                                                                                                                                                                 
                             6. SideEffects and Mitigation                                                                                                                                                      
                                - SideEffect: inputs with extremely large but otherwise parsable `mplen` fields will fail with IOException. This is acceptable, since such inputs are malicious                 
                             or malformed.                                                                                                                                                                       
                                - Tests: existing unit tests for MAPIAttribute will see a parsing exception rather than an OOM, which is in line with documented behavior for invalid data. No                   
                             harness or test changes are required.                                                                                                                                               
                                                                                                                                                                                                                 
                             7. References to Similar Code                                                                                                                                                       
                                - `TNEFAttribute` uses `IOUtils.safelyAllocate(length, MAX_RECORD_LENGTH)` at line 69; this pattern is mirrored here for consistency.                                            
                                - Upstream code in `StringUtil.getFromUnicodeLE` already validates offset and length; our fix ensures those preconditions cannot be violated via unbounded data.                 
                                                                                                                                                                                                                 
                             8. No Further Changes to Harness or Utility Code                                                                                                                                    
                                - This patch only affects `MAPIAttribute.java`; it does not touch fuzzing harnesses, utility functions beyond safeAllocate usage, or external dependencies.                      
                                - All existing APIs and tests will remain valid and pass unchanged.                                                                                                              
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/20/25 13:29:25] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/20/25 13:30:27] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/20/25 13:31:50] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
                    INFO     [logging_performance](apache-poi Setting owner) Took 0.89 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:31:51] INFO     [logging_performance](apache-poi Patching) Started...                                                                                                          context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpnfv0s3tx                                                                                                                                 default.py:173
[10/20/25 13:35:03] INFO     [logging_performance](apache-poi Patching) Took 192.12 seconds; exception=False                                                                               context_managers.py:23
                    INFO     [logging_performance](apache-poi Checking build) Started...                                                                                                    context_managers.py:9
[10/20/25 13:35:40] INFO     [logging_performance](apache-poi Checking build) Took 36.67 seconds; exception=False                                                                          context_managers.py:23
                    INFO     [logging_performance](apache-poi Running PoV) Started...                                                                                                       context_managers.py:9
[10/20/25 13:35:45] INFO     [logging_performance](apache-poi Running PoV) Took 5.48 seconds; exception=False                                                                              context_managers.py:23
                    INFO     [logging_performance](apache-poi Testing) Started...                                                                                                           context_managers.py:9
                    INFO     [logging_performance](apache-poi Testing) Took 0.00 seconds; exception=False                                                                                  context_managers.py:23
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:35:46] INFO     [logging_performance](apache-poi Setting owner) Took 0.88 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:35:47] INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:35:48] INFO     [logging_performance](apache-poi Setting owner) Took 0.94 seconds; exception=False                                                                            context_managers.py:23
                    INFO     [logging_performance](apache-poi Setting owner) Started...                                                                                                     context_managers.py:9
[10/20/25 13:35:49] INFO     [logging_performance](apache-poi Setting owner) Took 0.98 seconds; exception=False                                                                            context_managers.py:23
[10/20/25 13:35:50] INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.SOUND                                                                                                                                                                   
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java                                                                                                 
                             +++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java                                                                                                 
                             @@ -164,16 +164,23 @@                                                                                                                                                               
                                                name = base.name;                                                                                                                                                
                                             } else {                                                                                                                                                            
                                                // Custom name was stored                                                                                                                                        
                             -                  int mplen = LittleEndian.readInt(inp);                                                                                                                           
                             -                  if (mplen < 0) {                                                                                                                                                 
                             -                     throw new IOException("Did not expect negative value: " + mplen);                                                                                             
                             -                  }                                                                                                                                                                
                             -                  byte[] mpdata = new byte[mplen];                                                                                                                                 
                             -                  if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                        
                             -                     throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                      
                             -                  }                                                                                                                                                                
                             -                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);                                                                                                      
                             -                  skipToBoundary(mplen, inp);                                                                                                                                      
                             +                   int mplen = LittleEndian.readInt(inp);                                                                                                                          
                             +                   if (mplen < 0) {                                                                                                                                                
                             +                      throw new IOException("Did not expect negative property name length: " + mplen);                                                                             
                             +                   }                                                                                                                                                               
                             +                   if (mplen < 2 || (mplen & 1) != 0) {                                                                                                                            
                             +                      throw new IOException("Invalid or odd property name length: " + mplen);                                                                                      
                             +                   }                                                                                                                                                               
                             +                   byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.getMaxRecordLength());                                                                              
                             +                   if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                       
                             +                      throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                     
                             +                   }                                                                                                                                                               
                             +                   try {                                                                                                                                                           
                             +                      name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2) - 1);                                                                                                
                             +                   } catch (IllegalArgumentException e) {                                                                                                                          
                             +                      throw new IOException("Invalid property name data for length " + mplen, e);                                                                                  
                             +                   }                                                                                                                                                               
                             +                   skipToBoundary(mplen, inp);                                                                                                                                     
                                             }                                                                                                                                                                   
                                                                                                                                                                                                                 
                                             // Now create                                                                                                                                                       
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A fuzzing session against Apache POIs HMEF (Transport Neutral Encapsulation Format) code triggered a lowseverity security issue due to an OutOfMemoryError in                     
                             MAPIAttribute.create, when StringUtil.getFromUnicodeLE was fed unbounded Unicode data. The submitted patch attempt added validation on the incoming namelength,                    
                             replaced raw bytearray allocation with IOUtils.safelyAllocate guarded by a maximum record size constant, and wrapped the Unicode conversion in a try/catch.                        
                             However, on compilation, the patch failed in the poi-scratchpad module because it referenced TNEFAttribute.MAX_RECORD_LENGTH, which has private access. No new                      
                             fuzzer crashes are shown, but the build error blocks integration.                                                                                                                   
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Initial issue                                                                                                                                                                    
                                - A Jazzerdriven libFuzzer test input caused `java.lang.OutOfMemoryError: Java heap space`, reported as `FuzzerSecurityIssueLow`.                                               
                                - The stack trace shows the failure during `StringUtil.getFromUnicodeLE` inside `org.apache.poi.hmef.attribute.MAPIAttribute.create`.                                            
                                - The harness entry point was `POIHMEFFuzzer.fuzzerTestOneInput`, which calls into `HMEFMessage` and eventually processes MAPI attributes.                                       
                                                                                                                                                                                                                 
                             2. Key observations in the original log                                                                                                                                             
                                - The fuzzer suggestion was to reproduce with `-Xmx921m`.                                                                                                                        
                                - No bounds checks were applied to the propertyname length (`mplen`), leading to unbounded allocation of a byte array.                                                          
                                - The code read `mplen` bytes and immediately passed the entire array to StringUtil, constructing large Strings and exhausting the heap.                                         
                                                                                                                                                                                                                 
                             3. Patch attempt                                                                                                                                                                    
                                - In `poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java`, the patch replaces the existing block that reads `mplen` and allocates                     
                             `new byte[mplen]` with:                                                                                                                                                             
                                   A check that `mplen` is nonnegative, at least 2, and even.                                                                                                                  
                                   Allocation via `IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH)`.                                                                                             
                                   Wrapping the `StringUtil.getFromUnicodeLE` call in a try/catch for `IllegalArgumentException`.                                                                               
                                   Unchanged call to `skipToBoundary(mplen, inp)`.                                                                                                                              
                                - This diff spans around lines 164180 in MAPIAttribute.java.                                                                                                                    
                                                                                                                                                                                                                 
                             4. Postpatch build log                                                                                                                                                             
                                - The root error is in the `poi-scratchpad:compileJava` step:                                                                                                                    
                                  `/src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                    
                             org.apache.poi.hmef.attribute.TNEFAttribute`                                                                                                                                        
                                - The erroneous reference is to `TNEFAttribute.MAX_RECORD_LENGTH`. That constant is not publicly visible to MAPIAttribute.                                                       
                                - Numerous deprecation and uncheckedcast warnings appear elsewhere in POI, but they do not block the build.                                                                     
                                - The build fails immediately on that one compilation error in the scratchpad module.                                                                                            
                                                                                                                                                                                                                 
                             5. Areas for further investigation                                                                                                                                                  
                                - Visibility and intended value of `TNEFAttribute.MAX_RECORD_LENGTH`: should it be exposed or duplicated?                                                                        
                                - Surrounding code in `MAPIAttribute` and `TNEFAttribute` to understand how record lengths are defined and enforced across the scratchpad.                                       
                                - The implementation of `IOUtils.safelyAllocate` and its integration in the scratchpad versus core POI.                                                                          
                                - Any other code paths in HMEF message processing that read untrusted lengths without prevalidation.                                                                            
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx921m' to reproduce)                                                             
                             Caused by: java.lang.OutOfMemoryError: Java heap space                                                                                                                              
                                     at java.base/java.lang.String.<init>(String.java:657)                                                                                                                       
                                     at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:94)                                                                                                      
                                     at org.apache.poi.hmef.attribute.MAPIAttribute.create(MAPIAttribute.java:175)                                                                                               
                                     at org.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>(TNEFMAPIAttribute.java:41)                                                                                        
                                     at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:86)                                                                                                
                                     at org.apache.poi.hmef.HMEFMessage.processMessage(HMEFMessage.java:105)                                                                                                     
                                     at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:87)                                                                                                             
                                     at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:72)                                                                                                              
                                     at org.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput(POIHMEFFuzzer.java:32)                                                                                                   
                                     at java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)                                                                            
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00c00.invoke(LambdaForm$MH)                                                                                        
                                     at java.base/java.lang.invoke.LambdaForm$MH/0x0000000800d00400.invoke_MT(LambdaForm$MH)                                                                                     
                             DEDUP_TOKEN: a36f54a5f0a295bd                                                                                                                                                       
                             == libFuzzer crashing input ==                                                                                                                                                      
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             2025-10-20T13:28:36.865492627Z Execution worker Thread 6 ERROR Log4j API could not find a logging provider.                                                                         
                             Time to build schema type system: 0.859 seconds                                                                                                                                     
                             Time to generate code: 2.164 seconds                                                                                                                                                
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava                                                                                                                                            
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/util/GenericRecordUtil.java:132: warning: [unchecked] unchecked cast                                                                      
                                             m.putAll((Map<String,Supplier<?>>)baseMap);                                                                                                                         
                                                                               ^                                                                                                                                 
                               required: java.util.Map<java.lang.String,java.util.function.Supplier<?>>                                                                                                          
                               found:    java.lang.Object                                                                                                                                                        
                             /src/poi/poi/src/main/java/org/apache/poi/ss/formula/BaseFormulaEvaluator.java:225: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                     
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                     cell.setCellType(cellType);                                                                                                                                                 
                                         ^                                                                                                                                                                       
                                                                                                                                                                                                                 
                             > Task :poi-ooxml-lite-agent:compileJava9                                                                                                                                           
                             > Task :poi-ooxml-lite-agent:processResources NO-SOURCE                                                                                                                             
                             > Task :poi-ooxml-lite-agent:classes                                                                                                                                                
                             > Task :poi-ooxml-lite-agent:jar                                                                                                                                                    
                             > Task :poi-ooxml-lite-agent:javadocJar SKIPPED                                                                                                                                     
                             > Task :poi-ooxml-lite-agent:sourcesJar                                                                                                                                             
                             > Task :poi-ooxml-lite-agent:generateMetadataFileForPOIPublication SKIPPED                                                                                                          
                             > Task :poi-ooxml-lite-agent:generatePomFileForPOIPublication                                                                                                                       
                             > Task :poi-ooxml-lite-agent:signPOIPublication SKIPPED                                                                                                                             
                             > Task :poi-ooxml-lite-agent:publishPOIPublicationToMavenLocal                                                                                                                      
                             > Task :poi-ooxml-lite-agent:publishToMavenLocal                                                                                                                                    
                                                                                                                                                                                                                 
                             > Task :poi:compileJava                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/ss/usermodel/CellBase.java:39: warning: [deprecation] setCellType(org.apache.poi.ss.usermodel.CellType) in                                
                             org.apache.poi.ss.usermodel.Cell has been deprecated                                                                                                                                
                                 public final void setCellType(CellType cellType) {                                                                                                                              
                                                   ^                                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/model/InternalWorkbook.java:351: warning: [unchecked] unchecked call to                                                              
                             getMethod(java.lang.String,java.lang.Class<?>...) as a member of the raw type java.lang.Class                                                                                       
                                         Method m = clazz.getMethod(d("70757441646472657373"), long.class, long.class);                                                                                          
                                                                   ^                                                                                                                                             
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/NameRecord.java:466: warning: [deprecation] readAllContinuedRemainder() in                                                    
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                     byte[] remainder = ris.readAllContinuedRemainder();                                                                                                                         
                                                           ^                                                                                                                                                     
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/AbstractEscherHolderRecord.java:62: warning: [deprecation] readAllContinuedRemainder() in                                     
                             org.apache.poi.hssf.record.RecordInputStream has been deprecated                                                                                                                    
                                         byte[] data = in.readAllContinuedRemainder();                                                                                                                           
                                                         ^                                                                                                                                                       
                             /src/poi/poi/src/main/java/org/apache/poi/hssf/record/RecordFactoryInputStream.java:335: warning: [deprecation] processContinueRecord(byte[]) in                                    
                             org.apache.poi.hssf.record.DrawingRecord has been deprecated                                                                                                                        
                                             _lastDrawingRecord.processContinueRecord(contRec.getData());                                                                                                        
                                                               ^                                                                                                                                                 
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:541: warning: [deprecation] <R>exit(R) in org.apache.logging.log4j.Logger has been deprecated                     
                                 public <R> R exit(R result) {                                                                                                                                                   
                                              ^                                                                                                                                                                  
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:536: warning: [deprecation] exit() in org.apache.logging.log4j.Logger has been deprecated                         
                                 public void exit() {                                                                                                                                                            
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:291: warning: [deprecation] entry(java.lang.Object...) in org.apache.logging.log4j.Logger has                     
                             been deprecated                                                                                                                                                                     
                                 public void entry(Object... params) {                                                                                                                                           
                                             ^                                                                                                                                                                   
                             /src/poi/poi/src/main/java/org/apache/poi/logging/NoOpLogger.java:286: warning: [deprecation] entry() in org.apache.logging.log4j.Logger has been deprecated                        
                                 public void entry() {                                                                                                                                                           
                                             ^                                                                                                                                                                   
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:generatePomFileForPOIPublication                                                                                                                             
                             > Task :poi-examples:generatePomFileForPOIPublication                                                                                                                               
                             > Task :poi:compileJava9                                                                                                                                                            
                             > Task :poi:processResources                                                                                                                                                        
                             > Task :poi:classes                                                                                                                                                                 
                             > Task :poi:jar                                                                                                                                                                     
                             > Task :poi:javadocJar                                                                                                                                                              
                             > Task :poi:sourcesJar                                                                                                                                                              
                             > Task :poi:generateMetadataFileForPOIPublication SKIPPED                                                                                                                           
                             > Task :poi:generatePomFileForPOIPublication                                                                                                                                        
                             > Task :poi:signPOIPublication SKIPPED                                                                                                                                              
                             > Task :poi:publishPOIPublicationToMavenLocal                                                                                                                                       
                             > Task :poi:publishToMavenLocal                                                                                                                                                     
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava                                                                                                                                                  
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                          
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                  
                                                                                                           ^                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFDocument.java:337: warning: [deprecation]                                                                             
                             PicturesTable(org.apache.poi.hwpf.HWPFDocument,byte[],byte[],org.apache.poi.hwpf.model.FSPATable,org.apache.poi.hwpf.model.OfficeArtContent) in                                     
                             org.apache.poi.hwpf.model.PicturesTable has been deprecated                                                                                                                         
                                     _pictures = new PicturesTable(this, _dataStream, _mainStream, _fspaMain, officeArtContent);                                                                                 
                                                 ^                                                                                                                                                               
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:225: warning: [deprecation] getCharacterStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     CharacterProperties base = _styleSheet.getCharacterStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/HWPFList.java:243: warning: [deprecation] getParagraphStyle(int) in                                             
                             org.apache.poi.hwpf.model.StyleSheet has been deprecated                                                                                                                            
                                     ParagraphProperties base = _styleSheet.getParagraphStyle( styleIndex );                                                                                                     
                                                                           ^                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked method invocation: constructor <init> in                   
                             class org.apache.poi.hwpf.model.PropertyNode is applied to given types                                                                                                              
                                     super(other);                                                                                                                                                               
                                          ^                                                                                                                                                                      
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found: org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                                 
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/BytePropertyNode.java:35: warning: [unchecked] unchecked conversion                                                 
                                     super(other);                                                                                                                                                               
                                           ^                                                                                                                                                                     
                               required: org.apache.poi.hwpf.model.PropertyNode<T>                                                                                                                               
                               found:    org.apache.poi.hwpf.model.BytePropertyNode                                                                                                                              
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Table.java:89: warning: [deprecation] TYPE_TABLE in org.apache.poi.hwpf.usermodel.Range has                     
                             been deprecated                                                                                                                                                                     
                                     return TYPE_TABLE;                                                                                                                                                          
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/usermodel/Section.java:238: warning: [deprecation] TYPE_SECTION in org.apache.poi.hwpf.usermodel.Range                    
                             has been deprecated                                                                                                                                                                 
                                     return TYPE_SECTION;                                                                                                                                                        
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/ListFormatOverrideLevel.java:44: warning: [deprecation] ListLevel(byte[],int) in                                    
                             org.apache.poi.hwpf.model.ListLevel has been deprecated                                                                                                                             
                                         _lvl = new ListLevel( buf, offset );                                                                                                                                    
                                                ^                                                                                                                                                                
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/HWPFOldDocument.java:147: warning: [deprecation]                                                                          
                             OldSectionTable(byte[],int,int,int,org.apache.poi.hwpf.model.TextPieceTable) in org.apache.poi.hwpf.model.OldSectionTable has been deprecated                                       
                                     _st = new OldSectionTable(                                                                                                                                                  
                                           ^                                                                                                                                                                     
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hwpf/model/SinglentonTextPiece.java:39: warning: [deprecation] characterLength() in                                            
                             org.apache.poi.hwpf.model.TextPiece has been deprecated                                                                                                                             
                                 public int characterLength()                                                                                                                                                    
                                            ^                                                                                                                                                                    
                             /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hslf/usermodel/HSLFSlide.java:492: warning: [deprecation]                                                                      
                             getDisplayPlaceholder(org.apache.poi.sl.usermodel.Placeholder) in org.apache.poi.sl.usermodel.Slide has been deprecated                                                             
                                 public boolean getDisplayPlaceholder(final Placeholder placeholder) {                                                                                                           
                                                ^                                                                                                                                                                
                             1 error                                                                                                                                                                             
                             11 warnings                                                                                                                                                                         
                                                                                                                                                                                                                 
                             > Task :poi-scratchpad:compileJava FAILED                                                                                                                                           
                             > Task :poi-ooxml:generatePomFileForPOIPublication                                                                                                                                  
                             > Task :poi-ooxml-full:compileJava                                                                                                                                                  
                                                                                                                                                                                                                 
                             [Incubating] Problems report is available at: file:///src/poi/build/reports/problems/problems-report.html                                                                           
                                                                                                                                                                                                                 
                             FAILURE: Build failed with an exception.                                                                                                                                            
                                                                                                                                                                                                                 
                             * What went wrong:                                                                                                                                                                  
                             Execution failed for task ':poi-scratchpad:compileJava'.                                                                                                                            
                             > Compilation failed; see the compiler output below.                                                                                                                                
                               /src/poi/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:174: error: MAX_RECORD_LENGTH has private access in                                        
                             org.apache.poi.hmef.attribute.TNEFAttribute                                                                                                                                         
                                                  byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.MAX_RECORD_LENGTH);                                                                                
                                                                                                             ^                                                                                                   
                               1 error                                                                                                                                                                           
                               11 warnings                                                                                                                                                                       
                                                                                                                                                                                                                 
                             * Try:                                                                                                                                                                              
                             > Check your code and dependencies to fix the compilation error(s)                                                                                                                  
                             > Run with --scan to get full insights.                                                                                                                                             
                                                                                                                                                                                                                 
                             Deprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.                                                                                         
                                                                                                                                                                                                                 
                             You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.                                           
                                                                                                                                                                                                                 
                             For more on this, please refer to https://docs.gradle.org/8.14.2/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.                       
                                                                                                                                                                                                                 
                             BUILD FAILED in 2m 11s                                                                                                                                                              
                             41 actionable tasks: 40 executed, 1 up-to-date                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker build -t aixcc-afc/apache-poi:latest --file /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi/Dockerfile                   
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/projects/apache-poi.                                                                                                       
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.43kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/14] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 2.48kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [11/14] RUN apt-get update     && apt-get install -y      fontconfig=2.13.1-2ubuntu3     libfreetype6=2.10.1-2ubuntu0.4      libxext6=2:1.3.4-0ubuntu1                           
                             libx11-6=2:1.6.9-2ubuntu1.6     libxrender1=1:0.9.10-1      libxtst6=2:1.2.3-1     libxi6=2:1.7.10-0ubuntu1     libxcb1=1.14-2     libxau6=1:1.0.9-0ubuntu1                         
                             libxdmcp6=1:1.1.3-0ubuntu1 --no-install-recommends && apt-get clean autoclean && apt-get autoremove --yes && rm -rf /var/lib/apt && rm -rf var/lib/dpkg && rm -rf                   
                             /var/lib/cache && rm -rf /var/lib/log                                                                                                                                               
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [ 7/14] COPY pkgs/OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz /src/                                                                                                        
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [10/14] RUN tar -xzvf apache-poi.tar.gz &&     mv apache-poi poi && rm apache-poi.tar.gz                                                                                         
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 8/14] RUN tar xvf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz &&   rm -rf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz                                              
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 3/14] COPY pkgs/maven.zip /src/                                                                                                                                               
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 6/14] RUN tar xvf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz &&   rm -rf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz                                                 
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 4/14] RUN unzip maven.zip -d "/src/maven-3.6.3" && rm -rf maven.zip                                                                                                           
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [13/14] COPY src/ /src/src/                                                                                                                                                     
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [ 2/14] WORKDIR /src                                                                                                                                                            
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [12/14] COPY pom.xml build.sh *.options /src/                                                                                                                                   
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 5/14] COPY pkgs/OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz /src/                                                                                                         
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [ 9/14] COPY pkgs/apache-poi.tar.gz /src/                                                                                                                                       
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 [14/14] WORKDIR /src/poi                                                                                                                                                        
                             #18 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #19 exporting to image                                                                                                                                                              
                             #19 exporting layers done                                                                                                                                                           
                             #19 writing image sha256:db2ab0499c70ef777ccf115c8ad7c7e3bc5dc5b80d30b537f5e32a24bff67e22 done                                                                                      
                             #19 naming to docker.io/aixcc-afc/apache-poi:latest done                                                                                                                            
                             #19 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=apache-poi -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                    
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/official-afc-poi:/local-source-mount:ro -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/out/apache-poi/:/out -v                                                                                              
                             /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/fuzz-tooling/build/work/apache-poi:/work -t aixcc-afc/apache-poi:latest /bin/bash -c 'pushd $SRC && rm -rf /src/poi &&                  
                             cp -r /local-source-mount /src/poi && popd && compile'.                                                                                                                             
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.java:1-80                                                                                                  
                             ```                                                                                                                                                                                 
                             1:/* ====================================================================                                                                                                           
                             2:   Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3:   contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4:   this work for additional information regarding copyright ownership.                                                                                                            
                             5:   The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6:   (the "License"); you may not use this file except in compliance with                                                                                                           
                             7:   the License.  You may obtain a copy of the License at                                                                                                                          
                             8:                                                                                                                                                                                  
                             9:       http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                 
                             10:                                                                                                                                                                                 
                             11:   Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12:   distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14:   See the License for the specific language governing permissions and                                                                                                           
                             15:   limitations under the License.                                                                                                                                                
                             16:==================================================================== */                                                                                                          
                             17:                                                                                                                                                                                 
                             18:package org.apache.poi.hmef.attribute;                                                                                                                                           
                             19:                                                                                                                                                                                 
                             20:import java.io.IOException;                                                                                                                                                      
                             21:import java.io.InputStream;                                                                                                                                                      
                             22:                                                                                                                                                                                 
                             23:import org.apache.poi.hmef.Attachment;                                                                                                                                           
                             24:import org.apache.poi.hmef.HMEFMessage;                                                                                                                                          
                             25:import org.apache.poi.util.IOUtils;                                                                                                                                              
                             26:import org.apache.poi.util.LittleEndian;                                                                                                                                         
                             27:                                                                                                                                                                                 
                             28:                                                                                                                                                                                 
                             29:/**                                                                                                                                                                              
                             30: * An attribute which applies to a {@link HMEFMessage}                                                                                                                           
                             31: *  or one of its {@link Attachment}s.                                                                                                                                           
                             32: * Note - the types and IDs differ from standard Outlook/MAPI                                                                                                                    
                             33: *  ones, so we can't just re-use the HSMF ones.                                                                                                                                 
                             34: */                                                                                                                                                                              
                             35:public class TNEFAttribute {                                                                                                                                                     
                             36:                                                                                                                                                                                 
                             37:   //arbitrarily selected; may need to increase                                                                                                                                  
                             38:   private static final int DEFAULT_MAX_RECORD_LENGTH = 20_000_000;                                                                                                              
                             39:   private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;                                                                                                             
                             40:                                                                                                                                                                                 
                             41:   private final TNEFProperty property;                                                                                                                                          
                             42:   private final int type;                                                                                                                                                       
                             43:   private final byte[] data;                                                                                                                                                    
                             44:   private final int checksum;                                                                                                                                                   
                             45:                                                                                                                                                                                 
                             46:   /**                                                                                                                                                                           
                             47:    * @param length the max record length allowed for TNEFAttribute                                                                                                              
                             48:    */                                                                                                                                                                           
                             49:   public static void setMaxRecordLength(int length) {                                                                                                                           
                             50:      MAX_RECORD_LENGTH = length;                                                                                                                                                
                             51:   }                                                                                                                                                                             
                             52:                                                                                                                                                                                 
                             53:   /**                                                                                                                                                                           
                             54:    * @return the max record length allowed for TNEFAttribute                                                                                                                    
                             55:    */                                                                                                                                                                           
                             56:   public static int getMaxRecordLength() {                                                                                                                                      
                             57:      return MAX_RECORD_LENGTH;                                                                                                                                                  
                             58:   }                                                                                                                                                                             
                             59:                                                                                                                                                                                 
                             60:   /**                                                                                                                                                                           
                             61:    * Constructs a single new attribute from the id, type,                                                                                                                       
                             62:    *  and the contents of the stream                                                                                                                                            
                             63:    */                                                                                                                                                                           
                             64:   protected TNEFAttribute(int id, int type, InputStream inp) throws IOException {                                                                                               
                             65:      this.type = type;                                                                                                                                                          
                             66:      int length = LittleEndian.readInt(inp);                                                                                                                                    
                             67:                                                                                                                                                                                 
                             68:      property = TNEFProperty.getBest(id, type);                                                                                                                                 
                             69:      data = IOUtils.safelyAllocate(length, MAX_RECORD_LENGTH);                                                                                                                  
                             70:      IOUtils.readFully(inp, data);                                                                                                                                              
                             71:                                                                                                                                                                                 
                             72:      checksum = LittleEndian.readUShort(inp);                                                                                                                                   
                             73:   }                                                                                                                                                                             
                             74:                                                                                                                                                                                 
                             75:   /**                                                                                                                                                                           
                             76:    * Creates a new TNEF Attribute by reading data from                                                                                                                          
                             77:    *  the stream within a {@link HMEFMessage}                                                                                                                                   
                             78:    */                                                                                                                                                                           
                             79:   public static TNEFAttribute create(InputStream inp) throws IOException {                                                                                                      
                             80:      int id   = LittleEndian.readUShort(inp);                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java:167-175                                                                                               
                             ```                                                                                                                                                                                 
                             167:                  int mplen = LittleEndian.readInt(inp);                                                                                                                        
                             168:                  if (mplen < 0) {                                                                                                                                              
                             169:                     throw new IOException("Did not expect negative value: " + mplen);                                                                                          
                             170:                  }                                                                                                                                                             
                             171:                  byte[] mpdata = new byte[mplen];                                                                                                                              
                             172:                  if (IOUtils.readFully(inp, mpdata) < 0) {                                                                                                                     
                             173:                     throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");                                                                   
                             174:                  }                                                                                                                                                             
                             175:                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             poi/src/main/java/org/apache/poi/util/IOUtils.java:571-577                                                                                                                          
                             ```                                                                                                                                                                                 
                             571:    public static byte[] safelyAllocate(long length, int maxLength) {                                                                                                           
                             572:        safelyAllocateCheck(length, maxLength);                                                                                                                                 
                             573:                                                                                                                                                                                
                             574:        checkByteSizeLimit(length);                                                                                                                                             
                             575:                                                                                                                                                                                
                             576:        return new byte[(int)length];                                                                                                                                           
                             577:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             poi-scratchpad/src/main/java/org/apache/poi/hsmf/datatypes/PropertiesChunk.java:88-101                                                                                              
                             ```                                                                                                                                                                                 
                             88:                                                                                                                                                                                 
                             89:    /**                                                                                                                                                                          
                             90:     * @param length the max record length allowed for PropertiesChunk                                                                                                           
                             91:     */                                                                                                                                                                          
                             92:    public static void setMaxRecordLength(int length) {                                                                                                                          
                             93:        MAX_RECORD_LENGTH = length;                                                                                                                                              
                             94:    }                                                                                                                                                                            
                             95:                                                                                                                                                                                 
                             96:    /**                                                                                                                                                                          
                             97:     * @return the max record length allowed for PropertiesChunk                                                                                                                 
                             98:     */                                                                                                                                                                          
                             99:    public static int getMaxRecordLength() {                                                                                                                                     
                             100:        return MAX_RECORD_LENGTH;                                                                                                                                               
                             101:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Tests Result===                                                                                                                                                                  
                             No tests found                                                                                                                                                                      
                             ===Evaluation End===                                                                                                                                                                
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                                                      __init__.py:160
                             (n evals: 3, patch status: PatchStatus.SOUND)                                                                                                                                       
                    INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpiahldc5z                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/apache-poi-poi-full-01-vuln_1/agent-output-1760967350.2285557                                                                       
                             - Detection toml file: /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/detection/apache-poi-poi-full-01-vuln_1.toml                                                                     
                             - Challenge project directory: /tasks/9f4f673a-9570-46d1-bfb2-cafe4625487b/official-afc-poi                                                                                         
                                                                                                                                                                                                                 
