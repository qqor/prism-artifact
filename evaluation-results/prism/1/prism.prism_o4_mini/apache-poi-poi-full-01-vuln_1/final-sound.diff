--- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
+++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java
@@ -164,16 +164,23 @@
                   name = base.name;
                } else {
                   // Custom name was stored
-                  int mplen = LittleEndian.readInt(inp);
-                  if (mplen < 0) {
-                     throw new IOException("Did not expect negative value: " + mplen);
-                  }
-                  byte[] mpdata = new byte[mplen];
-                  if (IOUtils.readFully(inp, mpdata) < 0) {
-                     throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");
-                  }
-                  name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2)-1);
-                  skipToBoundary(mplen, inp);
+                   int mplen = LittleEndian.readInt(inp);
+                   if (mplen < 0) {
+                      throw new IOException("Did not expect negative property name length: " + mplen);
+                   }
+                   if (mplen < 2 || (mplen & 1) != 0) {
+                      throw new IOException("Invalid or odd property name length: " + mplen);
+                   }
+                   byte[] mpdata = IOUtils.safelyAllocate(mplen, TNEFAttribute.getMaxRecordLength());
+                   if (IOUtils.readFully(inp, mpdata) < 0) {
+                      throw new IOException("Not enough data to read " + mplen + " bytes for attribute name");
+                   }
+                   try {
+                      name = StringUtil.getFromUnicodeLE(mpdata, 0, (mplen/2) - 1);
+                   } catch (IllegalArgumentException e) {
+                      throw new IOException("Invalid property name data for length " + mplen, e);
+                   }
+                   skipToBoundary(mplen, inp);
                }
 
                // Now create
