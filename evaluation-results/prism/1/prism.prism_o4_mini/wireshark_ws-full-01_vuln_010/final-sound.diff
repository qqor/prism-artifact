--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -704,9 +704,9 @@
 
 	/* Allocate buffer for signature field */
 	if (flag & 0x80) {
-		signature = g_malloc( NB_SIZE_HMAC + 1);
+		signature = g_malloc((NB_SIZE_HMAC * 2) + 1);
 	} else {
-		signature = g_malloc( NB_SIZE_TMAC + 1);
+		signature = g_malloc((NB_SIZE_TMAC * 2) + 1);
 	}
 
 	if (signature == NULL)
