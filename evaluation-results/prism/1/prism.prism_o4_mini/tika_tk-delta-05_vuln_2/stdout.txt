[2;36m[12/27/25 13:53:07][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=925937;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=179173;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp85rcoi_g[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-05_vuln_2/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66843587.59712[0m                                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-05_vuln_2.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=847007;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=511274;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:54:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m108.27[0m ]8;id=5217;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=718257;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=114607;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=453459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=478568;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=199747;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=360181;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=61666;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m108[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=388308;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=150730;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:54:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.02[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=258562;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=187601;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 13:54:58][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=470655;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=191244;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=299288;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=520610;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=673218;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=988271;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=607696;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=312623;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:55:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.51[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=549852;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=663698;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=785512;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=68415;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:55:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=693477;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=562701;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 13:55:14][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=712691;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=152356;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp6198892121778572931/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkFile[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:304[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkObj[0m[1m([0mFilePathTraversa [2m                [0m
[2;36m                    [0m         l.jav[1;92ma:288[0m[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.processFileOutputStartHoo[0m [2m                [0m
[2;36m                    [0m         [1;35mk[0m[1m([0mFilePathTraversal.jav[1;92ma:256[0m[1m)[0m                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1111[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1057[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:486[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:238[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ea76e639355e804b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp6198892121778572931/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkFile[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:304[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkObj[0m[1m([0mFilePathTraversa [2m                [0m
[2;36m                    [0m         l.jav[1;92ma:288[0m[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.processFileOutputStartHoo[0m [2m                [0m
[2;36m                    [0m         [1;35mk[0m[1m([0mFilePathTraversal.jav[1;92ma:256[0m[1m)[0m                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1111[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1057[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:486[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:238[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ea76e639355e804b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/27/25 13:55:19][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=115849;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=381040;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 13:56:01][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=408276;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=483190;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/27/25 13:56:24][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=741495;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=276517;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=825200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=45139;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:56:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.01[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=370435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=687176;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=294520;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=149680;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp9uf10pqw[0m                                                 ]8;id=971601;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=493795;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/27/25 13:57:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m76.29[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=274798;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=916394;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=652495;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=773954;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:58:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m33.18[0m seconds;                ]8;id=503357;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=514512;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=60854;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=645712;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:58:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m11.73[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=180830;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=785814;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=209198;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=510880;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=716662;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=30605;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=194613;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=32804;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:58:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=784857;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=126821;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 13:58:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=325534;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=366786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:58:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=990629;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=631393;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=272542;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=392381;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/27/25 13:58:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.07[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=489447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=7644;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/27/25 13:58:32][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=454486;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=929088;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java                       [2m                [0m
[2;36m                    [0m         +++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java                       [2m                [0m
[2;36m                    [0m         @@ [1;36m-1157[0m,[1;36m13[0m +[1;36m1157[0m,[1;36m22[0m @@                                                             [2m                [0m
[2;36m                    [0m                      [1m}[0m catch [1m([0mIllegalArgumentException e[1m)[0m [1m{[0m                                 [2m                [0m
[2;36m                    [0m                          [1;35mLOG.warn[0m[1m([0m[32m"couldn't url decode name [0m[32m{[0m[32m}[0m[32m"[0m, normalizedName[1m)[0m;           [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -            File outputFile = new [1;35mFile[0m[1m([0mextractDir, normalizedName[1m)[0m;                [2m                [0m
[2;36m                    [0m         +            java.nio.file.Path baseDir =                                           [2m                [0m
[2;36m                    [0m         [1;35mextractDir.toPath[0m[1m([0m[1m)[0m[1;35m.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                                   [2m                [0m
[2;36m                    [0m         +            java.nio.file.Path candidate =                                         [2m                [0m
[2;36m                    [0m         [1;35mbaseDir.resolve[0m[1m([0mnormalizedName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                                        [2m                [0m
[2;36m                    [0m         +            if [1m([0m![1;35mcandidate.startsWith[0m[1m([0mbaseDir[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m         +                String safeName = [1;35mFilenameUtils.getName[0m[1m([0mnormalizedName[1m)[0m;           [2m                [0m
[2;36m                    [0m         +                candidate = [1;35mbaseDir.resolve[0m[1m([0msafeName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                 [2m                [0m
[2;36m                    [0m         +                if [1m([0m![1;35mcandidate.startsWith[0m[1m([0mbaseDir[1m)[0m[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         +                    String uniqueName = [1;35mUUID.randomUUID[0m[1m([0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m + [32m"-"[0m +       [2m                [0m
[2;36m                    [0m         safeName;                                                                           [2m                [0m
[2;36m                    [0m         +                    candidate = [1;35mbaseDir.resolve[0m[1m([0muniqueName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;           [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         +            File outputFile = [1;35mcandidate.toFile[0m[1m([0m[1m)[0m;                                  [2m                [0m
[2;36m                    [0m                      [35m/[0m[35m/[0m[95mif[0m file already exists, prepend uuid                                 [2m                [0m
[2;36m                    [0m                      if [1m([0m[1;35moutputFile.exists[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                             [2m                [0m
[2;36m                    [0m                          String fileName = [1;35mFilenameUtils.getName[0m[1m([0mnormalizedName[1m)[0m;           [2m                [0m
[2;36m                    [0m         -                outputFile = new [1;35mFile[0m[1m([0mextractDir, UUID                             [2m                [0m
[2;36m                    [0m         -                        [1;35m.randomUUID[0m[1m([0m[1m)[0m                                              [2m                [0m
[2;36m                    [0m         -                        [1;35m.toString[0m[1m([0m[1m)[0m + [32m"-"[0m + fileName[1m)[0m;                             [2m                [0m
[2;36m                    [0m         +                java.nio.file.Path newCandidate =                                  [2m                [0m
[2;36m                    [0m         [1;35mbaseDir.resolve[0m[1m([0m[1;35mUUID.randomUUID[0m[1m([0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m + [32m"-"[0m + fileName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;         [2m                [0m
[2;36m                    [0m         +                outputFile = [1;35mnewCandidate.toFile[0m[1m([0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                      return outputFile;                                                     [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp6198892121778572931/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkFile[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:304[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkObj[0m[1m([0mFilePathTraversa [2m                [0m
[2;36m                    [0m         l.jav[1;92ma:288[0m[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.processFileOutputStartHoo[0m [2m                [0m
[2;36m                    [0m         [1;35mk[0m[1m([0mFilePathTraversal.jav[1;92ma:256[0m[1m)[0m                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1111[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1057[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:486[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:238[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ea76e639355e804b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A Jazzer-based fuzzing run against an Apache Tika‚Äìpowered unpacker triggered a      [2m                [0m
[2;36m                    [0m         `FuzzerSecurityIssueCritical` exception, indicating a file path traversal           [2m                [0m
[2;36m                    [0m         vulnerability. The sanitizer detected that a crafted input caused the extraction    [2m                [0m
[2;36m                    [0m         logic to write files outside the intended directory [1m([0me.g., using                    [2m                [0m
[2;36m                    [0m         ‚Äú..[35m/../[0m[95mjazzer-traversal[0m‚Äù[1m)[0m. The issue arises during embedded-document extraction in  [2m                [0m
[2;36m                    [0m         the Tika CLI pipeline.                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue                                                                             [2m                [0m
[2;36m                    [0m           A security sanitizer in the Jazzer fuzzing framework flagged a critical file path [2m                [0m
[2;36m                    [0m         traversal when processing a test input. The exception message shows that an output  [2m                [0m
[2;36m                    [0m         path containing ‚Äú..[35m/../[0m[95mjazzer-traversal[0m‚Äù escapes the intended temporary directory   [2m                [0m
[2;36m                    [0m         [1m([0m`[35m/tmp/expander-tmp6198892121778572931/output/q/r/s/t/[0m[95m...[0m`[1m)[0m.                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Vulnerability Type                                                                [2m                [0m
[2;36m                    [0m           File path traversal [1m([0malso known as directory traversal[1m)[0m: an adversary-controlled  [2m                [0m
[2;36m                    [0m         path component allows writing or accessing files outside of a designated directory. [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Key Observations                                                                  [2m                [0m
[2;36m                    [0m           ‚Ä¢ The exception originates in the Jazzer sanitizer `FilePathTraversal.check` and  [2m                [0m
[2;36m                    [0m         `checkFile`, which detect attempts to traverse upward in the directory hierarchy.   [2m                [0m
[2;36m                    [0m           ‚Ä¢ The stack trace shows calls through Tika‚Äôs                                      [2m                [0m
[2;36m                    [0m         `FileEmbeddedDocumentExtractor.parseEmbedded`, `PackageParser.parseEntry`, and      [2m                [0m
[2;36m                    [0m         ultimately `TikaCLI.process`.                                                       [2m                [0m
[2;36m                    [0m           ‚Ä¢ The fuzzer harness [1m([0m`TikaAppUnpackerFuzzer.fuzzerTestOneInput`[1m)[0m invokes the     [2m                [0m
[2;36m                    [0m         Tika CLI logic but is not itself the root cause; it merely provides entry-point     [2m                [0m
[2;36m                    [0m         inputs.                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Relevant Code Areas for Investigation                                             [2m                [0m
[2;36m                    [0m           [1;36m1[0m. **FilePathTraversal Sanitizer**                                                [2m                [0m
[2;36m                    [0m         [1m([0mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal[1m)[0m: review how paths are   [2m                [0m
[2;36m                    [0m         sanitized and validated.                                                            [2m                [0m
[2;36m                    [0m           [1;36m2[0m. **Embedded Document Extraction** in Tika                                       [2m                [0m
[2;36m                    [0m         [1m([0morg.apache.tika.cli.TikaCLI$FileEmbeddedDocumentExtractor[1m)[0m: examine how extracted  [2m                [0m
[2;36m                    [0m         entries‚Äô paths are constructed.                                                     [2m                [0m
[2;36m                    [0m           [1;36m3[0m. **PackageParser** [1m([0morg.apache.tika.parser.pkg.PackageParser[1m)[0m: trace how        [2m                [0m
[2;36m                    [0m         archive entries‚Äô names map to filesystem locations.                                 [2m                [0m
[2;36m                    [0m           [1;36m4[0m. **TikaCLI Output Handling** [1m([0morg.apache.tika.cli.TikaCLI$OutputType.process[1m)[0m:  [2m                [0m
[2;36m                    [0m         review overall output directory management.                                         [2m                [0m
[2;36m                    [0m           [1;36m5[0m. **Fuzzer Harness** [1m([0mcom.example.TikaAppUnpackerFuzzer[1m)[0m: while not the defect   [2m                [0m
[2;36m                    [0m         source, it drives the code under test and may help reproduce the traversal          [2m                [0m
[2;36m                    [0m         scenario.                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Observations for Holistic View                                                    [2m                [0m
[2;36m                    [0m           ‚Ä¢ How entry names from various archive formats are normalized before file         [2m                [0m
[2;36m                    [0m         creation.                                                                           [2m                [0m
[2;36m                    [0m           ‚Ä¢ Whether relative path segments [1m([0m`..`[1m)[0m are stripped or validated.                [2m                [0m
[2;36m                    [0m           ‚Ä¢ The interplay between temporary directory creation and nested output paths.     [2m                [0m
[2;36m                    [0m           ‚Ä¢ Differences in behavior across parser implementations [1m([0me.g., ZIP versus other   [2m                [0m
[2;36m                    [0m         package formats[1m)[0m.                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         No root-cause analysis or remediation steps are included. The report focuses solely [2m                [0m
[2;36m                    [0m         on the observed symptom‚Äîa critical file path traversal detected during fuzz         [2m                [0m
[2;36m                    [0m         testing‚Äîand the code areas that should be reviewed to understand the issue fully.   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp6198892121778572931/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkFile[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:304[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkObj[0m[1;39m([0m[39mFilePathTraversa[0m [2m                [0m
[2;36m                    [0m         [39ml.jav[0m[1;92ma:288[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.processFileOutputStartHoo[0m [2m                [0m
[2;36m                    [0m         [1;35mk[0m[1;39m([0m[39mFilePathTraversal.jav[0m[1;92ma:256[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.cli.TikaCLI$[0m[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mTikaCLI.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1111[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:481[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:386[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:336[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:259[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.tika.cli.TikaCLI$[0m[1;35mOutputType.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:1057[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:486[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.main[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:238[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:54[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ea76e639355e804b[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1000[0m[39m-[0m[1;36m1150[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:        public boolean [0m[1;35mmetOutput[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:            return this.metOutput;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:     * Outputs the Tika metadata as XMP using the Tika XMP module[0m              [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:    private static class NoDocumentXMPMetaHandler extends DefaultHandler [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:        protected final Metadata metadata;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:        protected PrintWriter writer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1017[0m[39m:        public [0m[1;35mNoDocumentXMPMetaHandler[0m[1;39m([0m[39mMetadata metadata, PrintWriter writer[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1018[0m[39m:            this.metadata = metadata;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1019[0m[39m:            this.writer = writer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1020[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1021[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1022[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1023[0m[39m:        public void [0m[1;35mendDocument[0m[1;39m([0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1024[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1025[0m[39m:                XMPMetadata xmp = new [0m[1;35mXMPMetadata[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1026[0m[39m:                String result;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1027[0m[39m:                result = [0m[1;35mxmp.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1028[0m[39m:                [0m[1;35mwriter.write[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1029[0m[39m:                [0m[1;35mwriter.flush[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1030[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1031[0m[39m:                throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1032[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1033[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1034[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1035[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1036[0m[39m:    private static class SimplePasswordProvider implements PasswordProvider, [0m  [2m                [0m
[2;36m                    [0m         [39mSerializable [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1037[0m[39m:        private final String password;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1038[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1039[0m[39m:        public [0m[1;35mSimplePasswordProvider[0m[1;39m([0m[39mString password[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1040[0m[39m:            this.password = password;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1041[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1042[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1043[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1044[0m[39m:        public String [0m[1;35mgetPassword[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1045[0m[39m:            return password;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1046[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1047[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1048[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1049[0m[39m:    private class OutputType [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:        public void [0m[1;35mprocess[0m[1;39m([0m[39mInputStream input, OutputStream output, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:            Parser p = parser;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:            if [0m[1;39m([0m[39mfork[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:                p = new [0m[1;35mForkParser[0m[1;39m([0m[1;35mTikaCLI.class.getClassLoader[0m[1;39m([0m[1;39m)[0m[39m, p[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:            ContentHandler handler = [0m[1;35mgetContentHandler[0m[1;39m([0m[39moutput, metadata[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:                [0m[1;35mp.parse[0m[1;39m([0m[39minput, handler, metadata, context[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:                [0m[35m/[0m[35m/[0m[39m fix for TIKA-[0m[1;36m596[0m[39m: if a parser doesn't generate[0m              [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:                [0m[35m/[0m[35m/[0m[39m XHTML output, the lack of an output document prevents[0m       [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:                [0m[35m/[0m[35m/[0m[39m metadata from being output: this fixes that[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:                if [0m[1;39m([0m[39mhandler instanceof NoDocumentMetHandler[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:                    NoDocumentMetHandler metHandler = [0m[1;39m([0m[39mNoDocumentMetHandler[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mhandler;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:                    if [0m[1;39m([0m[39m![0m[1;35mmetHandler.metOutput[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:                        [0m[1;35mmetHandler.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:                if [0m[1;39m([0m[39mfork[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:                    [0m[1;39m([0m[1;39m([0m[39mForkParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:        protected ContentHandler [0m[1;35mgetContentHandler[0m[1;39m([0m[39mOutputStream output, [0m       [2m                [0m
[2;36m                    [0m         [39mMetadata metadata[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:            throw new [0m[1;35mUnsupportedOperationException[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:    private class FileEmbeddedDocumentExtractor implements [0m                    [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:        private final TikaConfig config = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:        private final EmbeddedStreamTranslator embeddedStreamTranslator = new [0m [2m                [0m
[2;36m                    [0m         [1;35mDefaultEmbeddedStreamTranslator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:        private int count = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:        public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:        public void [0m[1;35mparseEmbedded[0m[1;39m([0m[39mTikaInputStream tis, ContentHandler [0m         [2m                [0m
[2;36m                    [0m         [39mcontentHandler, Metadata metadata, boolean outputHtml[0m[1;39m)[0m[39m throws SAXException, [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:            MediaType contentType = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:            File outputFile = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:            if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:                name = [0m[32m"file"[0m[39m + count++;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:            outputFile = [0m[1;35mgetOutputFile[0m[1;39m([0m[39mname, metadata, contentType[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:            File parent = [0m[1;35moutputFile.getParentFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mparent.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparent.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1106[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"unable to create directory \""[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mparent + [0m[32m"\""[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1107[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1108[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1109[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"Extracting '"[0m[39m + name + [0m[32m"' [0m[32m([0m[32m"[0m[39m + contentType + [0m  [2m                [0m
[2;36m                    [0m         [32m"[0m[32m)[0m[32m to "[0m[39m + outputFile[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1110[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1111[0m[39m:            try [0m[1;39m([0m[39mFileOutputStream os = new [0m[1;35mFileOutputStream[0m[1;39m([0m[39moutputFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1112[0m[39m:                if [0m[1;39m([0m[1;35membeddedStreamTranslator.shouldTranslate[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m1113[0m[39m:                    try [0m[1;39m([0m[39mInputStream translated = [0m                             [2m                [0m
[2;36m                    [0m         [1;35membeddedStreamTranslator.translate[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1114[0m[39m:                        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mtranslated, os[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1115[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1116[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1117[0m[39m:                    [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1118[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1119[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1120[0m[39m:                [0m[35m/[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1121[0m[39m:                [0m[35m/[0m[35m/[0m[39m being a CLI program messages should go to the stderr too[0m    [2m                [0m
[2;36m                    [0m         [1;36m1122[0m[39m:                [0m[35m/[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1123[0m[39m:                String msg = [0m[1;35mString.format[0m[1;39m([0m[39mLocale.ROOT, [0m[32m"Ignoring unexpected [0m  [2m                [0m
[2;36m                    [0m         [32mexception trying to save embedded file %s [0m[32m([0m[32m%s[0m[32m)[0m[32m"[0m[39m, name, [0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1124[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[39mmsg, e[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1125[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1126[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1127[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1128[0m[39m:        private File [0m[1;35mgetOutputFile[0m[1;39m([0m[39mString name, Metadata metadata, MediaType [0m  [2m                [0m
[2;36m                    [0m         [39mcontentType[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1129[0m[39m:            String ext = [0m[1;35mgetExtension[0m[1;39m([0m[39mcontentType[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1130[0m[39m:            if [0m[1;39m([0m[1;35mname.indexOf[0m[1;39m([0m[32m'.'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[39m && contentType != null[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1131[0m[39m:                name += ext;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1132[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1133[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1134[0m[39m:            String relID = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1135[0m[39m:            if [0m[1;39m([0m[39mrelID != null && ![0m[1;35mname.startsWith[0m[1;39m([0m[39mrelID[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1136[0m[39m:                name = relID + [0m[32m"_"[0m[39m + name;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1137[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1138[0m[39m:            [0m[35m/[0m[35m/[0m[95mdefensively[0m[39m do this so that we don't get an exception[0m            [2m                [0m
[2;36m                    [0m         [1;36m1139[0m[39m:            [0m[35m/[0m[35m/[0m[95mfrom[0m[39m FilenameUtils.normalize[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:            name = [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"\u0000"[0m[39m, [0m[32m" "[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:            String normalizedName = [0m[1;35mFilenameUtils.normalize[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:                normalizedName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:                normalizedName = [0m[32m"file"[0m[39m + count++ + ext;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:            [0m[35m/[0m[35m/[0m[95mstrip[0m[39m off initial C:[0m[35m/[0m[39m or ~[0m[35m/[0m[39m or [0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1050[0m[39m-[0m[1;36m1100[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1050[0m[39m:        public void [0m[1;35mprocess[0m[1;39m([0m[39mInputStream input, OutputStream output, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1051[0m[39m:            Parser p = parser;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1052[0m[39m:            if [0m[1;39m([0m[39mfork[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1053[0m[39m:                p = new [0m[1;35mForkParser[0m[1;39m([0m[1;35mTikaCLI.class.getClassLoader[0m[1;39m([0m[1;39m)[0m[39m, p[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1054[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:            ContentHandler handler = [0m[1;35mgetContentHandler[0m[1;39m([0m[39moutput, metadata[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:                [0m[1;35mp.parse[0m[1;39m([0m[39minput, handler, metadata, context[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:                [0m[35m/[0m[35m/[0m[39m fix for TIKA-[0m[1;36m596[0m[39m: if a parser doesn't generate[0m              [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:                [0m[35m/[0m[35m/[0m[39m XHTML output, the lack of an output document prevents[0m       [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:                [0m[35m/[0m[35m/[0m[39m metadata from being output: this fixes that[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:                if [0m[1;39m([0m[39mhandler instanceof NoDocumentMetHandler[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:                    NoDocumentMetHandler metHandler = [0m[1;39m([0m[39mNoDocumentMetHandler[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mhandler;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:                    if [0m[1;39m([0m[39m![0m[1;35mmetHandler.metOutput[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:                        [0m[1;35mmetHandler.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:                if [0m[1;39m([0m[39mfork[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:                    [0m[1;39m([0m[1;39m([0m[39mForkParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:        protected ContentHandler [0m[1;35mgetContentHandler[0m[1;39m([0m[39mOutputStream output, [0m       [2m                [0m
[2;36m                    [0m         [39mMetadata metadata[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:            throw new [0m[1;35mUnsupportedOperationException[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:    private class FileEmbeddedDocumentExtractor implements [0m                    [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:        private final TikaConfig config = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:        private final EmbeddedStreamTranslator embeddedStreamTranslator = new [0m [2m                [0m
[2;36m                    [0m         [1;35mDefaultEmbeddedStreamTranslator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:        private int count = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:        public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:        public void [0m[1;35mparseEmbedded[0m[1;39m([0m[39mTikaInputStream tis, ContentHandler [0m         [2m                [0m
[2;36m                    [0m         [39mcontentHandler, Metadata metadata, boolean outputHtml[0m[1;39m)[0m[39m throws SAXException, [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:            MediaType contentType = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:            File outputFile = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:            if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:                name = [0m[32m"file"[0m[39m + count++;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:            outputFile = [0m[1;35mgetOutputFile[0m[1;39m([0m[39mname, metadata, contentType[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/pkg/PackageParser.jav[0m[1;92ma:450[0m[39m-[0m[1;36m520[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m extendedEntryName = entryName;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:            if [0m[1;39m([0m[1;36m0[0m[39m < entryName.length && entryName.length < [0m                     [2m                [0m
[2;36m                    [0m         [39mMIN_BYTES_FOR_DETECTING_CHARSET[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:                int len = entryName.length * [0m[1;39m([0m[39mMIN_BYTES_FOR_DETECTING_CHARSET [0m[35m/[0m [2m                [0m
[2;36m                    [0m         [39mentryName.length[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:                extendedEntryName = new byte[0m[1;39m[[0m[39mlen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                    extendedEntryName[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = entryName[0m[1;39m[[0m[39mi % entryName.length[0m[1;39m][0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:            Charset candidate =[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:                    [0m[1;35mgetEncodingDetector[0m[1;39m([0m[1;39m)[0m[1;35m.detect[0m[1;39m([0m                               [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mextendedEntryName[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                            parentMetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:            if [0m[1;39m([0m[39mcandidate != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                name = new [0m[1;35mString[0m[1;39m([0m[1;39m([0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[39m entry[0m[1;39m)[0m[1;35m.getRawName[0m[1;39m([0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mcandidate[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:        if [0m[1;39m([0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:            [0m[35m/[0m[35m/[0m[39m Fetch the metadata on the entry contained in the archive[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:            Metadata entrydata =[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:                    [0m[1;35mhandleEntryMetadata[0m[1;39m([0m[39mname, null, [0m                            [2m                [0m
[2;36m                    [0m         [1;35mentry.getLastModifiedDate[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mentry.getSize[0m[1;39m([0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:                            xhtml[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:            [0m[35m/[0m[35m/[0m[39m Recurse into the entry if desired[0m                                [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:            if [0m[1;39m([0m[1;35mextractor.shouldParseEmbedded[0m[1;39m([0m[39mentrydata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                [0m[35m/[0m[35m/[0m[39m For detectors to work, we need a mark/reset supporting[0m       [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:                [0m[35m/[0m[35m/[0m[39m InputStream, which ArchiveInputStream isn't, so wrap[0m         [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                    TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39marchive, tmp, [0m    [2m                [0m
[2;36m                    [0m         [39mentrydata[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                    [0m[1;35mextractor.parseEmbedded[0m[1;39m([0m[39mtis, xhtml, entrydata, true[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                    [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            name = [0m[1;39m([0m[39mname == null[0m[1;39m)[0m[39m ? [0m[32m""[0m[39m : name;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:            if [0m[1;39m([0m[39mentry instanceof ZipArchiveEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                ZipArchiveEntry zipArchiveEntry = [0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[39m entry;[0m      [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:                boolean usesEncryption = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mzipArchiveEntry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.usesEncryption[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                if [0m[1;39m([0m[39musesEncryption[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                    [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m         [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                            new [0m[1;35mEncryptedDocumentException[0m[1;39m([0m[32m"stream [0m[32m([0m[32m"[0m[39m + name + [0m [2m                [0m
[2;36m                    [0m         [32m"[0m[32m)[0m[32m is encrypted"[0m[1;39m)[0m[39m,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            parentMetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                [0m[35m/[0m[35m/[0m[39m do not write to the handler if[0m                               [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                [0m[35m/[0m[35m/[0m[39m UnsupportedZipFeatureException.Feature.DATA_DESCRIPTOR[0m       [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                [0m[35m/[0m[35m/[0m[39m is met, we will catch this exception and read the zip [0m       [2m                [0m
[2;36m                    [0m         [39marchive once again[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                boolean usesDataDescriptor =[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mzipArchiveEntry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.usesDataDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                if [0m[1;39m([0m[39musesDataDescriptor && [0m[1;35mzipArchiveEntry.getMethod[0m[1;39m([0m[1;39m)[0m[39m == [0m       [2m                [0m
[2;36m                    [0m         [39mZipEntry.STORED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                    throw new [0m[1;35mUnsupportedZipFeatureException[0m[1;39m([0m                   [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [39mUnsupportedZipFeatureException.Feature.DATA_DESCRIPTOR,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:                            zipArchiveEntry[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m             [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:                        new [0m[1;35mTikaException[0m[1;39m([0m[32m"Can't read archive stream [0m[32m([0m[32m"[0m[39m + name [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m,[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                        parentMetadata[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:            if [0m[1;39m([0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:                [0m[1;35mxhtml.element[0m[1;39m([0m[32m"p"[0m[39m, name[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:    [0m[35m/[0m[35m/[0m[39m Pending a fix for COMPRESS-[0m[1;36m269[0m[39m, we have to wrap ourselves[0m                [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:    private static class SevenZWrapper extends ArchiveInputStream [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:        private SevenZFile file;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1128[0m[39m-[0m[1;36m1200[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1128[0m[39m:        private File [0m[1;35mgetOutputFile[0m[1;39m([0m[39mString name, Metadata metadata, MediaType [0m  [2m                [0m
[2;36m                    [0m         [39mcontentType[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1129[0m[39m:            String ext = [0m[1;35mgetExtension[0m[1;39m([0m[39mcontentType[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1130[0m[39m:            if [0m[1;39m([0m[1;35mname.indexOf[0m[1;39m([0m[32m'.'[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[39m && contentType != null[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1131[0m[39m:                name += ext;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1132[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1133[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1134[0m[39m:            String relID = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1135[0m[39m:            if [0m[1;39m([0m[39mrelID != null && ![0m[1;35mname.startsWith[0m[1;39m([0m[39mrelID[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1136[0m[39m:                name = relID + [0m[32m"_"[0m[39m + name;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1137[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1138[0m[39m:            [0m[35m/[0m[35m/[0m[95mdefensively[0m[39m do this so that we don't get an exception[0m            [2m                [0m
[2;36m                    [0m         [1;36m1139[0m[39m:            [0m[35m/[0m[35m/[0m[95mfrom[0m[39m FilenameUtils.normalize[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:            name = [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"\u0000"[0m[39m, [0m[32m" "[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:            String normalizedName = [0m[1;35mFilenameUtils.normalize[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:                normalizedName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:                normalizedName = [0m[32m"file"[0m[39m + count++ + ext;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:            [0m[35m/[0m[35m/[0m[95mstrip[0m[39m off initial C:[0m[35m/[0m[39m or ~[0m[35m/[0m[39m or [0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:            int prefixLength = [0m[1;35mFilenameUtils.getPrefixLength[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:            if [0m[1;39m([0m[39mprefixLength > [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:                normalizedName = [0m[1;35mnormalizedName.substring[0m[1;39m([0m[39mprefixLength[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:                normalizedName = [0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mnormalizedName, UTF_8[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't url decode name [0m[32m{[0m[32m}[0m[32m"[0m[39m, normalizedName[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:            File outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mextractDir, normalizedName[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:            [0m[35m/[0m[35m/[0m[95mif[0m[39m file already exists, prepend uuid[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:            if [0m[1;39m([0m[1;35moutputFile.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                String fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mextractDir, UUID[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        [0m[1;35m.randomUUID[0m[1;39m([0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:                        [0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"-"[0m[39m + fileName[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:            return outputFile;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        private String [0m[1;35mgetExtension[0m[1;39m([0m[39mMediaType contentType[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:                String ext = config[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:                        [0m[1;35m.getMimeRepository[0m[1;39m([0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                        [0m[1;35m.forName[0m[1;39m([0m[1;35mcontentType.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                        [0m[1;35m.getExtension[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                if [0m[1;39m([0m[39mext == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                    return [0m[32m".bin"[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                    return ext;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mMimeTypeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:            return [0m[32m".bin"[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:    private class NoDocumentJSONMetHandler extends DefaultHandler [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:        protected final Metadata metadata;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:        protected PrintWriter writer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        public [0m[1;35mNoDocumentJSONMetHandler[0m[1;39m([0m[39mMetadata metadata, PrintWriter writer[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:            this.metadata = metadata;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:            this.writer = writer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:800[0m[39m-[0m[1;36m840[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:            String name2 = p2[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:                    [0m[1;35m.getClass[0m[1;39m([0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                    [0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            return [0m[1;35mname1.compareTo[0m[1;39m([0m[39mname2[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:        return sortedParsers;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    private Map<Parser, Set<MediaType>> [0m[1;35minvertMediaTypeMap[0m[1;39m([0m[39mMap<MediaType, [0m      [2m                [0m
[2;36m                    [0m         [39mParser> supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        Map<Parser, Set<MediaType>> parsers = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        for [0m[1;39m([0m[39mEntry<MediaType, Parser> e : [0m[1;35msupported.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mparsers.containsKey[0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mparsers.put[0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m, new HashSet<>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:            parsers[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                    [0m[1;35m.get[0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                    [0m[1;35m.add[0m[1;39m([0m[1;35me.getKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:        return parsers;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:     * Prints all the known media types, aliases and matching parser classes.[0m   [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    private void [0m[1;35mdisplaySupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:        AutoDetectParser parser = new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:        MediaTypeRegistry registry = [0m[1;35mparser.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:        Map<MediaType, Parser> parsers = [0m[1;35mparser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:        for [0m[1;39m([0m[39mMediaType type : [0m[1;35mregistry.getTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:            for [0m[1;39m([0m[39mMediaType alias : [0m[1;35mregistry.getAliases[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"  alias:     "[0m[39m + alias[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:            MediaType supertype = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:            if [0m[1;39m([0m[39msupertype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:                [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"  supertype: "[0m[39m + supertype[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:            Parser p = [0m[1;35mparsers.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:            if [0m[1;39m([0m[39mp != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:                if [0m[1;39m([0m[39mp instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1140[0m[39m-[0m[1;36m1150[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:            name = [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"\u0000"[0m[39m, [0m[32m" "[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:            String normalizedName = [0m[1;35mFilenameUtils.normalize[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:                normalizedName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:            if [0m[1;39m([0m[39mnormalizedName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:                normalizedName = [0m[32m"file"[0m[39m + count++ + ext;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:            [0m[35m/[0m[35m/[0m[95mstrip[0m[39m off initial C:[0m[35m/[0m[39m or ~[0m[35m/[0m[39m or [0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1155[0m[39m-[0m[1;36m1169[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:                normalizedName = [0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mnormalizedName, UTF_8[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't url decode name [0m[32m{[0m[32m}[0m[32m"[0m[39m, normalizedName[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:            File outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mextractDir, normalizedName[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:            [0m[35m/[0m[35m/[0m[95mif[0m[39m file already exists, prepend uuid[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:            if [0m[1;39m([0m[1;35moutputFile.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                String fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mextractDir, UUID[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        [0m[1;35m.randomUUID[0m[1;39m([0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:                        [0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"-"[0m[39m + fileName[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:            return outputFile;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Identify the vulnerable code block  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - File: tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java  [0m                [2m                [0m
[2;36m                    [0m         [39m   - Method: FileEmbeddedDocumentExtractor.getOutputFile [0m[1;39m([0m[39maround line [0m[1;36m1160[0m[1;39m)[0m[39m  [0m       [2m                [0m
[2;36m                    [0m         [39m   - Symptom: After collapsing ‚Äú..‚Äù segments via FilenameUtils.normalize, leading [0m  [2m                [0m
[2;36m                    [0m         [39m‚Äú..[0m[35m/[0m[39m‚Äù segments remain and are combined with the extractDir, allowing `new [0m          [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[39mextractDir, [0m[32m"../‚Ä¶"[0m[1;39m)[0m[39m` to escape the sandbox.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Insert a canonical‚Äêpath containment check  [0m                                      [2m                [0m
[2;36m                    [0m         [39m   a. Immediately before or in place of the existing  [0m                              [2m                [0m
[2;36m                    [0m         [39m        File outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mextractDir, normalizedName[0m[1;39m)[0m[39m;  [0m                   [2m                [0m
[2;36m                    [0m         [39m      introduce something like:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        ```java[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m resolve and normalize both base dir and candidate path[0m                   [2m                [0m
[2;36m                    [0m         [39m        Path baseDir    = [0m[1;35mextractDir.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m        Path candidate  = [0m[1;35mbaseDir.resolve[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39m![0m[1;35mcandidate.startsWith[0m[1;39m([0m[39mbaseDir[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m            [0m[35m/[0m[35m/[0m[39m attempted traversal outside extractDir ‚Äì fallback to basename[0m        [2m                [0m
[2;36m                    [0m         [39m            String safeName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m            candidate = [0m[1;35mbaseDir.resolve[0m[1;39m([0m[39msafeName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m            [0m[35m/[0m[35m/[0m[39m if still invalid [0m[1;39m([0m[39mextremely unlikely[0m[1;39m)[0m[39m, prefix a UUID[0m                 [2m                [0m
[2;36m                    [0m         [39m            if [0m[1;39m([0m[39m![0m[1;35mcandidate.startsWith[0m[1;39m([0m[39mbaseDir[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m                String uniqueName = [0m[1;35mUUID.randomUUID[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"-"[0m[39m + safeName;[0m             [2m                [0m
[2;36m                    [0m         [39m                candidate = [0m[1;35mbaseDir.resolve[0m[1;39m([0m[39muniqueName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m            [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        File outputFile = [0m[1;35mcandidate.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   b. Retain the existing ‚Äúif [0m[1;39m([0m[1;35moutputFile.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m ‚Ä¶ [0m[1;39m}[0m[39m‚Äù block, but rebase it on [0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35moutputFile.getParentFile[0m[1;39m([0m[1;39m)[0m[39m` being within `extractDir`.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preserve existing filename logic  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Do not remove extension detection or metadata‚Äêbased prefixes.  [0m                [2m                [0m
[2;36m                    [0m         [39m   - Keep URL decoding, null‚Äêchar replacement, and the count‚Äêbased default filename[0m [2m                [0m
[2;36m                    [0m         [39mintact.  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Legitimate nested paths [0m[1;39m([0m[39me.g., ‚Äúa/b/c.txt‚Äù[0m[1;39m)[0m[39m remain allowed as long as they [0m    [2m                [0m
[2;36m                    [0m         [39mresolve under `extractDir`.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Imports  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - Add:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        ```java[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        import java.nio.file.Path;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        import java.nio.file.Paths;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        ```[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Rationale  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - By resolving both the base extract directory and the candidate path to [0m        [2m                [0m
[2;36m                    [0m         [39mabsolute, normalized forms, we can reliably detect any upward traversal.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - Fallback to the basename ensures malicious or malformed names are flattened [0m   [2m                [0m
[2;36m                    [0m         [39mrather than causing an exception or breach.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m   - This approach aligns with standard ‚Äúzip slip‚Äù mitigations found in other [0m      [2m                [0m
[2;36m                    [0m         [39mApache projects [0m[1;39m([0m[39me.g., in Commons Compress examples[0m[1;39m)[0m[39m, and does not disrupt normal [0m  [2m                [0m
[2;36m                    [0m         [39mextraction of deeply nested legitimate files.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Side effects and mitigation  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Normal archive entries continue to extract into subdirectories when intended. [0m [2m                [0m
[2;36m                    [0m         [39m   - Any path‚Äêtraversal payloads result in safe, flat filenames under `extractDir`.[0m [2m                [0m
[2;36m                    [0m         [39m   - No changes to harness, test code, or external dependencies; thus existing [0m     [2m                [0m
[2;36m                    [0m         [39mtests and fuzzing logic remain valid.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=93577;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=628739;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=992188;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=802976;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp85rcoi_g[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/tika_tk-delta-05_vuln_2/[0m[95magent-output-17[0m [2m               [0m
[2;36m                    [0m         [95m66843912.5328074[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-05_vuln_2.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=504266;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=525693;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[12/27/25 13:58:33][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=844748;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=858929;file:///home/user/crete/scripts/benchmark/__main__.py#309\[2m309[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=629203;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=357190;file:///home/user/crete/scripts/benchmark/__main__.py#312\[2m312[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
