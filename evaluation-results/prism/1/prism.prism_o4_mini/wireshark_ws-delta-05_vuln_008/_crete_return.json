{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-05_vuln_008",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.23420320000000006,
    "prompt_tokens": 149524,
    "completion_tokens": 15847
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-netbios.c\n+++ b/epan/dissectors/packet-netbios.c\n@@ -1104,10 +1104,19 @@\n \n \thdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);\n \tcommand = tvb_get_uint8( tvb, offset + NB_COMMAND);\n-\t\t\t\t\t/* limit command so no table overflows */\n-\tcommand = MIN(command, array_length(dissect_netb));\n-\n-\t\t/* print command name */\n+\t/* If the command byte falls outside our handler table, treat it as \"unknown\" */\n+\t{\n+\t\tsize_t cmd_count = array_length(dissect_netb);\n+\t\tif (command >= cmd_count) {\n+\t\t\t/* add an expert/info note for the unknown command */\n+\t\t\texpert_add_info_format(pinfo, NULL,\n+\t\t\t\t&ei_netb_unknown_command_data,\n+\t\t\t\t\"Unknown NetBIOS command 0x%02x\", command);\n+\t\t\t/* dispatch the generic unknown-command handler */\n+\t\t\treturn dissect_netb_unknown(tvb, pinfo, offset, tree);\n+\t\t}\n+\t}\n+\t/* print command name */\n \tcommand_name = val_to_str_ext(command, &cmd_vals_ext, \"Unknown (0x%02x)\");\n \tswitch ( command ) {\n \t\tcase NB_NAME_QUERY:\n",
  "stdout": "",
  "stderr": ""
}