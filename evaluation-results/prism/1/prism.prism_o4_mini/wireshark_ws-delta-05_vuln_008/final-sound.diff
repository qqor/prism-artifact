--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1104,10 +1104,19 @@
 
 	hdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);
 	command = tvb_get_uint8( tvb, offset + NB_COMMAND);
-					/* limit command so no table overflows */
-	command = MIN(command, array_length(dissect_netb));
-
-		/* print command name */
+	/* If the command byte falls outside our handler table, treat it as "unknown" */
+	{
+		size_t cmd_count = array_length(dissect_netb);
+		if (command >= cmd_count) {
+			/* add an expert/info note for the unknown command */
+			expert_add_info_format(pinfo, NULL,
+				&ei_netb_unknown_command_data,
+				"Unknown NetBIOS command 0x%02x", command);
+			/* dispatch the generic unknown-command handler */
+			return dissect_netb_unknown(tvb, pinfo, offset, tree);
+		}
+	}
+	/* print command name */
 	command_name = val_to_str_ext(command, &cmd_vals_ext, "Unknown (0x%02x)");
 	switch ( command ) {
 		case NB_NAME_QUERY:
