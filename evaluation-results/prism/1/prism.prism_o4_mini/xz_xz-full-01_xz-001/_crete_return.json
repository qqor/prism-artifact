{
  "project_name": "xz",
  "vulnerability_identifier": "xz-xz-full-01-xz-001",
  "source_directory": "/tasks/ff65fd61-d483-4a2d-a3e1-fd8a99eb00a3/official-afc-xz",
  "llm_usage": {
    "total_cost": 0.12163580000000002,
    "prompt_tokens": 50430,
    "completion_tokens": 15037
  },
  "variant": "sound",
  "diff": "--- a/src/liblzma/check/treeck.c\n+++ b/src/liblzma/check/treeck.c\n@@ -65,27 +65,25 @@\n // Walk the tree to calculate the e37vk checksum\n static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)\n {\n-  // Skip if already hashed\n-  if (!node || node->state == STATE_HASHED) {\n+  // Skip non-clear nodes (already visited or hashed)\n+  if (!node || node->state != STATE_CLEAR) {\n     return 0;\n   }\n \n-  // Compute initial checksum from depth and value\n+  // Mark as visited and compute initial checksum from depth and value\n+  node->state = STATE_VISITED;\n   uint32_t sum = node->value * (depth + 1);\n \n-  // Traverse the child nodes if not already visited\n-  if (node->state == STATE_CLEAR) {\n-    node->state = STATE_VISITED;\n-    for (size_t i = 0; i < node->edge_count; ++i) {\n-      TreeNode *child = node->edges[i];\n-      if (child) {\n-        sum += compute_tree_checksum(child, depth + 1);\n-      }\n+  // Traverse the child nodes\n+  for (size_t i = 0; i < node->edge_count; ++i) {\n+    TreeNode *child = node->edges[i];\n+    if (child) {\n+      sum += compute_tree_checksum(child, depth + 1);\n     }\n-    node->state = STATE_HASHED;\n   }\n \n-  // Free the node and edges\n+  // Mark as hashed and free the node and its edges\n+  node->state = STATE_HASHED;\n   free(node->edges);\n   free(node);\n \n",
  "stdout": "",
  "stderr": ""
}