[10/28/25 08:18:29] INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpg85meun7                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/wireshark_ws-full-01_vuln_011/agent-output-1761639509.0675366                                                                       
                             - Detection toml file: /tasks_new/wireshark_ws-full-01/detection/wireshark_ws-full-01_vuln_011.toml                                                                                 
                             - Challenge project directory: /tasks_new/wireshark_ws-full-01/official-afc-wireshark                                                                                               
                                                                                                                                                                                                                 
                    INFO     [logging_performance](wireshark Building Cached for CLEAN environment) Started...                                                                              context_managers.py:9
[10/28/25 08:25:34] INFO     [logging_performance](wireshark Building Cached for CLEAN environment) Took 424.96 seconds; exception=False                                                   context_managers.py:23
                    INFO     [logging_performance](wireshark Running tests for Cached for CLEAN environment) Started...                                                                     context_managers.py:9
                    INFO     [logging_performance](wireshark Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False                                            context_managers.py:23
                    INFO     Setting timeouts                                                                                                                                                       default.py:85
                               - build: 878 (original: 424)                                                                                                                                                      
                               - run tests: 600 (original: 0)                                                                                                                                                    
                    INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:25:35] INFO     [logging_performance](wireshark Setting owner) Took 0.97 seconds; exception=False                                                                             context_managers.py:23
[10/28/25 08:26:23] INFO     Successfully created Cached for CLEAN environment                                                                                                                    oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                                                            oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                                                 
                    INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:26:32] INFO     [logging_performance](wireshark Setting owner) Took 8.69 seconds; exception=False                                                                             context_managers.py:23
                    INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:26:33] INFO     [logging_performance](wireshark Setting owner) Took 0.97 seconds; exception=False                                                                             context_managers.py:23
[10/28/25 08:26:37] INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             + FUZZER=handler_aim                                                                                                                                                                
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer handler_aim -runs=100 /testcase                                                                                                                                        
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/handler_aim -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -max_len=1024 -timeout_exitcode=0 < /dev/null                                                                   
                             oss-fuzzshark: disabling: ip                                                                                                                                                        
                             oss-fuzzshark: disabling: udp                                                                                                                                                       
                             oss-fuzzshark: disabling: udplite                                                                                                                                                   
                             oss-fuzzshark: disabling: ospf                                                                                                                                                      
                             oss-fuzzshark: disabling: bgp                                                                                                                                                       
                             oss-fuzzshark: disabling: dhcp                                                                                                                                                      
                             oss-fuzzshark: disabling: json                                                                                                                                                      
                             oss-fuzzshark: disabling: snort                                                                                                                                                     
                             oss-fuzzshark: configured for dissector: aim                                                                                                                                        
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3325023467                                                                                                                                                              
                             INFO: Loaded 1 modules   (420518 inline 8-bit counters): 420518 [0xa9f6a00, 0xaa5d4a6),                                                                                             
                             INFO: Loaded 1 PC tables (420518 PCs): 420518 [0xaa5d4a8,0xb0c7f08),                                                                                                                
                             /out/handler_aim: Running 1 inputs 100 time(s) each.                                                                                                                                
                             Running: /testcase                                                                                                                                                                  
                             *** buffer overflow detected ***: terminated                                                                                                                                        
                             AddressSanitizer:DEADLYSIGNAL                                                                                                                                                       
                             =================================================================                                                                                                                   
                             ==18==ERROR: AddressSanitizer: ABRT on unknown address 0x000000000012 (pc 0x7f65a3f1e00b bp 0x7ffd2ae3f040 sp 0x7ffd2ae3ecc0 T0)                                                    
                             SCARINESS: 10 (signal)                                                                                                                                                              
                                 #0 0x7f65a3f1e00b in raise (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #1 0x7f65a3efd858 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x22858) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #2 0x7f65a3f68265  (/lib/x86_64-linux-gnu/libc.so.6+0x8d265) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                                
                                 #3 0x7f65a400acd9 in __fortify_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12fcd9) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                              
                                 #4 0x7f65a4009575 in __chk_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12e575) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                  
                                 #5 0x5dbcb23 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10                                                                                              
                                 #6 0x5dbcb23 in aim_get_buddyname /src/wireshark/epan/dissectors/packet-aim.c:591:3                                                                                             
                                 #7 0x5dbcb23 in dissect_aim_chat_outgoing_msg /src/wireshark/epan/dissectors/packet-aim.c:1976:21                                                                               
                                 #8 0x5dbaa2f in dissect_aim_snac /src/wireshark/epan/dissectors/packet-aim.c:809:3                                                                                              
                                 #9 0x5dbaa2f in dissect_aim_pdu /src/wireshark/epan/dissectors/packet-aim.c:1618:3                                                                                              
                                 #10 0x52ff8af in tcp_dissect_pdus /src/wireshark/epan/dissectors/packet-tcp.c:5569:13                                                                                           
                                 #11 0x5db7f4d in dissect_aim /src/wireshark/epan/dissectors/packet-aim.c:1655:2                                                                                                 
                                 #12 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #13 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #14 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #15 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3                                                                                                    
                                 #16 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5                                                                                             
                                 #17 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #18 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #19 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #20 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8                                                                                                   
                                 #21 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3                                                                                                              
                                 #22 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2                                                                                                              
                                 #23 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2                                                                                                   
                                 #24 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13                            
                                 #25 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6                                
                                 #26 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long))                                                                              
                             /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9                                                                                                                     
                                 #27 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10                                                                                             
                                 #28 0x7f65a3eff082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                           
                                 #29 0x4f49cad in _start (/out/handler_aim+0x4f49cad)                                                                                                                            
                                                                                                                                                                                                                 
                             DEDUP_TOKEN: raise--abort--                                                                                                                                                         
                             AddressSanitizer can not provide additional info.                                                                                                                                   
                             SUMMARY: AddressSanitizer: ABRT (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d) in raise                                              
                             ==18==ABORTING                                                                                                                                                                      
                             MS: 0 ; base unit: 0000000000000000000000000000000000000000                                                                                                                         
                             0x2a,0x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x28,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0                 
                             ,0x6f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x0,0x0,0xf7,0x0,0xe,0x0,0x5,0x0,0x0,0x0,0x0,0xff,0xfc,0x2a,0x2,0x2,0x24,0x8,0x0,0x0,0x0,0x0,0x0,0xf7,0                 
                             xff,0xff,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x24,0x0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x89,0x1f,0x5,0                 
                             x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,                                                                        
                             *\001*\005\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000(\000\000\000\001*\000\000\000\000\000\000\000\000o\000\000\000\0                 
                             00\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\                 
                             000\000\000\000\000\000\000*\002\002\000\000\367\000\016\000\005\000\000\000\000\377\374*\002\002$\010\000\000\000\000\000\367\377\377\377\000\000\000\000\000\000\                 
                             000\000\000\000\000*\002\002$\000\200\000\000\000\000\000\000\001\000\000\000\001*\000\000\000\000\000\000\000\001*\005\000\001\000\000\000\000\000\000\000\000\002                 
                             \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\211\037\005\000\001\000\000\000\000\000\000\000\000\001\000\000\000\00                 
                             1*\000\000\000\000\000\000\000\000\000\000\012                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/wireshark_ws-full-01/fuzz-tooling/build/out/wireshark:/out -v /tmp/tmphn82q5ns:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                            
                             handler_aim -runs=100.                                                                                                                                                              
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             + FUZZER=handler_aim                                                                                                                                                                
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer handler_aim -runs=100 /testcase                                                                                                                                        
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/handler_aim -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -max_len=1024 -timeout_exitcode=0 < /dev/null                                                                   
                             oss-fuzzshark: disabling: ip                                                                                                                                                        
                             oss-fuzzshark: disabling: udp                                                                                                                                                       
                             oss-fuzzshark: disabling: udplite                                                                                                                                                   
                             oss-fuzzshark: disabling: ospf                                                                                                                                                      
                             oss-fuzzshark: disabling: bgp                                                                                                                                                       
                             oss-fuzzshark: disabling: dhcp                                                                                                                                                      
                             oss-fuzzshark: disabling: json                                                                                                                                                      
                             oss-fuzzshark: disabling: snort                                                                                                                                                     
                             oss-fuzzshark: configured for dissector: aim                                                                                                                                        
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3325023467                                                                                                                                                              
                             INFO: Loaded 1 modules   (420518 inline 8-bit counters): 420518 [0xa9f6a00, 0xaa5d4a6),                                                                                             
                             INFO: Loaded 1 PC tables (420518 PCs): 420518 [0xaa5d4a8,0xb0c7f08),                                                                                                                
                             /out/handler_aim: Running 1 inputs 100 time(s) each.                                                                                                                                
                             Running: /testcase                                                                                                                                                                  
                             *** buffer overflow detected ***: terminated                                                                                                                                        
                             AddressSanitizer:DEADLYSIGNAL                                                                                                                                                       
                             =================================================================                                                                                                                   
                             ==18==ERROR: AddressSanitizer: ABRT on unknown address 0x000000000012 (pc 0x7f65a3f1e00b bp 0x7ffd2ae3f040 sp 0x7ffd2ae3ecc0 T0)                                                    
                             SCARINESS: 10 (signal)                                                                                                                                                              
                                 #0 0x7f65a3f1e00b in raise (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #1 0x7f65a3efd858 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x22858) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #2 0x7f65a3f68265  (/lib/x86_64-linux-gnu/libc.so.6+0x8d265) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                                
                                 #3 0x7f65a400acd9 in __fortify_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12fcd9) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                              
                                 #4 0x7f65a4009575 in __chk_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12e575) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                  
                                 #5 0x5dbcb23 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10                                                                                              
                                 #6 0x5dbcb23 in aim_get_buddyname /src/wireshark/epan/dissectors/packet-aim.c:591:3                                                                                             
                                 #7 0x5dbcb23 in dissect_aim_chat_outgoing_msg /src/wireshark/epan/dissectors/packet-aim.c:1976:21                                                                               
                                 #8 0x5dbaa2f in dissect_aim_snac /src/wireshark/epan/dissectors/packet-aim.c:809:3                                                                                              
                                 #9 0x5dbaa2f in dissect_aim_pdu /src/wireshark/epan/dissectors/packet-aim.c:1618:3                                                                                              
                                 #10 0x52ff8af in tcp_dissect_pdus /src/wireshark/epan/dissectors/packet-tcp.c:5569:13                                                                                           
                                 #11 0x5db7f4d in dissect_aim /src/wireshark/epan/dissectors/packet-aim.c:1655:2                                                                                                 
                                 #12 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #13 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #14 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #15 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3                                                                                                    
                                 #16 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5                                                                                             
                                 #17 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #18 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #19 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #20 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8                                                                                                   
                                 #21 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3                                                                                                              
                                 #22 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2                                                                                                              
                                 #23 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2                                                                                                   
                                 #24 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13                            
                                 #25 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6                                
                                 #26 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long))                                                                              
                             /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9                                                                                                                     
                                 #27 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10                                                                                             
                                 #28 0x7f65a3eff082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                           
                                 #29 0x4f49cad in _start (/out/handler_aim+0x4f49cad)                                                                                                                            
                                                                                                                                                                                                                 
                             DEDUP_TOKEN: raise--abort--                                                                                                                                                         
                             AddressSanitizer can not provide additional info.                                                                                                                                   
                             SUMMARY: AddressSanitizer: ABRT (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d) in raise                                              
                             ==18==ABORTING                                                                                                                                                                      
                             MS: 0 ; base unit: 0000000000000000000000000000000000000000                                                                                                                         
                             0x2a,0x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x28,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0                 
                             ,0x6f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x0,0x0,0xf7,0x0,0xe,0x0,0x5,0x0,0x0,0x0,0x0,0xff,0xfc,0x2a,0x2,0x2,0x24,0x8,0x0,0x0,0x0,0x0,0x0,0xf7,0                 
                             xff,0xff,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x24,0x0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x89,0x1f,0x5,0                 
                             x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,                                                                        
                             *\001*\005\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000(\000\000\000\001*\000\000\000\000\000\000\000\000o\000\000\000\0                 
                             00\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\                 
                             000\000\000\000\000\000\000*\002\002\000\000\367\000\016\000\005\000\000\000\000\377\374*\002\002$\010\000\000\000\000\000\367\377\377\377\000\000\000\000\000\000\                 
                             000\000\000\000\000*\002\002$\000\200\000\000\000\000\000\000\001\000\000\000\001*\000\000\000\000\000\000\000\001*\005\000\001\000\000\000\000\000\000\000\000\002                 
                             \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\211\037\005\000\001\000\000\000\000\000\000\000\000\001\000\000\000\00                 
                             1*\000\000\000\000\000\000\000\000\000\000\012                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/wireshark_ws-full-01/fuzz-tooling/build/out/wireshark:/out -v /tmp/tmphn82q5ns:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                            
                             handler_aim -runs=100.                                                                                                                                                              
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Analysis Report===                                                                                                                                                               
                                                                                                                                                                                                                 
                             ===Evaluation End===                                                                                                                                                                
[10/28/25 08:26:50] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/28/25 08:28:13] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/28/25 08:31:08] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:31:09] INFO     [logging_performance](wireshark Setting owner) Took 1.03 seconds; exception=False                                                                             context_managers.py:23
[10/28/25 08:31:10] INFO     [logging_performance](wireshark Patching) Started...                                                                                                           context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmphcu0cy2m                                                                                                                                 default.py:173
[10/28/25 08:36:22] INFO     [logging_performance](wireshark Patching) Took 312.82 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](wireshark Checking build) Started...                                                                                                     context_managers.py:9
[10/28/25 08:40:51] INFO     [logging_performance](wireshark Checking build) Took 268.28 seconds; exception=False                                                                          context_managers.py:23
                    INFO     [logging_performance](wireshark Running PoV) Started...                                                                                                        context_managers.py:9
[10/28/25 08:40:53] INFO     [logging_performance](wireshark Running PoV) Took 2.72 seconds; exception=False                                                                               context_managers.py:23
                    INFO     [logging_performance](wireshark Testing) Started...                                                                                                            context_managers.py:9
                    INFO     [logging_performance](wireshark Testing) Took 0.00 seconds; exception=False                                                                                   context_managers.py:23
                    INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:40:54] INFO     [logging_performance](wireshark Setting owner) Took 1.00 seconds; exception=False                                                                             context_managers.py:23
[10/28/25 08:42:04] INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:42:05] INFO     [logging_performance](wireshark Setting owner) Took 0.99 seconds; exception=False                                                                             context_managers.py:23
[10/28/25 08:42:06] INFO     [logging_performance](wireshark Setting owner) Started...                                                                                                      context_managers.py:9
[10/28/25 08:42:07] INFO     [logging_performance](wireshark Setting owner) Took 0.99 seconds; exception=False                                                                             context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.SOUND                                                                                                                                                                   
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/epan/dissectors/packet-aim.c                                                                                                                                                  
                             +++ b/epan/dissectors/packet-aim.c                                                                                                                                                  
                             @@ -581,16 +581,41 @@                                                                                                                                                               
                              static int                                                                                                                                                                         
                              aim_get_buddyname(wmem_allocator_t *pool, uint8_t **name, tvbuff_t *tvb, int offset)                                                                                               
                              {                                                                                                                                                                                  
                             -       uint16_t buddyname_length;                                                                                                                                                  
                             -                                                                                                                                                                                   
                             -       *name = wmem_alloc(pool, 256);                                                                                                                                              
                             -                                                                                                                                                                                   
                             -       buddyname_length = tvb_get_ntohs(tvb, offset);                                                                                                                              
                             -                                                                                                                                                                                   
                             -       if (pool)                                                                                                                                                                   
                             -               memcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);                                                                                                         
                             -                                                                                                                                                                                   
                             -       return buddyname_length;                                                                                                                                                    
                             +    uint16_t name_length_field;                                                                                                                                                    
                             +    uint16_t copy_length;                                                                                                                                                          
                             +    const uint8_t *ptr;                                                                                                                                                            
                             +    guint32 rem_len;                                                                                                                                                               
                             +                                                                                                                                                                                   
                             +    /* Ensure we have at least 2 bytes for the length field */                                                                                                                     
                             +    if (tvb_reported_length_remaining(tvb, offset) < 2) {                                                                                                                          
                             +        *name = wmem_alloc(pool, 1);                                                                                                                                               
                             +        (*name)[0] = '\0';                                                                                                                                                         
                             +        return 0;                                                                                                                                                                  
                             +    }                                                                                                                                                                              
                             +                                                                                                                                                                                   
                             +    /* Read buddy-name length (network byte order) */                                                                                                                              
                             +    name_length_field = tvb_get_ntohs(tvb, offset);                                                                                                                                
                             +                                                                                                                                                                                   
                             +    /* Calculate remaining bytes after the length field */                                                                                                                         
                             +    rem_len = tvb_reported_length_remaining(tvb, offset + 2);                                                                                                                      
                             +                                                                                                                                                                                   
                             +    /* Cap the copy length to avoid overflow and overread */                                                                                                                       
                             +    copy_length = name_length_field;                                                                                                                                               
                             +    if (copy_length > 255)                                                                                                                                                         
                             +        copy_length = 255;                                                                                                                                                         
                             +    if (copy_length > rem_len)                                                                                                                                                     
                             +        copy_length = rem_len;                                                                                                                                                     
                             +                                                                                                                                                                                   
                             +    /* Pointer to buddy-name data starts 2 bytes past offset */                                                                                                                    
                             +    ptr = tvb_get_ptr(tvb, offset + 2, copy_length);                                                                                                                               
                             +                                                                                                                                                                                   
                             +    /* Allocate buffer for name plus null terminator */                                                                                                                            
                             +    *name = wmem_alloc(pool, copy_length + 1);                                                                                                                                     
                             +    memcpy(*name, ptr, copy_length);                                                                                                                                               
                             +    (*name)[copy_length] = '\0';                                                                                                                                                   
                             +                                                                                                                                                                                   
                             +    /* Return the payload length field for offset calculations */                                                                                                                  
                             +    return name_length_field;                                                                                                                                                      
                              }                                                                                                                                                                                  
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             + FUZZER=handler_aim                                                                                                                                                                
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer handler_aim -runs=100 /testcase                                                                                                                                        
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/handler_aim -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -max_len=1024 -timeout_exitcode=0 < /dev/null                                                                   
                             oss-fuzzshark: disabling: ip                                                                                                                                                        
                             oss-fuzzshark: disabling: udp                                                                                                                                                       
                             oss-fuzzshark: disabling: udplite                                                                                                                                                   
                             oss-fuzzshark: disabling: ospf                                                                                                                                                      
                             oss-fuzzshark: disabling: bgp                                                                                                                                                       
                             oss-fuzzshark: disabling: dhcp                                                                                                                                                      
                             oss-fuzzshark: disabling: json                                                                                                                                                      
                             oss-fuzzshark: disabling: snort                                                                                                                                                     
                             oss-fuzzshark: configured for dissector: aim                                                                                                                                        
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3325023467                                                                                                                                                              
                             INFO: Loaded 1 modules   (420518 inline 8-bit counters): 420518 [0xa9f6a00, 0xaa5d4a6),                                                                                             
                             INFO: Loaded 1 PC tables (420518 PCs): 420518 [0xaa5d4a8,0xb0c7f08),                                                                                                                
                             /out/handler_aim: Running 1 inputs 100 time(s) each.                                                                                                                                
                             Running: /testcase                                                                                                                                                                  
                             *** buffer overflow detected ***: terminated                                                                                                                                        
                             AddressSanitizer:DEADLYSIGNAL                                                                                                                                                       
                             =================================================================                                                                                                                   
                             ==18==ERROR: AddressSanitizer: ABRT on unknown address 0x000000000012 (pc 0x7f65a3f1e00b bp 0x7ffd2ae3f040 sp 0x7ffd2ae3ecc0 T0)                                                    
                             SCARINESS: 10 (signal)                                                                                                                                                              
                                 #0 0x7f65a3f1e00b in raise (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #1 0x7f65a3efd858 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x22858) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #2 0x7f65a3f68265  (/lib/x86_64-linux-gnu/libc.so.6+0x8d265) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                                
                                 #3 0x7f65a400acd9 in __fortify_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12fcd9) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                              
                                 #4 0x7f65a4009575 in __chk_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12e575) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                  
                                 #5 0x5dbcb23 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10                                                                                              
                                 #6 0x5dbcb23 in aim_get_buddyname /src/wireshark/epan/dissectors/packet-aim.c:591:3                                                                                             
                                 #7 0x5dbcb23 in dissect_aim_chat_outgoing_msg /src/wireshark/epan/dissectors/packet-aim.c:1976:21                                                                               
                                 #8 0x5dbaa2f in dissect_aim_snac /src/wireshark/epan/dissectors/packet-aim.c:809:3                                                                                              
                                 #9 0x5dbaa2f in dissect_aim_pdu /src/wireshark/epan/dissectors/packet-aim.c:1618:3                                                                                              
                                 #10 0x52ff8af in tcp_dissect_pdus /src/wireshark/epan/dissectors/packet-tcp.c:5569:13                                                                                           
                                 #11 0x5db7f4d in dissect_aim /src/wireshark/epan/dissectors/packet-aim.c:1655:2                                                                                                 
                                 #12 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #13 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #14 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #15 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3                                                                                                    
                                 #16 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5                                                                                             
                                 #17 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #18 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #19 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #20 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8                                                                                                   
                                 #21 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3                                                                                                              
                                 #22 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2                                                                                                              
                                 #23 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2                                                                                                   
                                 #24 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13                            
                                 #25 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6                                
                                 #26 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long))                                                                              
                             /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9                                                                                                                     
                                 #27 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10                                                                                             
                                 #28 0x7f65a3eff082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                           
                                 #29 0x4f49cad in _start (/out/handler_aim+0x4f49cad)                                                                                                                            
                                                                                                                                                                                                                 
                             DEDUP_TOKEN: raise--abort--                                                                                                                                                         
                             AddressSanitizer can not provide additional info.                                                                                                                                   
                             SUMMARY: AddressSanitizer: ABRT (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d) in raise                                              
                             ==18==ABORTING                                                                                                                                                                      
                             MS: 0 ; base unit: 0000000000000000000000000000000000000000                                                                                                                         
                             0x2a,0x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x28,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0                 
                             ,0x6f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x0,0x0,0xf7,0x0,0xe,0x0,0x5,0x0,0x0,0x0,0x0,0xff,0xfc,0x2a,0x2,0x2,0x24,0x8,0x0,0x0,0x0,0x0,0x0,0xf7,0                 
                             xff,0xff,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x24,0x0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x89,0x1f,0x5,0                 
                             x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,                                                                        
                             *\001*\005\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000(\000\000\000\001*\000\000\000\000\000\000\000\000o\000\000\000\0                 
                             00\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\                 
                             000\000\000\000\000\000\000*\002\002\000\000\367\000\016\000\005\000\000\000\000\377\374*\002\002$\010\000\000\000\000\000\367\377\377\377\000\000\000\000\000\000\                 
                             000\000\000\000\000*\002\002$\000\200\000\000\000\000\000\000\001\000\000\000\001*\000\000\000\000\000\000\000\001*\005\000\001\000\000\000\000\000\000\000\000\002                 
                             \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\211\037\005\000\001\000\000\000\000\000\000\000\000\001\000\000\000\00                 
                             1*\000\000\000\000\000\000\000\000\000\000\012                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/wireshark_ws-full-01/fuzz-tooling/build/out/wireshark:/out -v /tmp/tmphn82q5ns:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                            
                             handler_aim -runs=100.                                                                                                                                                              
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A fuzzing session targeting the Wireshark AIM dissector (`handler_aim`) triggered an AddressSanitizer-detected buffer overflow. The crash occurs in the function                    
                             `aim_get_buddyname` within `packet-aim.c`, where a `memcpy` operation overruns its destination buffer, leading to an abort signal.                                                  
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             - The provided log shows a libFuzzer-based run of `handler_aim` with AddressSanitizer enabled.                                                                                      
                             - During processing of a crafted input (`/testcase`), the program aborts due to a buffer overflow detected by the fortified `memcpy` implementation in `libc`.                      
                             - The sanitizer stack trace pinpoints the overflow to `aim_get_buddyname` at line 591 of `packet-aim.c`, which is called by `dissect_aim_chat_outgoing_msg` (line                   
                             1976), then by `dissect_aim_snac` (line 809), and by higher-level dissecting routines (`dissect_aim_pdu`, `tcp_dissect_pdus`, etc.).                                                
                             - The vulnerability type is a classic memory safety violation (buffer overflow) in the AIM protocol dissector.                                                                      
                             - Important observations:                                                                                                                                                           
                                The crash is an immediate abort (`ABRT`) with a high scarness rating (10).                                                                                                      
                                The failure originates from a fortified `memcpy` boundary check (`__chk_fail`).                                                                                                 
                                The fuzzers input exercises the chatoutgoing message path specifically.                                                                                                       
                             - To understand the full scope of the issue, review all related code in `src/wireshark/epan/dissectors/packet-aim.c`, especially:                                                   
                                The implementation of `aim_get_buddyname` (around line 591).                                                                                                                    
                                The logic in `dissect_aim_chat_outgoing_msg` that prepares and passes data to `aim_get_buddyname`.                                                                              
                                Surrounding SNAC and PDU parsing functions (`dissect_aim_snac`, `dissect_aim_pdu`).                                                                                             
                                Any buffer allocation or length computations tied to buddy names or chat messages.                                                                                              
                             ---                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             + FUZZER=handler_aim                                                                                                                                                                
                             + shift                                                                                                                                                                             
                             + '[' '!' -v TESTCASE ']'                                                                                                                                                           
                             + TESTCASE=/testcase                                                                                                                                                                
                             + '[' '!' -f /testcase ']'                                                                                                                                                          
                             + export RUN_FUZZER_MODE=interactive                                                                                                                                                
                             + RUN_FUZZER_MODE=interactive                                                                                                                                                       
                             + export FUZZING_ENGINE=libfuzzer                                                                                                                                                   
                             + FUZZING_ENGINE=libfuzzer                                                                                                                                                          
                             + export SKIP_SEED_CORPUS=1                                                                                                                                                         
                             + SKIP_SEED_CORPUS=1                                                                                                                                                                
                             + run_fuzzer handler_aim -runs=100 /testcase                                                                                                                                        
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             /out/handler_aim -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -max_len=1024 -timeout_exitcode=0 < /dev/null                                                                   
                             oss-fuzzshark: disabling: ip                                                                                                                                                        
                             oss-fuzzshark: disabling: udp                                                                                                                                                       
                             oss-fuzzshark: disabling: udplite                                                                                                                                                   
                             oss-fuzzshark: disabling: ospf                                                                                                                                                      
                             oss-fuzzshark: disabling: bgp                                                                                                                                                       
                             oss-fuzzshark: disabling: dhcp                                                                                                                                                      
                             oss-fuzzshark: disabling: json                                                                                                                                                      
                             oss-fuzzshark: disabling: snort                                                                                                                                                     
                             oss-fuzzshark: configured for dissector: aim                                                                                                                                        
                             INFO: Running with entropic power schedule (0xFF, 100).                                                                                                                             
                             INFO: Seed: 3325023467                                                                                                                                                              
                             INFO: Loaded 1 modules   (420518 inline 8-bit counters): 420518 [0xa9f6a00, 0xaa5d4a6),                                                                                             
                             INFO: Loaded 1 PC tables (420518 PCs): 420518 [0xaa5d4a8,0xb0c7f08),                                                                                                                
                             /out/handler_aim: Running 1 inputs 100 time(s) each.                                                                                                                                
                             Running: /testcase                                                                                                                                                                  
                             *** buffer overflow detected ***: terminated                                                                                                                                        
                             AddressSanitizer:DEADLYSIGNAL                                                                                                                                                       
                             =================================================================                                                                                                                   
                             ==18==ERROR: AddressSanitizer: ABRT on unknown address 0x000000000012 (pc 0x7f65a3f1e00b bp 0x7ffd2ae3f040 sp 0x7ffd2ae3ecc0 T0)                                                    
                             SCARINESS: 10 (signal)                                                                                                                                                              
                                 #0 0x7f65a3f1e00b in raise (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #1 0x7f65a3efd858 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x22858) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                        
                                 #2 0x7f65a3f68265  (/lib/x86_64-linux-gnu/libc.so.6+0x8d265) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                                
                                 #3 0x7f65a400acd9 in __fortify_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12fcd9) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                              
                                 #4 0x7f65a4009575 in __chk_fail (/lib/x86_64-linux-gnu/libc.so.6+0x12e575) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                                  
                                 #5 0x5dbcb23 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10                                                                                              
                                 #6 0x5dbcb23 in aim_get_buddyname /src/wireshark/epan/dissectors/packet-aim.c:591:3                                                                                             
                                 #7 0x5dbcb23 in dissect_aim_chat_outgoing_msg /src/wireshark/epan/dissectors/packet-aim.c:1976:21                                                                               
                                 #8 0x5dbaa2f in dissect_aim_snac /src/wireshark/epan/dissectors/packet-aim.c:809:3                                                                                              
                                 #9 0x5dbaa2f in dissect_aim_pdu /src/wireshark/epan/dissectors/packet-aim.c:1618:3                                                                                              
                                 #10 0x52ff8af in tcp_dissect_pdus /src/wireshark/epan/dissectors/packet-tcp.c:5569:13                                                                                           
                                 #11 0x5db7f4d in dissect_aim /src/wireshark/epan/dissectors/packet-aim.c:1655:2                                                                                                 
                                 #12 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #13 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #14 0x5b90394 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #15 0x5b90394 in call_all_postdissectors /src/wireshark/epan/packet.c:4166:3                                                                                                    
                                 #16 0x544b347 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1438:5                                                                                             
                                 #17 0x5b8573d in call_dissector_through_handle /src/wireshark/epan/packet.c:887:9                                                                                               
                                 #18 0x5b8573d in call_dissector_work /src/wireshark/epan/packet.c:975:9                                                                                                         
                                 #19 0x5b81237 in call_dissector_only /src/wireshark/epan/packet.c:3621:8                                                                                                        
                                 #20 0x5b81237 in call_dissector_with_data /src/wireshark/epan/packet.c:3634:8                                                                                                   
                                 #21 0x5b81237 in dissect_record /src/wireshark/epan/packet.c:687:3                                                                                                              
                                 #22 0x52bddb0 in epan_dissect_run /src/wireshark/epan/epan.c:666:2                                                                                                              
                                 #23 0x50b47c8 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:359:2                                                                                                   
                                 #24 0x4f674a0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13                            
                                 #25 0x4f51ac5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6                                
                                 #26 0x4f5755f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long))                                                                              
                             /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9                                                                                                                     
                                 #27 0x4f83452 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10                                                                                             
                                 #28 0x7f65a3eff082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)                                           
                                 #29 0x4f49cad in _start (/out/handler_aim+0x4f49cad)                                                                                                                            
                                                                                                                                                                                                                 
                             DEDUP_TOKEN: raise--abort--                                                                                                                                                         
                             AddressSanitizer can not provide additional info.                                                                                                                                   
                             SUMMARY: AddressSanitizer: ABRT (/lib/x86_64-linux-gnu/libc.so.6+0x4300b) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d) in raise                                              
                             ==18==ABORTING                                                                                                                                                                      
                             MS: 0 ; base unit: 0000000000000000000000000000000000000000                                                                                                                         
                             0x2a,0x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x28,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0                 
                             ,0x6f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x0,0x0,0xf7,0x0,0xe,0x0,0x5,0x0,0x0,0x0,0x0,0xff,0xfc,0x2a,0x2,0x2,0x24,0x8,0x0,0x0,0x0,0x0,0x0,0xf7,0                 
                             xff,0xff,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x2,0x2,0x24,0x0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0                 
                             x1,0x2a,0x5,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0x0,0x0,0x0,0x89,0x1f,0x5,0                 
                             x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x2a,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,                                                                        
                             *\001*\005\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000(\000\000\000\001*\000\000\000\000\000\000\000\000o\000\000\000\0                 
                             00\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\                 
                             000\000\000\000\000\000\000*\002\002\000\000\367\000\016\000\005\000\000\000\000\377\374*\002\002$\010\000\000\000\000\000\367\377\377\377\000\000\000\000\000\000\                 
                             000\000\000\000\000*\002\002$\000\200\000\000\000\000\000\000\001\000\000\000\001*\000\000\000\000\000\000\000\001*\005\000\001\000\000\000\000\000\000\000\000\002                 
                             \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\211\037\005\000\001\000\000\000\000\000\000\000\000\001\000\000\000\00                 
                             1*\000\000\000\000\000\000\000\000\000\000\012                                                                                                                                      
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v                                                
                             /tasks_new/wireshark_ws-full-01/fuzz-tooling/build/out/wireshark:/out -v /tmp/tmphn82q5ns:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce                            
                             handler_aim -runs=100.                                                                                                                                                              
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             epan/dissectors/packet-aim.c:550-650                                                                                                                                                
                             ```                                                                                                                                                                                 
                             550:*aim_get_subtype( uint16_t famnum, uint16_t subtype )                                                                                                                           
                             551:{                                                                                                                                                                               
                             552:    GList *gl = families;                                                                                                                                                       
                             553:    while(gl) {                                                                                                                                                                 
                             554:            aim_family *fam = (aim_family *)gl->data;                                                                                                                           
                             555:            if(fam->family == famnum) {                                                                                                                                         
                             556:                    int i;                                                                                                                                                      
                             557:                    for(i = 0; fam->subtypes[i].name; i++) {                                                                                                                    
                             558:                            if(fam->subtypes[i].id == subtype) return &(fam->subtypes[i]);                                                                                      
                             559:                    }                                                                                                                                                           
                             560:            }                                                                                                                                                                   
                             561:            gl = gl->next;                                                                                                                                                      
                             562:    }                                                                                                                                                                           
                             563:                                                                                                                                                                                
                             564:    return NULL;                                                                                                                                                                
                             565:                                                                                                                                                                                
                             566:}                                                                                                                                                                               
                             567:                                                                                                                                                                                
                             568:static const aim_family                                                                                                                                                         
                             569:*aim_get_family( uint16_t famnum )                                                                                                                                              
                             570:{                                                                                                                                                                               
                             571:    GList *gl = families;                                                                                                                                                       
                             572:    while(gl) {                                                                                                                                                                 
                             573:            aim_family *fam = (aim_family *)gl->data;                                                                                                                           
                             574:            if(fam->family == famnum) return fam;                                                                                                                               
                             575:            gl = gl->next;                                                                                                                                                      
                             576:    }                                                                                                                                                                           
                             577:                                                                                                                                                                                
                             578:    return NULL;                                                                                                                                                                
                             579:}                                                                                                                                                                               
                             580:                                                                                                                                                                                
                             581:static int                                                                                                                                                                      
                             582:aim_get_buddyname(wmem_allocator_t *pool, uint8_t **name, tvbuff_t *tvb, int offset)                                                                                            
                             583:{                                                                                                                                                                               
                             584:    uint16_t buddyname_length;                                                                                                                                                  
                             585:                                                                                                                                                                                
                             586:    *name = wmem_alloc(pool, 256);                                                                                                                                              
                             587:                                                                                                                                                                                
                             588:    buddyname_length = tvb_get_ntohs(tvb, offset);                                                                                                                              
                             589:                                                                                                                                                                                
                             590:    if (pool)                                                                                                                                                                   
                             591:            memcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);                                                                                                         
                             592:                                                                                                                                                                                
                             593:    return buddyname_length;                                                                                                                                                    
                             594:}                                                                                                                                                                               
                             595:                                                                                                                                                                                
                             596:                                                                                                                                                                                
                             597:static void                                                                                                                                                                     
                             598:aim_get_message( unsigned char *msg, tvbuff_t *tvb, int msg_offset, int msg_length)                                                                                             
                             599:{                                                                                                                                                                               
                             600:    int i,j,c;                                                                                                                                                                  
                             601:    bool bracket = false;                                                                                                                                                       
                             602:    int max, tagchars = 0;                                                                                                                                                      
                             603:    int new_offset = msg_offset;                                                                                                                                                
                             604:    int new_length = msg_length;                                                                                                                                                
                             605:                                                                                                                                                                                
                             606:                                                                                                                                                                                
                             607:    /* make sure nothing bigger than 1000 bytes is printed */                                                                                                                   
                             608:    if( msg_length > 999 ) return;                                                                                                                                              
                             609:                                                                                                                                                                                
                             610:    memset( msg, '\0', 1000);                                                                                                                                                   
                             611:    i = 0;                                                                                                                                                                      
                             612:    c = 0;                                                                                                                                                                      
                             613:                                                                                                                                                                                
                             614:    /* loop until HTML tag is reached - quick&dirty way to find start of message                                                                                                
                             615:     * (it is nearly impossible to find the correct start offset for all client versions) */                                                                                    
                             616:    while( (tagchars < 6) && (new_length > 5) )                                                                                                                                 
                             617:    {                                                                                                                                                                           
                             618:            j = tvb_get_uint8(tvb, new_offset);                                                                                                                                 
                             619:            if( ( (j == '<') && (tagchars == 0) ) ||                                                                                                                            
                             620:                ( (j == 'h') && (tagchars == 1) ) ||                                                                                                                            
                             621:                ( (j == 'H') && (tagchars == 1) ) ||                                                                                                                            
                             622:                ( (j == 't') && (tagchars == 2) ) ||                                                                                                                            
                             623:                ( (j == 'T') && (tagchars == 2) ) ||                                                                                                                            
                             624:                ( (j == 'm') && (tagchars == 3) ) ||                                                                                                                            
                             625:                ( (j == 'M') && (tagchars == 3) ) ||                                                                                                                            
                             626:                ( (j == 'l') && (tagchars == 4) ) ||                                                                                                                            
                             627:                ( (j == 'L') && (tagchars == 4) ) ||                                                                                                                            
                             628:                ( (j == '>') && (tagchars == 5) ) ) tagchars++;                                                                                                                 
                             629:            new_offset++;                                                                                                                                                       
                             630:            new_length--;                                                                                                                                                       
                             631:    }                                                                                                                                                                           
                             632:                                                                                                                                                                                
                             633:    /* set offset and length of message to after the first HTML tag */                                                                                                          
                             634:    msg_offset = new_offset;                                                                                                                                                    
                             635:    msg_length = new_length;                                                                                                                                                    
                             636:    max = msg_length - 1;                                                                                                                                                       
                             637:    tagchars = 0;                                                                                                                                                               
                             638:                                                                                                                                                                                
                             639:    /* find the rest of the message until either a </html> is reached or the end of the frame.                                                                                  
                             640:     * All other HTML tags are stripped to display only the raw message (printable characters) */                                                                               
                             641:    while( (c < max) && (tagchars < 7) )                                                                                                                                        
                             642:    {                                                                                                                                                                           
                             643:            j = tvb_get_uint8(tvb, msg_offset+c);                                                                                                                               
                             644:                                                                                                                                                                                
                             645:                                                                                                                                                                                
                             646:            /* make sure this is an HTML tag by checking the order of the chars */                                                                                              
                             647:            if( ( (j == '<') && (tagchars == 0) ) ||                                                                                                                            
                             648:                ( (j == '/') && (tagchars == 1) ) ||                                                                                                                            
                             649:                ( (j == 'h') && (tagchars == 2) ) ||                                                                                                                            
                             650:                ( (j == 'H') && (tagchars == 2) ) ||                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             epan/dissectors/packet-aim.c:1930-2000                                                                                                                                              
                             ```                                                                                                                                                                                 
                             1930: ***********************************************************************************************************/                                                                  
                             1931:                                                                                                                                                                               
                             1932:/* SNAC families */                                                                                                                                                            
                             1933:                                                                                                                                                                               
                             1934:#define AIM_CHAT_TLV_BROWSABLE_TREE                0x001                                                                                                                       
                             1935:#define AIM_CHAT_TLV_CLASS_EXCLUSIVE               0x002                                                                                                                       
                             1936:#define AIM_CHAT_TLV_MAX_CONCURRENT_ROOMS  0x003                                                                                                                               
                             1937:#define AIM_CHAT_TLV_MAX_ROOM_NAME_LEN             0x004                                                                                                                       
                             1938:#define AIM_CHAT_TLV_ROOT_ROOMS                    0x005                                                                                                                       
                             1939:#define AIM_CHAT_TLV_SEARCH_TAGS           0x006                                                                                                                               
                             1940:#define AIM_CHAT_TLV_CHILD_ROOMS           0x065                                                                                                                               
                             1941:#define AIM_CHAT_TLV_CONTAINS_USER_CLASS   0x066                                                                                                                               
                             1942:#define AIM_CHAT_TLV_CONTAINS_USER_ARRAY   0x067                                                                                                                               
                             1943:                                                                                                                                                                               
                             1944:#if 0                                                                                                                                                                          
                             1945:static const aim_tlv aim_chat_tlvs[] _U_ = {                                                                                                                                   
                             1946:   { AIM_CHAT_TLV_BROWSABLE_TREE,       "Browsable tree",                  dissect_aim_tlv_value_bytes },                                                                      
                             1947:   { AIM_CHAT_TLV_CLASS_EXCLUSIVE,      "Exclusively for class",           dissect_aim_tlv_value_userclass },                                                                  
                             1948:   { AIM_CHAT_TLV_MAX_CONCURRENT_ROOMS, "Max. number of concurrent rooms", dissect_aim_tlv_value_uint8 },                                                                      
                             1949:   { AIM_CHAT_TLV_MAX_ROOM_NAME_LEN,    "Max. length of room name",        dissect_aim_tlv_value_uint8 },                                                                      
                             1950:   { AIM_CHAT_TLV_ROOT_ROOMS,           "Root Rooms",                      dissect_aim_tlv_value_bytes },                                                                      
                             1951:   { AIM_CHAT_TLV_SEARCH_TAGS,          "Search Tags",                     dissect_aim_tlv_value_bytes },                                                                      
                             1952:   { AIM_CHAT_TLV_CHILD_ROOMS,          "Child Rooms",                     dissect_aim_tlv_value_bytes },                                                                      
                             1953:   { AIM_CHAT_TLV_CONTAINS_USER_CLASS,  "Contains User Class",             dissect_aim_tlv_value_bytes },                                                                      
                             1954:   { AIM_CHAT_TLV_CONTAINS_USER_ARRAY,  "Contains User Array",             dissect_aim_tlv_value_bytes },                                                                      
                             1955:   { 0, NULL, NULL }                                                                                                                                                           
                             1956:};                                                                                                                                                                             
                             1957:#endif                                                                                                                                                                         
                             1958:                                                                                                                                                                               
                             1959:                                                                                                                                                                               
                             1960:static int dissect_aim_chat_userinfo_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *chat_tree)                                                                            
                             1961:{                                                                                                                                                                              
                             1962:   int offset = 0;                                                                                                                                                             
                             1963:   while(tvb_reported_length_remaining(tvb, offset) > 0) {                                                                                                                     
                             1964:           offset = dissect_aim_userinfo(tvb, pinfo, offset, chat_tree);                                                                                                       
                             1965:   }                                                                                                                                                                           
                             1966:   return offset;                                                                                                                                                              
                             1967:}                                                                                                                                                                              
                             1968:                                                                                                                                                                               
                             1969:static int dissect_aim_chat_outgoing_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *chat_tree _U_)                                                                         
                             1970:{                                                                                                                                                                              
                             1971:   uint8_t *buddyname;                                                                                                                                                         
                             1972:   unsigned char *msg;                                                                                                                                                         
                             1973:   int buddyname_length;                                                                                                                                                       
                             1974:                                                                                                                                                                               
                             1975:   msg=(unsigned char *)wmem_alloc(pinfo->pool, 1000);                                                                                                                         
                             1976:   buddyname_length = aim_get_buddyname( pinfo->pool, &buddyname, tvb, 30 );                                                                                                   
                             1977:                                                                                                                                                                               
                             1978:   /* channel message from client */                                                                                                                                           
                             1979:   aim_get_message( msg, tvb, 40 + buddyname_length, tvb_reported_length(tvb)                                                                                                  
                             1980:                                    - 40 - buddyname_length );                                                                                                                 
                             1981:                                                                                                                                                                               
                             1982:   col_append_fstr(pinfo->cinfo, COL_INFO, " -> %s", msg);                                                                                                                     
                             1983:                                                                                                                                                                               
                             1984:   return tvb_reported_length(tvb);                                                                                                                                            
                             1985:}                                                                                                                                                                              
                             1986:                                                                                                                                                                               
                             1987:                                                                                                                                                                               
                             1988:static int dissect_aim_chat_incoming_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *chat_tree)                                                                             
                             1989:{                                                                                                                                                                              
                             1990:   uint8_t *buddyname;                                                                                                                                                         
                             1991:   unsigned char *msg;                                                                                                                                                         
                             1992:   /* channel message to client */                                                                                                                                             
                             1993:   int buddyname_length;                                                                                                                                                       
                             1994:                                                                                                                                                                               
                             1995:   msg=(unsigned char *)wmem_alloc(pinfo->pool, 1000);                                                                                                                         
                             1996:   buddyname_length = aim_get_buddyname( pinfo->pool, &buddyname, tvb, 30 );                                                                                                   
                             1997:                                                                                                                                                                               
                             1998:   aim_get_message( msg, tvb, 36 + buddyname_length, tvb_reported_length(tvb)                                                                                                  
                             1999:                                    - 36 - buddyname_length );                                                                                                                 
                             2000:                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             epan/dissectors/packet-aim.c:780-850                                                                                                                                                
                             ```                                                                                                                                                                                 
                             780:                                                                                                                                                                                
                             781:    if (family)                                                                                                                                                                 
                             782:            col_set_str(pinfo->cinfo, COL_PROTOCOL, family->name);                                                                                                              
                             783:                                                                                                                                                                                
                             784:    if(subtype != NULL && family != NULL)                                                                                                                                       
                             785:    {                                                                                                                                                                           
                             786:            col_set_str(pinfo->cinfo, COL_INFO, family->name);                                                                                                                  
                             787:            col_append_fstr(pinfo->cinfo, COL_INFO, ", %s", subtype->name);                                                                                                     
                             788:    } else {                                                                                                                                                                    
                             789:            col_set_str(pinfo->cinfo, COL_INFO, "SNAC data");                                                                                                                   
                             790:                                                                                                                                                                                
                             791:            if(family)                                                                                                                                                          
                             792:                    col_append_fstr(pinfo->cinfo, COL_INFO, ", %s", family->name);                                                                                              
                             793:            else                                                                                                                                                                
                             794:                    col_append_fstr(pinfo->cinfo, COL_INFO, ", Family: 0x%04x", family_id);                                                                                     
                             795:                                                                                                                                                                                
                             796:            col_append_fstr(pinfo->cinfo, COL_INFO, ", Subtype: 0x%04x", subtype_id);                                                                                           
                             797:    }                                                                                                                                                                           
                             798:                                                                                                                                                                                
                             799:    if(aim_tree && family != NULL)                                                                                                                                              
                             800:    {                                                                                                                                                                           
                             801:            proto_item *ti = proto_tree_add_item(root_tree, family->proto_id, subtvb, 0, -1, ENC_NA);                                                                           
                             802:            family_tree = proto_item_add_subtree(ti, family->ett);                                                                                                              
                             803:            if(subtype)                                                                                                                                                         
                             804:                    proto_item_append_text(ti, ", %s", subtype->name);                                                                                                          
                             805:    }                                                                                                                                                                           
                             806:                                                                                                                                                                                
                             807:    if((tvb_reported_length_remaining(tvb, offset) > 0) && (subtype != NULL) && subtype->dissector)                                                                             
                             808:    {                                                                                                                                                                           
                             809:            subtype->dissector(subtvb, pinfo, family_tree);                                                                                                                     
                             810:    }                                                                                                                                                                           
                             811:}                                                                                                                                                                               
                             812:                                                                                                                                                                                
                             813:static void                                                                                                                                                                     
                             814:dissect_aim_flap_err(tvbuff_t *tvb, packet_info *pinfo, int offset,                                                                                                             
                             815:                 proto_tree *tree)                                                                                                                                              
                             816:{                                                                                                                                                                               
                             817:    col_set_str(pinfo->cinfo, COL_INFO, "FLAP error");                                                                                                                          
                             818:                                                                                                                                                                                
                             819:    /* Show the undissected payload */                                                                                                                                          
                             820:    if (tvb_reported_length_remaining(tvb, offset) > 0)                                                                                                                         
                             821:            proto_tree_add_item(tree, hf_aim_data, tvb, offset, -1, ENC_NA);                                                                                                    
                             822:}                                                                                                                                                                               
                             823:                                                                                                                                                                                
                             824:static void                                                                                                                                                                     
                             825:dissect_aim_keep_alive(tvbuff_t *tvb, packet_info *pinfo, int offset,                                                                                                           
                             826:                   proto_tree *tree)                                                                                                                                            
                             827:{                                                                                                                                                                               
                             828:    col_set_str(pinfo->cinfo, COL_INFO, "Keep Alive");                                                                                                                          
                             829:                                                                                                                                                                                
                             830:    /* Show the undissected payload */                                                                                                                                          
                             831:    if (tvb_reported_length_remaining(tvb, offset) > 0)                                                                                                                         
                             832:            proto_tree_add_item(tree, hf_aim_data, tvb, offset, -1, ENC_NA);                                                                                                    
                             833:}                                                                                                                                                                               
                             834:                                                                                                                                                                                
                             835:static void                                                                                                                                                                     
                             836:dissect_aim_unknown_channel(tvbuff_t *tvb, packet_info *pinfo, int offset,                                                                                                      
                             837:                        proto_tree *tree)                                                                                                                                       
                             838:{                                                                                                                                                                               
                             839:    col_set_str(pinfo->cinfo, COL_INFO, "Unknown Channel");                                                                                                                     
                             840:                                                                                                                                                                                
                             841:    /* Show the undissected payload */                                                                                                                                          
                             842:    if (tvb_reported_length_remaining(tvb, offset) > 0)                                                                                                                         
                             843:            proto_tree_add_item(tree, hf_aim_data, tvb, offset, -1, ENC_NA);                                                                                                    
                             844:}                                                                                                                                                                               
                             845:                                                                                                                                                                                
                             846:static int                                                                                                                                                                      
                             847:dissect_aim_buddyname(tvbuff_t *tvb, packet_info *pinfo _U_, int offset,                                                                                                        
                             848:                  proto_tree *tree)                                                                                                                                             
                             849:{                                                                                                                                                                               
                             850:    uint8_t buddyname_length = 0;                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             epan/dissectors/packet-aim.c:581-594                                                                                                                                                
                             ```                                                                                                                                                                                 
                             581:static int                                                                                                                                                                      
                             582:aim_get_buddyname(wmem_allocator_t *pool, uint8_t **name, tvbuff_t *tvb, int offset)                                                                                            
                             583:{                                                                                                                                                                               
                             584:    uint16_t buddyname_length;                                                                                                                                                  
                             585:                                                                                                                                                                                
                             586:    *name = wmem_alloc(pool, 256);                                                                                                                                              
                             587:                                                                                                                                                                                
                             588:    buddyname_length = tvb_get_ntohs(tvb, offset);                                                                                                                              
                             589:                                                                                                                                                                                
                             590:    if (pool)                                                                                                                                                                   
                             591:            memcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);                                                                                                         
                             592:                                                                                                                                                                                
                             593:    return buddyname_length;                                                                                                                                                    
                             594:}                                                                                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             epan/dissectors/packet-aim.c:606-610                                                                                                                                                
                             ```                                                                                                                                                                                 
                             606:                                                                                                                                                                                
                             607:    /* make sure nothing bigger than 1000 bytes is printed */                                                                                                                   
                             608:    if( msg_length > 999 ) return;                                                                                                                                              
                             609:                                                                                                                                                                                
                             610:    memset( msg, '\0', 1000);                                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Tests Result===                                                                                                                                                                  
                             No tests found                                                                                                                                                                      
                             ===Evaluation End===                                                                                                                                                                
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                                                      __init__.py:160
                             (n evals: 2, patch status: PatchStatus.SOUND)                                                                                                                                       
                    INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpg85meun7                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/wireshark_ws-full-01_vuln_011/agent-output-1761640927.867664                                                                        
                             - Detection toml file: /tasks_new/wireshark_ws-full-01/detection/wireshark_ws-full-01_vuln_011.toml                                                                                 
                             - Challenge project directory: /tasks_new/wireshark_ws-full-01/official-afc-wireshark                                                                                               
                                                                                                                                                                                                                 
