{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-03_vuln_4",
  "source_directory": "/home/user/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.1649945,
    "prompt_tokens": 75223,
    "completion_tokens": 18693
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -219,7 +219,7 @@\n      * </p>\n      */\n     private static final Pattern PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN =\n-            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d*)?\");\n+            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d{0,9})?\");\n \n     private static FileTime fileTimeFromOptionalSeconds(final long seconds) {\n         return seconds <= 0 ? null : FileTimes.fromUnixTime(seconds);\n@@ -272,11 +272,32 @@\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n         }\n \n-        final BigDecimal epochSeconds = new BigDecimal(value);\n-        final long seconds = epochSeconds.longValue();\n-        final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n+        // Manual parsing to avoid expensive BigDecimal operations\n         try {\n-            return Instant.ofEpochSecond(seconds, nanos);\n+            String secondsPart;\n+            String fractionPart;\n+            int dotIndex = value.indexOf('.');\n+            if (dotIndex >= 0) {\n+                secondsPart = value.substring(0, dotIndex);\n+                fractionPart = value.substring(dotIndex + 1);\n+            } else {\n+                secondsPart = value;\n+                fractionPart = \"\";\n+            }\n+            long secs = Long.parseLong(secondsPart);\n+            if (fractionPart.length() > 9) {\n+                throw new IOException(\"Corrupted PAX header. Time field value has too many fractional digits '\" + value + \"'\");\n+            }\n+            long nanosVal = 0;\n+            if (!fractionPart.isEmpty()) {\n+                String frac = fractionPart + \"000000000\";\n+                frac = frac.substring(0, 9);\n+                nanosVal = Long.parseLong(frac);\n+            }\n+            if (secs < 0) {\n+                nanosVal = -nanosVal;\n+            }\n+            return Instant.ofEpochSecond(secs, nanosVal);\n         } catch (DateTimeException | ArithmeticException e) {\n             // DateTimeException: Thrown if the instant exceeds the maximum or minimum instant.\n             // ArithmeticException: Thrown if numeric overflow occurs.\n",
  "stdout": "",
  "stderr": ""
}