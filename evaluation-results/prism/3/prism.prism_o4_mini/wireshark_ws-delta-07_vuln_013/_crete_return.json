{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.20229990000000003,
    "prompt_tokens": 129329,
    "completion_tokens": 13645
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -980,10 +980,11 @@\n {\n \tuint32_t value = 0;\n \t\n+\tif (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT)\n+\t    return 0;\n \tvalue = tvb_get_letohl(tvb, offset);\n \tgvcp_register_number[gvcp_register_count] = addr;\n \tgvcp_register_value[gvcp_register_count++] = value;\n-\n \tswitch (addr)\n \t{\n \tcase GVCP_VERSION:\n@@ -1495,10 +1496,11 @@\n {\n \tuint32_t value = 0;\n \t\n+\tif (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT)\n+\t    return 0;\n \tvalue = tvb_get_letohl(tvb, offset);\n \tgvcp_register_number[gvcp_register_count] = addr;\n \tgvcp_register_value[gvcp_register_count++] = value;\n-\n \tswitch (addr)\n \t{\n \tcase GVCP_SC_GENDC_DESCRIPTOR_ADDRESS:\n@@ -1781,6 +1783,10 @@\n \tconst char *address_string = NULL;\n \tbool is_custom_register = false;\n \tint num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */\n+\t/* Reset global register count and clamp to max entries */\n+\tgvcp_register_count = 0;\n+\tif (num_registers > GVCP_MAX_REGISTER_COUNT)\n+\t    num_registers = GVCP_MAX_REGISTER_COUNT;\n \tproto_tree *subtree = NULL;\n \n \tif (gvcp_trans)\n",
  "stdout": "",
  "stderr": ""
}